[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS626 Portfolio",
    "section": "",
    "text": "Welcome! This is my course website for ISSS626.\n\nHands-on → see Ex01a in the navbar.\nIn-class / Take-home pages are placeholders for now."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Local Measures of Spatial Autocorrelation (LMSA) focus on the relationships between each observation and its surroundings, rather than providing a single summary of these relationships across the map. In this sense, they are not summary statistics but scores that allow us to learn more about the spatial structure in our data.\nIn this hands-on exercise, you will learn how to compute Local Measures of Spatial Autocorrelation (LMSA) by using sfdep package. By the end of this hands-on exercise, you will be able to:\n\nImport geospatial data using appropriate function(s) of sf package\nImport csv file using appropriate function of readr package\nPerform relational join using appropriate join function of dplyr package\nCompute Local Indicator of Spatial Association (LISA) statistics for detecting clusters and outliers by using appropriate functions of sfdep package\nCompute Getis-Ord’s Gi-statistics for detecting hot spot or/and cold spot area by using appropriate functions of sfdep package\nVisualise the analysis output by using tmap package\n\n\n\nIn spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China.\n\n\n\nTwo data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-analytical-question",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-analytical-question",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-study-area-and-data",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-study-area-and-data",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Two data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#setting-the-analytical-tools",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#setting-the-analytical-tools",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "2.1 Setting the Analytical Tools",
    "text": "2.1 Setting the Analytical Tools\nBefore we get started, we need to ensure that sf, sfdep, tmap and tidyverse packages are installed and loaded.\n\nsf is used for importing and handling geospatial data in R\ntidyverse is mainly used for wrangling attribute data in R\nsfdep will be used to compute spatial weights, global and local spatial autocorrelation statistics\ntmap will be used to prepare cartographic quality choropleth maps\n\n\npacman::p_load(sf, sfdep, tmap, tidyverse, knitr)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-shapefile-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-shapefile-into-r-environment",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.1 Import shapefile into R environment",
    "text": "3.1 Import shapefile into R environment\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be simple features object of sf.\n\n\nShow code\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\n\nReading layer `Hunan' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\nImportant: The raw data is in WGS 84 geographic coordinates system. For geospatial analysis, it is appropriate to use projected coordinates system. We will transform Hunan geospatial data from WGS 84 to UTM zone 50N (i.e. EPSG: 32650).\n\n\nShow code\nhunan &lt;- st_transform(hunan, crs = 32650)\n\n# Verify the transformation\nst_crs(hunan)\n\n\nCoordinate Reference System:\n  User input: EPSG:32650 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 50N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            MEMBER[\"World Geodetic System 1984 (G2296)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 50N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",117,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 114°E and 120°E, northern hemisphere between equator and 84°N, onshore and offshore. Brunei. China. Hong Kong. Indonesia. Malaysia - East Malaysia - Sarawak. Mongolia. Philippines. Russian Federation. Taiwan.\"],\n        BBOX[0,114,84,120]],\n    ID[\"EPSG\",32650]]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-csv-file-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-csv-file-into-r-environment",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.2 Import csv file into R environment",
    "text": "3.2 Import csv file into R environment\nNext, we will import Hunan_2012.csv into R by using read_csv() of readr package.\n\n\nShow code\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\", show_col_types = FALSE)\n\n# Check the data structure\nglimpse(hunan2012)\n\n\nRows: 88\nColumns: 29\n$ County      &lt;chr&gt; \"Anhua\", \"Anren\", \"Anxiang\", \"Baojing\", \"Chaling\", \"Changn…\n$ City        &lt;chr&gt; \"Yiyang\", \"Chenzhou\", \"Changde\", \"Hunan West\", \"Zhuzhou\", …\n$ avg_wage    &lt;dbl&gt; 30544, 28058, 31935, 30843, 31251, 28518, 54540, 28597, 33…\n$ deposite    &lt;dbl&gt; 10967.0, 4598.9, 5517.2, 2250.0, 8241.4, 10860.0, 24332.0,…\n$ FAI         &lt;dbl&gt; 6831.7, 6386.1, 3541.0, 1005.4, 6508.4, 7920.0, 33624.0, 1…\n$ Gov_Rev     &lt;dbl&gt; 456.72, 220.57, 243.64, 192.59, 620.19, 769.86, 5350.00, 1…\n$ Gov_Exp     &lt;dbl&gt; 2703.0, 1454.7, 1779.5, 1379.1, 1947.0, 2631.6, 7885.5, 11…\n$ GDP         &lt;dbl&gt; 13225.0, 4941.2, 12482.0, 4087.9, 11585.0, 19886.0, 88009.…\n$ GDPPC       &lt;dbl&gt; 14567, 12761, 23667, 14563, 20078, 24418, 88656, 10132, 17…\n$ GIO         &lt;dbl&gt; 9276.90, 4189.20, 5108.90, 3623.50, 9157.70, 37392.00, 513…\n$ Loan        &lt;dbl&gt; 3954.90, 2555.30, 2806.90, 1253.70, 4287.40, 4242.80, 4053…\n$ NIPCR       &lt;dbl&gt; 3528.3, 3271.8, 7693.7, 4191.3, 3887.7, 9528.0, 17070.0, 3…\n$ Bed         &lt;dbl&gt; 2718, 970, 1931, 927, 1449, 3605, 3310, 582, 2170, 2179, 1…\n$ Emp         &lt;dbl&gt; 494.310, 290.820, 336.390, 195.170, 330.290, 548.610, 670.…\n$ EmpR        &lt;dbl&gt; 441.4, 255.4, 270.5, 145.6, 299.0, 415.1, 452.0, 127.6, 21…\n$ EmpRT       &lt;dbl&gt; 338.0, 99.4, 205.9, 116.4, 154.0, 273.7, 219.4, 94.4, 174.…\n$ Pri_Stu     &lt;dbl&gt; 54.175, 33.171, 19.584, 19.249, 33.906, 81.831, 59.151, 18…\n$ Sec_Stu     &lt;dbl&gt; 32.830, 17.505, 17.819, 11.831, 20.548, 44.485, 39.685, 7.…\n$ Household   &lt;dbl&gt; 290.4, 104.6, 148.1, 73.2, 148.7, 211.2, 300.3, 76.1, 139.…\n$ Household_R &lt;dbl&gt; 234.5, 121.9, 135.4, 69.9, 139.4, 211.7, 248.4, 59.6, 110.…\n$ NOIP        &lt;dbl&gt; 101, 34, 53, 18, 106, 115, 214, 17, 55, 70, 44, 84, 74, 17…\n$ Pop_R       &lt;dbl&gt; 670.3, 243.2, 346.0, 184.1, 301.6, 448.2, 475.1, 189.6, 31…\n$ RSCG        &lt;dbl&gt; 5760.60, 2386.40, 3957.90, 768.04, 4009.50, 5220.40, 22604…\n$ Pop_T       &lt;dbl&gt; 910.8, 388.7, 528.3, 281.3, 578.4, 816.3, 998.6, 256.7, 45…\n$ Agri        &lt;dbl&gt; 4942.253, 2357.764, 4524.410, 1118.561, 3793.550, 6430.782…\n$ Service     &lt;dbl&gt; 5414.5, 3814.1, 14100.0, 541.8, 5444.0, 13074.6, 17726.6, …\n$ Disp_Inc    &lt;dbl&gt; 12373, 16072, 16610, 13455, 20461, 20868, 183252, 12379, 1…\n$ RORP        &lt;dbl&gt; 0.7359464, 0.6256753, 0.6549309, 0.6544614, 0.5214385, 0.5…\n$ ROREmp      &lt;dbl&gt; 0.8929619, 0.8782065, 0.8041262, 0.7460163, 0.9052651, 0.7…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#performing-relational-join",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#performing-relational-join",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.3 Performing relational join",
    "text": "3.3 Performing relational join\nThe code chunk below will be used to update the attribute table of hunan’s sf data frame with the attribute fields of hunan2012 dataframe.\n\n\nShow code\nhunan &lt;- left_join(hunan, hunan2012, by = c(\"County\" = \"County\"))\n\n# Check the result\nglimpse(hunan)\n\n\nRows: 88\nColumns: 36\n$ NAME_2      &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ ID_3        &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 21…\n$ NAME_3      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ ENGTYPE_3   &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"Co…\n$ Shape_Leng  &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.171918…\n$ Shape_Area  &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.11450357…\n$ County      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ City        &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ avg_wage    &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 45…\n$ deposite    &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, 1…\n$ FAI         &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0,…\n$ Gov_Rev     &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, 2…\n$ Gov_Exp     &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 48…\n$ GDP         &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 81113…\n$ GDPPC       &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 70…\n$ GIO         &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254.…\n$ Loan        &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 23408…\n$ NIPCR       &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, 1…\n$ Bed         &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970, …\n$ Emp         &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 85…\n$ EmpR        &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 268…\n$ EmpRT       &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 131…\n$ Pri_Stu     &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80.…\n$ Sec_Stu     &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68.…\n$ Household   &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 161…\n$ Household_R &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 154…\n$ NOIP        &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, 4…\n$ Pop_R       &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 266…\n$ RSCG        &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, 1…\n$ Pop_T       &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5, …\n$ Agri        &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.510…\n$ Service     &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.8…\n$ Disp_Inc    &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 27…\n$ RORP        &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.6…\n$ ROREmp      &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.8…\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.96…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-regional-development-indicator",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-regional-development-indicator",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.4 Visualising Regional Development Indicator",
    "text": "3.4 Visualising Regional Development Indicator\nIn the code chunks below, tmap functions are used to build two choropleth maps by using equal interval and quantile classification methods.\n\n\nShow code\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp = 1, \n             ncol = 2)\n\n\n\n\n\n\n\n\n\nQuestions to consider: - Does the plot above reveal any outliers or clusters? - Does the plot above indicate the presence of hot spots or cold spots?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-contiguity-spatial-weights",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-contiguity-spatial-weights",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.1 Computing Contiguity Spatial Weights",
    "text": "4.1 Computing Contiguity Spatial Weights\nBefore we can compute the local spatial autocorrelation statistics, we need to construct a spatial weights of the study area.\nIn the code chunk below, st_contiguity() of sfdep package is used to compute contiguity weight matrices for the study area.\n\n\nShow code\n# Compute contiguity neighbours\nnb &lt;- st_contiguity(hunan)\n\n# Calculate spatial weights (row-standardized)\nwt &lt;- st_weights(nb, \n                 style = \"W\")\n\n# Add to the sf data frame\nhunan &lt;- hunan %&gt;%\n  mutate(nb = nb,\n         wt = wt,\n         .before = 1)\n\n\nTo reveal the neighbour list, code chunk below is used:\n\n\nShow code\nsummary(nb)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report shows that: - There are 88 area units in Hunan - The most connected area unit has 11 neighbours - There are two area units with only one neighbour"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-morans-i",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.2 Computing local Moran’s I",
    "text": "4.2 Computing local Moran’s I\nTo compute local Moran’s I, the local_moran() function of sfdep will be used.\n\n\nShow code\nlisa &lt;- hunan %&gt;%\n  mutate(local_moran = local_moran(GDPPC, nb, wt),\n         .before = 1) %&gt;%\n  unnest(local_moran)\n\n# Check the structure\nglimpse(lisa)\n\n\nRows: 88\nColumns: 50\n$ ii           &lt;dbl&gt; -1.468468e-03, 2.587817e-02, -1.198765e-02, 1.022468e-03,…\n$ eii          &lt;dbl&gt; -5.031595e-06, 4.179725e-03, 2.258314e-03, 8.792440e-06, …\n$ var_ii       &lt;dbl&gt; 4.423043e-04, 1.101828e-02, 1.061694e-01, 4.994452e-06, 1…\n$ z_ii         &lt;dbl&gt; -0.06958460, 0.20671488, -0.04372119, 0.45358108, 0.39958…\n$ p_ii         &lt;dbl&gt; 0.9445242908, 0.8362325383, 0.9651266470, 0.6501303708, 0…\n$ p_ii_sim     &lt;dbl&gt; 0.828, 0.952, 0.812, 0.572, 0.608, 0.808, 0.024, 0.100, 0…\n$ p_folded_sim &lt;dbl&gt; 0.414, 0.476, 0.406, 0.286, 0.304, 0.404, 0.012, 0.050, 0…\n$ skewness     &lt;dbl&gt; -0.7867148, -0.8685058, 0.8664268, 0.8163783, 1.1171427, …\n$ kurtosis     &lt;dbl&gt; 0.5687998, 0.5171958, 0.3141648, 0.5230209, 1.8978968, 0.…\n$ mean         &lt;fct&gt; Low-High, Low-Low, High-Low, High-High, High-High, High-L…\n$ median       &lt;fct&gt; High-High, High-High, High-High, High-High, High-High, Hi…\n$ pysal        &lt;fct&gt; Low-High, Low-Low, High-Low, High-High, High-High, High-L…\n$ nb           &lt;nb&gt; &lt;2, 3, 4, 57, 85&gt;, &lt;1, 57, 58, 78, 85&gt;, &lt;1, 4, 5, 85&gt;, &lt;1,…\n$ wt           &lt;list&gt; &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0…\n$ NAME_2       &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ ID_3         &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 2…\n$ NAME_3       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ ENGTYPE_3    &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"C…\n$ Shape_Leng   &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.17191…\n$ Shape_Area   &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.1145035…\n$ County       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ City         &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ avg_wage     &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 4…\n$ deposite     &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, …\n$ FAI          &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0…\n$ Gov_Rev      &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, …\n$ Gov_Exp      &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 4…\n$ GDP          &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 8111…\n$ GDPPC        &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 7…\n$ GIO          &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254…\n$ Loan         &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 2340…\n$ NIPCR        &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, …\n$ Bed          &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970,…\n$ Emp          &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 8…\n$ EmpR         &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 26…\n$ EmpRT        &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 13…\n$ Pri_Stu      &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80…\n$ Sec_Stu      &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68…\n$ Household    &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 16…\n$ Household_R  &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 15…\n$ NOIP         &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, …\n$ Pop_R        &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 26…\n$ RSCG         &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, …\n$ Pop_T        &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5,…\n$ Agri         &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.51…\n$ Service      &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.…\n$ Disp_Inc     &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 2…\n$ RORP         &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.…\n$ ROREmp       &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.9…\n\n\nThe local_moran() function returns a data frame with the following columns: - ii: the local Moran’s I statistics - eii: the expectation of local moran statistic under the randomisation hypothesis - var_ii: the variance of local moran statistic under the randomisation hypothesis - z_ii: the standard deviate of local moran statistic - p_ii: the p-value of local moran statistic - mean: classification based on mean - median: classification based on median - pysal: classification following PySAL convention"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-local-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-local-morans-i",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.3 Visualising local Moran’s I",
    "text": "4.3 Visualising local Moran’s I\n\n4.3.1 Mapping local Moran’s I values\nUsing choropleth mapping functions of tmap package, we can plot the local Moran’s I values.\n\n\nShow code\ntm_shape(lisa) +\n  tm_fill(\"ii\",\n          style = \"pretty\",\n          palette = \"RdBu\",\n          midpoint = NA) +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Moran's I of GDPPC\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n4.3.2 Mapping local Moran’s I p-values\nThe choropleth shows there is evidence for both positive and negative Ii values. However, it is useful to consider the p-values for each of these values.\n\n\nShow code\ntm_shape(lisa) +\n  tm_fill(\"p_ii\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\",\n          title = \"p-value\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values of Local Moran's I\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n4.3.3 Mapping both local Moran’s I values and p-values\nFor effective interpretation, it is better to plot both the local Moran’s I values map and its corresponding p-values map next to each other.\n\n\nShow code\nii_map &lt;- tm_shape(lisa) +\n  tm_fill(\"ii\",\n          style = \"pretty\",\n          n = 5,\n          palette = \"RdBu\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Moran's I of GDPPC\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\np_ii_map &lt;- tm_shape(lisa) +\n  tm_fill(\"p_ii\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values of Local Moran's I\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\ntmap_arrange(ii_map, p_ii_map, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#preparing-and-visualising-lisa-map",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#preparing-and-visualising-lisa-map",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.4 Preparing and Visualising LISA Map",
    "text": "4.4 Preparing and Visualising LISA Map\n\n4.4.1 Plotting Moran scatterplot\nA Moran Scatterplot is a graphical tool that visualizes the relationship between a variable’s values and the average values of its neighboring locations (spatial lag).\nFirst, we need to calculate the spatial lag of GDPPC:\n\n\nShow code\nlisa &lt;- lisa %&gt;%\n  mutate(lag_GDPPC = st_lag(GDPPC, nb, wt),\n         .before = 1)\n\n\nNow, plot the Moran Scatterplot:\n\n\nShow code\nggplot(data = lisa,\n       aes(x = GDPPC,\n           y = lag_GDPPC)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              color = \"red\") +\n  labs(x = \"GDPPC\",\n       y = \"Spatial Lag of GDPPC\",\n       title = \"Moran Scatterplot\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nTo make the plot more intuitive, we can color-code by LISA quadrants:\n\n\nShow code\nggplot(data = lisa,\n       aes(x = GDPPC,\n           y = lag_GDPPC,\n           color = mean)) +\n  geom_point(size = 2) +\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              color = \"black\") +\n  geom_hline(yintercept = mean(lisa$lag_GDPPC), lty = 2) +\n  geom_vline(xintercept = mean(lisa$GDPPC), lty = 2) +\n  scale_color_manual(\n    values = c(\"High-High\" = \"red\",\n               \"Low-Low\" = \"blue\",\n               \"Low-High\" = \"lightblue\",\n               \"High-Low\" = \"pink\")) +\n  labs(x = \"GDPPC\",\n       y = \"Spatial Lag of GDPPC\",\n       title = \"Moran Scatterplot with LISA Quadrants\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n4.4.2 Plotting Moran scatterplot with standardised variable\nFirst we will use scale() to center and scale the variable:\n\n\nShow code\nlisa &lt;- lisa %&gt;%\n  mutate(z_GDPPC = as.vector(scale(GDPPC)),\n         z_lag_GDPPC = as.vector(scale(lag_GDPPC)),\n         .before = 1)\n\n\nNow, plot the standardised Moran scatterplot:\n\n\nShow code\nggplot(data = lisa,\n       aes(x = z_GDPPC,\n           y = z_lag_GDPPC,\n           color = mean)) +\n  geom_point(size = 2) +\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              color = \"black\") +\n  geom_hline(yintercept = 0, lty = 2) +\n  geom_vline(xintercept = 0, lty = 2) +\n  scale_color_manual(\n    values = c(\"High-High\" = \"red\",\n               \"Low-Low\" = \"blue\",\n               \"Low-High\" = \"lightblue\",\n               \"High-Low\" = \"pink\")) +\n  labs(x = \"Standardised GDPPC\",\n       y = \"Standardised Spatial Lag of GDPPC\",\n       title = \"Standardised Moran Scatterplot with LISA Quadrants\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n4.4.3 Preparing LISA cluster map\nNow we will prepare a LISA cluster map. First, we need to create a categorical variable for LISA clusters:\n\n\nShow code\nlisa &lt;- lisa %&gt;%\n  mutate(LISA_cluster = case_when(\n    p_ii &gt; 0.05 ~ \"Insignificant\",\n    mean == \"High-High\" ~ \"High-High\",\n    mean == \"Low-Low\" ~ \"Low-Low\",\n    mean == \"Low-High\" ~ \"Low-High\",\n    mean == \"High-Low\" ~ \"High-Low\",\n    TRUE ~ \"Other\"\n  ),\n  LISA_cluster = factor(\n    LISA_cluster,\n    levels = c(\"Insignificant\", \"High-High\", \"Low-Low\", \n               \"Low-High\", \"High-Low\")\n  ))\n\n# Check the distribution\ntable(lisa$LISA_cluster)\n\n\n\nInsignificant     High-High       Low-Low      Low-High      High-Low \n           76             9             2             1             0 \n\n\n\n\n4.4.4 Plotting LISA map\nNow, we can plot the LISA map:\n\n\nShow code\nlisa_map &lt;- tm_shape(lisa) +\n  tm_polygons(\n    \"LISA_cluster\",\n    palette = c(\"grey80\",     # Insignificant\n                \"red\",        # High-High\n                \"blue\",       # Low-Low\n                \"lightblue\",  # Low-High\n                \"pink\"),      # High-Low\n    title = \"LISA Cluster\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"LISA Cluster Map (p &lt; 0.05)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\nlisa_map\n\n\n\n\n\n\n\n\n\nFor comprehensive visualization, we can combine all LISA-related maps:\n\n\nShow code\ntmap_arrange(ii_map, p_ii_map, lisa_map, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n\n4.4.5 Statistical Observations from LISA Map\nThe LISA map reveals: - High-High clusters (Hot spots): Areas of high GDPPC surrounded by high GDPPC neighbors - Low-Low clusters (Cold spots): Areas of low GDPPC surrounded by low GDPPC neighbors - Low-High outliers: Low GDPPC areas surrounded by high GDPPC neighbors - High-Low outliers: High GDPPC areas surrounded by low GDPPC neighbors - Insignificant areas: No significant local spatial autocorrelation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#deriving-distance-weight-matrix",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#deriving-distance-weight-matrix",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.1 Deriving distance weight matrix",
    "text": "5.1 Deriving distance weight matrix\nFor Getis-Ord Gi* statistics, we define neighbours based on distance.\n\n5.1.1 Determine the cut-off distance\nFirst, we need to determine the upper limit for distance band:\n\n\nShow code\n# Get geometry\ngeo &lt;- st_geometry(hunan)\n\n# Compute centroid\nco &lt;- st_centroid(geo)\n\n# Determine the cutoff distance\nk1 &lt;- sfdep::st_knn(co, k = 1)\nk1_dist &lt;- sfdep::st_nb_dists(co, k1)\n\n# Summary of distances\nsummary(unlist(k1_dist))\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24845   32677   38110   38998   44639   58635 \n\n\nThe summary report shows that the largest first nearest neighbour distance is about 61.8 km, so using this as the upper threshold gives certainty that all units will have at least one neighbour.\n\n\n5.1.2 Computing fixed distance weights\nUsing the critical threshold value computed above, we compute the fixed distance weight:\n\n\nShow code\n# Compute fixed distance neighbors (using 62km as threshold)\nwm_fd &lt;- st_dist_band(co, \n                      upper = 62000)  # Note: using meters since we're in UTM\n\n# Important: Include self for Gi* statistics\nwm_fd &lt;- include_self(wm_fd)\n\n# Compute weights\nwm_fd_weights &lt;- st_weights(wm_fd)\n\n# Check summary\nsummary(wm_fd)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 406 \nPercentage nonzero weights: 5.242769 \nAverage number of links: 4.613636 \nLink number distribution:\n\n 2  3  4  5  6  7 \n 7 14 15 28 18  6 \n7 least connected regions:\n6 15 30 32 56 65 85 with 2 links\n6 most connected regions:\n21 28 45 50 52 82 with 7 links\n\n\n\n\n5.1.3 Computing adaptive distance weights\nIt is possible to control the numbers of neighbours directly using k-nearest neighbours:\n\n\nShow code\n# Compute k-nearest neighbors (k=8)\nwm_ad &lt;- st_knn(co, k = 8)\n\n# Include self for Gi* statistics\nwm_ad &lt;- include_self(wm_ad)\n\n# Compute weights\nwm_ad_weights &lt;- st_weights(wm_ad)\n\n# Check summary\nsummary(wm_ad)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 792 \nPercentage nonzero weights: 10.22727 \nAverage number of links: 9 \nNon-symmetric neighbours list\nLink number distribution:\n\n 9 \n88 \n88 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 9 links\n88 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 9 links"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-gi-statistics",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-gi-statistics",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.2 Computing local Gi* statistics",
    "text": "5.2 Computing local Gi* statistics\n\n5.2.1 Using fixed distance weights\n\n\nShow code\nHCSA_fdw &lt;- hunan %&gt;%\n  mutate(local_Gi = local_gstar_perm(GDPPC, \n                                     wm_fd, \n                                     wm_fd_weights,\n                                     nsim = 999),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\n\n# Check the results\nglimpse(HCSA_fdw)\n\n\nRows: 88\nColumns: 48\n$ gi_star      &lt;dbl&gt; 0.38306332, -0.34046184, 0.23257243, 0.36406563, 0.364065…\n$ cluster      &lt;fct&gt; Low, Low, High, High, High, High, High, High, High, Low, …\n$ e_gi         &lt;dbl&gt; 0.011254385, 0.010951719, 0.012238394, 0.011316908, 0.011…\n$ var_gi       &lt;dbl&gt; 7.030617e-06, 7.748785e-06, 7.671638e-06, 9.048618e-06, 9…\n$ std_dev      &lt;dbl&gt; 0.43869732, -0.22290144, -0.06120218, 0.42831922, 0.35163…\n$ p_value      &lt;dbl&gt; 6.608809e-01, 8.236122e-01, 9.511982e-01, 6.684187e-01, 7…\n$ p_sim        &lt;dbl&gt; 0.590, 0.958, 0.892, 0.552, 0.556, 0.906, 0.040, 0.044, 0…\n$ p_folded_sim &lt;dbl&gt; 0.295, 0.479, 0.446, 0.276, 0.278, 0.447, 0.020, 0.022, 0…\n$ skewness     &lt;dbl&gt; 1.0057872, 1.0211726, 1.1521531, 1.0204971, 1.1530047, 2.…\n$ kurtosis     &lt;dbl&gt; 1.0752646, 0.9456147, 2.1028553, 0.9295575, 1.2587780, 4.…\n$ nb           &lt;nb&gt; &lt;2, 3, 4, 57, 85&gt;, &lt;1, 57, 58, 78, 85&gt;, &lt;1, 4, 5, 85&gt;, &lt;1,…\n$ wt           &lt;list&gt; &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0…\n$ NAME_2       &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ ID_3         &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 2…\n$ NAME_3       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ ENGTYPE_3    &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"C…\n$ Shape_Leng   &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.17191…\n$ Shape_Area   &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.1145035…\n$ County       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ City         &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ avg_wage     &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 4…\n$ deposite     &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, …\n$ FAI          &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0…\n$ Gov_Rev      &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, …\n$ Gov_Exp      &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 4…\n$ GDP          &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 8111…\n$ GDPPC        &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 7…\n$ GIO          &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254…\n$ Loan         &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 2340…\n$ NIPCR        &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, …\n$ Bed          &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970,…\n$ Emp          &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 8…\n$ EmpR         &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 26…\n$ EmpRT        &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 13…\n$ Pri_Stu      &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80…\n$ Sec_Stu      &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68…\n$ Household    &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 16…\n$ Household_R  &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 15…\n$ NOIP         &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, …\n$ Pop_R        &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 26…\n$ RSCG         &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, …\n$ Pop_T        &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5,…\n$ Agri         &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.51…\n$ Service      &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.…\n$ Disp_Inc     &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 2…\n$ RORP         &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.…\n$ ROREmp       &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.9…\n\n\n\n\n5.2.2 Using adaptive distance weights\n\n\nShow code\nHCSA_adw &lt;- hunan %&gt;%\n  mutate(local_Gi = local_gstar_perm(GDPPC, \n                                     wm_ad, \n                                     wm_ad_weights,\n                                     nsim = 999),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\n\n# Check the results\nglimpse(HCSA_adw)\n\n\nRows: 88\nColumns: 48\n$ gi_star      &lt;dbl&gt; 0.24600226, 0.21329499, 0.24600226, 0.21343577, -0.007866…\n$ cluster      &lt;fct&gt; Low, Low, High, High, High, High, High, High, High, Low, …\n$ e_gi         &lt;dbl&gt; 0.01129003, 0.01115470, 0.01179819, 0.01143186, 0.0116048…\n$ var_gi       &lt;dbl&gt; 4.783271e-06, 4.576758e-06, 4.830319e-06, 4.821283e-06, 5…\n$ std_dev      &lt;dbl&gt; 0.28167764, 0.31751238, 0.04909104, 0.18326923, -0.110502…\n$ p_value      &lt;dbl&gt; 7.781907e-01, 7.508548e-01, 9.608467e-01, 8.545868e-01, 9…\n$ p_sim        &lt;dbl&gt; 0.704, 0.672, 0.844, 0.778, 0.958, 0.686, 0.004, 0.092, 0…\n$ p_folded_sim &lt;dbl&gt; 0.352, 0.336, 0.422, 0.389, 0.479, 0.343, 0.002, 0.046, 0…\n$ skewness     &lt;dbl&gt; 0.8205124, 0.6688263, 0.7986046, 0.6748990, 0.9112671, 0.…\n$ kurtosis     &lt;dbl&gt; 0.92733254, 0.38518126, 0.83154947, 0.61541898, 1.4072177…\n$ nb           &lt;nb&gt; &lt;2, 3, 4, 57, 85&gt;, &lt;1, 57, 58, 78, 85&gt;, &lt;1, 4, 5, 85&gt;, &lt;1,…\n$ wt           &lt;list&gt; &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0…\n$ NAME_2       &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ ID_3         &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 2…\n$ NAME_3       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ ENGTYPE_3    &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"C…\n$ Shape_Leng   &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.17191…\n$ Shape_Area   &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.1145035…\n$ County       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ City         &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ avg_wage     &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 4…\n$ deposite     &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, …\n$ FAI          &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0…\n$ Gov_Rev      &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, …\n$ Gov_Exp      &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 4…\n$ GDP          &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 8111…\n$ GDPPC        &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 7…\n$ GIO          &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254…\n$ Loan         &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 2340…\n$ NIPCR        &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, …\n$ Bed          &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970,…\n$ Emp          &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 8…\n$ EmpR         &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 26…\n$ EmpRT        &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 13…\n$ Pri_Stu      &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80…\n$ Sec_Stu      &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68…\n$ Household    &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 16…\n$ Household_R  &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 15…\n$ NOIP         &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, …\n$ Pop_R        &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 26…\n$ RSCG         &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, …\n$ Pop_T        &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5,…\n$ Agri         &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.51…\n$ Service      &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.…\n$ Disp_Inc     &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 2…\n$ RORP         &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.…\n$ ROREmp       &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.9…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-hcsa",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-hcsa",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.3 Visualising HCSA",
    "text": "5.3 Visualising HCSA\n\n5.3.1 Mapping Gi* with fixed distance weights\n\n\nShow code\ntm_shape(HCSA_fdw) +\n  tm_fill(\"gi_star\",\n          style = \"pretty\",\n          palette = \"-RdBu\",\n          midpoint = NA) +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Gi* of GDPPC (Fixed Distance)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n5.3.2 Mapping local Gi* p-values\n\n\nShow code\ntm_shape(HCSA_fdw) +\n  tm_fill(\"p_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\",\n          title = \"p-value\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values of Local Gi* (Fixed Distance)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n5.3.3 Mapping both Gi* values and p-values\n\n\nShow code\nGi_star_map &lt;- tm_shape(HCSA_fdw) +\n  tm_fill(\"gi_star\",\n          style = \"pretty\",\n          n = 5,\n          palette = \"-RdBu\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Gi*\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\np_values_map &lt;- tm_shape(HCSA_fdw) +\n  tm_fill(\"p_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\ntmap_arrange(Gi_star_map, p_values_map, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n\n5.3.4 Preparing and plotting HCSA Map\nCreate a categorical variable for HCSA clusters:\n\n\nShow code\nHCSA_fdw &lt;- HCSA_fdw %&gt;%\n  mutate(HCSA_cluster = case_when(\n    p_sim &gt; 0.05 ~ \"Insignificant\",\n    p_sim &lt;= 0.05 & gi_star &gt; 0 ~ \"Hot spot\",\n    p_sim &lt;= 0.05 & gi_star &lt; 0 ~ \"Cold spot\",\n    TRUE ~ \"Other\"\n  ),\n  HCSA_cluster = factor(\n    HCSA_cluster,\n    levels = c(\"Insignificant\", \"Hot spot\", \"Cold spot\")\n  ))\n\n# Check the distribution\ntable(HCSA_fdw$HCSA_cluster)\n\n\n\nInsignificant      Hot spot     Cold spot \n           76             7             5 \n\n\nNow plot the HCSA map:\n\n\nShow code\nHCSA_map &lt;- tm_shape(HCSA_fdw) +\n  tm_polygons(\n    \"HCSA_cluster\",\n    palette = c(\"grey80\",    # Insignificant\n                \"red\",       # Hot spot\n                \"blue\"),     # Cold spot\n    title = \"HCSA Cluster\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"HCSA Clusters (p &lt; 0.05)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\nHCSA_map\n\n\n\n\n\n\n\n\n\n\n\n5.3.5 Combined visualization\n\n\nShow code\ntmap_arrange(Gi_star_map, HCSA_map, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#comparison-fixed-vs-adaptive-distance-weights",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#comparison-fixed-vs-adaptive-distance-weights",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.4 Comparison: Fixed vs Adaptive Distance Weights",
    "text": "5.4 Comparison: Fixed vs Adaptive Distance Weights\nLet’s compare the results from fixed and adaptive distance weights:\n\n\nShow code\n# Prepare HCSA clusters for adaptive weights\nHCSA_adw &lt;- HCSA_adw %&gt;%\n  mutate(HCSA_cluster = case_when(\n    p_sim &gt; 0.05 ~ \"Insignificant\",\n    p_sim &lt;= 0.05 & gi_star &gt; 0 ~ \"Hot spot\",\n    p_sim &lt;= 0.05 & gi_star &lt; 0 ~ \"Cold spot\",\n    TRUE ~ \"Other\"\n  ),\n  HCSA_cluster = factor(\n    HCSA_cluster,\n    levels = c(\"Insignificant\", \"Hot spot\", \"Cold spot\")\n  ))\n\n\n\n\nShow code\nHCSA_fixed &lt;- tm_shape(HCSA_fdw) +\n  tm_polygons(\"HCSA_cluster\",\n              palette = c(\"grey80\", \"red\", \"blue\"),\n              title = \"HCSA\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Fixed Distance (62km)\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\nHCSA_adaptive &lt;- tm_shape(HCSA_adw) +\n  tm_polygons(\"HCSA_cluster\",\n              palette = c(\"grey80\", \"red\", \"blue\"),\n              title = \"HCSA\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Adaptive Distance (k=8)\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\ntmap_arrange(HCSA_fixed, HCSA_adaptive, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#lisa-analysis-results",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#lisa-analysis-results",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "6.1 LISA Analysis Results",
    "text": "6.1 LISA Analysis Results\n\nIdentified local clusters and outliers using Local Moran’s I:\n\nHigh-High clusters: Counties with high GDPPC surrounded by high GDPPC neighbors\nLow-Low clusters: Counties with low GDPPC surrounded by low GDPPC neighbors\nSpatial outliers: High-Low and Low-High patterns\n\nVisualized spatial relationships through:\n\nMoran scatterplots showing the relationship between values and their spatial lags\nLISA cluster maps highlighting significant local patterns"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#hcsa-analysis-results",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#hcsa-analysis-results",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "6.2 HCSA Analysis Results",
    "text": "6.2 HCSA Analysis Results\n\nDetected hot spots and cold spots using Getis-Ord Gi* statistics:\n\nHot spots: Significant clusters of high GDPPC values\nCold spots: Significant clusters of low GDPPC values\n\nCompared different spatial weight schemes:\n\nFixed distance weights (62km threshold)\nAdaptive distance weights (k=8 nearest neighbors)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#key-findings",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#key-findings",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "6.3 Key Findings",
    "text": "6.3 Key Findings\n\nEconomic development in Hunan Province shows clear spatial clustering\nHot spots (high GDPPC clusters) are concentrated in specific regions\nCold spots (low GDPPC clusters) indicate areas needing development attention\nThe choice of spatial weights (fixed vs adaptive) can influence the detection of clusters\n\nThese local measures complement the global measures from Exercise 05a by showing where the spatial clustering occurs, providing actionable insights for policy makers and planners."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "",
    "text": "In this hands-on exercise, you will learn how to compute spatial weights using R. By the end of this exercise, you will be able to:\n\nImport geospatial data using appropriate function(s) of sf package\nImport csv file using appropriate function of readr package\nPerform relational join using appropriate join function of dplyr package\nCompute spatial weights using appropriate functions of spdep package\nCalculate spatially lagged variables using appropriate functions of spdep package"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#loading-r-packages",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#loading-r-packages",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "3.1 Loading R Packages",
    "text": "3.1 Loading R Packages\nBefore we get started, we need to ensure that spdep, sf, tmap and tidyverse packages are installed and loaded.\n\npacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-shapefile-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-shapefile-into-r-environment",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "4.1 Import shapefile into R environment",
    "text": "4.1 Import shapefile into R environment\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be a simple features object of sf.\n\n\nShow code\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\n\nReading layer `Hunan' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex04\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-csv-file-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-csv-file-into-r-environment",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "4.2 Import csv file into R environment",
    "text": "4.2 Import csv file into R environment\nNext, we will import Hunan_2012.csv into R using read_csv() of readr package. The output is an R dataframe class.\n\n\nShow code\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\", show_col_types = FALSE)\n\n# Check the data\nglimpse(hunan2012)\n\n\nRows: 88\nColumns: 29\n$ County      &lt;chr&gt; \"Anhua\", \"Anren\", \"Anxiang\", \"Baojing\", \"Chaling\", \"Changn…\n$ City        &lt;chr&gt; \"Yiyang\", \"Chenzhou\", \"Changde\", \"Hunan West\", \"Zhuzhou\", …\n$ avg_wage    &lt;dbl&gt; 30544, 28058, 31935, 30843, 31251, 28518, 54540, 28597, 33…\n$ deposite    &lt;dbl&gt; 10967.0, 4598.9, 5517.2, 2250.0, 8241.4, 10860.0, 24332.0,…\n$ FAI         &lt;dbl&gt; 6831.7, 6386.1, 3541.0, 1005.4, 6508.4, 7920.0, 33624.0, 1…\n$ Gov_Rev     &lt;dbl&gt; 456.72, 220.57, 243.64, 192.59, 620.19, 769.86, 5350.00, 1…\n$ Gov_Exp     &lt;dbl&gt; 2703.0, 1454.7, 1779.5, 1379.1, 1947.0, 2631.6, 7885.5, 11…\n$ GDP         &lt;dbl&gt; 13225.0, 4941.2, 12482.0, 4087.9, 11585.0, 19886.0, 88009.…\n$ GDPPC       &lt;dbl&gt; 14567, 12761, 23667, 14563, 20078, 24418, 88656, 10132, 17…\n$ GIO         &lt;dbl&gt; 9276.90, 4189.20, 5108.90, 3623.50, 9157.70, 37392.00, 513…\n$ Loan        &lt;dbl&gt; 3954.90, 2555.30, 2806.90, 1253.70, 4287.40, 4242.80, 4053…\n$ NIPCR       &lt;dbl&gt; 3528.3, 3271.8, 7693.7, 4191.3, 3887.7, 9528.0, 17070.0, 3…\n$ Bed         &lt;dbl&gt; 2718, 970, 1931, 927, 1449, 3605, 3310, 582, 2170, 2179, 1…\n$ Emp         &lt;dbl&gt; 494.310, 290.820, 336.390, 195.170, 330.290, 548.610, 670.…\n$ EmpR        &lt;dbl&gt; 441.4, 255.4, 270.5, 145.6, 299.0, 415.1, 452.0, 127.6, 21…\n$ EmpRT       &lt;dbl&gt; 338.0, 99.4, 205.9, 116.4, 154.0, 273.7, 219.4, 94.4, 174.…\n$ Pri_Stu     &lt;dbl&gt; 54.175, 33.171, 19.584, 19.249, 33.906, 81.831, 59.151, 18…\n$ Sec_Stu     &lt;dbl&gt; 32.830, 17.505, 17.819, 11.831, 20.548, 44.485, 39.685, 7.…\n$ Household   &lt;dbl&gt; 290.4, 104.6, 148.1, 73.2, 148.7, 211.2, 300.3, 76.1, 139.…\n$ Household_R &lt;dbl&gt; 234.5, 121.9, 135.4, 69.9, 139.4, 211.7, 248.4, 59.6, 110.…\n$ NOIP        &lt;dbl&gt; 101, 34, 53, 18, 106, 115, 214, 17, 55, 70, 44, 84, 74, 17…\n$ Pop_R       &lt;dbl&gt; 670.3, 243.2, 346.0, 184.1, 301.6, 448.2, 475.1, 189.6, 31…\n$ RSCG        &lt;dbl&gt; 5760.60, 2386.40, 3957.90, 768.04, 4009.50, 5220.40, 22604…\n$ Pop_T       &lt;dbl&gt; 910.8, 388.7, 528.3, 281.3, 578.4, 816.3, 998.6, 256.7, 45…\n$ Agri        &lt;dbl&gt; 4942.253, 2357.764, 4524.410, 1118.561, 3793.550, 6430.782…\n$ Service     &lt;dbl&gt; 5414.5, 3814.1, 14100.0, 541.8, 5444.0, 13074.6, 17726.6, …\n$ Disp_Inc    &lt;dbl&gt; 12373, 16072, 16610, 13455, 20461, 20868, 183252, 12379, 1…\n$ RORP        &lt;dbl&gt; 0.7359464, 0.6256753, 0.6549309, 0.6544614, 0.5214385, 0.5…\n$ ROREmp      &lt;dbl&gt; 0.8929619, 0.8782065, 0.8041262, 0.7460163, 0.9052651, 0.7…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#performing-relational-join",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#performing-relational-join",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "4.3 Performing relational join",
    "text": "4.3 Performing relational join\nThe code chunk below will be used to update the attribute table of hunan’s SpatialPolygonsDataFrame with the attribute fields of hunan2012 dataframe. This is performed using left_join() of dplyr package.\n\n\nShow code\nhunan &lt;- left_join(hunan, hunan2012, by = c(\"County\" = \"County\"))\n\n# Check the result\nglimpse(hunan)\n\n\nRows: 88\nColumns: 36\n$ NAME_2      &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ ID_3        &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 21…\n$ NAME_3      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ ENGTYPE_3   &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"Co…\n$ Shape_Leng  &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.171918…\n$ Shape_Area  &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.11450357…\n$ County      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ City        &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ avg_wage    &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 45…\n$ deposite    &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, 1…\n$ FAI         &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0,…\n$ Gov_Rev     &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, 2…\n$ Gov_Exp     &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 48…\n$ GDP         &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 81113…\n$ GDPPC       &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 70…\n$ GIO         &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254.…\n$ Loan        &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 23408…\n$ NIPCR       &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, 1…\n$ Bed         &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970, …\n$ Emp         &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 85…\n$ EmpR        &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 268…\n$ EmpRT       &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 131…\n$ Pri_Stu     &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80.…\n$ Sec_Stu     &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68.…\n$ Household   &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 161…\n$ Household_R &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 154…\n$ NOIP        &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, 4…\n$ Pop_R       &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 266…\n$ RSCG        &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, 1…\n$ Pop_T       &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5, …\n$ Agri        &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.510…\n$ Service     &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.8…\n$ Disp_Inc    &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 27…\n$ RORP        &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.6…\n$ ROREmp      &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.8…\n$ geometry    &lt;POLYGON [°]&gt; POLYGON ((112.0625 29.75523..., POLYGON ((112.2288…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-queen-contiguity-based-neighbours",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-queen-contiguity-based-neighbours",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "6.1 Computing (QUEEN) contiguity based neighbours",
    "text": "6.1 Computing (QUEEN) contiguity based neighbours\nThe code chunk below is used to compute Queen contiguity weight matrix.\n\n\nShow code\nwm_q &lt;- poly2nb(hunan, queen = TRUE)\nsummary(wm_q)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report shows that: - There are 88 area units in Hunan - The most connected area unit has 11 neighbours - There are two area units with only one neighbour\n\n6.1.1 Examining the neighbours\nFor each polygon in our polygon object, wm_q lists all neighboring polygons. For example, to see the neighbors for the first polygon:\n\n\nShow code\n# Check neighbours for polygon 1\nwm_q[[1]]\n\n\n[1]  2  3  4 57 85\n\n\nShow code\n# Get the county name of Polygon ID=1\nhunan$County[1]\n\n\n[1] \"Anxiang\"\n\n\nShow code\n# Get the county names of the five neighboring polygons\nhunan$County[c(2,3,4,57,85)]\n\n\n[1] \"Hanshou\" \"Jinshi\"  \"Li\"      \"Nan\"     \"Taoyuan\"\n\n\nShow code\n# Get the GDPPC of these five counties\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n\n[1] 20981 34592 24473 21311 22879\n\n\n\n\n6.1.2 Display the complete weight matrix\nYou can display the complete weight matrix structure using str():\n\n\nShow code\nstr(wm_q)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#creating-rook-contiguity-based-neighbours",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#creating-rook-contiguity-based-neighbours",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "6.2 Creating (ROOK) contiguity based neighbours",
    "text": "6.2 Creating (ROOK) contiguity based neighbours\nThe code chunk below is used to compute Rook contiguity weight matrix.\n\n\nShow code\nwm_r &lt;- poly2nb(hunan, queen = FALSE)\nsummary(wm_r)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 440 \nPercentage nonzero weights: 5.681818 \nAverage number of links: 5 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 10 \n 2  2 12 20 21 14 11  3  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 10 links\n\n\nThe summary report shows that: - The most connected area unit has 10 neighbours - There are two area units with only one neighbour"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#visualising-contiguity-weights",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#visualising-contiguity-weights",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "6.3 Visualising contiguity weights",
    "text": "6.3 Visualising contiguity weights\nA connectivity graph takes a point and displays a line to each neighboring point. We need to get points (polygon centroids) to make our connectivity graphs.\n\n6.3.1 Getting Latitude and Longitude of Polygon Centroids\n\n\nShow code\n# Get longitude values\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n# Get latitude values\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n# Bind longitude and latitude into the same object\ncoords &lt;- cbind(longitude, latitude)\n\n# Check the first few observations\nhead(coords)\n\n\n     longitude latitude\n[1,]  112.1531 29.44362\n[2,]  112.0372 28.86489\n[3,]  111.8917 29.47107\n[4,]  111.7031 29.74499\n[5,]  111.6138 29.49258\n[6,]  111.0341 29.79863\n\n\n\n\n6.3.2 Plotting Queen contiguity based neighbours map\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\ntitle(\"Queen Contiguity\")\n\n\n\n\n\n\n\n\n\n\n\n6.3.3 Plotting Rook contiguity based neighbours map\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\ntitle(\"Rook Contiguity\")\n\n\n\n\n\n\n\n\n\n\n\n6.3.4 Plotting both Queen and Rook contiguity based neighbours maps\n\n\nShow code\npar(mfrow = c(1,2))\nplot(hunan$geometry, border = \"lightgrey\", main = \"Queen Contiguity\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\nplot(hunan$geometry, border = \"lightgrey\", main = \"Rook Contiguity\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#determine-the-cut-off-distance",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#determine-the-cut-off-distance",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "7.1 Determine the cut-off distance",
    "text": "7.1 Determine the cut-off distance\nFirst, we need to determine the upper limit for distance band:\n\n\nShow code\n# Step 1: Find k-nearest neighbours\nk1 &lt;- knn2nb(knearneigh(coords))\n\n# Step 2: Calculate distances between neighbours\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\n\n# Step 3: Summary statistics\nsummary(k1dists)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\nThe summary report shows that the largest first nearest neighbour distance is 61.79 km, so using this as the upper threshold gives certainty that all units will have at least one neighbour."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-fixed-distance-weight-matrix",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-fixed-distance-weight-matrix",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "7.2 Computing fixed distance weight matrix",
    "text": "7.2 Computing fixed distance weight matrix\nNow, we will compute the distance weight matrix using dnearneigh():\n\n\nShow code\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\n\n7.2.1 Display the structure of the weight matrix\n\n\nShow code\nstr(wm_d62)\n\n\nWe can also use table() and card() to check the neighbour distribution:\n\n\nShow code\ntable(hunan$County, card(wm_d62))\n\n\n               \n                1 2 3 4 5 6\n  Anhua         1 0 0 0 0 0\n  Anren         0 0 0 1 0 0\n  Anxiang       0 0 0 0 1 0\n  Baojing       0 0 0 0 1 0\n  Chaling       0 0 1 0 0 0\n  Changning     0 0 1 0 0 0\n  Changsha      0 0 0 1 0 0\n  Chengbu       0 1 0 0 0 0\n  Chenxi        0 0 0 1 0 0\n  Cili          0 1 0 0 0 0\n  Dao           0 0 0 1 0 0\n  Dongan        0 0 1 0 0 0\n  Dongkou       0 0 0 1 0 0\n  Fenghuang     0 0 0 1 0 0\n  Guidong       0 0 1 0 0 0\n  Guiyang       0 0 0 1 0 0\n  Guzhang       0 0 0 0 0 1\n  Hanshou       0 0 0 1 0 0\n  Hengdong      0 0 0 0 1 0\n  Hengnan       0 0 0 0 1 0\n  Hengshan      0 0 0 0 0 1\n  Hengyang      0 0 0 0 0 1\n  Hongjiang     0 0 0 0 1 0\n  Huarong       0 0 0 1 0 0\n  Huayuan       0 0 0 1 0 0\n  Huitong       0 0 0 1 0 0\n  Jiahe         0 0 0 0 1 0\n  Jianghua      0 0 1 0 0 0\n  Jiangyong     0 1 0 0 0 0\n  Jingzhou      0 1 0 0 0 0\n  Jinshi        0 0 0 1 0 0\n  Jishou        0 0 0 0 0 1\n  Lanshan       0 0 0 1 0 0\n  Leiyang       0 0 0 1 0 0\n  Lengshuijiang 0 0 1 0 0 0\n  Li            0 0 1 0 0 0\n  Lianyuan      0 0 0 0 1 0\n  Liling        0 1 0 0 0 0\n  Linli         0 0 0 1 0 0\n  Linwu         0 0 0 1 0 0\n  Linxiang      1 0 0 0 0 0\n  Liuyang       0 1 0 0 0 0\n  Longhui       0 0 1 0 0 0\n  Longshan      0 1 0 0 0 0\n  Luxi          0 0 0 0 1 0\n  Mayang        0 0 0 0 0 1\n  Miluo         0 0 0 0 1 0\n  Nan           0 0 0 0 1 0\n  Ningxiang     0 0 0 1 0 0\n  Ningyuan      0 0 0 0 1 0\n  Pingjiang     0 1 0 0 0 0\n  Qidong        0 0 1 0 0 0\n  Qiyang        0 0 1 0 0 0\n  Rucheng       0 1 0 0 0 0\n  Sangzhi       0 1 0 0 0 0\n  Shaodong      0 0 0 0 1 0\n  Shaoshan      0 0 0 0 1 0\n  Shaoyang      0 0 0 1 0 0\n  Shimen        1 0 0 0 0 0\n  Shuangfeng    0 0 0 0 0 1\n  Shuangpai     0 0 0 1 0 0\n  Suining       0 0 0 0 1 0\n  Taojiang      0 1 0 0 0 0\n  Taoyuan       0 1 0 0 0 0\n  Tongdao       0 1 0 0 0 0\n  Wangcheng     0 0 0 1 0 0\n  Wugang        0 0 1 0 0 0\n  Xiangtan      0 0 0 1 0 0\n  Xiangxiang    0 0 0 0 1 0\n  Xiangyin      0 0 0 1 0 0\n  Xinhua        0 0 0 0 1 0\n  Xinhuang      1 0 0 0 0 0\n  Xinning       0 1 0 0 0 0\n  Xinshao       0 0 0 0 0 1\n  Xintian       0 0 0 0 1 0\n  Xupu          0 1 0 0 0 0\n  Yanling       0 0 1 0 0 0\n  Yizhang       1 0 0 0 0 0\n  Yongshun      0 0 0 1 0 0\n  Yongxing      0 0 0 1 0 0\n  You           0 0 0 1 0 0\n  Yuanjiang     0 0 0 0 1 0\n  Yuanling      1 0 0 0 0 0\n  Yueyang       0 0 1 0 0 0\n  Zhijiang      0 0 0 0 1 0\n  Zhongfang     0 0 0 1 0 0\n  Zhuzhou       0 0 0 0 1 0\n  Zixing        0 0 1 0 0 0\n\n\n\n\n7.2.2 Plotting fixed distance weight matrix\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(wm_d62, coords, add = TRUE)\nplot(k1, coords, add = TRUE, col = \"red\", length = 0.08)\ntitle(\"Fixed Distance Weights (62km)\")\n\n\n\n\n\n\n\n\n\nThe red lines show the links of 1st nearest neighbours and the black lines show the links of neighbours within the cut-off distance of 62km.\n\n\n7.2.3 Plotting with comparison\n\n\nShow code\npar(mfrow = c(1,2))\nplot(hunan$geometry, border = \"lightgrey\", main = \"1st Nearest Neighbours\")\nplot(k1, coords, add = TRUE, col = \"red\", length = 0.08)\n\nplot(hunan$geometry, border = \"lightgrey\", main = \"Distance Neighbours (62km)\")\nplot(wm_d62, coords, add = TRUE, pch = 19, cex = 0.6)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-adaptive-distance-weight-matrix",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-adaptive-distance-weight-matrix",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "7.3 Computing adaptive distance weight matrix",
    "text": "7.3 Computing adaptive distance weight matrix\nOne characteristic of fixed distance weight matrix is that more densely settled areas (usually urban) tend to have more neighbours while less densely settled areas (usually rural) tend to have fewer neighbours.\nIt is possible to control the numbers of neighbours directly using k-nearest neighbours:\n\n\nShow code\nknn6 &lt;- knn2nb(knearneigh(coords, k = 6))\nknn6\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 528 \nPercentage nonzero weights: 6.818182 \nAverage number of links: 6 \nNon-symmetric neighbours list\n\n\nNotice that each county now has exactly six neighbours, no more, no less!\n\n7.3.1 Display the content of the matrix\n\n\nShow code\nstr(knn6)\n\n\n\n\n7.3.2 Plotting distance based neighbours\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(knn6, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\ntitle(\"K-Nearest Neighbours (k=6)\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-with-row-standardized-weights",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-with-row-standardized-weights",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.1 Spatial lag with row-standardized weights",
    "text": "10.1 Spatial lag with row-standardized weights\nWe’ll compute the average neighbor GDPPC value for each polygon. These values are often referred to as spatially lagged values.\n\n\nShow code\nGDPPC.lag &lt;- lag.listw(rswm_q, hunan$GDPPC)\nGDPPC.lag\n\n\n [1] 24847.20 22724.80 24143.25 27737.50 27270.25 21248.80 43747.00 33582.71\n [9] 45651.17 32027.62 32671.00 20810.00 25711.50 30672.33 33457.75 31689.20\n[17] 20269.00 23901.60 25126.17 21903.43 22718.60 25918.80 20307.00 20023.80\n[25] 16576.80 18667.00 14394.67 19848.80 15516.33 20518.00 17572.00 15200.12\n[33] 18413.80 14419.33 24094.50 22019.83 12923.50 14756.00 13869.80 12296.67\n[41] 15775.17 14382.86 11566.33 13199.50 23412.00 39541.00 36186.60 16559.60\n[49] 20772.50 19471.20 19827.33 15466.80 12925.67 18577.17 14943.00 24913.00\n[57] 25093.00 24428.80 17003.00 21143.75 20435.00 17131.33 24569.75 23835.50\n[65] 26360.00 47383.40 55157.75 37058.00 21546.67 23348.67 42323.67 28938.60\n[73] 25880.80 47345.67 18711.33 29087.29 20748.29 35933.71 15439.71 29787.50\n[81] 18145.00 21617.00 29203.89 41363.67 22259.09 44939.56 16902.00 16930.00\n\n\n\n10.1.1 Understanding spatial lag\nRecall that we retrieved the GDPPC of the five neighbours of polygon 1:\n\n\nShow code\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n\n[1] 20981 34592 24473 21311 22879\n\n\nShow code\n# The average GDPPC of the neighbours\nmean(nb1)\n\n\n[1] 24847.2\n\n\nShow code\n# Compare with the lag value\nGDPPC.lag[1]\n\n\n[1] 24847.2\n\n\nWe can append the spatially lag GDPPC values onto hunan sf data frame:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(lag_GDPPC = GDPPC.lag)\n\n# Check the result\nhead(hunan[c(\"County\", \"GDPPC\", \"lag_GDPPC\")], 10)\n\n\nSimple feature collection with 10 features and 3 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 26.28322 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n      County GDPPC lag_GDPPC                       geometry\n1    Anxiang 23667  24847.20 POLYGON ((112.0625 29.75523...\n2    Hanshou 20981  22724.80 POLYGON ((112.2288 29.11684...\n3     Jinshi 34592  24143.25 POLYGON ((111.8927 29.6013,...\n4         Li 24473  27737.50 POLYGON ((111.3731 29.94649...\n5      Linli 25554  27270.25 POLYGON ((111.6324 29.76288...\n6     Shimen 27137  21248.80 POLYGON ((110.8825 30.11675...\n7    Liuyang 63118  43747.00 POLYGON ((113.9905 28.5682,...\n8  Ningxiang 62202  33582.71 POLYGON ((112.7181 28.38299...\n9  Wangcheng 70666  45651.17 POLYGON ((112.7914 28.52688...\n10     Anren 12761  32027.62 POLYGON ((113.1757 26.82734...\n\n\n\n\n10.1.2 Plotting GDPPC and spatial lag GDPPC\n\n\nShow code\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_gdppc &lt;- qtm(hunan, \"lag_GDPPC\")\ntmap_arrange(gdppc, lag_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-as-a-sum-of-neighboring-values",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-as-a-sum-of-neighboring-values",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.2 Spatial lag as a sum of neighboring values",
    "text": "10.2 Spatial lag as a sum of neighboring values\nWe can calculate spatial lag as a sum of neighboring values by assigning binary weights:\n\n\nShow code\n# Apply a function that assigns value of 1 per neighbour\nb_weights &lt;- lapply(wm_q, function(x) 0*x + 1)\n\n# Assign binary weights\nb_weights2 &lt;- nb2listw(wm_q, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1    S2\nB 88 7744 448 896 10224\n\n\nWith the proper weights assigned, we can compute a lag variable:\n\n\nShow code\nlag_sum &lt;- lag.listw(b_weights2, hunan$GDPPC)\nlag_sum\n\n\n [1] 124236 113624  96573 110950 109081 106244 174988 235079 273907 256221\n[11]  98013 104050 102846  92017 133831 158446 141883 119508 150757 153324\n[21] 113593 129594 142149 100119  82884  74668  43184  99244  46549  20518\n[31] 140576 121601  92069  43258 144567 132119  51694  59024  69349  73780\n[41]  94651 100680  69398  52798 140472 118623 180933  82798  83090  97356\n[51]  59482  77334  38777 111463  74715 174391 150558 122144  68012  84575\n[61] 143045  51394  98279  47671  26360 236917 220631 185290  64640  70046\n[71] 126971 144693 129404 284074 112268 203611 145238 251536 108078 238300\n[81] 108870 108085 262835 248182 244850 404456  67608  33860\n\n\n\n10.2.1 Understanding the result\n\n\nShow code\n# Check the result for polygon 1\nnb1 &lt;- wm_q[[1]]\nnb1_GDPPC &lt;- hunan$GDPPC[nb1]\n\n# Sum of neighbours' GDPPC\nsum(nb1_GDPPC)\n\n\n[1] 124236\n\n\nShow code\n# Compare with lag_sum\nlag_sum[1]\n\n\n[1] 124236\n\n\nAppend the lag_sum GDPPC field into hunan:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(lag_sum_GDPPC = lag_sum)\n\n# Plot for comparison\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum_GDPPC\")\ntmap_arrange(gdppc, lag_sum_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-average",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-average",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.3 Spatial window average",
    "text": "10.3 Spatial window average\nThe spatial window average uses row-standardized weights and includes the diagonal element (the region itself).\n\n\nShow code\n# Add diagonal element\nwm_q1 &lt;- include.self(wm_q)\nwm_q1\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\n\nShow code\n# Check the neighbour list of area 1\nwm_q1[[1]]\n\n\n[1]  1  2  3  4 57 85\n\n\nNotice that now area 1 has six neighbours instead of five (including itself).\nNow we obtain weights:\n\n\nShow code\nwm_q1 &lt;- nb2listw(wm_q1)\nwm_q1\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 30.90265 357.5308\n\n\nCreate the lag variable from our weight structure and GDPPC variable:\n\n\nShow code\nlag_w_avg_gpdpc &lt;- lag.listw(wm_q1, hunan$GDPPC)\nlag_w_avg_gpdpc\n\n\n [1] 24650.50 22434.17 26233.00 27084.60 26927.00 22230.17 47621.20 37160.12\n [9] 49224.71 29886.89 26627.50 22690.17 25366.40 25825.75 30329.00 32682.83\n[17] 25948.62 23987.67 25463.14 21904.38 23127.50 25949.83 20018.75 19524.17\n[25] 18955.00 17800.40 15883.00 18831.33 14832.50 17965.00 17159.89 16199.44\n[33] 18764.50 26878.75 23188.86 20788.14 12365.20 15985.00 13764.83 11907.43\n[41] 17128.14 14593.62 11644.29 12706.00 21712.29 43548.25 35049.00 16226.83\n[49] 19294.40 18156.00 19954.75 18145.17 12132.75 18419.29 14050.83 23619.75\n[57] 24552.71 24733.67 16762.60 20932.60 19467.75 18334.00 22541.00 26028.00\n[65] 29128.50 46569.00 47576.60 36545.50 20838.50 22531.00 42115.50 27619.00\n[73] 27611.33 44523.29 18127.43 28746.38 20734.50 33880.62 14716.38 28516.22\n[81] 18086.14 21244.50 29568.80 48119.71 22310.75 43151.60 17133.40 17009.33\n\n\nConvert to data frame and append to hunan:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(lag_window_avg_GDPPC = lag_w_avg_gpdpc)\n\n# Create comparison table\nhunan %&gt;%\n  select(County, GDPPC, lag_GDPPC, lag_window_avg_GDPPC) %&gt;%\n  head(10) %&gt;%\n  knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\n\nCounty\nGDPPC\nlag_GDPPC\nlag_window_avg_GDPPC\ngeometry\n\n\n\n\nAnxiang\n23667\n24847.20\n24650.50\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n20981\n22724.80\n22434.17\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n34592\n24143.25\n26233.00\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n24473\n27737.50\n27084.60\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n25554\n27270.25\n26927.00\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n27137\n21248.80\n22230.17\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n63118\n43747.00\n47621.20\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n62202\n33582.71\n37160.12\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n70666\n45651.17\n49224.71\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n12761\n32027.62\n29886.89\nPOLYGON ((113.1757 26.82734…\n\n\n\n\n\n\n10.3.1 Plot comparison\n\n\nShow code\nlag_gdppc &lt;- qtm(hunan, \"lag_GDPPC\")\nw_avg_gdppc &lt;- qtm(hunan, \"lag_window_avg_GDPPC\")\ntmap_arrange(lag_gdppc, w_avg_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-sum",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-sum",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.4 Spatial window sum",
    "text": "10.4 Spatial window sum\nThe spatial window sum is the counterpart of the window average, but without using row-standardized weights.\n\n\nShow code\n# Add diagonal element\nwm_q2 &lt;- include.self(wm_q)\n\n# Assign binary weights\nb_weights3 &lt;- lapply(wm_q2, function(x) 0*x + 1)\nwm_q2 &lt;- nb2listw(wm_q2, \n                  glist = b_weights3, \n                  style = \"B\")\nwm_q2\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 536 1072 14160\n\n\nCompute the lag variable:\n\n\nShow code\nw_sum_gdppc &lt;- lag.listw(wm_q2, hunan$GDPPC)\nw_sum_gdppc\n\n\n [1] 147903 134605 131165 135423 134635 133381 238106 297281 344573 268982\n[11] 106510 136141 126832 103303 151645 196097 207589 143926 178242 175235\n[21] 138765 155699 160150 117145 113730  89002  63532 112988  59330  35930\n[31] 154439 145795 112587 107515 162322 145517  61826  79925  82589  83352\n[41] 119897 116749  81510  63530 151986 174193 210294  97361  96472 108936\n[51]  79819 108871  48531 128935  84305 188958 171869 148402  83813 104663\n[61] 155742  73336 112705  78084  58257 279414 237883 219273  83354  90124\n[71] 168462 165714 165668 311663 126892 229971 165876 271045 117731 256646\n[81] 126603 127467 295688 336838 267729 431516  85667  51028\n\n\nConvert to data frame and append:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(w_sum_GDPPC = w_sum_gdppc)\n\n# Create comparison table\nhunan %&gt;%\n  select(County, lag_sum_GDPPC, w_sum_GDPPC) %&gt;%\n  head(10) %&gt;%\n  knitr::kable()\n\n\n\n\n\nCounty\nlag_sum_GDPPC\nw_sum_GDPPC\ngeometry\n\n\n\n\nAnxiang\n124236\n147903\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n113624\n134605\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n96573\n131165\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n110950\n135423\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n109081\n134635\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n106244\n133381\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n174988\n238106\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n235079\n297281\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n273907\n344573\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n256221\n268982\nPOLYGON ((113.1757 26.82734…\n\n\n\n\n\n\n10.4.1 Plot comparison\n\n\nShow code\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum_GDPPC\")\nw_sum_gdppc &lt;- qtm(hunan, \"w_sum_GDPPC\")\ntmap_arrange(lag_sum_gdppc, w_sum_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "",
    "text": "Second-order spatial point pattern analysis examines the spatial relationships between points in a pattern, specifically focusing on how the presence of one point influences the location of others. Using appropriate functions of spatstat package, this hands-on exercise aims to discover the spatial point processes of childcare centres in Singapore.\nThe specific questions we would like to answer are: - Are the childcare centres in Singapore randomly distributed throughout the country? - If the answer is not, then where are the locations with higher concentration of childcare centres?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#overview",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "",
    "text": "Second-order spatial point pattern analysis examines the spatial relationships between points in a pattern, specifically focusing on how the presence of one point influences the location of others. Using appropriate functions of spatstat package, this hands-on exercise aims to discover the spatial point processes of childcare centres in Singapore.\nThe specific questions we would like to answer are: - Are the childcare centres in Singapore randomly distributed throughout the country? - If the answer is not, then where are the locations with higher concentration of childcare centres?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#setup-and-loading-r-packages",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#setup-and-loading-r-packages",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Setup and Loading R Packages",
    "text": "Setup and Loading R Packages\n\n\nCode\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\npacman::p_load(sf, tidyverse, tmap, spatstat, rvest, \n               here, janitor, stringr, units)\n\n# Set tmap to plot mode\ntmap_mode(\"plot\")\n\n# Set up directory paths\nroot_dir &lt;- here::here()\nexo_data &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"data\")\nexo_fig &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"figures\")\n\nif (!dir.exists(exo_fig)) dir.create(exo_fig, recursive = TRUE, showWarnings = FALSE)\n\nmessage(\"Data directory: \", exo_data)\nmessage(\"Figures directory: \", exo_fig)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#data-import-and-preparation",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#data-import-and-preparation",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Data Import and Preparation",
    "text": "Data Import and Preparation\n\nImport Master Plan Subzones\n\n\nCode\n# Function to extract KML fields from HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    map_chr(~ html_text2(html_element(.x, \"td\")))\n  \n  if (length(value) == 0) NA_character_ else value[1]\n}\n\n# Load Master Plan 2019 subzones\nmessage(\"Loading Master Plan 2019 subzones...\")\nsubzone_path &lt;- file.path(exo_data, \"MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\")\n\nmpsz &lt;- st_read(subzone_path, quiet = TRUE)\n\n# Transform to SVY21 if needed\nif (st_crs(mpsz)$epsg != 3414) {\n  mpsz &lt;- st_transform(mpsz, 3414)\n}\n\n# Extract fields from HTML Description\nmpsz &lt;- mpsz %&gt;%\n  mutate(\n    SUBZONE_N = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    PLN_AREA_N = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n    SUBZONE_C = map_chr(Description, extract_kml_field, \"SUBZONE_C\"),\n    REGION_N = map_chr(Description, extract_kml_field, \"REGION_N\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\n# Make geometries valid\nmpsz &lt;- st_make_valid(mpsz)\n\nmessage(\"Master Plan subzones loaded: \", nrow(mpsz), \" records\")\n\n\n\n\nImport Childcare Services\n\n\nCode\nmessage(\"Loading childcare services...\")\nchildcare_path &lt;- file.path(exo_data, \"ChildCareServices.geojson\")\n\nchildcare_sf &lt;- st_read(childcare_path, quiet = TRUE) %&gt;%\n  janitor::clean_names()\n\n# Transform to SVY21 if needed\nif (st_crs(childcare_sf)$epsg != 3414) {\n  childcare_sf &lt;- st_transform(childcare_sf, 3414)\n}\n\n# Remove Z dimension if present\nchildcare_sf &lt;- st_zm(childcare_sf, drop = TRUE, what = \"ZM\")\n\nmessage(\"Childcare services loaded: \", nrow(childcare_sf), \" records\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#geospatial-data-wrangling-for-spatstat",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#geospatial-data-wrangling-for-spatstat",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Geospatial Data Wrangling for spatstat",
    "text": "Geospatial Data Wrangling for spatstat\n\nConverting to spatstat format\n\n\nCode\n# Convert childcare points to ppp format\nchildcare_ppp &lt;- as.ppp(childcare_sf)\nclass(childcare_ppp)\n\n\n[1] \"ppp\"\n\n\nCode\n# Check summary\nsummary(childcare_ppp)\n\n\nMarked planar point pattern:  1925 points\nAverage intensity 2.417323e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nMark variables: name, description\nSummary:\n     name           description       \n Length:1925        Length:1925       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n\nWindow: rectangle = [11810.03, 45404.24] x [25596.33, 49300.88] units\n                    (33590 x 23700 units)\nWindow area = 796335000 square units\n\n\nCode\n# Create Singapore boundary owin object\nsg_owin &lt;- as.owin(mpsz)\nclass(sg_owin)\n\n\n[1] \"owin\"\n\n\nCode\n# Plot the owin object\nplot(sg_owin)\n\n\n\n\n\n\n\n\n\nCode\n# Combine points and window\nchildcareSG_ppp = childcare_ppp[sg_owin]\nsummary(childcareSG_ppp)\n\n\nMarked planar point pattern:  1925 points\nAverage intensity 2.452904e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nMark variables: name, description\nSummary:\n     name           description       \n Length:1925        Length:1925       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n\nWindow: polygonal boundary\n88 separate polygons (43 holes)\n                  vertices         area relative.area\npolygon 1              285  1.61128e+06      2.05e-03\npolygon 2              719  5.40368e+07      6.89e-02\npolygon 3               44  2.26577e+03      2.89e-06\npolygon 4               27  1.50315e+04      1.92e-05\npolygon 5              706  1.28815e+07      1.64e-02\npolygon 6 (hole)        41 -4.01660e+04     -5.12e-05\npolygon 7 (hole)       317 -5.11280e+04     -6.51e-05\npolygon 8 (hole)         3 -3.42709e-01     -4.37e-10\npolygon 9               77  3.29939e+05      4.20e-04\npolygon 10 (hole)        3 -4.14100e-04     -5.28e-13\npolygon 11              30  2.80002e+04      3.57e-05\npolygon 12 (hole)        4 -2.86396e-01     -3.65e-10\npolygon 13 (hole)        3 -1.81439e-04     -2.31e-13\npolygon 14 (hole)        3 -5.99531e-04     -7.64e-13\npolygon 15 (hole)        3 -3.04560e-04     -3.88e-13\npolygon 16 (hole)        3 -4.46108e-04     -5.68e-13\npolygon 17 (hole)        5 -2.44408e-04     -3.11e-13\npolygon 18 (hole)        5 -3.64686e-02     -4.65e-11\npolygon 19              71  8.18750e+03      1.04e-05\npolygon 20 (hole)       38 -7.79904e+03     -9.94e-06\npolygon 21 (hole)        3 -3.41897e-05     -4.36e-14\npolygon 22 (hole)        3 -3.65499e-03     -4.66e-12\npolygon 23 (hole)        3 -4.95057e-02     -6.31e-11\npolygon 24              91  1.49663e+04      1.91e-05\npolygon 25 (hole)        3 -3.79135e-02     -4.83e-11\npolygon 26 (hole)      270 -1.21455e+03     -1.55e-06\npolygon 27 (hole)       19 -4.39650e+00     -5.60e-09\npolygon 28 (hole)       35 -1.38385e+02     -1.76e-07\npolygon 29 (hole)       23 -1.99656e+01     -2.54e-08\npolygon 30              40  1.38607e+04      1.77e-05\npolygon 31 (hole)       41 -6.00381e+03     -7.65e-06\npolygon 32 (hole)        7 -1.40546e-01     -1.79e-10\npolygon 33 (hole)       11 -8.36705e+01     -1.07e-07\npolygon 34 (hole)        3 -2.33435e-03     -2.97e-12\npolygon 35              45  2.51218e+03      3.20e-06\npolygon 36             139  3.22293e+03      4.11e-06\npolygon 37             148  3.10395e+03      3.96e-06\npolygon 38 (hole)        4 -1.72650e-04     -2.20e-13\npolygon 39              75  1.73526e+04      2.21e-05\npolygon 40              83  5.28920e+03      6.74e-06\npolygon 41             211  4.70521e+05      6.00e-04\npolygon 42             106  3.04104e+03      3.88e-06\npolygon 43             264  1.50631e+06      1.92e-03\npolygon 44              71  5.63061e+03      7.17e-06\npolygon 45              10  1.99717e+02      2.54e-07\npolygon 46 (hole)        3 -1.37223e-02     -1.75e-11\npolygon 47             487  2.06117e+06      2.63e-03\npolygon 48             155  2.67502e+05      3.41e-04\npolygon 49            1020  1.27781e+06      1.63e-03\npolygon 50 (hole)       12 -5.81913e-01     -7.41e-10\npolygon 51 (hole)        4 -6.55702e-01     -8.36e-10\npolygon 52 (hole)        4 -3.13199e-05     -3.99e-14\npolygon 53 (hole)        3 -3.15099e-05     -4.02e-14\npolygon 54              65  8.42861e+04      1.07e-04\npolygon 55 (hole)        3 -1.20875e-01     -1.54e-10\npolygon 56              47  3.82087e+04      4.87e-05\npolygon 57               6  4.50259e+02      5.74e-07\npolygon 58             129  9.53761e+04      1.22e-04\npolygon 59 (hole)        3 -3.23305e-04     -4.12e-13\npolygon 60               4  2.69313e+02      3.43e-07\npolygon 61            1045  4.44510e+06      5.66e-03\npolygon 62              22  6.74651e+03      8.60e-06\npolygon 63              59  3.43150e+04      4.37e-05\npolygon 64              14  5.86546e+03      7.47e-06\npolygon 65              94  5.96187e+04      7.60e-05\npolygon 66             234  2.08755e+06      2.66e-03\npolygon 67              10  4.90942e+02      6.26e-07\npolygon 68             232  4.72886e+05      6.03e-04\npolygon 69 (hole)       13 -3.91907e+02     -4.99e-07\npolygon 70              15  4.03300e+04      5.14e-05\npolygon 71             227  1.10308e+06      1.41e-03\npolygon 72              10  6.60195e+03      8.41e-06\npolygon 73              19  3.09221e+04      3.94e-05\npolygon 74             145  9.61782e+05      1.23e-03\npolygon 75              30  4.28933e+03      5.47e-06\npolygon 76              37  1.29481e+04      1.65e-05\npolygon 77               4  9.47108e+01      1.21e-07\npolygon 78 (hole)        3 -8.68789e-04     -1.11e-12\npolygon 79 (hole)        3 -3.39815e-04     -4.33e-13\npolygon 80 (hole)        3 -4.52041e-05     -5.76e-14\npolygon 81 (hole)        3 -3.90173e-05     -4.97e-14\npolygon 82 (hole)        3 -9.59845e-05     -1.22e-13\npolygon 83 (hole)        8 -4.28707e-01     -5.46e-10\npolygon 84 (hole)        4 -2.18619e-04     -2.79e-13\npolygon 85 (hole)        6 -8.37554e-01     -1.07e-09\npolygon 86 (hole)        5 -2.92235e-04     -3.72e-13\npolygon 87           15307  7.00834e+08      8.93e-01\npolygon 88 (hole)        3 -7.43616e-06     -9.48e-15\nenclosing rectangle: [2667.54, 56396.44] x [15748.72, 50256.33] units\n                     (53730 x 34510 units)\nWindow area = 784784000 square units\nFraction of frame area: 0.423\n\n\nCode\n# Plot the combined object\nplot(childcareSG_ppp)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#extract-study-areas",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#extract-study-areas",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Extract Study Areas",
    "text": "Extract Study Areas\nFor this analysis, we’ll focus on four planning areas: Choa Chu Kang, Tampines, Punggol, and Jurong West.\n\n\nCode\n# Extract the four planning areas\npg &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"PUNGGOL\")\ntm &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"TAMPINES\")\nck &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"CHOA CHU KANG\")\njw &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"JURONG WEST\")\n\n# Plot the four areas\npar(mfrow=c(2,2))\nplot(st_geometry(pg), main = \"Punggol\")\nplot(st_geometry(tm), main = \"Tampines\")\nplot(st_geometry(ck), main = \"Choa Chu Kang\")\nplot(st_geometry(jw), main = \"Jurong West\")\n\n\n\n\n\n\n\n\n\n\nCreate owin objects for each area\n\n\nCode\npg_owin &lt;- as.owin(pg)\ntm_owin &lt;- as.owin(tm)\nck_owin &lt;- as.owin(ck)\njw_owin &lt;- as.owin(jw)\n\n\n\n\nExtract childcare points for each area\n\n\nCode\nchildcare_pg_ppp &lt;- childcare_ppp[pg_owin]\nchildcare_tm_ppp &lt;- childcare_ppp[tm_owin]\nchildcare_ck_ppp &lt;- childcare_ppp[ck_owin]\nchildcare_jw_ppp &lt;- childcare_ppp[jw_owin]\n\n# Rescale to kilometer\nchildcare_pg_ppp.km &lt;- rescale.ppp(childcare_pg_ppp, 1000, \"km\")\nchildcare_tm_ppp.km &lt;- rescale.ppp(childcare_tm_ppp, 1000, \"km\")\nchildcare_ck_ppp.km &lt;- rescale.ppp(childcare_ck_ppp, 1000, \"km\")\nchildcare_jw_ppp.km &lt;- rescale.ppp(childcare_jw_ppp, 1000, \"km\")\n\n# Plot the study areas\npar(mfrow=c(2,2))\nplot(childcare_pg_ppp.km, main=\"Punggol\")\nplot(childcare_tm_ppp.km, main=\"Tampines\")\nplot(childcare_ck_ppp.km, main=\"Choa Chu Kang\")\nplot(childcare_jw_ppp.km, main=\"Jurong West\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#second-order-spatial-point-patterns-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#second-order-spatial-point-patterns-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Second-order Spatial Point Patterns Analysis",
    "text": "Second-order Spatial Point Patterns Analysis"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#g-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#g-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "G-Function Analysis",
    "text": "G-Function Analysis\nThe G function measures the distribution of distances from an arbitrary event to its nearest event.\n\nChoa Chu Kang - G Function\n\n\nCode\n# Computing G-function estimation\nG_ck &lt;- Gest(childcare_ck_ppp.km, correction = \"border\")\nplot(G_ck, main = \"G-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nG_ck.csr &lt;- envelope(childcare_ck_ppp.km, Gest, \n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(G_ck.csr, main = \"G-function CSR Test: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - G Function\n\n\nCode\n# Computing G-function estimation\nG_tm &lt;- Gest(childcare_tm_ppp.km, correction = \"best\")\nplot(G_tm, main = \"G-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nG_tm.csr &lt;- envelope(childcare_tm_ppp.km, Gest,\n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(G_tm.csr, main = \"G-function CSR Test: Tampines\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#f-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#f-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "F-Function Analysis",
    "text": "F-Function Analysis\nThe F function estimates the empty space function or its hazard rate from a point pattern.\n\nChoa Chu Kang - F Function\n\n\nCode\n# Computing F-function estimation\nF_ck &lt;- Fest(childcare_ck_ppp.km, correction = \"best\")\nplot(F_ck, main = \"F-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nF_ck.csr &lt;- envelope(childcare_ck_ppp.km, Fest,\n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(F_ck.csr, main = \"F-function CSR Test: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - F Function\n\n\nCode\n# Computing F-function estimation\nF_tm &lt;- Fest(childcare_tm_ppp.km, correction = \"best\")\nplot(F_tm, main = \"F-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nF_tm.csr &lt;- envelope(childcare_tm_ppp.km, Fest,\n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(F_tm.csr, main = \"F-function CSR Test: Tampines\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#k-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#k-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "K-Function Analysis",
    "text": "K-Function Analysis\nK-function measures the number of events found up to a given distance of any particular event.\n\nChoa Chu Kang - K Function\n\n\nCode\n# Computing K-function estimate\nK_ck &lt;- Kest(childcare_ck_ppp.km, correction = \"border\")\nplot(K_ck, main = \"K-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nK_ck.csr &lt;- envelope(childcare_ck_ppp.km, Kest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(K_ck.csr, main = \"K-function CSR Test: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - K Function\n\n\nCode\n# Computing K-function estimate\nK_tm &lt;- Kest(childcare_tm_ppp.km, correction = \"border\")\nplot(K_tm, main = \"K-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nK_tm.csr &lt;- envelope(childcare_tm_ppp.km, Kest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(K_tm.csr, main = \"K-function CSR Test: Tampines\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#l-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#l-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "L-Function Analysis",
    "text": "L-Function Analysis\nL-function is the normalized version of K-function.\n\nChoa Chu Kang - L Function\n\n\nCode\n# Computing L-function estimate\nL_ck &lt;- Lest(childcare_ck_ppp.km, correction = \"border\")\nplot(L_ck, main = \"L-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nL_ck.csr &lt;- envelope(childcare_ck_ppp.km, Lest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(L_ck.csr, . - r ~ r, \n     main = \"L-function CSR Test: Choa Chu Kang\",\n     ylab = \"L(r) - r\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - L Function\n\n\nCode\n# Computing L-function estimate\nL_tm &lt;- Lest(childcare_tm_ppp.km, correction = \"border\")\nplot(L_tm, main = \"L-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nL_tm.csr &lt;- envelope(childcare_tm_ppp.km, Lest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(L_tm.csr, . - r ~ r,\n     main = \"L-function CSR Test: Tampines\",\n     ylab = \"L(r) - r\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#summary-and-interpretation",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#summary-and-interpretation",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Summary and Interpretation",
    "text": "Summary and Interpretation\n\nKey Findings\nBased on the second-order spatial point pattern analyses:\n\nG-Function Results:\n\nBoth Choa Chu Kang and Tampines show clustering patterns\nThe observed G-function lies above the theoretical CSR envelope\nThis indicates that childcare centres are closer to each other than expected under random distribution\n\nF-Function Results:\n\nThe empty space function shows shorter distances to the nearest childcare centre than expected\nThis further confirms the clustering pattern\n\nK-Function Results:\n\nAt various distance scales, there are more neighbours than expected under CSR\nThe clustering is significant across multiple spatial scales\n\nL-Function Results:\n\nThe normalized L-function confirms clustering patterns\nThe deviation from the theoretical line (L(r) - r = 0) indicates non-random distribution\n\n\n\n\nConclusions\nThe childcare centres in both Choa Chu Kang and Tampines planning areas are NOT randomly distributed. Instead, they exhibit significant clustering patterns. This clustering likely reflects:\n\nConcentration in residential areas\nProximity to HDB estates\nStrategic placement near transport nodes\nMarket-driven location decisions\n\nThe null hypothesis of Complete Spatial Randomness is rejected for both areas at the 0.001 significance level."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "",
    "text": "This exercise demonstrates choropleth mapping techniques using Singapore’s 2024 population data. We’ll create two thematic maps:\n\nAged population share (65+) by Planning Area using quantile classification\nDependency ratio by Planning Area using Jenks natural breaks classification"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#overview",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "",
    "text": "This exercise demonstrates choropleth mapping techniques using Singapore’s 2024 population data. We’ll create two thematic maps:\n\nAged population share (65+) by Planning Area using quantile classification\nDependency ratio by Planning Area using Jenks natural breaks classification"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#setup-and-environment",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#setup-and-environment",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Setup and Environment",
    "text": "Setup and Environment\n\n\nCode\n# 兜底：没装 pacman 就装\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\npacman::p_load(sf, dplyr, tidyr, readr, janitor, stringr, xml2, rvest,\n               tmap, here, units, purrr)\n\n# 需要 purrr，因为后面用到 map_chr / keep\npacman::p_load(sf, dplyr, tidyr, readr, janitor, stringr, xml2, rvest,\n               tmap, here, units, purrr)\ntmap_mode(\"plot\")\n\npath_ex01 &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\")\npath_geo  &lt;- file.path(path_ex01, \"data\", \"geospatial\")\npath_asp  &lt;- file.path(path_ex01, \"data\", \"aspatial\")\npath_fig  &lt;- file.path(path_ex01, \"figures\")\nif (!dir.exists(path_fig)) dir.create(path_fig, recursive = TRUE)\n\nmessage(\"Working directory: \", getwd())\nmessage(\"tmap version: \", as.character(packageVersion(\"tmap\")))\nmessage(\"Date: \", as.character(Sys.Date()))\ntmap_options(show.messages = FALSE)  # 关闭“组件被缩放”等提示"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-import",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-import",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Data Import",
    "text": "Data Import\n\nImport Geospatial Data (KML)\n\n\nCode\n# Import Master Plan 2019 Subzone Boundary (No Sea) from KML\nkml_file &lt;- file.path(path_geo, \"MasterPlan2019SubzoneBoundaryNoSeaKML.kml\")\n\nif (!file.exists(kml_file)) {\n  stop(\"KML file not found at: \", kml_file)\n}\n\n# Read KML file\nsubzone &lt;- st_read(kml_file, quiet = FALSE)\n\n\nReading layer `URA_MP19_SUBZONE_NO_SEA_PL' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial\\MasterPlan2019SubzoneBoundaryNoSeaKML.kml' \n  using driver `KML'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nCode\n# Check if GEOMETRYCOLLECTION and extract polygons if needed\nif (any(st_geometry_type(subzone) == \"GEOMETRYCOLLECTION\")) {\n  message(\"Extracting POLYGON from GEOMETRYCOLLECTION...\")\n  subzone &lt;- st_collection_extract(subzone, \"POLYGON\")\n}\n\n# Transform to SVY21 (EPSG:3414)\nsubzone &lt;- st_transform(subzone, crs = 3414)\n\nmessage(\"CRS after transformation: EPSG:\", st_crs(subzone)$epsg)\n\n\n\n\nParse KML Attributes\n\n\nCode\n# Function to extract field from HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  # Find the row with matching field name\n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# Check if PLN_AREA_N and SUBZONE_N exist\nif (!all(c(\"PLN_AREA_N\", \"SUBZONE_N\") %in% names(subzone))) {\n  message(\"Extracting planning area and subzone names from Description field...\")\n  \n  # Extract fields from HTML description\n  subzone &lt;- subzone %&gt;%\n    mutate(\n      pln_area_n = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n      subzone_n = map_chr(Description, extract_kml_field, \"SUBZONE_N\")\n    ) %&gt;%\n    select(-Name, -Description)\n} else {\n  # If fields exist, just rename to snake_case\n  subzone &lt;- subzone %&gt;%\n    clean_names()\n}\n\n# Display sample data\nmessage(\"Subzone data structure:\")\nmessage(\"- Records: \", nrow(subzone))\nmessage(\"- Planning areas: \", n_distinct(subzone$pln_area_n))\n\n\n\n\nAggregate to Planning Area Level\n\n\nCode\n# Aggregate subzones to planning area level\nplanning &lt;- subzone %&gt;%\n  group_by(pln_area_n) %&gt;%\n  summarise(\n    do_union = TRUE,\n    .groups = 'drop'\n  )\n\nmessage(\"Planning areas created: \", nrow(planning))\n\n# Verify CRS\nstopifnot(st_crs(planning) == st_crs(3414))\n\n\n\n\nImport Population Data\n\n\nCode\n# --- Import population CSV (robust rename) ---\npop_file &lt;- file.path(path_asp, \"respopagesextod2024.csv\")\nif (!file.exists(pop_file)) stop(\"Population CSV file not found at: \", pop_file)\n\npop_raw &lt;- read_csv(pop_file, show_col_types = FALSE)\nmessage(\"Raw columns: \", paste(names(pop_raw), collapse = \", \"))\n\n# 标准化列名为小写下划线\npopdata &lt;- pop_raw %&gt;% janitor::clean_names()\n\nnm &lt;- names(popdata)\nif (\"planning_area\"     %in% nm) popdata &lt;- dplyr::rename(popdata, pa  = planning_area)\nif (\"planning_area_name\"%in% nm) popdata &lt;- dplyr::rename(popdata, pa  = planning_area_name)\nif (\"age_group\"         %in% nm) popdata &lt;- dplyr::rename(popdata, ag  = age_group)\nif (\"type_of_dwelling\"  %in% nm) popdata &lt;- dplyr::rename(popdata, tod = type_of_dwelling)\nif (\"value\"             %in% nm) popdata &lt;- dplyr::rename(popdata, pop = value)\n\npopdata &lt;- popdata %&gt;%\n  mutate(\n    pa  = str_squish(pa),\n    ag  = str_replace_all(str_to_lower(ag), \"\\\\s+\", \"_\"),\n    tod = str_squish(tod),\n    sex = str_squish(sex)\n  )\n\n\n# 映射不同写法 -&gt; 统一到 pa / ag / sex / tod / pop\n# （左边=原始列名，右边=统一后的列名）\nalias_map &lt;- c(\n  \"planning_area\"    = \"pa\",\n  \"planning_area_name\" = \"pa\",\n  \"pa\"               = \"pa\",\n  \"age_group\"        = \"ag\",\n  \"ag\"               = \"ag\",\n  \"sex\"              = \"sex\",\n  \"type_of_dwelling\" = \"tod\",\n  \"tod\"              = \"tod\",\n  \"value\"            = \"pop\",\n  \"population\"       = \"pop\"\n)\n\n# 只对存在的列做重命名：rename(new = old)\nmap &lt;- alias_map[names(alias_map) %in% names(popdata)]\npopdata &lt;- dplyr::rename(popdata, !!!setNames(names(map), map))\n\n# 现在这5列应该都在：pa / ag / sex / tod / pop\nneed &lt;- c(\"pa\", \"ag\", \"sex\", \"tod\", \"pop\")\nmiss &lt;- setdiff(need, names(popdata))\nif (length(miss)) stop(\"These required columns are missing after rename: \", paste(miss, collapse = \", \"))\n\n# 文本清洗：去多余空格，小写化 age_group 并把空格变下划线\npopdata &lt;- popdata %&gt;%\n  dplyr::mutate(\n    pa = stringr::str_squish(pa),\n    ag = stringr::str_replace_all(stringr::str_to_lower(ag), \"\\\\s+\", \"_\"),\n    tod = stringr::str_squish(tod),\n    sex = stringr::str_squish(sex)\n  )\n\nmessage(\"Normalized columns: \", paste(names(popdata), collapse = \", \"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-wrangling",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-wrangling",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Data Wrangling",
    "text": "Data Wrangling\n\nProcess Population Data\n\n\nCode\n# --- Process population BY SUBZONE (sum across Sex and TOD) ---\n\n# 前提：import-population 已 clean_names()，并把列名统一成 pa/sz/ag/sex/tod/pop/time\n# 如果你还没统一列名，请在 import-population 那块 clean_names() 后加：\n# nm &lt;- names(popdata)\n# if (\"planning_area\" %in% nm) popdata &lt;- dplyr::rename(popdata, pa = planning_area)\n# if (\"subzone\"       %in% nm) popdata &lt;- dplyr::rename(popdata, sz = subzone)\n# if (\"age_group\"     %in% nm) popdata &lt;- dplyr::rename(popdata, ag = age_group)\n# if (\"type_of_dwelling\" %in% nm) popdata &lt;- dplyr::rename(popdata, tod = type_of_dwelling)\n# if (\"value\"         %in% nm) popdata &lt;- dplyr::rename(popdata, pop = value)\n\n# 0) 只取 2024（如果有 time 列）\npop_w &lt;- popdata\nif (\"time\" %in% names(pop_w)) {\n  pop_w &lt;- pop_w %&gt;% dplyr::filter(time == max(time, na.rm = TRUE))\n}\n\n# 1) 不再按 Sex/TOD 过滤，直接“对子区+年龄段”把人头加总（= Total）\npop_sz &lt;- pop_w %&gt;%\n  dplyr::group_by(sz, ag) %&gt;%\n  dplyr::summarise(pop = sum(pop, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  # 标准化子区名，提取起始年龄\n  dplyr::mutate(\n    sz_clean  = stringr::str_squish(stringr::str_to_upper(sz)),\n    ag_start  = readr::parse_integer(stringr::str_extract(ag, \"^[0-9]+\")),\n    age_category = dplyr::case_when(\n      !is.na(ag_start) & ag_start &lt;= 19 ~ \"young\",\n      !is.na(ag_start) & ag_start &lt;= 64 ~ \"econ\",\n      TRUE                              ~ \"aged\"\n    )\n  ) %&gt;%\n  dplyr::count(sz_clean, age_category, wt = pop, name = \"population\") %&gt;%\n  tidyr::complete(sz_clean, age_category, fill = list(population = 0)) %&gt;%\n  tidyr::pivot_wider(names_from = age_category, values_from = population, values_fill = 0)\n\n# 2) 指标（安全版）\nfor (col in c(\"young\",\"econ\",\"aged\")) if (!col %in% names(pop_sz)) pop_sz[[col]] &lt;- 0\npop_sz &lt;- pop_sz %&gt;%\n  dplyr::mutate(\n    total       = young + econ + aged,\n    aged_share  = dplyr::if_else(total &gt; 0, 100 * aged / total, 0),\n    dependency  = dplyr::if_else(econ  &gt; 0, 100 * (young + aged) / econ, NA_real_)\n  )\n\nmessage(\"Subzone-level population rows: \", nrow(pop_sz))\n\n\n\n\nJoin Spatial and Population Data\n\n\nCode\n# --- Build SZ -&gt; PA bridge from KML, then aggregate to PA ---\n\n# 注意：你的子区几何对象在前文叫 subzone（若叫 mpsz，请把下行的 subzone 改成 mpsz）\nbridge &lt;- subzone %&gt;%\n  sf::st_drop_geometry() %&gt;%\n  dplyr::transmute(\n    sz_clean       = stringr::str_squish(stringr::str_to_upper(subzone_n)),\n    pln_area_clean = stringr::str_squish(stringr::str_to_upper(pln_area_n))\n  ) %&gt;%\n  dplyr::distinct()\n\n# 子区人口接上映射 → 聚合到规划区\npop_pa &lt;- pop_sz %&gt;%\n  dplyr::left_join(bridge, by = \"sz_clean\") %&gt;%\n  dplyr::filter(!is.na(pln_area_clean)) %&gt;%\n  dplyr::group_by(pln_area_clean) %&gt;%\n  dplyr::summarise(\n    young = sum(young, na.rm = TRUE),\n    econ  = sum(econ,  na.rm = TRUE),\n    aged  = sum(aged,  na.rm = TRUE),\n    .groups = \"drop\"\n  ) %&gt;%\n  dplyr::mutate(\n    total       = young + econ + aged,\n    aged_share  = dplyr::if_else(total &gt; 0, 100 * aged / total, 0),\n    dependency  = dplyr::if_else(econ  &gt; 0, 100 * (young + aged) / econ, NA_real_)\n  )\n\nmessage(\"Aggregated to planning areas: \", nrow(pop_pa), \" (expected ≈55)\")\n\n# 用 inner_join 接回规划区几何（保证有值的区才保留）\nplanning &lt;- planning %&gt;% dplyr::mutate(\n  pln_area_clean = stringr::str_squish(stringr::str_to_upper(pln_area_n))\n)\nplanning_pop &lt;- planning %&gt;%\n  dplyr::inner_join(pop_pa, by = \"pln_area_clean\")\n\n# 必须 &gt;0（否则仍是 NA）\nstopifnot(sum(!is.na(planning_pop$aged_share)) &gt; 0)\nstopifnot(sum(!is.na(planning_pop$dependency)) &gt; 0)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#create-choropleth-maps",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#create-choropleth-maps",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Create Choropleth Maps",
    "text": "Create Choropleth Maps\n\nMap A: Aged Population Share (65+)\n\n\nCode\ntmap_options(show.messages = FALSE)\n\n# Map A —— Aged 65+ share（过滤 NA，避免 Missing）\nplanning_aged &lt;- planning_pop[!is.na(planning_pop$aged_share) & !sf::st_is_empty(planning_pop), ]\n\nmap_aged &lt;- tm_shape(planning_aged) +\n  tm_polygons(col = \"aged_share\", style = \"quantile\", n = 5, palette = \"Reds\",\n              title = \"Aged Share (%)\") +\n  tm_layout(legend.outside = TRUE) +\n  tm_compass(type = \"8star\", size = 1.8, position = c(\"left\",\"top\")) +\n  tm_scale_bar(position = c(\"left\",\"bottom\")) +\n  tm_credits(\"Data: URA MP19 (No Sea), SingStat 2024\\nCRS: SVY21 / EPSG:3414\",\n             position = c(\"right\",\"bottom\"), size = 0.6)\n\nmap_aged\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(map_aged, file.path(path_fig, \"ex01b_aged_share_quantile.png\"),\n          width = 1600, height = 1200, dpi = 300, units = \"px\")\n\n\n\n\nMap B: Dependency Ratio\n\n\nCode\n# Map B —— Dependency ratio（过滤 NA）\nplanning_dep &lt;- planning_pop[!is.na(planning_pop$dependency) & !sf::st_is_empty(planning_pop), ]\n\nmap_dependency &lt;- tm_shape(planning_dep) +\n  tm_polygons(col = \"dependency\", style = \"jenks\", n = 5, palette = \"PuBuGn\",\n              title = \"Dependency Ratio (%)\") +\n  tm_layout(legend.outside = TRUE) +\n  tm_compass(type = \"8star\", size = 1.8, position = c(\"left\",\"top\")) +\n  tm_scale_bar(position = c(\"left\",\"bottom\")) +\n  tm_credits(\"Data: URA MP19 (No Sea), SingStat 2024\\nCRS: SVY21 / EPSG:3414\",\n             position = c(\"right\",\"bottom\"), size = 0.6)\n\nmap_dependency\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(map_dependency, file.path(path_fig, \"ex01b_dependency_jenks.png\"),\n          width = 1600, height = 1200, dpi = 300, units = \"px\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#results",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#results",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Results",
    "text": "Results\nThe two choropleth maps have been successfully created and saved to the figures folder:\n\nMap A: Share of Aged Population (65+)\n\n\n\nAged Population Share\n\n\nThis map uses quantile classification with 5 classes to show the distribution of aged population (65 years and above) as a percentage of total population across Singapore’s planning areas. The red color ramp helps identify areas with higher concentrations of elderly residents.\n\n\nMap B: Dependency Ratio\n\n\n\nDependency Ratio\n\n\nThis map uses Jenks natural breaks classification with 5 classes to visualize the dependency ratio across planning areas. The dependency ratio represents the proportion of economically dependent population (young and aged) to the economically active population. The PuBuGn color scheme provides clear visual distinction between areas with different dependency levels."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#summary-statistics",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#summary-statistics",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Summary Statistics",
    "text": "Summary Statistics\n\n\nCode\n# Display summary statistics\ncat(\"\\n=== Summary Statistics ===\\n\")\n\n\n\n=== Summary Statistics ===\n\n\nCode\ncat(\"\\nAged Population Share (%):\\n\")\n\n\n\nAged Population Share (%):\n\n\nCode\nsummary(planning_pop$aged_share)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   1.639  14.964  12.790  21.026  28.801 \n\n\nCode\ncat(\"\\nDependency Ratio (%):\\n\")\n\n\n\nDependency Ratio (%):\n\n\nCode\nsummary(planning_pop$dependency)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  27.30   51.08   58.48   56.26   64.18   72.89      13 \n\n\nCode\n# Top 5 areas with highest aged share\ncat(\"\\nTop 5 Planning Areas - Highest Aged Share:\\n\")\n\n\n\nTop 5 Planning Areas - Highest Aged Share:\n\n\nCode\nplanning_pop %&gt;%\n  st_drop_geometry() %&gt;%\n  select(pln_area_n, aged_share) %&gt;%\n  arrange(desc(aged_share)) %&gt;%\n  head(5) %&gt;%\n  print()\n\n\n# A tibble: 5 × 2\n  pln_area_n   aged_share\n  &lt;chr&gt;             &lt;dbl&gt;\n1 OUTRAM             28.8\n2 ANG MO KIO         25.4\n3 ROCHOR             24.8\n4 SUNGEI KADUT       24.6\n5 BUKIT MERAH        24.5\n\n\nCode\n# Top 5 areas with highest dependency ratio\ncat(\"\\nTop 5 Planning Areas - Highest Dependency Ratio:\\n\")\n\n\n\nTop 5 Planning Areas - Highest Dependency Ratio:\n\n\nCode\nplanning_pop %&gt;%\n  st_drop_geometry() %&gt;%\n  select(pln_area_n, dependency) %&gt;%\n  arrange(desc(dependency)) %&gt;%\n  head(5) %&gt;%\n  print()\n\n\n# A tibble: 5 × 2\n  pln_area_n  dependency\n  &lt;chr&gt;            &lt;dbl&gt;\n1 OUTRAM            72.9\n2 CHANGI            71.4\n3 BUKIT TIMAH       70.6\n4 ANG MO KIO        67.9\n5 BUKIT MERAH       67.4\n\n\n\nEnd of Hands-on Exercise 01b"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "",
    "text": "This exercise focuses on importing, cleaning, and standardizing geospatial data for Singapore. We will process three spatial datasets (subzones, cycling paths, and pre-schools) and one aspatial dataset (Airbnb listings), ensuring all spatial data uses the SVY21 (EPSG:3414) coordinate reference system."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#overview",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "",
    "text": "This exercise focuses on importing, cleaning, and standardizing geospatial data for Singapore. We will process three spatial datasets (subzones, cycling paths, and pre-schools) and one aspatial dataset (Airbnb listings), ensuring all spatial data uses the SVY21 (EPSG:3414) coordinate reference system."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#setup-and-environment",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#setup-and-environment",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "Setup and Environment",
    "text": "Setup and Environment\n\n\nCode\n# Load required packages (including lwgeom for geometry validation)\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\npacman::p_load(sf, lwgeom, dplyr, readr, janitor, stringr, here, tmap, ggplot2, units)\n\n# Print session information for reproducibility\ncat(\"R version:\", R.version.string, \"\\n\")\n\n\nR version: R version 4.5.0 (2025-04-11 ucrt) \n\n\nCode\ncat(\"sf version:\", as.character(packageVersion(\"sf\")), \"\\n\")\n\n\nsf version: 1.0.20 \n\n\nCode\nmessage(\"Date: \", as.character(Sys.Date()))\n\n# Define path variables using here::here()\npath_root &lt;- here::here()\npath_ex01 &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\")\npath_geo &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\", \"data\", \"geospatial\")\npath_asp &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\", \"data\", \"aspatial\")\n\n# Display paths for verification\nmessage(\"Project root: \", path_root)\nmessage(\"Exercise 01 path: \", path_ex01)\nmessage(\"Geospatial data path: \", path_geo)\nmessage(\"Aspatial data path: \", path_asp)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#workflow",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#workflow",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "Workflow",
    "text": "Workflow\n\nStep 1: Import Geospatial Data\n\n\nCode\n# 1.1 Import MP14_SUBZONE_WEB_PL (Polygon)\nmessage(\"\\n=== Importing Subzone Data ===\")\n\n\n\n=== Importing Subzone Data ===\n\n\nCode\nsubzone_file &lt;- file.path(path_geo, \"MP14_SUBZONE_WEB_PL.shp\")\nif (!file.exists(subzone_file)) {\n  stop(\"MP14_SUBZONE_WEB_PL.shp not found at: \", subzone_file,\n       \"\\nPlease ensure the file is placed in: \", path_geo)\n}\n\nmpsz &lt;- sf::st_read(dsn = path_geo, layer = \"MP14_SUBZONE_WEB_PL\", quiet = FALSE)\n\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nCode\nsub_crs &lt;- sf::st_crs(mpsz)\nif (is.na(sub_crs$epsg)) {\n  hint &lt;- paste(sub_crs$input, sub_crs$wkt)\n  if (grepl(\"SVY21|Singapore TM|3414\", hint, ignore.case = TRUE)) {\n    message(\"Subzone CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\")\n    mpsz &lt;- sf::st_set_crs(mpsz, 3414)\n  } else {\n    stop(\"Subzone CRS has no EPSG and doesn't look like SVY21. Check the .prj file.\")\n  }\n}\n\n\nSubzone CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\n\n\nCode\n# Display basic information\nmessage(\"Subzone data imported successfully\")\n\n\nSubzone data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(mpsz))\n\n\n- Records: 323\n\n\nCode\nmessage(\"- CRS: \", sf::st_crs(mpsz)$input, \" | EPSG: \", sf::st_crs(mpsz)$epsg)\n\n\n- CRS: EPSG:3414 | EPSG: 3414\n\n\nCode\nmessage(\"- Geometry type: \", paste(unique(sf::st_geometry_type(mpsz)), collapse = \", \"))\n\n\n- Geometry type: MULTIPOLYGON\n\n\n\n\nCode\n# 1.2 Import CyclingPathGazette (Line)\nmessage(\"\\n=== Importing Cycling Path Data ===\")\n\n\n\n=== Importing Cycling Path Data ===\n\n\nCode\ncycling_file &lt;- file.path(path_geo, \"CyclingPath_Aug2025\", \"CyclingPathGazette.shp\")\nif (!file.exists(cycling_file)) {\n  stop(\"CyclingPathGazette.shp not found at: \", cycling_file,\n       \"\\nPlease ensure the file is placed in: \", file.path(path_geo, \"CyclingPath_Aug2025\"))\n}\n\ncycling_path &lt;- sf::st_read(cycling_file, quiet = FALSE)\n\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial\\CyclingPath_Aug2025\\CyclingPathGazette.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 4674 features and 7 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21\n\n\nCode\ncy_crs &lt;- sf::st_crs(cycling_path)\nif (is.na(cy_crs$epsg)) {\n  hint &lt;- paste(cy_crs$input, cy_crs$wkt)\n  if (grepl(\"SVY21|Singapore TM|3414\", hint, ignore.case = TRUE)) {\n    message(\"Cycling Path CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\")\n    cycling_path &lt;- sf::st_set_crs(cycling_path, 3414)\n  } else {\n    stop(\"Cycling Path CRS has no EPSG and doesn't look like SVY21. Check the .prj file.\")\n  }\n}\n\n\nCycling Path CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\n\n\nCode\n# Display basic information\nmessage(\"Cycling path data imported successfully\")\n\n\nCycling path data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(cycling_path))\n\n\n- Records: 4674\n\n\nCode\nmessage(\"- CRS: \", sf::st_crs(cycling_path)$input, \" | EPSG: \", sf::st_crs(cycling_path)$epsg)\n\n\n- CRS: EPSG:3414 | EPSG: 3414\n\n\nCode\nmessage(\"- Geometry type: \", paste(unique(sf::st_geometry_type(cycling_path)), collapse = \", \"))\n\n\n- Geometry type: MULTILINESTRING\n\n\n\n\nCode\n# 1.3 Import PreSchoolsLocation (Point)\nmessage(\"\\n=== Importing Pre-Schools Data ===\")\n\n\n\n=== Importing Pre-Schools Data ===\n\n\nCode\npreschool_file &lt;- file.path(path_geo, \"PreSchoolsLocation.kml\")\nif (!file.exists(preschool_file)) {\n  stop(\"PreSchoolsLocation.kml not found at: \", preschool_file,\n       \"\\nPlease ensure the file is placed in: \", path_geo)\n}\n\npreschools &lt;- st_read(preschool_file, quiet = FALSE)\n\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\n# Display basic information before transformation\nmessage(\"Pre-schools data imported successfully\")\n\n\nPre-schools data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(preschools))\n\n\n- Records: 2290\n\n\nCode\nmessage(\"- Original CRS EPSG: \", st_crs(preschools)$epsg)\n\n\n- Original CRS EPSG: 4326\n\n\nCode\nmessage(\"- Geometry type: \", unique(st_geometry_type(preschools)))\n\n\n- Geometry type: POINT\n\n\n\n\nCode\n# 1.4 Import listings.csv (Aspatial)\nmessage(\"\\n=== Importing Airbnb Listings Data ===\")\n\n\n\n=== Importing Airbnb Listings Data ===\n\n\nCode\nlistings_file &lt;- file.path(path_asp, \"listings.csv\")\nif (!file.exists(listings_file)) {\n  stop(\"listings.csv not found at: \", listings_file,\n       \"\\nPlease ensure the file is placed in: \", path_asp)\n}\n\nlistings &lt;- read_csv(listings_file, show_col_types = FALSE)\n\n# Verify required columns exist\nif (!all(c(\"latitude\", \"longitude\") %in% names(listings))) {\n  stop(\"listings.csv must contain 'latitude' and 'longitude' columns\")\n}\n\nmessage(\"Listings data imported successfully\")\n\n\nListings data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(listings))\n\n\n- Records: 3659\n\n\nCode\nmessage(\"- Columns: \", ncol(listings))\n\n\n- Columns: 79\n\n\nCode\nmessage(\"- Latitude/Longitude columns: VERIFIED\")\n\n\n- Latitude/Longitude columns: VERIFIED\n\n\n\n\nStep 2: Exploratory Data Inspection (Ch. 1.5–1.6)\n\n\nCode\nmessage(\"\\n=== Inspecting Subzone Data Structure ===\")\n\n\n\n=== Inspecting Subzone Data Structure ===\n\n\nCode\n# Geometry column summary and CRS bbox overview\nprint(st_geometry(mpsz))\n\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\nCode\nprint(st_bbox(mpsz))\n\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334 \n\n\nCode\n# Attribute glimpse and sample records\nglimpse(mpsz)\n\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\nCode\nprint(head(mpsz, 3))\n\n\nSimple feature collection with 3 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 28160.23 ymin: 28369.47 xmax: 32362.39 ymax: 30247.18\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO    SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N PLN_AREA_C\n1        1          1 MARINA SOUTH    MSSZ01      Y    MARINA SOUTH         MS\n2        2          1 PEARL'S HILL    OTSZ01      Y          OUTRAM         OT\n3        3          3    BOAT QUAY    SRSZ03      Y SINGAPORE RIVER         SR\n        REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR\n1 CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84 29220.19\n2 CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06 29782.05\n3 CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96 29974.66\n  SHAPE_Leng SHAPE_Area                       geometry\n1   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n\n\n\n\nCode\nmessage(\"\\n=== Inspecting Cycling Path Data Structure ===\")\n\n\n\n=== Inspecting Cycling Path Data Structure ===\n\n\nCode\nprint(st_geometry(cycling_path))\n\n\nGeometry set for 4674 features \nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nMULTILINESTRING ((40128.23 37076.74, 40130.44 3...\n\n\nMULTILINESTRING ((35123.93 42970.72, 35121.12 4...\n\n\nMULTILINESTRING ((35088.86 42820.93, 35089.18 4...\n\n\nMULTILINESTRING ((35099.12 42871.11, 35097.69 4...\n\n\nMULTILINESTRING ((16031.65 36921.59, 16035.79 3...\n\n\nCode\nprint(st_bbox(cycling_path))\n\n\n    xmin     ymin     xmax     ymax \n11721.10 27550.13 42809.37 49702.59 \n\n\nCode\nglimpse(cycling_path)\n\n\nRows: 4,674\nColumns: 8\n$ RD_CD      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PATH_OWNER &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ SHAPE_LEN  &lt;dbl&gt; 18.732594, 94.469928, 9.169593, 51.320348, 29.886054, 38.38…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ RD_CD_DESC &lt;chr&gt; \"TAMPINES AVENUE 4\", \"PUNGGOL FIELD\", \"PUNGGOL FIELD\", \"PUN…\n$ PATH_OWN_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\n\nCode\nprint(head(cycling_path, 3))\n\n\nSimple feature collection with 3 features and 7 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 35088.86 ymin: 37076.69 xmax: 40146.92 ymax: 42970.72\nProjected CRS: SVY21 / Singapore TM\n  RD_CD PLANNING_A PATH_OWNER SHAPE_LEN PLANNING_1        RD_CD_DESC\n1  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; 18.732594   TAMPINES TAMPINES AVENUE 4\n2  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; 94.469928    PUNGGOL     PUNGGOL FIELD\n3  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;  9.169593    PUNGGOL     PUNGGOL FIELD\n                PATH_OWN_1                       geometry\n1 Land Transport Authority MULTILINESTRING ((40128.23 ...\n2 Land Transport Authority MULTILINESTRING ((35123.93 ...\n3 Land Transport Authority MULTILINESTRING ((35088.86 ...\n\n\n\n\nCode\nmessage(\"\\n=== Inspecting Pre-School Data Structure ===\")\n\n\n\n=== Inspecting Pre-School Data Structure ===\n\n\nCode\nprint(st_geometry(preschools))\n\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\nPOINT Z (103.8072 1.299333 0)\n\n\nPOINT Z (103.826 1.312839 0)\n\n\nPOINT Z (103.8409 1.348843 0)\n\n\nPOINT Z (103.8048 1.435024 0)\n\n\nPOINT Z (103.839 1.33315 0)\n\n\nCode\nprint(st_bbox(preschools))\n\n\n      xmin       ymin       xmax       ymax \n103.687842   1.247759 103.989707   1.462134 \n\n\nCode\nglimpse(preschools)\n\n\nRows: 2,290\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;POINT [°]&gt; POINT Z (103.8072 1.299333 0), POINT Z (103.826 1.31…\n\n\nCode\nprint(head(preschools, 3))\n\n\nSimple feature collection with 3 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.8072 ymin: 1.299333 xmax: 103.8409 ymax: 1.348843\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n   Name\n1 kml_1\n2 kml_2\n3 kml_3\n                                                                                                                                                                                                                                                                                                                                                                                          Description\n1     &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PRESCHOOL PTE.LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9390&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;498CC9FE48CC94D4&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n2              &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PTE. LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT8675&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;22877550804213FD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n3 &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S VINEYARD PRESCHOOL PTE. LTD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9308&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;B2FE90E44AD494E3&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n                       geometry\n1 POINT Z (103.8072 1.299333 0)\n2  POINT Z (103.826 1.312839 0)\n3 POINT Z (103.8409 1.348843 0)\n\n\n\n\nCode\nmessage(\"\\n=== Quick Look Plots (Chapter 1.6) ===\")\n\n\n\n=== Quick Look Plots (Chapter 1.6) ===\n\n\nCode\nop &lt;- par(mfrow = c(2, 2))\nplot(mpsz, main = \"MPSZ Subzones\")\n\n\n\n\n\n\n\n\n\nCode\nplot(st_geometry(mpsz), main = \"Subzone Geometry Only\")\nif (\"PLN_AREA_N\" %in% names(mpsz)) {\n  plot(mpsz[\"PLN_AREA_N\"], main = \"Planning Area Names\")\n} else if (\"pln_area_n\" %in% names(mpsz)) {\n  plot(mpsz[\"pln_area_n\"], main = \"Planning Area Names\")\n} else {\n  plot(st_geometry(mpsz), main = \"Planning Area Names\")\n}\n\n\n\n\n\n\n\n\n\nCode\nplot(st_geometry(mpsz), main = \"Subzones with Pre-Schools\")\nplot(st_geometry(preschools), add = TRUE, col = \"red\", pch = 20)\npar(op)\n\n\n\n\n\n\n\n\n\n\n\nStep 3: Converting Aspatial Data to sf (Ch. 1.8.2)\n\n\nCode\nmessage(\"\\n=== Converting Airbnb Listings to sf ===\")\n\n\n\n=== Converting Airbnb Listings to sf ===\n\n\nCode\nlistings_sf &lt;- listings %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326, remove = FALSE) %&gt;%\n  st_transform(3414)\n\nmessage(\"Listings converted to sf with CRS EPSG:\", st_crs(listings_sf)$epsg)\n\n\nListings converted to sf with CRS EPSG:3414\n\n\nCode\nglimpse(listings_sf)\n\n\nRows: 3,659\nColumns: 80\n$ id                                           &lt;dbl&gt; 71609, 71896, 71903, 2753…\n$ listing_url                                  &lt;chr&gt; \"https://www.airbnb.com/r…\n$ scrape_id                                    &lt;dbl&gt; 2.025063e+13, 2.025063e+1…\n$ last_scraped                                 &lt;date&gt; 2025-06-26, 2025-06-27, …\n$ source                                       &lt;chr&gt; \"city scrape\", \"previous …\n$ name                                         &lt;chr&gt; \"Ensuite Room (Room 1 & 2…\n$ description                                  &lt;chr&gt; \"For 3 rooms.Book room 1&…\n$ neighborhood_overview                        &lt;chr&gt; NA, NA, \"Quiet and view o…\n$ picture_url                                  &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_id                                      &lt;dbl&gt; 367042, 367042, 367042, 1…\n$ host_url                                     &lt;chr&gt; \"https://www.airbnb.com/u…\n$ host_name                                    &lt;chr&gt; \"Belinda\", \"Belinda\", \"Be…\n$ host_since                                   &lt;date&gt; 2011-01-29, 2011-01-29, …\n$ host_location                                &lt;chr&gt; \"Singapore\", \"Singapore\",…\n$ host_about                                   &lt;chr&gt; \"Hi My name is Belinda -H…\n$ host_response_time                           &lt;chr&gt; \"within an hour\", \"within…\n$ host_response_rate                           &lt;chr&gt; \"100%\", \"100%\", \"100%\", \"…\n$ host_acceptance_rate                         &lt;chr&gt; \"100%\", \"100%\", \"100%\", \"…\n$ host_is_superhost                            &lt;lgl&gt; FALSE, FALSE, FALSE, FALS…\n$ host_thumbnail_url                           &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_picture_url                             &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_neighbourhood                           &lt;chr&gt; \"Tampines\", \"Tampines\", \"…\n$ host_listings_count                          &lt;dbl&gt; 5, 5, 5, 59, 59, 7, 59, 5…\n$ host_total_listings_count                    &lt;dbl&gt; 10, 10, 10, 88, 88, 8, 88…\n$ host_verifications                           &lt;chr&gt; \"['email', 'phone']\", \"['…\n$ host_has_profile_pic                         &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ host_identity_verified                       &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ neighbourhood                                &lt;chr&gt; NA, NA, \"Singapore, Singa…\n$ neighbourhood_cleansed                       &lt;chr&gt; \"Tampines\", \"Tampines\", \"…\n$ neighbourhood_group_cleansed                 &lt;chr&gt; \"East Region\", \"East Regi…\n$ latitude                                     &lt;dbl&gt; 1.34537, 1.34754, 1.34531…\n$ longitude                                    &lt;dbl&gt; 103.9589, 103.9596, 103.9…\n$ property_type                                &lt;chr&gt; \"Private room in villa\", …\n$ room_type                                    &lt;chr&gt; \"Private room\", \"Private …\n$ accommodates                                 &lt;dbl&gt; 2, 1, 2, 1, 1, 2, 1, 1, 1…\n$ bathrooms                                    &lt;dbl&gt; 1.0, NA, 0.5, NA, NA, 1.0…\n$ bathrooms_text                               &lt;chr&gt; \"1 private bath\", \"Shared…\n$ bedrooms                                     &lt;dbl&gt; 2, NA, 1, NA, NA, 2, NA, …\n$ beds                                         &lt;dbl&gt; 3, NA, 2, NA, NA, 1, NA, …\n$ amenities                                    &lt;chr&gt; \"[\\\"Shampoo\\\", \\\"Fire pit…\n$ price                                        &lt;chr&gt; \"$143.00\", NA, \"$76.00\", …\n$ minimum_nights                               &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_nights                               &lt;dbl&gt; 365, 365, 365, 999, 999, …\n$ minimum_minimum_nights                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_minimum_nights                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ minimum_maximum_nights                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ maximum_maximum_nights                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ minimum_nights_avg_ntm                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_nights_avg_ntm                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ calendar_updated                             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, N…\n$ has_availability                             &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ availability_30                              &lt;dbl&gt; 30, 20, 30, 0, 0, 30, 0, …\n$ availability_60                              &lt;dbl&gt; 60, 49, 60, 24, 25, 60, 2…\n$ availability_90                              &lt;dbl&gt; 90, 79, 90, 54, 55, 90, 5…\n$ availability_365                             &lt;dbl&gt; 90, 79, 90, 153, 153, 365…\n$ calendar_last_scraped                        &lt;date&gt; 2025-06-26, 2025-06-27, …\n$ number_of_reviews                            &lt;dbl&gt; 19, 24, 46, 20, 16, 131, …\n$ number_of_reviews_ltm                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ number_of_reviews_l30d                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ availability_eoy                             &lt;dbl&gt; 90, 79, 90, 153, 153, 185…\n$ number_of_reviews_ly                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ estimated_occupancy_l365d                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ estimated_revenue_l365d                      &lt;dbl&gt; 0, NA, 0, NA, NA, 0, NA, …\n$ first_review                                 &lt;date&gt; 2011-12-19, 2011-07-30, …\n$ last_review                                  &lt;date&gt; 2020-01-17, 2019-10-13, …\n$ review_scores_rating                         &lt;dbl&gt; 4.44, 4.16, 4.41, 4.40, 4…\n$ review_scores_accuracy                       &lt;dbl&gt; 4.37, 4.22, 4.39, 4.16, 4…\n$ review_scores_cleanliness                    &lt;dbl&gt; 4.00, 4.09, 4.52, 4.26, 4…\n$ review_scores_checkin                        &lt;dbl&gt; 4.63, 4.43, 4.63, 4.47, 4…\n$ review_scores_communication                  &lt;dbl&gt; 4.78, 4.43, 4.64, 4.42, 4…\n$ review_scores_location                       &lt;dbl&gt; 4.26, 4.17, 4.50, 4.53, 4…\n$ review_scores_value                          &lt;dbl&gt; 4.32, 4.04, 4.36, 4.63, 4…\n$ license                                      &lt;chr&gt; NA, NA, NA, \"S0399\", \"S03…\n$ instant_bookable                             &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE…\n$ calculated_host_listings_count               &lt;dbl&gt; 5, 5, 5, 58, 58, 7, 58, 5…\n$ calculated_host_listings_count_entire_homes  &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0…\n$ calculated_host_listings_count_private_rooms &lt;dbl&gt; 5, 5, 5, 58, 58, 6, 58, 5…\n$ calculated_host_listings_count_shared_rooms  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ reviews_per_month                            &lt;dbl&gt; 0.12, 0.14, 0.27, 0.13, 0…\n$ geometry                                     &lt;POINT [m]&gt; POINT (41972.5 3639…\n\n\nCode\nprint(head(listings_sf, 3))\n\n\nSimple feature collection with 3 features and 79 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 41972.5 ymin: 36383.43 xmax: 42209.55 ymax: 36630.01\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 3 × 80\n     id listing_url              scrape_id last_scraped source name  description\n  &lt;dbl&gt; &lt;chr&gt;                        &lt;dbl&gt; &lt;date&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;      \n1 71609 https://www.airbnb.com/…   2.03e13 2025-06-26   city … Ensu… For 3 room…\n2 71896 https://www.airbnb.com/…   2.03e13 2025-06-27   previ… B&B … &lt;NA&gt;       \n3 71903 https://www.airbnb.com/…   2.03e13 2025-06-27   city … Room… Like your …\n# ℹ 73 more variables: neighborhood_overview &lt;chr&gt;, picture_url &lt;chr&gt;,\n#   host_id &lt;dbl&gt;, host_url &lt;chr&gt;, host_name &lt;chr&gt;, host_since &lt;date&gt;,\n#   host_location &lt;chr&gt;, host_about &lt;chr&gt;, host_response_time &lt;chr&gt;,\n#   host_response_rate &lt;chr&gt;, host_acceptance_rate &lt;chr&gt;,\n#   host_is_superhost &lt;lgl&gt;, host_thumbnail_url &lt;chr&gt;, host_picture_url &lt;chr&gt;,\n#   host_neighbourhood &lt;chr&gt;, host_listings_count &lt;dbl&gt;,\n#   host_total_listings_count &lt;dbl&gt;, host_verifications &lt;chr&gt;, …\n\n\n\n\nCode\nmessage(\"\\n=== DIY Map: Airbnb Listings over Subzones ===\")\n\nold_tmap_mode &lt;- tmap_mode(\"plot\")\n\ntmap::tm_shape(mpsz) +\n  tmap::tm_polygons(col = \"grey90\", border.col = \"grey60\") +\n  tmap::tm_shape(listings_sf) +\n  tmap::tm_symbols(col = \"tomato\", size = 0.03, alpha = 0.5) +\n  tmap::tm_layout(\n    title = \"Airbnb Listings across Singapore Subzones\",\n    legend.show = FALSE,\n    frame = FALSE\n  )\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(old_tmap_mode)\n\n\n\n\nStep 4: Coordinate System Transformation and Validation\n\n\nCode\nmessage(\"\\n=== CRS Transformation and Validation ===\")\n\n\n\n=== CRS Transformation and Validation ===\n\n\nCode\n# Define target CRS\ncrs_target &lt;- sf::st_crs(3414)\n\n# Transform Pre-Schools from WGS84 (4326) to SVY21 (3414)\nif (st_crs(preschools)$epsg == 4326) {\n  message(\"Transforming Pre-Schools from EPSG:4326 to EPSG:3414...\")\n  preschools &lt;- st_transform(preschools, crs = crs_target)\n  message(\"Transformation completed\")\n} else if (st_crs(preschools) != crs_target) {\n  stop(\"Unexpected CRS for Pre-Schools. Expected 4326 or 3414, got: \", \n       st_crs(preschools)$epsg)\n}\n\n\nTransforming Pre-Schools from EPSG:4326 to EPSG:3414...\n\n\nTransformation completed\n\n\nCode\n# Handle potential GEOMETRYCOLLECTION from KML\nif (any(st_geometry_type(preschools) == \"GEOMETRYCOLLECTION\")) {\n  message(\"Extracting POINT geometries from GEOMETRYCOLLECTION...\")\n  preschools &lt;- st_collection_extract(preschools, \"POINT\")\n}\n\n# Verify all spatial data is in EPSG:3414\nmessage(\"\\nVerifying CRS consistency...\")\n\n\n\nVerifying CRS consistency...\n\n\nCode\n# Assert CRS for all spatial datasets using object comparison\nif (st_crs(mpsz) != crs_target) {\n  stop(\"Subzone CRS is not EPSG:3414. Current CRS: \", st_crs(mpsz)$input)\n}\n\nif (st_crs(cycling_path) != crs_target) {\n  stop(\"Cycling Path CRS is not EPSG:3414. Current CRS: \", st_crs(cycling_path)$input)\n}\n\nif (st_crs(preschools) != crs_target) {\n  stop(\"Pre-Schools CRS is not EPSG:3414 after transform. Current CRS: \", st_crs(preschools)$input)\n}\n\nmessage(\"✓ All spatial datasets are in EPSG:3414 (SVY21)\")\n\n\n✓ All spatial datasets are in EPSG:3414 (SVY21)\n\n\nCode\n# Verify geometry types\nmessage(\"\\nVerifying geometry types...\")\n\n\n\nVerifying geometry types...\n\n\nCode\n# Check subzone geometry\nsubzone_geom &lt;- unique(st_geometry_type(mpsz))\nif (!all(subzone_geom %in% c(\"POLYGON\", \"MULTIPOLYGON\"))) {\n  stop(\"Subzone should be POLYGON or MULTIPOLYGON, got: \", paste(subzone_geom, collapse=\", \"))\n}\n\n# Check cycling path geometry  \ncycling_geom &lt;- unique(st_geometry_type(cycling_path))\nif (!all(cycling_geom %in% c(\"LINESTRING\", \"MULTILINESTRING\"))) {\n  stop(\"Cycling Path should be LINESTRING or MULTILINESTRING, got: \", paste(cycling_geom, collapse=\", \"))\n}\n\n# Check preschools geometry\npreschool_geom &lt;- unique(st_geometry_type(preschools))\nif (!all(preschool_geom %in% c(\"POINT\"))) {\n  stop(\"Pre-Schools should be POINT, got: \", paste(preschool_geom, collapse=\", \"))\n}\n\nmessage(\"✓ All geometry types verified\")\n\n\n✓ All geometry types verified\n\n\n\n\nStep 5: Data Cleaning and Standardization\n\n\nCode\nmessage(\"\\n=== Data Cleaning and Standardization ===\")\n\n\n\n=== Data Cleaning and Standardization ===\n\n\nCode\n# 3.1 Clean column names (snake_case)\nmessage(\"Standardizing column names to snake_case...\")\n\n\nStandardizing column names to snake_case...\n\n\nCode\nmpsz &lt;- mpsz %&gt;% janitor::clean_names()\ncycling_path &lt;- cycling_path %&gt;% janitor::clean_names()\npreschools &lt;- preschools %&gt;% janitor::clean_names()\n\n# 3.2 Select and retain key fields\nmessage(\"Selecting key fields...\")\n\n\nSelecting key fields...\n\n\nCode\n# For subzone: retain subzone_n and pln_area_n\nif (all(c(\"subzone_n\", \"pln_area_n\") %in% names(mpsz))) {\n  mpsz_clean &lt;- mpsz %&gt;%\n    select(subzone_n, pln_area_n, geometry)\n} else {\n  message(\"Note: Expected fields 'subzone_n' or 'pln_area_n' not found. Retaining all fields.\")\n  mpsz_clean &lt;- mpsz\n}\n\n# For cycling path: retain basic identification fields\ncycling_clean &lt;- cycling_path %&gt;%\n  select(any_of(c(\"objectid\", \"name\", \"type\", \"status\")), geometry)\n\n# For preschools: retain name field\nif (\"name\" %in% names(preschools)) {\n  preschools_clean &lt;- preschools %&gt;%\n    select(name, geometry)\n} else {\n  message(\"Note: 'name' field not found in Pre-Schools. Retaining all fields.\")\n  preschools_clean &lt;- preschools\n}\n\n# 3.3 Remove empty geometries\nmessage(\"Checking for empty geometries...\")\n\n\nChecking for empty geometries...\n\n\nCode\n# Check and remove empty geometries\nn_empty_mpsz &lt;- sum(st_is_empty(mpsz_clean))\nn_empty_cycling &lt;- sum(st_is_empty(cycling_clean))\nn_empty_preschools &lt;- sum(st_is_empty(preschools_clean))\n\nif (n_empty_mpsz &gt; 0) {\n  message(\"Removing \", n_empty_mpsz, \" empty geometries from subzone data\")\n  mpsz_clean &lt;- mpsz_clean[!st_is_empty(mpsz_clean), ]\n}\n\nif (n_empty_cycling &gt; 0) {\n  message(\"Removing \", n_empty_cycling, \" empty geometries from cycling path data\")\n  cycling_clean &lt;- cycling_clean[!st_is_empty(cycling_clean), ]\n}\n\nif (n_empty_preschools &gt; 0) {\n  message(\"Removing \", n_empty_preschools, \" empty geometries from preschools data\")\n  preschools_clean &lt;- preschools_clean[!st_is_empty(preschools_clean), ]\n}\n\nmessage(\"✓ Data cleaning completed\")\n\n\n✓ Data cleaning completed\n\n\nCode\n# 3.4 Make geometries valid if needed\nmessage(\"Validating geometries...\")\n\n\nValidating geometries...\n\n\nCode\n# Check and fix invalid geometries\nif (any(!st_is_valid(mpsz_clean))) {\n  message(\"Fixing invalid geometries in subzone data...\")\n  mpsz_clean &lt;- st_make_valid(mpsz_clean)\n}\n\n\nFixing invalid geometries in subzone data...\n\n\nCode\nif (any(!st_is_valid(cycling_clean))) {\n  message(\"Fixing invalid geometries in cycling path data...\")\n  cycling_clean &lt;- st_make_valid(cycling_clean)\n}\n\nif (any(!st_is_valid(preschools_clean))) {\n  message(\"Fixing invalid geometries in preschools data...\")\n  preschools_clean &lt;- st_make_valid(preschools_clean)\n}\n\nmessage(\"✓ All geometries are valid\")\n\n\n✓ All geometries are valid\n\n\n\n\nStep 6: Export Clean Data\n\n\nCode\nmessage(\"\\n=== Exporting Clean Data ===\")\n\n\n\n=== Exporting Clean Data ===\n\n\nCode\n# Define output file paths\nsubzone_out &lt;- file.path(path_geo, \"clean_subzone.gpkg\")\ncycling_out &lt;- file.path(path_geo, \"clean_cycling_path.gpkg\")\npreschools_out &lt;- file.path(path_geo, \"clean_preschools_svy21.gpkg\")\n\n# Remove existing files to avoid multiple layers\nif (file.exists(subzone_out)) {\n  message(\"Removing existing clean_subzone.gpkg\")\n  file.remove(subzone_out)\n}\n\n\nRemoving existing clean_subzone.gpkg\n\n\n[1] TRUE\n\n\nCode\nif (file.exists(cycling_out)) {\n  message(\"Removing existing clean_cycling_path.gpkg\")\n  file.remove(cycling_out)\n}\n\n\nRemoving existing clean_cycling_path.gpkg\n\n\n[1] TRUE\n\n\nCode\nif (file.exists(preschools_out)) {\n  message(\"Removing existing clean_preschools_svy21.gpkg\")\n  file.remove(preschools_out)\n}\n\n\nRemoving existing clean_preschools_svy21.gpkg\n\n\n[1] TRUE\n\n\nCode\n# Export to GeoPackage\nmessage(\"Writing clean data to GeoPackage files...\")\n\n\nWriting clean data to GeoPackage files...\n\n\nCode\nst_write(mpsz_clean, subzone_out, layer = \"subzone\", quiet = FALSE)\n\n\nWriting layer `subzone' to data source \n  `C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_subzone.gpkg' using driver `GPKG'\nWriting 323 features with 2 fields and geometry type Unknown (any).\n\n\nCode\nst_write(cycling_clean, cycling_out, layer = \"cycling_path\", quiet = FALSE)\n\n\nWriting layer `cycling_path' to data source \n  `C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_cycling_path.gpkg' using driver `GPKG'\nWriting 4674 features with 0 fields and geometry type Multi Line String.\n\n\nCode\nst_write(preschools_clean, preschools_out, layer = \"preschools\", quiet = FALSE)\n\n\nWriting layer `preschools' to data source \n  `C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_preschools_svy21.gpkg' using driver `GPKG'\nWriting 2290 features with 1 fields and geometry type 3D Point.\n\n\nCode\nmessage(\"\\n✓ All clean data exported successfully\")\n\n\n\n✓ All clean data exported successfully\n\n\nCode\nmessage(\"Output files:\")\n\n\nOutput files:\n\n\nCode\nmessage(\"- \", subzone_out)\n\n\n- C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_subzone.gpkg\n\n\nCode\nmessage(\"- \", cycling_out)\n\n\n- C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_cycling_path.gpkg\n\n\nCode\nmessage(\"- \", preschools_out)\n\n\n- C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_preschools_svy21.gpkg\n\n\n\n\nStep 7: Geospatial Processing Examples (Ch. 1.9)\n\n\nCode\nmessage(\"\\n=== Cycling Path Buffer and Area Calculations ===\")\n\n\n\n=== Cycling Path Buffer and Area Calculations ===\n\n\nCode\n# Create 5 metre buffer around cleaned cycling paths (per feature)\ncycling_buffer &lt;- cycling_clean %&gt;%\n  st_buffer(dist = 5) %&gt;%\n  mutate(\n    buffer_area_sqm = st_area(.),\n    buffer_area_sqkm = set_units(buffer_area_sqm, \"km^2\")\n  )\n\ntotal_buffer_area &lt;- sum(cycling_buffer$buffer_area_sqkm)\nmessage(\n  \"Total buffered cycling corridor area (5 m): \",\n  signif(as.numeric(total_buffer_area), 4),\n  \" sq km\"\n)\n\n\nTotal buffered cycling corridor area (5 m): 3.56 sq km\n\n\nCode\n# Intersect buffer with Tampines West subzone (if available)\ntampines_west &lt;- mpsz_clean %&gt;%\n  filter(\n    toupper(pln_area_n) == \"TAMPINES\",\n    toupper(subzone_n) == \"TAMPINES WEST\"\n  )\n\nif (nrow(tampines_west) == 0) {\n  message(\"Tampines West subzone not found – selecting first available subzone instead.\")\n  tampines_west &lt;- mpsz_clean[1, ]\n}\n\ntampines_buffer &lt;- st_intersection(st_make_valid(tampines_west), st_union(cycling_buffer))\n\nif (nrow(tampines_buffer) &gt; 0) {\n  tampines_area &lt;- set_units(st_area(tampines_buffer), \"km^2\")\n  message(\n    \"Buffered cycling area within selected subzone: \",\n    signif(as.numeric(tampines_area), 4),\n    \" sq km\"\n  )\n} else {\n  message(\"No buffered cycling segments found within the selected subzone.\")\n}\n\n\nBuffered cycling area within selected subzone: 0.09913 sq km\n\n\n\n\nCode\nmessage(\"\\n=== Visualising Cycling Buffer in Tampines West ===\")\n\nold_tmap_mode &lt;- tmap_mode(\"plot\")\n\nif (nrow(tampines_buffer) &gt; 0) {\n  tmap::tm_shape(tampines_west) +\n    tmap::tm_polygons(col = \"#f0f4ff\", border.col = \"#26456e\") +\n    tmap::tm_shape(tampines_buffer) +\n    tmap::tm_fill(col = \"#ffb347\", alpha = 0.6) +\n    tmap::tm_layout(\n      title = \"5 m Cycling Corridor Buffer in Tampines West\",\n      legend.show = FALSE,\n      frame = FALSE\n    )\n} else {\n  message(\"Skipping map because no buffered cycling segments were found in the selected subzone.\")\n}\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(old_tmap_mode)\n\n\n\n\nCode\n# Count pre-schools per subzone\nmessage(\"\\n=== Preschool Counts by Subzone ===\")\n\n\n\n=== Preschool Counts by Subzone ===\n\n\nCode\nsubzone_preschool &lt;- mpsz_clean %&gt;%\n  dplyr::mutate(\n    subzone_area_sqkm = as.numeric(units::set_units(sf::st_area(.), \"km^2\")),\n    preschool_count   = lengths(sf::st_intersects(., preschools_clean)),\n    preschool_density = preschool_count / subzone_area_sqkm\n  )\n\nsubzone_summary &lt;- subzone_preschool %&gt;%\n  sf::st_drop_geometry() %&gt;%\n  dplyr::transmute(\n    subzone_n,\n    planning_area      = pln_area_n,\n    subzone_area_sqkm,\n    preschool_count,\n    preschool_density\n  )\n\nprint(head(subzone_summary, 5))\n\n\n       subzone_n   planning_area subzone_area_sqkm preschool_count\n1   MARINA SOUTH    MARINA SOUTH         1.6303793               0\n2   PEARL'S HILL          OUTRAM         0.5598162               6\n3      BOAT QUAY SINGAPORE RIVER         0.1608075               0\n4 HENDERSON HILL     BUKIT MERAH         0.5954289               5\n5        REDHILL     BUKIT MERAH         0.3874294               3\n  preschool_density\n1          0.000000\n2         10.717803\n3          0.000000\n4          8.397308\n5          7.743345\n\n\nCode\nmessage(\"\\nSummary of preschool density (counts per sq km):\")\n\n\n\nSummary of preschool density (counts per sq km):\n\n\nCode\nprint(summary(subzone_summary$preschool_density))\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   5.154   6.449  10.908  35.602 \n\n\nCode\ntop_subzone &lt;- subzone_summary %&gt;%\n  dplyr::arrange(dplyr::desc(preschool_count)) %&gt;%\n  dplyr::slice_head(n = 1)\n\nmessage(\"\\nSubzone with the highest preschool count:\")\n\n\n\nSubzone with the highest preschool count:\n\n\nCode\nprint(top_subzone)\n\n\n      subzone_n planning_area subzone_area_sqkm preschool_count\n1 TAMPINES EAST      TAMPINES          4.339824              72\n  preschool_density\n1          16.59053\n\n\n\n\nCode\np_hist &lt;- ggplot(subzone_summary, aes(x = preschool_density)) +\n  geom_histogram(fill = \"#74a9cf\", colour = \"white\", bins = 20) +\n  labs(\n    x = \"Preschool Density (count per sq km)\",\n    y = \"Number of Subzones\",\n    title = \"Distribution of Preschool Density across Subzones\"\n  ) +\n  theme_minimal()\np_hist\n\n\n\n\n\n\n\n\n\n\n\nCode\np_scatter &lt;- ggplot(subzone_summary, aes(x = preschool_count, y = preschool_density)) +\n  geom_point(alpha = 0.6, colour = \"#2b8cbe\") +\n  labs(\n    x = \"Preschool Count\",\n    y = \"Preschool Density (count per sq km)\",\n    title = \"Preschool Density vs. Count\"\n  ) +\n  theme_minimal()\np_scatter"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#results",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#results",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "Results",
    "text": "Results\n\nData Summary\n\n\nCode\nmessage(\"\\n\", strrep(\"=\", 60), \"\\n\")\n\n\n\n============================================================\n\n\nCode\nmessage(\"DATA PROCESSING SUMMARY\")\n\n\nDATA PROCESSING SUMMARY\n\n\nCode\nmessage(strrep(\"=\", 60), \"\\n\")\n\n\n============================================================\n\n\nCode\n# Subzone Summary\nmessage(\"1. SUBZONE DATA (clean_subzone.gpkg)\")\n\n\n1. SUBZONE DATA (clean_subzone.gpkg)\n\n\nCode\nmessage(\"   - Records: \", nrow(mpsz_clean))\n\n\n   - Records: 323\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(mpsz_clean)$epsg, \" (SVY21)\")\n\n\n   - CRS: EPSG:3414 (SVY21)\n\n\nCode\nmessage(\"   - Geometry types: \", paste(unique(sf::st_geometry_type(mpsz_clean)), collapse=\", \"))\n\n\n   - Geometry types: POLYGON, MULTIPOLYGON\n\n\nCode\nmessage(\"   - Fields: \", paste(names(sf::st_drop_geometry(mpsz_clean)), collapse=\", \"))\n\n\n   - Fields: subzone_n, pln_area_n\n\n\nCode\n# Cycling Path Summary\nmessage(\"\\n2. CYCLING PATH DATA (clean_cycling_path.gpkg)\")\n\n\n\n2. CYCLING PATH DATA (clean_cycling_path.gpkg)\n\n\nCode\nmessage(\"   - Records: \", nrow(cycling_clean))\n\n\n   - Records: 4674\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(cycling_clean)$epsg, \" (SVY21)\")\n\n\n   - CRS: EPSG:3414 (SVY21)\n\n\nCode\nmessage(\"   - Geometry types: \", paste(unique(sf::st_geometry_type(cycling_clean)), collapse=\", \"))\n\n\n   - Geometry types: MULTILINESTRING\n\n\nCode\nmessage(\"   - Fields: \", paste(names(sf::st_drop_geometry(cycling_clean)), collapse=\", \"))\n\n\n   - Fields: \n\n\nCode\n# Pre-Schools Summary\nmessage(\"\\n3. PRE-SCHOOLS DATA (clean_preschools_svy21.gpkg)\")\n\n\n\n3. PRE-SCHOOLS DATA (clean_preschools_svy21.gpkg)\n\n\nCode\nmessage(\"   - Records: \", nrow(preschools_clean))\n\n\n   - Records: 2290\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(preschools_clean)$epsg, \" (SVY21)\")\n\n\n   - CRS: EPSG:3414 (SVY21)\n\n\nCode\nmessage(\"   - Geometry types: \", paste(unique(sf::st_geometry_type(preschools_clean)), collapse=\", \"))\n\n\n   - Geometry types: POINT\n\n\nCode\nmessage(\"   - Fields: \", paste(names(sf::st_drop_geometry(preschools_clean)), collapse=\", \"))\n\n\n   - Fields: name\n\n\nCode\n# Listings Summary\nmessage(\"\\n4. LISTINGS DATA (listings.csv - read only)\")\n\n\n\n4. LISTINGS DATA (listings.csv - read only)\n\n\nCode\nmessage(\"   - Records: \", nrow(listings))\n\n\n   - Records: 3659\n\n\nCode\nmessage(\"   - Latitude range: [\", round(min(listings$latitude), 4), \", \",\n        round(max(listings$latitude), 4), \"]\")\n\n\n   - Latitude range: [1.2227, 1.4578]\n\n\nCode\nmessage(\"   - Longitude range: [\", round(min(listings$longitude), 4), \", \",\n        round(max(listings$longitude), 4), \"]\")\n\n\n   - Longitude range: [103.6346, 103.9896]\n\n\nCode\nmessage(\"\\n5. LISTINGS DATA (listings_sf - transformed)\")\n\n\n\n5. LISTINGS DATA (listings_sf - transformed)\n\n\nCode\nmessage(\"   - Records: \", nrow(listings_sf))\n\n\n   - Records: 3659\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(listings_sf)$epsg)\n\n\n   - CRS: EPSG:3414\n\n\nCode\nmessage(\"   - Geometry type: \", unique(sf::st_geometry_type(listings_sf)))\n\n\n   - Geometry type: POINT\n\n\nCode\nmessage(\"\\n\", strrep(\"=\", 60))\n\n\n\n============================================================\n\n\nCode\nmessage(\"✓ All data processing completed successfully!\")\n\n\n✓ All data processing completed successfully!\n\n\nCode\nmessage(strrep(\"=\", 60))\n\n\n============================================================\n\n\n\n\nSample Data Preview\n\n\nCode\n# Preview first 3 records without geometry\nmessage(\"\\nSample records from cleaned datasets:\")\n\nmessage(\"\\nSubzone (first 3 records):\")\nprint(head(sf::st_drop_geometry(mpsz_clean), 3))\n\n\n     subzone_n      pln_area_n\n1 MARINA SOUTH    MARINA SOUTH\n2 PEARL'S HILL          OUTRAM\n3    BOAT QUAY SINGAPORE RIVER\n\n\nCode\nmessage(\"\\nCycling Path (first 3 records):\")\nprint(head(sf::st_drop_geometry(cycling_clean), 3))\n\n\ndata frame with 0 columns and 3 rows\n\n\nCode\nmessage(\"\\nPre-Schools (first 3 records):\")\nprint(head(sf::st_drop_geometry(preschools_clean), 3))\n\n\n   name\n1 kml_1\n2 kml_2\n3 kml_3"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "",
    "text": "This exercise follows the Chapter 4 workflow from the course notes. We will:\n\nImport the 2019 Master Plan subzone polygons and the Early Childhood Development Agency (ECDA) child care point locations.\nClean and standardize the data, ensuring all geometries use the SVY21 / EPSG:3414 projection.\nCompute analytical summaries, including the number of centres and (when available) registered capacity by subzone and planning area.\nCreate exploratory maps (point overlay) and thematic choropleths that illustrate spatial patterns in the provision of child care services.\n\nThe original data files should be placed at:\n\nHands-on_Ex/Hands-on_ex02/data/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\nHands-on_Ex/Hands-on_ex02/data/ChildCareServices.geojson"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#overview",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "",
    "text": "This exercise follows the Chapter 4 workflow from the course notes. We will:\n\nImport the 2019 Master Plan subzone polygons and the Early Childhood Development Agency (ECDA) child care point locations.\nClean and standardize the data, ensuring all geometries use the SVY21 / EPSG:3414 projection.\nCompute analytical summaries, including the number of centres and (when available) registered capacity by subzone and planning area.\nCreate exploratory maps (point overlay) and thematic choropleths that illustrate spatial patterns in the provision of child care services.\n\nThe original data files should be placed at:\n\nHands-on_Ex/Hands-on_ex02/data/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\nHands-on_Ex/Hands-on_ex02/data/ChildCareServices.geojson"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#setup-and-environment",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#setup-and-environment",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Setup and Environment",
    "text": "Setup and Environment\n\n\nCode\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\npacman::p_load(\n  sf, tidyverse, janitor, stringr, rvest,\n  here, tmap, units, readr, sessioninfo)\n\ntmap_mode(\"plot\")\n\nroot_dir &lt;- here::here()\nexo_dir &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\")\nexo_data &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"data\")\nexo_fig &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"figures\")\n\nif (!dir.exists(exo_fig)) dir.create(exo_fig, recursive = TRUE, showWarnings = FALSE)\n\nmessage(\"Project root: \", root_dir)\nmessage(\"Exercise directory: \", exo_dir)\nmessage(\"Data directory: \", exo_data)\nmessage(\"Figures directory: \", exo_fig)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#import-and-inspect-spatial-data",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#import-and-inspect-spatial-data",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Import and Inspect Spatial Data",
    "text": "Import and Inspect Spatial Data\n\nMaster Plan Subzones (Polygon)\n\n\nCode\nmessage(\"\\n=== Loading Master Plan 2019 subzones ===\")\nsubzone_path &lt;- file.path(exo_data, \"MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\")\n\nif (!file.exists(subzone_path)) {\n  stop(\"Subzone boundary GeoJSON not found at: \", subzone_path,\n       \"\\nDownload it from data.gov.sg and place it in the data directory before knitting.\")\n}\n\nmpsz_2019 &lt;- st_read(subzone_path, quiet = FALSE)\n\n\nReading layer `MasterPlan2019SubzoneBoundaryNoSeaGEOJSON' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex02\\data\\MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nCode\nif (is.na(st_crs(mpsz_2019))) {\n  stop(\"Master Plan subzones are missing CRS information. Please check the source file.\")\n}\n\nif (st_crs(mpsz_2019)$epsg != 3414) {\n  message(\"Transforming subzones to EPSG:3414 (SVY21).\")\n  mpsz_2019 &lt;- st_transform(mpsz_2019, 3414)\n}\n\n# Make geometries valid using sf package\nmpsz_2019 &lt;- st_make_valid(mpsz_2019)\n\nmessage(\"Records loaded: \", nrow(mpsz_2019))\nmessage(\"Geometry type(s): \", paste(unique(st_geometry_type(mpsz_2019)), collapse = \", \"))\nmessage(\"Subzone attributes: \", paste(head(names(mpsz_2019), 10), collapse = \", \"))\n\n\n\n\nExtract fields from HTML Description\n\n\nCode\n# Function to extract KML fields from HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    map_chr(~ html_text2(html_element(.x, \"td\")))\n  \n  if (length(value) == 0) NA_character_ else value[1]\n}\n\n# Extract SUBZONE_N and PLN_AREA_N from Description field\nmpsz_2019 &lt;- mpsz_2019 %&gt;%\n  mutate(\n    subzone_name = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    planning_area = map_chr(Description, extract_kml_field, \"PLN_AREA_N\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\n# Clean the extracted data\nmpsz_2019 &lt;- mpsz_2019 %&gt;%\n  mutate(\n    subzone_name = str_squish(as.character(subzone_name)),\n    planning_area = str_squish(as.character(planning_area))\n  )\n\n# Display sample data\nsubzone_glimpse &lt;- mpsz_2019 %&gt;%\n  st_drop_geometry() %&gt;%\n  select(subzone_name, planning_area) %&gt;%\n  distinct() %&gt;%\n  head(10)\n\nprint(subzone_glimpse)\n\n\n          subzone_name planning_area\n1           DEPOT ROAD   BUKIT MERAH\n2          BUKIT MERAH   BUKIT MERAH\n3            CHINATOWN        OUTRAM\n4              PHILLIP DOWNTOWN CORE\n5        RAFFLES PLACE DOWNTOWN CORE\n6         CHINA SQUARE        OUTRAM\n7          TIONG BAHRU   BUKIT MERAH\n8     BAYFRONT SUBZONE DOWNTOWN CORE\n9  TIONG BAHRU STATION   BUKIT MERAH\n10       CLIFFORD PIER DOWNTOWN CORE\n\n\n\n\nChild Care Services (Point)\n\n\nCode\nmessage(\"\\n=== Loading ECDA child care locations ===\")\nchildcare_path &lt;- file.path(exo_data, \"ChildCareServices.geojson\")\n\nif (!file.exists(childcare_path)) {\n  stop(\"Child care services GeoJSON not found at: \", childcare_path,\n       \"\\nDownload the ECDA dataset and place it in the data directory before knitting.\")\n}\n\nchildcare_raw &lt;- st_read(childcare_path, quiet = FALSE) %&gt;%\n  janitor::clean_names()\n\n\nReading layer `ChildCareServices' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex02\\data\\ChildCareServices.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 1925 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\nif (is.na(st_crs(childcare_raw))) {\n  stop(\"Child care services data is missing CRS information. Please check the source file.\")\n}\n\nif (st_crs(childcare_raw)$epsg != 3414) {\n  message(\"Transforming child care locations to EPSG:3414 (SVY21).\")\n  childcare_sf &lt;- st_transform(childcare_raw, 3414)\n} else {\n  childcare_sf &lt;- childcare_raw\n}\n\n# Check if Description field contains HTML\n# Check if Description field contains HTML\nif (grepl(\"&lt;\", childcare_sf$description[1], fixed = TRUE)) {\n  # Extract centre name from HTML if present\n  childcare_sf &lt;- childcare_sf %&gt;%\n    mutate(\n      centre_name = map2_chr(description, name, function(desc, nm) {\n        if (is.na(desc) || desc == \"\") return(nm)\n        # Try to extract centre name from HTML\n        result &lt;- tryCatch({\n          extract_kml_field(desc, \"CENTRE_NAME\")\n        }, error = function(e) {\n          NA_character_\n        })\n        # If extraction fails, use name field\n        if (is.na(result)) return(nm) else return(result)\n      })\n    )\n} else {\n  # Use name field directly\n  childcare_sf &lt;- childcare_sf %&gt;%\n    mutate(centre_name = name)\n}\n\nchildcare_sf &lt;- childcare_sf %&gt;%\n  mutate(across(where(is.character), ~ str_squish(.x)))\n\nmessage(\"Records loaded: \", nrow(childcare_sf))\nmessage(\"Geometry type(s): \", paste(unique(st_geometry_type(childcare_sf)), collapse = \", \"))\nmessage(\"Child care attributes (first 10): \", paste(head(names(childcare_sf), 10), collapse = \", \"))\n\n# Display sample data\nchildcare_sf %&gt;%\n  st_drop_geometry() %&gt;%\n  select(any_of(c(\"centre_name\", \"name\"))) %&gt;%\n  head(5)\n\n\n  centre_name  name\n1       kml_1 kml_1\n2       kml_2 kml_2\n3       kml_3 kml_3\n4       kml_4 kml_4\n5       kml_5 kml_5"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#spatial-join-and-aggregation",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#spatial-join-and-aggregation",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Spatial Join and Aggregation",
    "text": "Spatial Join and Aggregation\n\nPrepare Helper Columns\n\n\nCode\n# No capacity column in this dataset, so we'll only count centres\ncapacity_col &lt;- NA_character_\nmessage(\"No capacity column detected; analyses will use only centre counts.\")\n\n# Prepare childcare data\nchildcare_ready &lt;- childcare_sf %&gt;%\n  mutate(\n    centre_name = coalesce(centre_name, name, \"(Unnamed centre)\"),\n    capacity = NA_real_  # No capacity data available\n  )\n\n\n\n\nSpatial Join (Points-in-Polygons)\n\n\nCode\nmessage(\"\\n=== Computing child care counts per subzone ===\")\nchildcare_joined &lt;- st_join(childcare_ready, mpsz_2019 %&gt;% select(subzone_name, planning_area),\n                            join = st_within, left = FALSE)\n\nchildcare_counts &lt;- childcare_joined %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(planning_area, subzone_name) %&gt;%\n  summarise(\n    centres = n(),\n    capacity_total = NA_real_,  # No capacity data\n    .groups = \"drop\"\n  )\n\nhas_capacity_information &lt;- FALSE\n\nprint(childcare_counts %&gt;% head(10))\n\n\n# A tibble: 10 × 4\n   planning_area subzone_name           centres capacity_total\n   &lt;chr&gt;         &lt;chr&gt;                    &lt;int&gt;          &lt;dbl&gt;\n 1 ANG MO KIO    ANG MO KIO TOWN CENTRE       3             NA\n 2 ANG MO KIO    CHENG SAN                   10             NA\n 3 ANG MO KIO    CHONG BOON                   7             NA\n 4 ANG MO KIO    KEBUN BAHRU                  8             NA\n 5 ANG MO KIO    SEMBAWANG HILLS              3             NA\n 6 ANG MO KIO    SHANGRI-LA                   7             NA\n 7 ANG MO KIO    TAGORE                       7             NA\n 8 ANG MO KIO    TOWNSVILLE                   9             NA\n 9 ANG MO KIO    YIO CHU KANG                 7             NA\n10 ANG MO KIO    YIO CHU KANG EAST            5             NA\n\n\n\n\nSubzone Summary\n\n\nCode\nsubzone_summary &lt;- mpsz_2019 %&gt;%\n  left_join(childcare_counts, by = c(\"planning_area\", \"subzone_name\")) %&gt;%\n  mutate(\n    centres = replace_na(centres, 0L),\n    capacity_total = NA_real_,  # No capacity data\n    area_sqm = st_area(geometry),\n    area_km2 = units::set_units(area_sqm, km^2) %&gt;% units::drop_units(),\n    centres_per_km2 = if_else(area_km2 &gt; 0, centres / area_km2, NA_real_),\n    capacity_per_km2 = NA_real_  # No capacity data\n  )\n\nsubzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  arrange(desc(centres)) %&gt;%\n  select(planning_area, subzone_name, centres, centres_per_km2) %&gt;%\n  head(10)\n\n\n   planning_area         subzone_name centres centres_per_km2\n1       TAMPINES        TAMPINES EAST      58       13.352509\n2      WOODLANDS       WOODLANDS EAST      49       19.189621\n3          BEDOK          BEDOK NORTH      32        9.988565\n4        GEYLANG             ALJUNIED      32       10.805459\n5       TAMPINES        TAMPINES WEST      30        8.632466\n6       SENGKANG SENGKANG TOWN CENTRE      30       20.540426\n7          BEDOK              FRANKEL      28        6.515961\n8    JURONG WEST               YUNNAN      27       12.237655\n9    JURONG WEST             HONG KAH      25       13.939508\n10      SENGKANG            RIVERVALE      24       15.296028\n\n\n\n\nPlanning Area Aggregation\n\n\nCode\nplanning_summary &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(planning_area) %&gt;%\n  summarise(\n    centres = sum(centres, na.rm = TRUE),\n    capacity_total = NA_real_,  # No capacity data\n    area_km2 = sum(area_km2, na.rm = TRUE),\n    centres_per_km2 = if_else(area_km2 &gt; 0, centres / area_km2, NA_real_),\n    capacity_per_km2 = NA_real_,  # No capacity data\n    .groups = \"drop\"\n  ) %&gt;%\n  arrange(desc(centres))\n\nprint(planning_summary %&gt;% head(10))\n\n\n# A tibble: 10 × 6\n   planning_area centres capacity_total area_km2 centres_per_km2\n   &lt;chr&gt;           &lt;int&gt;          &lt;dbl&gt;    &lt;dbl&gt;           &lt;dbl&gt;\n 1 BEDOK             130             NA    21.7             5.98\n 2 TAMPINES          117             NA    20.8             5.63\n 3 JURONG WEST       110             NA    14.7             7.49\n 4 WOODLANDS         107             NA    13.6             7.86\n 5 HOUGANG            98             NA    13.9             7.03\n 6 SENGKANG           94             NA    10.6             8.87\n 7 YISHUN             87             NA    20.9             4.17\n 8 CHOA CHU KANG      74             NA     6.12           12.1 \n 9 ANG MO KIO         72             NA    13.9             5.16\n10 PUNGGOL            72             NA     9.37            7.68\n# ℹ 1 more variable: capacity_per_km2 &lt;dbl&gt;"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#visual-analytics",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#visual-analytics",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Visual Analytics",
    "text": "Visual Analytics\n\nPoint Overlay Map\n\n\nCode\n# Check tmap version and use appropriate syntax\ntmap_version &lt;- packageVersion(\"tmap\")\n\nif (tmap_version &gt;= \"4.0\") {\n  # tmap v4 syntax\n  childcare_map &lt;- tm_shape(mpsz_2019) +\n    tm_polygons(fill = \"grey95\", col = \"grey70\", lwd = 0.3) +\n    tm_shape(childcare_ready) +\n    tm_dots(size = 0.05, fill = \"#0072B2\", fill_alpha = 0.6) +\n    tm_title(\"ECDA-registered Child Care Centres\") +\n    tm_scalebar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.2) +\n    tm_layout(frame = FALSE)\n} else {\n  # tmap v3 syntax\n  childcare_map &lt;- tm_shape(mpsz_2019) +\n    tm_polygons(col = \"grey95\", border.col = \"grey70\", lwd = 0.3) +\n    tm_shape(childcare_ready) +\n    tm_dots(size = 0.05, col = \"#0072B2\", alpha = 0.6,\n            title = \"Child care centres\") +\n    tm_layout(\n      title = \"ECDA-registered Child Care Centres\",\n      frame = FALSE,\n      legend.outside = TRUE,\n      outer.margins = 0.02,\n      main.title.position = \"center\"\n    ) +\n    tm_scale_bar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.2)\n}\n\nprint(childcare_map)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(childcare_map,\n          filename = file.path(exo_fig, \"ex02a_childcare_points.png\"),\n          width = 8, height = 6, units = \"in\", dpi = 300)\n\n\n\n\nChoropleth: Centres per Subzone\n\n\nCode\nif (tmap_version &gt;= \"4.0\") {\n  # tmap v4 syntax\n  centres_map &lt;- tm_shape(subzone_summary) +\n    tm_polygons(\n      fill = \"centres\",\n      fill.scale = tm_scale_intervals(\n        style = \"quantile\",\n        n = 5,\n        values = \"brewer.reds\"\n      ),\n      fill.legend = tm_legend(title = \"Centres\"),\n      col = \"grey60\",\n      lwd = 0.3\n    ) +\n    tm_title(\"Number of Child Care Centres by Subzone\") +\n    tm_scalebar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.1) +\n    tm_layout(frame = FALSE)\n} else {\n  # tmap v3 syntax\n  centres_map &lt;- tm_shape(subzone_summary) +\n    tm_polygons(\n      col = \"centres\",\n      palette = \"Reds\",\n      style = \"quantile\",\n      n = 5,\n      border.col = \"grey60\",\n      lwd = 0.3,\n      title = \"Centres\"\n    ) +\n    tm_layout(\n      title = \"Number of Child Care Centres by Subzone\",\n      frame = FALSE,\n      legend.outside = TRUE,\n      main.title.position = \"center\"\n    ) +\n    tm_scale_bar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.1)\n}\n\nprint(centres_map)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(centres_map,\n          filename = file.path(exo_fig, \"ex02a_childcare_centres.png\"),\n          width = 8, height = 6, units = \"in\", dpi = 300)\n\n\n\n\nChoropleth: Density of Centres\n\n\nCode\nif (!all(is.na(subzone_summary$centres_per_km2))) {\n  if (tmap_version &gt;= \"4.0\") {\n    # tmap v4 syntax\n    density_map &lt;- tm_shape(subzone_summary) +\n      tm_polygons(\n        fill = \"centres_per_km2\",\n        fill.scale = tm_scale_intervals(\n          style = \"jenks\",\n          n = 5,\n          values = \"brewer.blues\"\n        ),\n        fill.legend = tm_legend(title = \"Centres per km²\"),\n        col = \"grey60\",\n        lwd = 0.3\n      ) +\n      tm_title(\"Density of Child Care Centres by Subzone\") +\n      tm_scalebar(position = c(\"left\", \"bottom\")) +\n      tm_compass(position = c(\"right\", \"top\"), size = 1.1) +\n      tm_layout(frame = FALSE)\n  } else {\n    # tmap v3 syntax\n    density_map &lt;- tm_shape(subzone_summary) +\n      tm_polygons(\n        col = \"centres_per_km2\",\n        palette = \"Blues\",\n        style = \"jenks\",\n        n = 5,\n        border.col = \"grey60\",\n        lwd = 0.3,\n        title = \"Centres per km²\"\n      ) +\n      tm_layout(\n        title = \"Density of Child Care Centres by Subzone\",\n        frame = FALSE,\n        legend.outside = TRUE,\n        main.title.position = \"center\"\n      ) +\n      tm_scale_bar(position = c(\"left\", \"bottom\")) +\n      tm_compass(position = c(\"right\", \"top\"), size = 1.1)\n  }\n  \n  print(density_map)\n  \n  tmap_save(density_map,\n            filename = file.path(exo_fig, \"ex02a_childcare_density.png\"),\n            width = 8, height = 6, units = \"in\", dpi = 300)\n} else {\n  message(\"Centres per km² could not be computed (missing area information).\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#descriptive-summaries",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#descriptive-summaries",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Descriptive Summaries",
    "text": "Descriptive Summaries\n\nOverall Statistics\n\n\nCode\nsummary_stats &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  summarise(\n    total_centres = sum(centres, na.rm = TRUE),\n    mean_centres = mean(centres, na.rm = TRUE),\n    median_centres = median(centres, na.rm = TRUE),\n    max_centres = max(centres, na.rm = TRUE),\n    min_centres = min(centres, na.rm = TRUE),\n    sd_centres = sd(centres, na.rm = TRUE)\n  )\n\nprint(summary_stats)\n\n\n  total_centres mean_centres median_centres max_centres min_centres sd_centres\n1          1925     5.798193              3          58           0   7.642993\n\n\n\n\nTop Subzones by Centre Count\n\n\nCode\ntop_subzones &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  arrange(desc(centres)) %&gt;%\n  select(planning_area, subzone_name, centres, centres_per_km2) %&gt;%\n  head(10)\n\nprint(top_subzones)\n\n\n   planning_area         subzone_name centres centres_per_km2\n1       TAMPINES        TAMPINES EAST      58       13.352509\n2      WOODLANDS       WOODLANDS EAST      49       19.189621\n3          BEDOK          BEDOK NORTH      32        9.988565\n4        GEYLANG             ALJUNIED      32       10.805459\n5       TAMPINES        TAMPINES WEST      30        8.632466\n6       SENGKANG SENGKANG TOWN CENTRE      30       20.540426\n7          BEDOK              FRANKEL      28        6.515961\n8    JURONG WEST               YUNNAN      27       12.237655\n9    JURONG WEST             HONG KAH      25       13.939508\n10      SENGKANG            RIVERVALE      24       15.296028\n\n\n\n\nBottom Subzones by Centre Count\n\n\nCode\nbottom_subzones &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  filter(centres == 0) %&gt;%\n  select(planning_area, subzone_name, centres, centres_per_km2) %&gt;%\n  head(10)\n\nprint(paste(\"Number of subzones with no childcare centres:\", \n            sum(subzone_summary$centres == 0, na.rm = TRUE)))\n\n\n[1] \"Number of subzones with no childcare centres: 101\"\n\n\nCode\nprint(bottom_subzones)\n\n\n     planning_area            subzone_name centres centres_per_km2\n1           OUTRAM            CHINA SQUARE       0               0\n2    DOWNTOWN CORE        BAYFRONT SUBZONE       0               0\n3     MARINA SOUTH            MARINA SOUTH       0               0\n4    DOWNTOWN CORE                  NICOLL       0               0\n5      MARINA EAST             MARINA EAST       0               0\n6  WESTERN ISLANDS JURONG ISLAND AND BUKOM       0               0\n7           MUSEUM            FORT CANNING       0               0\n8  SINGAPORE RIVER               BOAT QUAY       0               0\n9    MARINE PARADE        MARINA EAST (MP)       0               0\n10 WESTERN ISLANDS                  SUDONG       0               0\n\n\n\n\nTop Planning Areas\n\n\nCode\ntop_planning &lt;- planning_summary %&gt;%\n  arrange(desc(centres)) %&gt;%\n  select(planning_area, centres, area_km2, centres_per_km2) %&gt;%\n  head(10)\n\nprint(top_planning)\n\n\n# A tibble: 10 × 4\n   planning_area centres area_km2 centres_per_km2\n   &lt;chr&gt;           &lt;int&gt;    &lt;dbl&gt;           &lt;dbl&gt;\n 1 BEDOK             130    21.7             5.98\n 2 TAMPINES          117    20.8             5.63\n 3 JURONG WEST       110    14.7             7.49\n 4 WOODLANDS         107    13.6             7.86\n 5 HOUGANG            98    13.9             7.03\n 6 SENGKANG           94    10.6             8.87\n 7 YISHUN             87    20.9             4.17\n 8 CHOA CHU KANG      74     6.12           12.1 \n 9 ANG MO KIO         72    13.9             5.16\n10 PUNGGOL            72     9.37            7.68"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#session-information",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#session-information",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Session Information",
    "text": "Session Information\n\n\nCode\nsessioninfo::session_info()\n\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.0 (2025-04-11 ucrt)\n os       Windows 11 x64 (build 26100)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  Chinese (Simplified)_Hong Kong SAR.utf8\n ctype    Chinese (Simplified)_Hong Kong SAR.utf8\n tz       Asia/Shanghai\n date     2025-10-18\n pandoc   3.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n quarto   NA @ C:\\\\PROGRA~1\\\\Quarto\\\\bin\\\\quarto.exe\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version   date (UTC) lib source\n abind            1.4-8     2024-09-12 [1] CRAN (R 4.5.0)\n base64enc        0.1-3     2015-07-28 [1] CRAN (R 4.5.0)\n chromote         0.5.1     2025-04-24 [1] CRAN (R 4.5.0)\n class            7.3-23    2025-01-01 [1] CRAN (R 4.5.0)\n classInt         0.4-11    2025-01-08 [1] CRAN (R 4.5.0)\n cli              3.6.5     2025-04-23 [1] CRAN (R 4.5.0)\n codetools        0.2-20    2024-03-31 [1] CRAN (R 4.5.0)\n colorspace       2.1-1     2024-07-26 [1] CRAN (R 4.5.0)\n cols4all         0.9       2025-08-28 [1] CRAN (R 4.5.1)\n crosstalk        1.2.1     2023-11-23 [1] CRAN (R 4.5.0)\n data.table       1.17.0    2025-02-22 [1] CRAN (R 4.5.0)\n DBI              1.2.3     2024-06-02 [1] CRAN (R 4.5.0)\n dichromat        2.0-0.1   2022-05-02 [1] CRAN (R 4.5.0)\n digest           0.6.37    2024-08-19 [1] CRAN (R 4.5.0)\n dplyr          * 1.1.4     2023-11-17 [1] CRAN (R 4.5.0)\n e1071            1.7-16    2024-09-16 [1] CRAN (R 4.5.0)\n evaluate         1.0.3     2025-01-10 [1] CRAN (R 4.5.0)\n farver           2.1.2     2024-05-13 [1] CRAN (R 4.5.0)\n fastmap          1.2.0     2024-05-15 [1] CRAN (R 4.5.0)\n forcats        * 1.0.0     2023-01-29 [1] CRAN (R 4.5.0)\n generics         0.1.3     2022-07-05 [1] CRAN (R 4.5.0)\n ggplot2        * 3.5.2     2025-04-09 [1] CRAN (R 4.5.0)\n glue             1.8.0     2024-09-30 [1] CRAN (R 4.5.0)\n gtable           0.3.6     2024-10-25 [1] CRAN (R 4.5.0)\n here           * 1.0.2     2025-09-15 [1] CRAN (R 4.5.1)\n hms              1.1.3     2023-03-21 [1] CRAN (R 4.5.0)\n htmltools        0.5.8.1   2024-04-04 [1] CRAN (R 4.5.0)\n htmlwidgets      1.6.4     2023-12-06 [1] CRAN (R 4.5.0)\n httr             1.4.7     2023-08-15 [1] CRAN (R 4.5.0)\n janitor        * 2.2.1     2024-12-22 [1] CRAN (R 4.5.1)\n jsonlite         2.0.0     2025-03-27 [1] CRAN (R 4.5.0)\n KernSmooth       2.23-26   2025-01-01 [1] CRAN (R 4.5.0)\n knitr            1.50      2025-03-16 [1] CRAN (R 4.5.0)\n later            1.4.2     2025-04-08 [1] CRAN (R 4.5.0)\n lattice          0.22-6    2024-03-20 [1] CRAN (R 4.5.0)\n leafem           0.2.5     2025-08-28 [1] CRAN (R 4.5.1)\n leaflegend       1.2.1     2024-05-09 [1] CRAN (R 4.5.1)\n leaflet          2.2.3     2025-09-04 [1] CRAN (R 4.5.1)\n leafsync         0.1.0     2019-03-05 [1] CRAN (R 4.5.1)\n lifecycle        1.0.4     2023-11-07 [1] CRAN (R 4.5.0)\n logger           0.4.0     2024-10-22 [1] CRAN (R 4.5.0)\n lubridate      * 1.9.4     2024-12-08 [1] CRAN (R 4.5.0)\n lwgeom           0.2-14    2024-02-21 [1] CRAN (R 4.5.1)\n magrittr         2.0.3     2022-03-30 [1] CRAN (R 4.5.0)\n maptiles         0.10.0    2025-05-07 [1] CRAN (R 4.5.1)\n microbenchmark   1.5.0     2024-09-04 [1] CRAN (R 4.5.0)\n pacman           0.5.1     2019-03-11 [1] CRAN (R 4.5.0)\n pillar           1.10.2    2025-04-05 [1] CRAN (R 4.5.0)\n pkgconfig        2.0.3     2019-09-22 [1] CRAN (R 4.5.0)\n png              0.1-8     2022-11-29 [1] CRAN (R 4.5.0)\n processx         3.8.6     2025-02-21 [1] CRAN (R 4.5.0)\n promises         1.3.2     2024-11-28 [1] CRAN (R 4.5.0)\n proxy            0.4-27    2022-06-09 [1] CRAN (R 4.5.0)\n ps               1.9.1     2025-04-12 [1] CRAN (R 4.5.0)\n purrr          * 1.0.4     2025-02-05 [1] CRAN (R 4.5.0)\n R6               2.6.1     2025-02-15 [1] CRAN (R 4.5.0)\n raster           3.6-32    2025-03-28 [1] CRAN (R 4.5.0)\n RColorBrewer     1.1-3     2022-04-03 [1] CRAN (R 4.5.0)\n Rcpp             1.0.14    2025-01-12 [1] CRAN (R 4.5.0)\n readr          * 2.1.5     2024-01-10 [1] CRAN (R 4.5.0)\n rlang            1.1.6     2025-04-11 [1] CRAN (R 4.5.0)\n rmarkdown        2.29      2024-11-04 [1] CRAN (R 4.5.0)\n rprojroot        2.1.1     2025-08-26 [1] CRAN (R 4.5.1)\n rstudioapi       0.17.1    2024-10-22 [1] CRAN (R 4.5.0)\n rvest          * 1.0.4     2024-02-12 [1] CRAN (R 4.5.0)\n s2               1.1.7     2024-07-17 [1] CRAN (R 4.5.0)\n scales           1.4.0     2025-04-24 [1] CRAN (R 4.5.0)\n selectr          0.4-2     2019-11-20 [1] CRAN (R 4.5.0)\n sessioninfo    * 1.2.3     2025-02-05 [1] CRAN (R 4.5.1)\n sf             * 1.0-21    2025-05-15 [1] CRAN (R 4.5.1)\n snakecase        0.11.1    2023-08-27 [1] CRAN (R 4.5.1)\n sp               2.2-0     2025-02-01 [1] CRAN (R 4.5.0)\n spacesXYZ        1.5-1     2025-02-10 [1] CRAN (R 4.5.0)\n stars            0.6-8     2025-02-01 [1] CRAN (R 4.5.1)\n stringi          1.8.7     2025-03-27 [1] CRAN (R 4.5.0)\n stringr        * 1.5.1     2023-11-14 [1] CRAN (R 4.5.0)\n terra            1.8-60    2025-07-21 [1] CRAN (R 4.5.1)\n tibble         * 3.3.0     2025-06-08 [1] CRAN (R 4.5.0)\n tidyr          * 1.3.1     2024-01-24 [1] CRAN (R 4.5.0)\n tidyselect       1.2.1     2024-03-11 [1] CRAN (R 4.5.0)\n tidyverse      * 2.0.0     2023-02-22 [1] CRAN (R 4.5.0)\n timechange       0.3.0     2024-01-18 [1] CRAN (R 4.5.0)\n tmap           * 4.2       2025-09-10 [1] CRAN (R 4.5.1)\n tmaptools        3.3       2025-07-24 [1] CRAN (R 4.5.1)\n tzdb             0.5.0     2025-03-15 [1] CRAN (R 4.5.0)\n units          * 0.8-7     2025-03-11 [1] CRAN (R 4.5.0)\n utf8             1.2.5     2025-05-01 [1] CRAN (R 4.5.0)\n vctrs            0.6.5     2023-12-01 [1] CRAN (R 4.5.0)\n websocket        1.4.4     2025-04-10 [1] CRAN (R 4.5.0)\n withr            3.0.2     2024-10-28 [1] CRAN (R 4.5.0)\n wk               0.9.4     2024-10-11 [1] CRAN (R 4.5.0)\n xfun             0.52      2025-04-02 [1] CRAN (R 4.5.0)\n XML              3.99-0.18 2025-01-01 [1] CRAN (R 4.5.0)\n xml2             1.3.8     2025-03-14 [1] CRAN (R 4.5.0)\n yaml             2.3.10    2024-07-26 [1] CRAN (R 4.5.0)\n\n [1] C:/dev/R-4.5.0/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "",
    "text": "A spatio-temporal point process is a random collection of points, where each point represents the time and location of an event. In this exercise, we will analyze forest fire events in Kepulauan Bangka Belitung, Indonesia using MODIS sensor data.\n\n\n\nAre the locations of forest fire in Kepulauan Bangka Belitung spatial and spatio-temporally independent?\nIf the answer is NO, where and when do the observed forest fire locations tend to cluster?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#research-questions",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#research-questions",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "",
    "text": "Are the locations of forest fire in Kepulauan Bangka Belitung spatial and spatio-temporally independent?\nIf the answer is NO, where and when do the observed forest fire locations tend to cluster?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-study-area-boundary",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-study-area-boundary",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.1 Importing Study Area Boundary",
    "text": "3.1 Importing Study Area Boundary\nWe’ll use the geodata package to automatically download Indonesian administrative boundaries from GADM.\n\n\nShow code\n# Set data directory\ndata_dir &lt;- here(\"Hands-on_Ex\", \"Hands-on_ex03\", \"data\")\nif (!dir.exists(data_dir)) dir.create(data_dir, recursive = TRUE)\n\n# Check if boundary file exists, if not, download it\nboundary_file &lt;- file.path(data_dir, \"bangka_belitung_kecamatan.gpkg\")\n\nif (!file.exists(boundary_file)) {\n  # Download Indonesia Level 3 boundaries (Kecamatan/Sub-district)\n  message(\"Downloading Indonesia administrative boundaries...\")\n  idn_lvl3 &lt;- geodata::gadm(\"IDN\", level = 3, path = data_dir)\n  \n  # Convert to sf object\n  idn3_sf &lt;- st_as_sf(idn_lvl3)\n  \n  # Filter for Bangka Belitung (correct name from GADM)\n  bangka_sf &lt;- idn3_sf %&gt;%\n    filter(NAME_1 == \"Bangka Belitung\")\n  \n  # Save as GeoPackage\n  st_write(bangka_sf, boundary_file, delete_dsn = TRUE, quiet = TRUE)\n  message(\"Boundary data saved to: \", boundary_file)\n}\n\n# Read the boundary data - with detailed diagnostics\nkbb_original &lt;- st_read(boundary_file, quiet = TRUE)\n\n# Diagnostic Step 1: Check what was downloaded\nmessage(\"=== DIAGNOSTIC INFO ===\")\nmessage(\"Total polygons downloaded: \", nrow(kbb_original))\nmessage(\"Column names: \", paste(names(kbb_original), collapse = \", \"))\n\n# Check if NAME_1 column exists and what provinces are there\nif (\"NAME_1\" %in% names(kbb_original)) {\n  province_list &lt;- unique(kbb_original$NAME_1)\n  message(\"Provinces found (first 10): \", paste(head(province_list, 10), collapse = \" | \"))\n  \n  # Check for Bangka variations\n  bangka_matches &lt;- grep(\"Bangka|bangka|BANGKA\", province_list, value = TRUE)\n  if (length(bangka_matches) &gt; 0) {\n    message(\"Found Bangka-related entries: \", paste(bangka_matches, collapse = \" | \"))\n  } else {\n    message(\"WARNING: No 'Bangka' found in province names!\")\n    message(\"Searching for 'Belitung'...\")\n    belitung_matches &lt;- grep(\"Belitung|belitung|BELITUNG\", province_list, value = TRUE)\n    message(\"Belitung matches: \", paste(belitung_matches, collapse = \" | \"))\n  }\n}\n\n# Try different name variations\npossible_names &lt;- c(\"Kepulauan Bangka Belitung\", \n                   \"Bangka Belitung\",\n                   \"Bangka-Belitung\",\n                   \"KEPULAUAN BANGKA BELITUNG\")\n\nkbb_sf &lt;- NULL\nfor (name_try in possible_names) {\n  temp_sf &lt;- kbb_original %&gt;%\n    filter(NAME_1 == name_try)\n  \n  if (nrow(temp_sf) &gt; 0) {\n    message(\"SUCCESS: Found data using name: '\", name_try, \"' with \", nrow(temp_sf), \" polygons\")\n    kbb_sf &lt;- temp_sf\n    break\n  }\n}\n\n# If still no data, check the structure\nif (is.null(kbb_sf) || nrow(kbb_sf) == 0) {\n  message(\"\\n=== FALLBACK: Showing sample of data ===\")\n  print(head(kbb_original[, c(\"NAME_0\", \"NAME_1\", \"NAME_2\", \"NAME_3\")], 20))\n  \n  message(\"\\n=== Manual selection needed ===\")\n  message(\"Please check the province names above and modify the filter accordingly.\")\n  \n  # Use all Indonesia data as fallback for now\n  message(\"Using all Indonesia data as fallback...\")\n  kbb_sf &lt;- kbb_original\n}\n\n# Transform to UTM Zone 48S\nkbb_sf &lt;- kbb_sf %&gt;%\n  st_transform(crs = 32748) %&gt;%\n  st_make_valid()\n\n# Check if geometries are valid\nmessage(\"\\n=== Geometry Check ===\")\nmessage(\"Valid geometries: \", sum(st_is_valid(kbb_sf)))\nmessage(\"Empty geometries: \", sum(st_is_empty(kbb_sf)))\n\n# Get bounding box\nbbox_check &lt;- st_bbox(kbb_sf)\nmessage(\"Bounding box: \")\nprint(bbox_check)\n\n\n     xmin      ymin      xmax      ymax \n 512010.4 9621858.3  928107.4 9833989.1 \n\n\nShow code\n# Plot only if we have valid geometries\nif (!any(is.na(bbox_check)) && nrow(kbb_sf) &gt; 0) {\n  plot(st_geometry(kbb_sf), \n       col = \"lightblue\",\n       border = \"darkblue\",\n       main = \"Study Area\")\n} else {\n  message(\"WARNING: Cannot plot due to invalid geometries. Continuing with analysis...\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#converting-to-owin-object",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#converting-to-owin-object",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.2 Converting to OWIN Object",
    "text": "3.2 Converting to OWIN Object\n\n\nShow code\n# Convert to owin object for spatstat\nkbb_owin &lt;- as.owin(kbb_sf)\n\n# Check the class\nclass(kbb_owin)\n\n\n[1] \"owin\"\n\n\nShow code\n# Display summary\nsummary(kbb_owin)\n\n\nWindow: polygonal boundary\n270 separate polygons (no holes)\n             vertices        area relative.area\npolygon 1           6 5.15790e+04      3.08e-06\npolygon 2           7 9.35325e+04      5.58e-06\npolygon 3          20 1.26679e+04      7.56e-07\npolygon 4          23 9.26107e+04      5.53e-06\npolygon 5          18 4.98850e+05      2.98e-05\npolygon 6          30 3.37290e+04      2.01e-06\npolygon 7          54 3.25363e+05      1.94e-05\npolygon 8          33 1.30250e+06      7.77e-05\npolygon 9         132 1.16490e+06      6.95e-05\npolygon 10         69 1.91355e+05      1.14e-05\npolygon 11        117 1.51905e+05      9.06e-06\npolygon 12         95 1.14409e+05      6.83e-06\npolygon 13         22 4.54503e+03      2.71e-07\npolygon 14         25 1.18153e+04      7.05e-07\npolygon 15        131 1.52345e+05      9.09e-06\npolygon 16         39 1.07779e+04      6.43e-07\npolygon 17         54 3.46837e+05      2.07e-05\npolygon 18         72 2.15853e+05      1.29e-05\npolygon 19         16 1.85061e+03      1.10e-07\npolygon 20         79 1.05702e+05      6.31e-06\npolygon 21         20 4.26450e+03      2.54e-07\npolygon 22        119 1.64729e+05      9.83e-06\npolygon 23         40 1.16146e+04      6.93e-07\npolygon 24         16 3.52284e+03      2.10e-07\npolygon 25        328 3.08592e+06      1.84e-04\npolygon 26        191 2.36937e+06      1.41e-04\npolygon 27         77 8.82506e+04      5.27e-06\npolygon 28         49 6.13179e+04      3.66e-06\npolygon 29        121 7.64910e+04      4.56e-06\npolygon 30          5 1.73815e+04      1.04e-06\npolygon 31          4 6.39020e+03      3.81e-07\npolygon 32         16 1.18396e+05      7.06e-06\npolygon 33          5 2.11407e+04      1.26e-06\npolygon 34         11 3.52360e+04      2.10e-06\npolygon 35         13 6.20570e+04      3.70e-06\npolygon 36          8 1.23128e+04      7.35e-07\npolygon 37          5 9.16907e+03      5.47e-07\npolygon 38         31 1.54528e+06      9.22e-05\npolygon 39         13 6.02786e+04      3.60e-06\npolygon 40         19 8.71573e+04      5.20e-06\npolygon 41         15 6.16242e+04      3.68e-06\npolygon 42          8 1.56726e+04      9.35e-07\npolygon 43          6 1.35363e+04      8.08e-07\npolygon 44          4 4.29360e+03      2.56e-07\npolygon 45         23 1.77052e+05      1.06e-05\npolygon 46         45 4.35839e+04      2.60e-06\npolygon 47          5 6.83224e+03      4.08e-07\npolygon 48          5 6.68328e+03      3.99e-07\npolygon 49          5 2.25570e+03      1.35e-07\npolygon 50          7 2.61716e+04      1.56e-06\npolygon 51          9 1.20125e+04      7.17e-07\npolygon 52          8 2.24884e+04      1.34e-06\npolygon 53          6 1.21058e+04      7.22e-07\npolygon 54          5 8.79539e+03      5.25e-07\npolygon 55          9 2.28045e+04      1.36e-06\npolygon 56          6 9.20554e+03      5.49e-07\npolygon 57         49 1.00131e+05      5.97e-06\npolygon 58          5 4.47493e+03      2.67e-07\npolygon 59          4 2.88084e+03      1.72e-07\npolygon 60          4 3.66452e+03      2.19e-07\npolygon 61         69 9.92186e+04      5.92e-06\npolygon 62          5 3.03623e+03      1.81e-07\npolygon 63          6 1.05413e+04      6.29e-07\npolygon 64          8 9.42911e+03      5.63e-07\npolygon 65         13 6.94883e+04      4.15e-06\npolygon 66         34 2.01331e+05      1.20e-05\npolygon 67        227 1.23408e+06      7.36e-05\npolygon 68          4 2.59824e+03      1.55e-07\npolygon 69          7 8.47540e+03      5.06e-07\npolygon 70          5 8.12486e+03      4.85e-07\npolygon 71         95 2.08341e+05      1.24e-05\npolygon 72         18 7.79145e+04      4.65e-06\npolygon 73         24 1.59007e+04      9.49e-07\npolygon 74          4 8.81028e+02      5.26e-08\npolygon 75         43 4.25653e+04      2.54e-06\npolygon 76          5 4.41923e+03      2.64e-07\npolygon 77          4 2.43914e+03      1.46e-07\npolygon 78          5 4.71226e+03      2.81e-07\npolygon 79        217 2.22687e+06      1.33e-04\npolygon 80         63 5.45427e+04      3.25e-06\npolygon 81          6 4.61991e+03      2.76e-07\npolygon 82          6 1.47370e+04      8.79e-07\npolygon 83          6 1.35588e+04      8.09e-07\npolygon 84         51 9.00805e+04      5.37e-06\npolygon 85          4 1.55335e+03      9.27e-08\npolygon 86         32 4.34625e+04      2.59e-06\npolygon 87        146 5.46576e+05      3.26e-05\npolygon 88         36 7.39133e+04      4.41e-06\npolygon 89         42 9.17378e+04      5.47e-06\npolygon 90        141 1.10143e+06      6.57e-05\npolygon 91         96 2.55421e+05      1.52e-05\npolygon 92         75 3.74798e+04      2.24e-06\npolygon 93         71 9.11194e+05      5.44e-05\npolygon 94          5 4.25220e+03      2.54e-07\npolygon 95         48 1.10263e+05      6.58e-06\npolygon 96          6 1.00670e+04      6.01e-07\npolygon 97         33 2.35513e+04      1.41e-06\npolygon 98          4 1.39953e+02      8.35e-09\npolygon 99        120 3.80319e+05      2.27e-05\npolygon 100        19 3.13896e+04      1.87e-06\npolygon 101        42 1.21247e+05      7.23e-06\npolygon 102        24 3.83865e+04      2.29e-06\npolygon 103        88 4.57022e+05      2.73e-05\npolygon 104        20 1.78068e+04      1.06e-06\npolygon 105        20 2.39368e+04      1.43e-06\npolygon 106         5 6.64860e+03      3.97e-07\npolygon 107         5 5.41661e+03      3.23e-07\npolygon 108        53 4.54957e+05      2.71e-05\npolygon 109       263 1.76196e+07      1.05e-03\npolygon 110         4 6.76374e+03      4.04e-07\npolygon 111        17 5.83732e+03      3.48e-07\npolygon 112        25 2.16843e+05      1.29e-05\npolygon 113         9 3.13706e+03      1.87e-07\npolygon 114        10 1.13374e+04      6.76e-07\npolygon 115        45 1.05289e+05      6.28e-06\npolygon 116         7 4.71437e+03      2.81e-07\npolygon 117       527 4.88599e+07      2.91e-03\npolygon 118       632 1.19875e+08      7.15e-03\npolygon 119        68 3.72752e+06      2.22e-04\npolygon 120        10 1.01946e+05      6.08e-06\npolygon 121        19 8.27040e+04      4.93e-06\npolygon 122        17 4.01684e+04      2.40e-06\npolygon 123        11 4.06518e+04      2.43e-06\npolygon 124       111 1.46837e+06      8.76e-05\npolygon 125       110 3.73961e+06      2.23e-04\npolygon 126        19 1.91715e+04      1.14e-06\npolygon 127        73 3.61882e+06      2.16e-04\npolygon 128        10 3.05396e+04      1.82e-06\npolygon 129         6 1.63086e+04      9.73e-07\npolygon 130        81 2.65410e+05      1.58e-05\npolygon 131         8 2.10497e+04      1.26e-06\npolygon 132         9 2.23051e+04      1.33e-06\npolygon 133        11 1.96429e+04      1.17e-06\npolygon 134       145 7.13724e+06      4.26e-04\npolygon 135        60 1.45303e+05      8.67e-06\npolygon 136        74 2.06450e+06      1.23e-04\npolygon 137        36 2.64395e+04      1.58e-06\npolygon 138       926 2.12401e+08      1.27e-02\npolygon 139        25 2.21142e+05      1.32e-05\npolygon 140         6 6.85335e+03      4.09e-07\npolygon 141        31 1.67739e+06      1.00e-04\npolygon 142         7 8.96845e+03      5.35e-07\npolygon 143        12 6.31109e+04      3.77e-06\npolygon 144       202 2.25183e+07      1.34e-03\npolygon 145        46 2.39836e+06      1.43e-04\npolygon 146        34 1.06861e+04      6.38e-07\npolygon 147         8 4.62274e+04      2.76e-06\npolygon 148         7 3.16257e+04      1.89e-06\npolygon 149         5 6.47214e+03      3.86e-07\npolygon 150        12 2.17322e+04      1.30e-06\npolygon 151         5 7.20136e+03      4.30e-07\npolygon 152       160 1.11856e+06      6.67e-05\npolygon 153       105 3.97161e+05      2.37e-05\npolygon 154        14 3.77546e+05      2.25e-05\npolygon 155        27 1.21328e+06      7.24e-05\npolygon 156       132 7.32320e+05      4.37e-05\npolygon 157        52 6.46488e+04      3.86e-06\npolygon 158        59 5.31644e+06      3.17e-04\npolygon 159        48 1.76605e+06      1.05e-04\npolygon 160        34 5.03181e+04      3.00e-06\npolygon 161        49 1.83632e+04      1.10e-06\npolygon 162        19 5.31559e+03      3.17e-07\npolygon 163       246 3.09440e+06      1.85e-04\npolygon 164        28 1.99191e+05      1.19e-05\npolygon 165        19 4.51980e+05      2.70e-05\npolygon 166        14 5.66638e+04      3.38e-06\npolygon 167        12 1.09882e+05      6.56e-06\npolygon 168        41 4.25466e+04      2.54e-06\npolygon 169       189 1.69035e+06      1.01e-04\npolygon 170       118 2.32814e+05      1.39e-05\npolygon 171         7 2.79374e+04      1.67e-06\npolygon 172        53 1.72586e+06      1.03e-04\npolygon 173        13 6.36463e+04      3.80e-06\npolygon 174       156 1.14531e+06      6.83e-05\npolygon 175        47 9.13932e+05      5.45e-05\npolygon 176        62 3.95152e+06      2.36e-04\npolygon 177       155 7.75116e+05      4.62e-05\npolygon 178        14 4.20349e+04      2.51e-06\npolygon 179        18 5.14007e+03      3.07e-07\npolygon 180        31 7.44696e+05      4.44e-05\npolygon 181        18 4.11037e+05      2.45e-05\npolygon 182        23 7.72702e+03      4.61e-07\npolygon 183         8 3.85828e+04      2.30e-06\npolygon 184       180 7.46362e+06      4.45e-04\npolygon 185        14 2.75557e+05      1.64e-05\npolygon 186         4 9.17061e+03      5.47e-07\npolygon 187         9 9.64342e+03      5.75e-07\npolygon 188         9 6.16694e+04      3.68e-06\npolygon 189        10 1.05264e+05      6.28e-06\npolygon 190         8 8.74118e+04      5.22e-06\npolygon 191         5 1.83999e+04      1.10e-06\npolygon 192         5 3.32417e+03      1.98e-07\npolygon 193        13 3.15953e+04      1.88e-06\npolygon 194        67 3.93589e+05      2.35e-05\npolygon 195         4 2.84280e+03      1.70e-07\npolygon 196        16 4.94144e+03      2.95e-07\npolygon 197         4 1.27360e+03      7.60e-08\npolygon 198         8 1.67265e+04      9.98e-07\npolygon 199        12 2.45940e+04      1.47e-06\npolygon 200        12 5.95411e+04      3.55e-06\npolygon 201        14 2.19831e+03      1.31e-07\npolygon 202        14 4.32480e+03      2.58e-07\npolygon 203        17 7.75234e+03      4.63e-07\npolygon 204        13 1.86854e+03      1.11e-07\npolygon 205        34 3.85424e+06      2.30e-04\npolygon 206         9 3.58530e+03      2.14e-07\npolygon 207        15 1.41276e+04      8.43e-07\npolygon 208        27 1.42520e+04      8.50e-07\npolygon 209        38 2.66059e+04      1.59e-06\npolygon 210        22 4.51365e+03      2.69e-07\npolygon 211        96 5.26123e+05      3.14e-05\npolygon 212        60 1.00574e+05      6.00e-06\npolygon 213        31 7.13409e+04      4.26e-06\npolygon 214        37 1.08935e+06      6.50e-05\npolygon 215       179 8.26972e+05      4.93e-05\npolygon 216        59 1.99001e+05      1.19e-05\npolygon 217        47 2.81875e+05      1.68e-05\npolygon 218       115 3.13327e+05      1.87e-05\npolygon 219       133 4.76117e+05      2.84e-05\npolygon 220        97 1.63408e+07      9.75e-04\npolygon 221        19 6.38976e+03      3.81e-07\npolygon 222        10 7.75421e+03      4.63e-07\npolygon 223       204 1.42141e+06      8.48e-05\npolygon 224       125 2.33616e+06      1.39e-04\npolygon 225        31 2.58857e+04      1.54e-06\npolygon 226        25 2.06725e+04      1.23e-06\npolygon 227        87 1.25180e+06      7.47e-05\npolygon 228        38 4.03858e+04      2.41e-06\npolygon 229        10 5.04629e+04      3.01e-06\npolygon 230         6 1.12888e+04      6.73e-07\npolygon 231        40 1.56849e+05      9.36e-06\npolygon 232        66 5.25038e+04      3.13e-06\npolygon 233         8 1.10747e+04      6.61e-07\npolygon 234        10 1.50784e+03      9.00e-08\npolygon 235        14 4.55332e+03      2.72e-07\npolygon 236        41 4.12940e+04      2.46e-06\npolygon 237         7 3.04017e+03      1.81e-07\npolygon 238        19 7.53923e+03      4.50e-07\npolygon 239        18 8.35187e+03      4.98e-07\npolygon 240        26 5.16261e+05      3.08e-05\npolygon 241        13 9.24908e+04      5.52e-06\npolygon 242        25 4.18653e+04      2.50e-06\npolygon 243         7 3.83476e+03      2.29e-07\npolygon 244        82 4.38420e+05      2.62e-05\npolygon 245       164 3.46334e+06      2.07e-04\npolygon 246        11 5.20050e+03      3.10e-07\npolygon 247        13 3.27494e+04      1.95e-06\npolygon 248         6 3.01213e+04      1.80e-06\npolygon 249        13 2.03114e+05      1.21e-05\npolygon 250        38 2.87869e+04      1.72e-06\npolygon 251        14 4.11781e+03      2.46e-07\npolygon 252        44 1.67050e+05      9.97e-06\npolygon 253        11 6.66399e+04      3.98e-06\npolygon 254       129 2.29310e+06      1.37e-04\npolygon 255        22 6.48307e+03      3.87e-07\npolygon 256       107 1.06884e+06      6.38e-05\npolygon 257         9 2.30080e+04      1.37e-06\npolygon 258        34 9.10976e+03      5.43e-07\npolygon 259        72 1.08609e+05      6.48e-06\npolygon 260        64 2.19815e+05      1.31e-05\npolygon 261        25 2.57976e+05      1.54e-05\npolygon 262        26 4.60002e+04      2.74e-06\npolygon 263        57 8.30086e+04      4.95e-06\npolygon 264        83 1.14012e+06      6.80e-05\npolygon 265        11 3.01000e+04      1.80e-06\npolygon 266        14 1.30459e+05      7.78e-06\npolygon 267        22 2.37055e+05      1.41e-05\npolygon 268        22 1.84821e+05      1.10e-05\npolygon 269      8736 1.15970e+10      6.92e-01\npolygon 270      5944 4.61753e+09      2.75e-01\nenclosing rectangle: [512010.4, 928107.4] x [9621858, 9833989] units\n                     (416100 x 212100 units)\nWindow area = 16761600000 square units\nFraction of frame area: 0.19"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-forest-fire-data",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-forest-fire-data",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.3 Importing Forest Fire Data",
    "text": "3.3 Importing Forest Fire Data\n\n\nShow code\n# Read the MODIS fire data\nfire_data_path &lt;- \"C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex03/data/fire_archive_M-C61_674949.csv\"\n\n# Read the CSV file\nforestfires &lt;- read_csv(fire_data_path, show_col_types = FALSE)\n\n# Display structure and first few rows\nglimpse(forestfires)\n\n\nRows: 4,503\nColumns: 15\n$ latitude   &lt;dbl&gt; -7.6338, -7.6470, -8.3723, 1.0408, -2.5785, -2.5771, -2.582…\n$ longitude  &lt;dbl&gt; 138.7764, 138.7681, 137.9117, 120.8256, 121.3911, 121.3812,…\n$ brightness &lt;dbl&gt; 314.7, 317.9, 316.8, 318.5, 326.7, 345.7, 325.5, 322.9, 313…\n$ scan       &lt;dbl&gt; 3.1, 3.1, 3.5, 1.3, 1.1, 1.1, 1.1, 1.0, 1.1, 1.2, 1.2, 1.2,…\n$ track      &lt;dbl&gt; 1.7, 1.7, 1.8, 1.1, 1.1, 1.1, 1.1, 1.0, 1.1, 1.1, 1.1, 1.1,…\n$ acq_date   &lt;date&gt; 2020-10-01, 2020-10-01, 2020-10-01, 2020-10-01, 2020-10-01…\n$ acq_time   &lt;chr&gt; \"0037\", \"0037\", \"0037\", \"0213\", \"0214\", \"0214\", \"0214\", \"02…\n$ satellite  &lt;chr&gt; \"Terra\", \"Terra\", \"Terra\", \"Terra\", \"Terra\", \"Terra\", \"Terr…\n$ instrument &lt;chr&gt; \"MODIS\", \"MODIS\", \"MODIS\", \"MODIS\", \"MODIS\", \"MODIS\", \"MODI…\n$ confidence &lt;dbl&gt; 28, 65, 0, 58, 80, 93, 51, 60, 35, 32, 62, 26, 0, 70, 72, 8…\n$ version    &lt;dbl&gt; 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03,…\n$ bright_t31 &lt;dbl&gt; 290.6, 291.4, 296.2, 296.4, 294.4, 294.9, 292.8, 296.1, 299…\n$ frp        &lt;dbl&gt; 30.8, 47.1, 55.1, 13.4, 19.7, 54.1, 19.3, 10.9, 8.5, 7.5, 1…\n$ daynight   &lt;chr&gt; \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\",…\n$ type       &lt;dbl&gt; 0, 0, 0, 2, 2, 2, 2, 0, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0,…\n\n\nShow code\nhead(forestfires)\n\n\n# A tibble: 6 × 15\n  latitude longitude brightness  scan track acq_date   acq_time satellite\n     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;    \n1    -7.63      139.       315.   3.1   1.7 2020-10-01 0037     Terra    \n2    -7.65      139.       318.   3.1   1.7 2020-10-01 0037     Terra    \n3    -8.37      138.       317.   3.5   1.8 2020-10-01 0037     Terra    \n4     1.04      121.       318.   1.3   1.1 2020-10-01 0213     Terra    \n5    -2.58      121.       327.   1.1   1.1 2020-10-01 0214     Terra    \n6    -2.58      121.       346.   1.1   1.1 2020-10-01 0214     Terra    \n# ℹ 7 more variables: instrument &lt;chr&gt;, confidence &lt;dbl&gt;, version &lt;dbl&gt;,\n#   bright_t31 &lt;dbl&gt;, frp &lt;dbl&gt;, daynight &lt;chr&gt;, type &lt;dbl&gt;\n\n\nShow code\n# Check date range\nmessage(\"Date range: \", min(forestfires$acq_date), \" to \", max(forestfires$acq_date))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-forest-fire-data",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-forest-fire-data",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.4 Preparing Forest Fire Data",
    "text": "3.4 Preparing Forest Fire Data\n\n\nShow code\n# Convert to sf object and transform to UTM 48S\nfire_sf &lt;- forestfires %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), \n           crs = 4326) %&gt;%\n  st_transform(crs = 32748)\n\n# Convert date to proper format and extract temporal components\nfire_sf &lt;- fire_sf %&gt;%\n  mutate(\n    acq_date = as.Date(acq_date),\n    Month = month(acq_date),\n    DayofYear = yday(acq_date),\n    Year = year(acq_date)\n  )\n\n# Filter to study area (clip to Bangka Belitung boundary)\nfire_sf &lt;- fire_sf[kbb_sf, ]\n\nmessage(\"Total fire points after clipping to study area: \", nrow(fire_sf))\n\n# Check temporal distribution\ntable(fire_sf$Year)\n\n\n\n2020 \n  31"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#overall-distribution",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#overall-distribution",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "4.1 Overall Distribution",
    "text": "4.1 Overall Distribution\n\n\nShow code\n# Create base map with fire points\ntm_shape(kbb_sf) +\n  tm_polygons(col = \"lightgray\", \n              border.col = \"darkgray\") +\n  tm_shape(fire_sf) +\n  tm_dots(col = \"red\", \n          size = 0.02,\n          alpha = 0.6) +\n  tm_layout(main.title = \"Forest Fire Distribution in Kepulauan Bangka Belitung\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_compass(position = c(\"right\", \"top\")) +\n  tm_scale_bar(position = c(\"left\", \"bottom\"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#monthly-distribution",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#monthly-distribution",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "4.2 Monthly Distribution",
    "text": "4.2 Monthly Distribution\n\n\nShow code\n# Create monthly faceted map\ntm_shape(kbb_sf) +\n  tm_polygons(col = \"lightgray\", \n              border.col = \"darkgray\") +\n  tm_shape(fire_sf) +\n  tm_dots(col = \"red\", \n          size = 0.05,\n          alpha = 0.7) +\n  tm_facets(by = \"Month\",\n            ncol = 4,\n            nrow = 3,\n            free.coords = FALSE) +\n  tm_layout(main.title = \"Monthly Forest Fire Distribution\",\n            main.title.size = 1,\n            legend.show = FALSE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-spatstat",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-spatstat",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.1 Preparing Data for spatstat",
    "text": "5.1 Preparing Data for spatstat\n\n\nShow code\n# Extract only needed fields for ppp object\nfire_month &lt;- fire_sf %&gt;%\n  dplyr::select(Month) %&gt;%\n  mutate(Month = as.numeric(Month))\n\n# Create ppp object\nfire_month_ppp &lt;- as.ppp(fire_month)\n\n# Check the object\nsummary(fire_month_ppp)\n\n\nMarked planar point pattern:  31 points\nAverage intensity 6.623857e-10 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  10.00   10.00   10.00   10.19   10.00   12.00 \n\nWindow: rectangle = [545783, 843983.5] x [9648316, 9805259] units\n                    (298200 x 156900 units)\nWindow area = 46800500000 square units\n\n\nShow code\n# Check for duplicates\nany(duplicated(fire_month_ppp))\n\n\n[1] FALSE\n\n\nShow code\n# Handle duplicates if any\nif(any(duplicated(fire_month_ppp))) {\n  fire_month_ppp &lt;- unique(fire_month_ppp)\n  message(\"Duplicated points removed\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#including-owin-object",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#including-owin-object",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.2 Including OWIN Object",
    "text": "5.2 Including OWIN Object\n\n\nShow code\n# Combine ppp with owin\nfire_month_owin &lt;- fire_month_ppp[kbb_owin]\n\n# Display summary\nsummary(fire_month_owin)\n\n\nMarked planar point pattern:  31 points\nAverage intensity 1.849468e-09 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  10.00   10.00   10.00   10.19   10.00   12.00 \n\nWindow: polygonal boundary\n270 separate polygons (no holes)\n             vertices        area relative.area\npolygon 1           6 5.15790e+04      3.08e-06\npolygon 2           7 9.35325e+04      5.58e-06\npolygon 3          20 1.26679e+04      7.56e-07\npolygon 4          23 9.26107e+04      5.53e-06\npolygon 5          18 4.98850e+05      2.98e-05\npolygon 6          30 3.37290e+04      2.01e-06\npolygon 7          54 3.25363e+05      1.94e-05\npolygon 8          33 1.30250e+06      7.77e-05\npolygon 9         132 1.16490e+06      6.95e-05\npolygon 10         69 1.91355e+05      1.14e-05\npolygon 11        117 1.51905e+05      9.06e-06\npolygon 12         95 1.14409e+05      6.83e-06\npolygon 13         22 4.54503e+03      2.71e-07\npolygon 14         25 1.18153e+04      7.05e-07\npolygon 15        131 1.52345e+05      9.09e-06\npolygon 16         39 1.07779e+04      6.43e-07\npolygon 17         54 3.46837e+05      2.07e-05\npolygon 18         72 2.15853e+05      1.29e-05\npolygon 19         16 1.85061e+03      1.10e-07\npolygon 20         79 1.05702e+05      6.31e-06\npolygon 21         20 4.26450e+03      2.54e-07\npolygon 22        119 1.64729e+05      9.83e-06\npolygon 23         40 1.16146e+04      6.93e-07\npolygon 24         16 3.52284e+03      2.10e-07\npolygon 25        328 3.08592e+06      1.84e-04\npolygon 26        191 2.36937e+06      1.41e-04\npolygon 27         77 8.82506e+04      5.27e-06\npolygon 28         49 6.13179e+04      3.66e-06\npolygon 29        121 7.64910e+04      4.56e-06\npolygon 30          5 1.73815e+04      1.04e-06\npolygon 31          4 6.39020e+03      3.81e-07\npolygon 32         16 1.18396e+05      7.06e-06\npolygon 33          5 2.11407e+04      1.26e-06\npolygon 34         11 3.52360e+04      2.10e-06\npolygon 35         13 6.20570e+04      3.70e-06\npolygon 36          8 1.23128e+04      7.35e-07\npolygon 37          5 9.16907e+03      5.47e-07\npolygon 38         31 1.54528e+06      9.22e-05\npolygon 39         13 6.02786e+04      3.60e-06\npolygon 40         19 8.71573e+04      5.20e-06\npolygon 41         15 6.16242e+04      3.68e-06\npolygon 42          8 1.56726e+04      9.35e-07\npolygon 43          6 1.35363e+04      8.08e-07\npolygon 44          4 4.29360e+03      2.56e-07\npolygon 45         23 1.77052e+05      1.06e-05\npolygon 46         45 4.35839e+04      2.60e-06\npolygon 47          5 6.83224e+03      4.08e-07\npolygon 48          5 6.68328e+03      3.99e-07\npolygon 49          5 2.25570e+03      1.35e-07\npolygon 50          7 2.61716e+04      1.56e-06\npolygon 51          9 1.20125e+04      7.17e-07\npolygon 52          8 2.24884e+04      1.34e-06\npolygon 53          6 1.21058e+04      7.22e-07\npolygon 54          5 8.79539e+03      5.25e-07\npolygon 55          9 2.28045e+04      1.36e-06\npolygon 56          6 9.20554e+03      5.49e-07\npolygon 57         49 1.00131e+05      5.97e-06\npolygon 58          5 4.47493e+03      2.67e-07\npolygon 59          4 2.88084e+03      1.72e-07\npolygon 60          4 3.66452e+03      2.19e-07\npolygon 61         69 9.92186e+04      5.92e-06\npolygon 62          5 3.03623e+03      1.81e-07\npolygon 63          6 1.05413e+04      6.29e-07\npolygon 64          8 9.42911e+03      5.63e-07\npolygon 65         13 6.94883e+04      4.15e-06\npolygon 66         34 2.01331e+05      1.20e-05\npolygon 67        227 1.23408e+06      7.36e-05\npolygon 68          4 2.59824e+03      1.55e-07\npolygon 69          7 8.47540e+03      5.06e-07\npolygon 70          5 8.12486e+03      4.85e-07\npolygon 71         95 2.08341e+05      1.24e-05\npolygon 72         18 7.79145e+04      4.65e-06\npolygon 73         24 1.59007e+04      9.49e-07\npolygon 74          4 8.81028e+02      5.26e-08\npolygon 75         43 4.25653e+04      2.54e-06\npolygon 76          5 4.41923e+03      2.64e-07\npolygon 77          4 2.43914e+03      1.46e-07\npolygon 78          5 4.71226e+03      2.81e-07\npolygon 79        217 2.22687e+06      1.33e-04\npolygon 80         63 5.45427e+04      3.25e-06\npolygon 81          6 4.61991e+03      2.76e-07\npolygon 82          6 1.47370e+04      8.79e-07\npolygon 83          6 1.35588e+04      8.09e-07\npolygon 84         51 9.00805e+04      5.37e-06\npolygon 85          4 1.55335e+03      9.27e-08\npolygon 86         32 4.34625e+04      2.59e-06\npolygon 87        146 5.46576e+05      3.26e-05\npolygon 88         36 7.39133e+04      4.41e-06\npolygon 89         42 9.17378e+04      5.47e-06\npolygon 90        141 1.10143e+06      6.57e-05\npolygon 91         96 2.55421e+05      1.52e-05\npolygon 92         75 3.74798e+04      2.24e-06\npolygon 93         71 9.11194e+05      5.44e-05\npolygon 94          5 4.25220e+03      2.54e-07\npolygon 95         48 1.10263e+05      6.58e-06\npolygon 96          6 1.00670e+04      6.01e-07\npolygon 97         33 2.35513e+04      1.41e-06\npolygon 98          4 1.39953e+02      8.35e-09\npolygon 99        120 3.80319e+05      2.27e-05\npolygon 100        19 3.13896e+04      1.87e-06\npolygon 101        42 1.21247e+05      7.23e-06\npolygon 102        24 3.83865e+04      2.29e-06\npolygon 103        88 4.57022e+05      2.73e-05\npolygon 104        20 1.78068e+04      1.06e-06\npolygon 105        20 2.39368e+04      1.43e-06\npolygon 106         5 6.64860e+03      3.97e-07\npolygon 107         5 5.41661e+03      3.23e-07\npolygon 108        53 4.54957e+05      2.71e-05\npolygon 109       263 1.76196e+07      1.05e-03\npolygon 110         4 6.76374e+03      4.04e-07\npolygon 111        17 5.83732e+03      3.48e-07\npolygon 112        25 2.16843e+05      1.29e-05\npolygon 113         9 3.13706e+03      1.87e-07\npolygon 114        10 1.13374e+04      6.76e-07\npolygon 115        45 1.05289e+05      6.28e-06\npolygon 116         7 4.71437e+03      2.81e-07\npolygon 117       527 4.88599e+07      2.91e-03\npolygon 118       632 1.19875e+08      7.15e-03\npolygon 119        68 3.72752e+06      2.22e-04\npolygon 120        10 1.01946e+05      6.08e-06\npolygon 121        19 8.27040e+04      4.93e-06\npolygon 122        17 4.01684e+04      2.40e-06\npolygon 123        11 4.06518e+04      2.43e-06\npolygon 124       111 1.46837e+06      8.76e-05\npolygon 125       110 3.73961e+06      2.23e-04\npolygon 126        19 1.91715e+04      1.14e-06\npolygon 127        73 3.61882e+06      2.16e-04\npolygon 128        10 3.05396e+04      1.82e-06\npolygon 129         6 1.63086e+04      9.73e-07\npolygon 130        81 2.65410e+05      1.58e-05\npolygon 131         8 2.10497e+04      1.26e-06\npolygon 132         9 2.23051e+04      1.33e-06\npolygon 133        11 1.96429e+04      1.17e-06\npolygon 134       145 7.13724e+06      4.26e-04\npolygon 135        60 1.45303e+05      8.67e-06\npolygon 136        74 2.06450e+06      1.23e-04\npolygon 137        36 2.64395e+04      1.58e-06\npolygon 138       926 2.12401e+08      1.27e-02\npolygon 139        25 2.21142e+05      1.32e-05\npolygon 140         6 6.85335e+03      4.09e-07\npolygon 141        31 1.67739e+06      1.00e-04\npolygon 142         7 8.96845e+03      5.35e-07\npolygon 143        12 6.31109e+04      3.77e-06\npolygon 144       202 2.25183e+07      1.34e-03\npolygon 145        46 2.39836e+06      1.43e-04\npolygon 146        34 1.06861e+04      6.38e-07\npolygon 147         8 4.62274e+04      2.76e-06\npolygon 148         7 3.16257e+04      1.89e-06\npolygon 149         5 6.47214e+03      3.86e-07\npolygon 150        12 2.17322e+04      1.30e-06\npolygon 151         5 7.20136e+03      4.30e-07\npolygon 152       160 1.11856e+06      6.67e-05\npolygon 153       105 3.97161e+05      2.37e-05\npolygon 154        14 3.77546e+05      2.25e-05\npolygon 155        27 1.21328e+06      7.24e-05\npolygon 156       132 7.32320e+05      4.37e-05\npolygon 157        52 6.46488e+04      3.86e-06\npolygon 158        59 5.31644e+06      3.17e-04\npolygon 159        48 1.76605e+06      1.05e-04\npolygon 160        34 5.03181e+04      3.00e-06\npolygon 161        49 1.83632e+04      1.10e-06\npolygon 162        19 5.31559e+03      3.17e-07\npolygon 163       246 3.09440e+06      1.85e-04\npolygon 164        28 1.99191e+05      1.19e-05\npolygon 165        19 4.51980e+05      2.70e-05\npolygon 166        14 5.66638e+04      3.38e-06\npolygon 167        12 1.09882e+05      6.56e-06\npolygon 168        41 4.25466e+04      2.54e-06\npolygon 169       189 1.69035e+06      1.01e-04\npolygon 170       118 2.32814e+05      1.39e-05\npolygon 171         7 2.79374e+04      1.67e-06\npolygon 172        53 1.72586e+06      1.03e-04\npolygon 173        13 6.36463e+04      3.80e-06\npolygon 174       156 1.14531e+06      6.83e-05\npolygon 175        47 9.13932e+05      5.45e-05\npolygon 176        62 3.95152e+06      2.36e-04\npolygon 177       155 7.75116e+05      4.62e-05\npolygon 178        14 4.20349e+04      2.51e-06\npolygon 179        18 5.14007e+03      3.07e-07\npolygon 180        31 7.44696e+05      4.44e-05\npolygon 181        18 4.11037e+05      2.45e-05\npolygon 182        23 7.72702e+03      4.61e-07\npolygon 183         8 3.85828e+04      2.30e-06\npolygon 184       180 7.46362e+06      4.45e-04\npolygon 185        14 2.75557e+05      1.64e-05\npolygon 186         4 9.17061e+03      5.47e-07\npolygon 187         9 9.64342e+03      5.75e-07\npolygon 188         9 6.16694e+04      3.68e-06\npolygon 189        10 1.05264e+05      6.28e-06\npolygon 190         8 8.74118e+04      5.22e-06\npolygon 191         5 1.83999e+04      1.10e-06\npolygon 192         5 3.32417e+03      1.98e-07\npolygon 193        13 3.15953e+04      1.88e-06\npolygon 194        67 3.93589e+05      2.35e-05\npolygon 195         4 2.84280e+03      1.70e-07\npolygon 196        16 4.94144e+03      2.95e-07\npolygon 197         4 1.27360e+03      7.60e-08\npolygon 198         8 1.67265e+04      9.98e-07\npolygon 199        12 2.45940e+04      1.47e-06\npolygon 200        12 5.95411e+04      3.55e-06\npolygon 201        14 2.19831e+03      1.31e-07\npolygon 202        14 4.32480e+03      2.58e-07\npolygon 203        17 7.75234e+03      4.63e-07\npolygon 204        13 1.86854e+03      1.11e-07\npolygon 205        34 3.85424e+06      2.30e-04\npolygon 206         9 3.58530e+03      2.14e-07\npolygon 207        15 1.41276e+04      8.43e-07\npolygon 208        27 1.42520e+04      8.50e-07\npolygon 209        38 2.66059e+04      1.59e-06\npolygon 210        22 4.51365e+03      2.69e-07\npolygon 211        96 5.26123e+05      3.14e-05\npolygon 212        60 1.00574e+05      6.00e-06\npolygon 213        31 7.13409e+04      4.26e-06\npolygon 214        37 1.08935e+06      6.50e-05\npolygon 215       179 8.26972e+05      4.93e-05\npolygon 216        59 1.99001e+05      1.19e-05\npolygon 217        47 2.81875e+05      1.68e-05\npolygon 218       115 3.13327e+05      1.87e-05\npolygon 219       133 4.76117e+05      2.84e-05\npolygon 220        97 1.63408e+07      9.75e-04\npolygon 221        19 6.38976e+03      3.81e-07\npolygon 222        10 7.75421e+03      4.63e-07\npolygon 223       204 1.42141e+06      8.48e-05\npolygon 224       125 2.33616e+06      1.39e-04\npolygon 225        31 2.58857e+04      1.54e-06\npolygon 226        25 2.06725e+04      1.23e-06\npolygon 227        87 1.25180e+06      7.47e-05\npolygon 228        38 4.03858e+04      2.41e-06\npolygon 229        10 5.04629e+04      3.01e-06\npolygon 230         6 1.12888e+04      6.73e-07\npolygon 231        40 1.56849e+05      9.36e-06\npolygon 232        66 5.25038e+04      3.13e-06\npolygon 233         8 1.10747e+04      6.61e-07\npolygon 234        10 1.50784e+03      9.00e-08\npolygon 235        14 4.55332e+03      2.72e-07\npolygon 236        41 4.12940e+04      2.46e-06\npolygon 237         7 3.04017e+03      1.81e-07\npolygon 238        19 7.53923e+03      4.50e-07\npolygon 239        18 8.35187e+03      4.98e-07\npolygon 240        26 5.16261e+05      3.08e-05\npolygon 241        13 9.24908e+04      5.52e-06\npolygon 242        25 4.18653e+04      2.50e-06\npolygon 243         7 3.83476e+03      2.29e-07\npolygon 244        82 4.38420e+05      2.62e-05\npolygon 245       164 3.46334e+06      2.07e-04\npolygon 246        11 5.20050e+03      3.10e-07\npolygon 247        13 3.27494e+04      1.95e-06\npolygon 248         6 3.01213e+04      1.80e-06\npolygon 249        13 2.03114e+05      1.21e-05\npolygon 250        38 2.87869e+04      1.72e-06\npolygon 251        14 4.11781e+03      2.46e-07\npolygon 252        44 1.67050e+05      9.97e-06\npolygon 253        11 6.66399e+04      3.98e-06\npolygon 254       129 2.29310e+06      1.37e-04\npolygon 255        22 6.48307e+03      3.87e-07\npolygon 256       107 1.06884e+06      6.38e-05\npolygon 257         9 2.30080e+04      1.37e-06\npolygon 258        34 9.10976e+03      5.43e-07\npolygon 259        72 1.08609e+05      6.48e-06\npolygon 260        64 2.19815e+05      1.31e-05\npolygon 261        25 2.57976e+05      1.54e-05\npolygon 262        26 4.60002e+04      2.74e-06\npolygon 263        57 8.30086e+04      4.95e-06\npolygon 264        83 1.14012e+06      6.80e-05\npolygon 265        11 3.01000e+04      1.80e-06\npolygon 266        14 1.30459e+05      7.78e-06\npolygon 267        22 2.37055e+05      1.41e-05\npolygon 268        22 1.84821e+05      1.10e-05\npolygon 269      8736 1.15970e+10      6.92e-01\npolygon 270      5944 4.61753e+09      2.75e-01\nenclosing rectangle: [512010.4, 928107.4] x [9621858, 9833989] units\n                     (416100 x 212100 units)\nWindow area = 16761600000 square units\nFraction of frame area: 0.19\n\n\nShow code\n# Plot to verify\nplot(fire_month_owin, \n     main = \"Fire Points with Study Area Window\",\n     pch = 20,\n     cex = 0.5)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-spatio-temporal-kde",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-spatio-temporal-kde",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.3 Computing Spatio-temporal KDE",
    "text": "5.3 Computing Spatio-temporal KDE\n\n\nShow code\n# First check how many points we have\nmessage(\"Total fire points: \", nrow(fire_month))\nmessage(\"Points per month:\")\ntable(fire_month$Month)\n\n\n\n10 11 12 \n26  4  1 \n\n\nShow code\n# Check if we have enough data\nif(nrow(fire_month) &lt; 30) {\n  message(\"WARNING: Very few fire points detected. Analysis may not be meaningful.\")\n}\n\n# Compute STKDE with manual bandwidth specification to avoid sparse data error\ntryCatch({\n  # Try automatic bandwidth first\n  fire_month_stkde &lt;- spattemp.density(\n    pp = fire_month_owin,\n    h = NULL,\n    lambda = NULL,\n    verbose = FALSE\n  )\n}, error = function(e) {\n  message(\"Automatic bandwidth failed due to sparse data. Using manual bandwidth...\")\n  \n  # Use manual bandwidth based on spatial extent and temporal range\n  spatial_range &lt;- diff(range(st_coordinates(fire_month)[,1]))\n  temporal_range &lt;- diff(range(fire_month$Month))\n  \n  # Rule of thumb: bandwidth = range / 5\n  h_manual &lt;- spatial_range / 5  # spatial bandwidth\n  lambda_manual &lt;- max(1, temporal_range / 5)  # temporal bandwidth (at least 1)\n  \n  message(\"Using manual bandwidths: h = \", round(h_manual), \", lambda = \", round(lambda_manual, 2))\n  \n  # Compute with manual bandwidth\n  fire_month_stkde &lt;&lt;- spattemp.density(\n    pp = fire_month_owin,\n    h = h_manual,\n    lambda = lambda_manual,\n    verbose = FALSE\n  )\n})\n\n# Display summary\nif(exists(\"fire_month_stkde\")) {\n  summary(fire_month_stkde)\n} else {\n  message(\"STKDE computation failed. Skipping this analysis.\")\n}\n\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 59640.1 (spatial)\n  lambda = 1 (temporal)\n\nNo. of observations\n  31 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512010.4, 928107.4] x [9621858, 9833989]\n\nTemporal bound\n  [10, 12]\n\nEvaluation\n  128 x 128 x 3 trivariate lattice\n  Density range: [2.541332e-12, 6.107462e-11]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-stkde-by-month",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-stkde-by-month",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.4 Plotting STKDE by Month",
    "text": "5.4 Plotting STKDE by Month\n\n\nShow code\n# Plot STKDE for selected months (if computation was successful)\nif(exists(\"fire_month_stkde\")) {\n  # Check the structure of the STKDE object\n  if(!is.null(fire_month_stkde) && !is.null(fire_month_stkde$z)) {\n    # Get dimensions safely\n    z_dims &lt;- dim(fire_month_stkde$z)\n    \n    if(length(z_dims) == 3) {\n      n_times &lt;- z_dims[3]\n      message(\"STKDE has \", n_times, \" time points\")\n      \n      # Plot available time points\n      if(n_times &gt; 0) {\n        n_plots &lt;- min(6, n_times)\n        par(mfrow = c(2, 3))\n        \n        for(i in 1:n_plots) {\n          tryCatch({\n            plot(fire_month_stkde, \n                 tselect = i,\n                 main = paste(\"STKDE - Time\", i))\n          }, error = function(e) {\n            plot.new()\n            text(0.5, 0.5, paste(\"No data for time\", i))\n          })\n        }\n        par(mfrow = c(1, 1))\n      }\n    } else {\n      message(\"STKDE object has unexpected structure. Attempting simple plot...\")\n      tryCatch({\n        plot(fire_month_stkde)\n      }, error = function(e) {\n        message(\"Cannot plot STKDE: \", e$message)\n      })\n    }\n  } else {\n    message(\"STKDE object is incomplete\")\n  }\n} else {\n  message(\"STKDE not computed due to sparse data\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#creating-ppp-object-with-day-of-year",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#creating-ppp-object-with-day-of-year",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "6.1 Creating PPP Object with Day of Year",
    "text": "6.1 Creating PPP Object with Day of Year\n\n\nShow code\n# Prepare data with DayofYear\nfire_doy &lt;- fire_sf %&gt;%\n  dplyr::select(DayofYear) %&gt;%\n  mutate(DayofYear = as.numeric(DayofYear))\n\n# Create ppp object\nfire_doy_ppp &lt;- as.ppp(fire_doy)\n\n# Handle duplicates\nfire_doy_ppp &lt;- unique(fire_doy_ppp)\n\n# Combine with owin\nfire_doy_owin &lt;- fire_doy_ppp[kbb_owin]\n\n# Display summary\nsummary(fire_doy_owin)\n\n\nMarked planar point pattern:  31 points\nAverage intensity 1.849468e-09 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  279.0   280.0   293.0   293.7   302.0   336.0 \n\nWindow: polygonal boundary\n270 separate polygons (no holes)\n             vertices        area relative.area\npolygon 1           6 5.15790e+04      3.08e-06\npolygon 2           7 9.35325e+04      5.58e-06\npolygon 3          20 1.26679e+04      7.56e-07\npolygon 4          23 9.26107e+04      5.53e-06\npolygon 5          18 4.98850e+05      2.98e-05\npolygon 6          30 3.37290e+04      2.01e-06\npolygon 7          54 3.25363e+05      1.94e-05\npolygon 8          33 1.30250e+06      7.77e-05\npolygon 9         132 1.16490e+06      6.95e-05\npolygon 10         69 1.91355e+05      1.14e-05\npolygon 11        117 1.51905e+05      9.06e-06\npolygon 12         95 1.14409e+05      6.83e-06\npolygon 13         22 4.54503e+03      2.71e-07\npolygon 14         25 1.18153e+04      7.05e-07\npolygon 15        131 1.52345e+05      9.09e-06\npolygon 16         39 1.07779e+04      6.43e-07\npolygon 17         54 3.46837e+05      2.07e-05\npolygon 18         72 2.15853e+05      1.29e-05\npolygon 19         16 1.85061e+03      1.10e-07\npolygon 20         79 1.05702e+05      6.31e-06\npolygon 21         20 4.26450e+03      2.54e-07\npolygon 22        119 1.64729e+05      9.83e-06\npolygon 23         40 1.16146e+04      6.93e-07\npolygon 24         16 3.52284e+03      2.10e-07\npolygon 25        328 3.08592e+06      1.84e-04\npolygon 26        191 2.36937e+06      1.41e-04\npolygon 27         77 8.82506e+04      5.27e-06\npolygon 28         49 6.13179e+04      3.66e-06\npolygon 29        121 7.64910e+04      4.56e-06\npolygon 30          5 1.73815e+04      1.04e-06\npolygon 31          4 6.39020e+03      3.81e-07\npolygon 32         16 1.18396e+05      7.06e-06\npolygon 33          5 2.11407e+04      1.26e-06\npolygon 34         11 3.52360e+04      2.10e-06\npolygon 35         13 6.20570e+04      3.70e-06\npolygon 36          8 1.23128e+04      7.35e-07\npolygon 37          5 9.16907e+03      5.47e-07\npolygon 38         31 1.54528e+06      9.22e-05\npolygon 39         13 6.02786e+04      3.60e-06\npolygon 40         19 8.71573e+04      5.20e-06\npolygon 41         15 6.16242e+04      3.68e-06\npolygon 42          8 1.56726e+04      9.35e-07\npolygon 43          6 1.35363e+04      8.08e-07\npolygon 44          4 4.29360e+03      2.56e-07\npolygon 45         23 1.77052e+05      1.06e-05\npolygon 46         45 4.35839e+04      2.60e-06\npolygon 47          5 6.83224e+03      4.08e-07\npolygon 48          5 6.68328e+03      3.99e-07\npolygon 49          5 2.25570e+03      1.35e-07\npolygon 50          7 2.61716e+04      1.56e-06\npolygon 51          9 1.20125e+04      7.17e-07\npolygon 52          8 2.24884e+04      1.34e-06\npolygon 53          6 1.21058e+04      7.22e-07\npolygon 54          5 8.79539e+03      5.25e-07\npolygon 55          9 2.28045e+04      1.36e-06\npolygon 56          6 9.20554e+03      5.49e-07\npolygon 57         49 1.00131e+05      5.97e-06\npolygon 58          5 4.47493e+03      2.67e-07\npolygon 59          4 2.88084e+03      1.72e-07\npolygon 60          4 3.66452e+03      2.19e-07\npolygon 61         69 9.92186e+04      5.92e-06\npolygon 62          5 3.03623e+03      1.81e-07\npolygon 63          6 1.05413e+04      6.29e-07\npolygon 64          8 9.42911e+03      5.63e-07\npolygon 65         13 6.94883e+04      4.15e-06\npolygon 66         34 2.01331e+05      1.20e-05\npolygon 67        227 1.23408e+06      7.36e-05\npolygon 68          4 2.59824e+03      1.55e-07\npolygon 69          7 8.47540e+03      5.06e-07\npolygon 70          5 8.12486e+03      4.85e-07\npolygon 71         95 2.08341e+05      1.24e-05\npolygon 72         18 7.79145e+04      4.65e-06\npolygon 73         24 1.59007e+04      9.49e-07\npolygon 74          4 8.81028e+02      5.26e-08\npolygon 75         43 4.25653e+04      2.54e-06\npolygon 76          5 4.41923e+03      2.64e-07\npolygon 77          4 2.43914e+03      1.46e-07\npolygon 78          5 4.71226e+03      2.81e-07\npolygon 79        217 2.22687e+06      1.33e-04\npolygon 80         63 5.45427e+04      3.25e-06\npolygon 81          6 4.61991e+03      2.76e-07\npolygon 82          6 1.47370e+04      8.79e-07\npolygon 83          6 1.35588e+04      8.09e-07\npolygon 84         51 9.00805e+04      5.37e-06\npolygon 85          4 1.55335e+03      9.27e-08\npolygon 86         32 4.34625e+04      2.59e-06\npolygon 87        146 5.46576e+05      3.26e-05\npolygon 88         36 7.39133e+04      4.41e-06\npolygon 89         42 9.17378e+04      5.47e-06\npolygon 90        141 1.10143e+06      6.57e-05\npolygon 91         96 2.55421e+05      1.52e-05\npolygon 92         75 3.74798e+04      2.24e-06\npolygon 93         71 9.11194e+05      5.44e-05\npolygon 94          5 4.25220e+03      2.54e-07\npolygon 95         48 1.10263e+05      6.58e-06\npolygon 96          6 1.00670e+04      6.01e-07\npolygon 97         33 2.35513e+04      1.41e-06\npolygon 98          4 1.39953e+02      8.35e-09\npolygon 99        120 3.80319e+05      2.27e-05\npolygon 100        19 3.13896e+04      1.87e-06\npolygon 101        42 1.21247e+05      7.23e-06\npolygon 102        24 3.83865e+04      2.29e-06\npolygon 103        88 4.57022e+05      2.73e-05\npolygon 104        20 1.78068e+04      1.06e-06\npolygon 105        20 2.39368e+04      1.43e-06\npolygon 106         5 6.64860e+03      3.97e-07\npolygon 107         5 5.41661e+03      3.23e-07\npolygon 108        53 4.54957e+05      2.71e-05\npolygon 109       263 1.76196e+07      1.05e-03\npolygon 110         4 6.76374e+03      4.04e-07\npolygon 111        17 5.83732e+03      3.48e-07\npolygon 112        25 2.16843e+05      1.29e-05\npolygon 113         9 3.13706e+03      1.87e-07\npolygon 114        10 1.13374e+04      6.76e-07\npolygon 115        45 1.05289e+05      6.28e-06\npolygon 116         7 4.71437e+03      2.81e-07\npolygon 117       527 4.88599e+07      2.91e-03\npolygon 118       632 1.19875e+08      7.15e-03\npolygon 119        68 3.72752e+06      2.22e-04\npolygon 120        10 1.01946e+05      6.08e-06\npolygon 121        19 8.27040e+04      4.93e-06\npolygon 122        17 4.01684e+04      2.40e-06\npolygon 123        11 4.06518e+04      2.43e-06\npolygon 124       111 1.46837e+06      8.76e-05\npolygon 125       110 3.73961e+06      2.23e-04\npolygon 126        19 1.91715e+04      1.14e-06\npolygon 127        73 3.61882e+06      2.16e-04\npolygon 128        10 3.05396e+04      1.82e-06\npolygon 129         6 1.63086e+04      9.73e-07\npolygon 130        81 2.65410e+05      1.58e-05\npolygon 131         8 2.10497e+04      1.26e-06\npolygon 132         9 2.23051e+04      1.33e-06\npolygon 133        11 1.96429e+04      1.17e-06\npolygon 134       145 7.13724e+06      4.26e-04\npolygon 135        60 1.45303e+05      8.67e-06\npolygon 136        74 2.06450e+06      1.23e-04\npolygon 137        36 2.64395e+04      1.58e-06\npolygon 138       926 2.12401e+08      1.27e-02\npolygon 139        25 2.21142e+05      1.32e-05\npolygon 140         6 6.85335e+03      4.09e-07\npolygon 141        31 1.67739e+06      1.00e-04\npolygon 142         7 8.96845e+03      5.35e-07\npolygon 143        12 6.31109e+04      3.77e-06\npolygon 144       202 2.25183e+07      1.34e-03\npolygon 145        46 2.39836e+06      1.43e-04\npolygon 146        34 1.06861e+04      6.38e-07\npolygon 147         8 4.62274e+04      2.76e-06\npolygon 148         7 3.16257e+04      1.89e-06\npolygon 149         5 6.47214e+03      3.86e-07\npolygon 150        12 2.17322e+04      1.30e-06\npolygon 151         5 7.20136e+03      4.30e-07\npolygon 152       160 1.11856e+06      6.67e-05\npolygon 153       105 3.97161e+05      2.37e-05\npolygon 154        14 3.77546e+05      2.25e-05\npolygon 155        27 1.21328e+06      7.24e-05\npolygon 156       132 7.32320e+05      4.37e-05\npolygon 157        52 6.46488e+04      3.86e-06\npolygon 158        59 5.31644e+06      3.17e-04\npolygon 159        48 1.76605e+06      1.05e-04\npolygon 160        34 5.03181e+04      3.00e-06\npolygon 161        49 1.83632e+04      1.10e-06\npolygon 162        19 5.31559e+03      3.17e-07\npolygon 163       246 3.09440e+06      1.85e-04\npolygon 164        28 1.99191e+05      1.19e-05\npolygon 165        19 4.51980e+05      2.70e-05\npolygon 166        14 5.66638e+04      3.38e-06\npolygon 167        12 1.09882e+05      6.56e-06\npolygon 168        41 4.25466e+04      2.54e-06\npolygon 169       189 1.69035e+06      1.01e-04\npolygon 170       118 2.32814e+05      1.39e-05\npolygon 171         7 2.79374e+04      1.67e-06\npolygon 172        53 1.72586e+06      1.03e-04\npolygon 173        13 6.36463e+04      3.80e-06\npolygon 174       156 1.14531e+06      6.83e-05\npolygon 175        47 9.13932e+05      5.45e-05\npolygon 176        62 3.95152e+06      2.36e-04\npolygon 177       155 7.75116e+05      4.62e-05\npolygon 178        14 4.20349e+04      2.51e-06\npolygon 179        18 5.14007e+03      3.07e-07\npolygon 180        31 7.44696e+05      4.44e-05\npolygon 181        18 4.11037e+05      2.45e-05\npolygon 182        23 7.72702e+03      4.61e-07\npolygon 183         8 3.85828e+04      2.30e-06\npolygon 184       180 7.46362e+06      4.45e-04\npolygon 185        14 2.75557e+05      1.64e-05\npolygon 186         4 9.17061e+03      5.47e-07\npolygon 187         9 9.64342e+03      5.75e-07\npolygon 188         9 6.16694e+04      3.68e-06\npolygon 189        10 1.05264e+05      6.28e-06\npolygon 190         8 8.74118e+04      5.22e-06\npolygon 191         5 1.83999e+04      1.10e-06\npolygon 192         5 3.32417e+03      1.98e-07\npolygon 193        13 3.15953e+04      1.88e-06\npolygon 194        67 3.93589e+05      2.35e-05\npolygon 195         4 2.84280e+03      1.70e-07\npolygon 196        16 4.94144e+03      2.95e-07\npolygon 197         4 1.27360e+03      7.60e-08\npolygon 198         8 1.67265e+04      9.98e-07\npolygon 199        12 2.45940e+04      1.47e-06\npolygon 200        12 5.95411e+04      3.55e-06\npolygon 201        14 2.19831e+03      1.31e-07\npolygon 202        14 4.32480e+03      2.58e-07\npolygon 203        17 7.75234e+03      4.63e-07\npolygon 204        13 1.86854e+03      1.11e-07\npolygon 205        34 3.85424e+06      2.30e-04\npolygon 206         9 3.58530e+03      2.14e-07\npolygon 207        15 1.41276e+04      8.43e-07\npolygon 208        27 1.42520e+04      8.50e-07\npolygon 209        38 2.66059e+04      1.59e-06\npolygon 210        22 4.51365e+03      2.69e-07\npolygon 211        96 5.26123e+05      3.14e-05\npolygon 212        60 1.00574e+05      6.00e-06\npolygon 213        31 7.13409e+04      4.26e-06\npolygon 214        37 1.08935e+06      6.50e-05\npolygon 215       179 8.26972e+05      4.93e-05\npolygon 216        59 1.99001e+05      1.19e-05\npolygon 217        47 2.81875e+05      1.68e-05\npolygon 218       115 3.13327e+05      1.87e-05\npolygon 219       133 4.76117e+05      2.84e-05\npolygon 220        97 1.63408e+07      9.75e-04\npolygon 221        19 6.38976e+03      3.81e-07\npolygon 222        10 7.75421e+03      4.63e-07\npolygon 223       204 1.42141e+06      8.48e-05\npolygon 224       125 2.33616e+06      1.39e-04\npolygon 225        31 2.58857e+04      1.54e-06\npolygon 226        25 2.06725e+04      1.23e-06\npolygon 227        87 1.25180e+06      7.47e-05\npolygon 228        38 4.03858e+04      2.41e-06\npolygon 229        10 5.04629e+04      3.01e-06\npolygon 230         6 1.12888e+04      6.73e-07\npolygon 231        40 1.56849e+05      9.36e-06\npolygon 232        66 5.25038e+04      3.13e-06\npolygon 233         8 1.10747e+04      6.61e-07\npolygon 234        10 1.50784e+03      9.00e-08\npolygon 235        14 4.55332e+03      2.72e-07\npolygon 236        41 4.12940e+04      2.46e-06\npolygon 237         7 3.04017e+03      1.81e-07\npolygon 238        19 7.53923e+03      4.50e-07\npolygon 239        18 8.35187e+03      4.98e-07\npolygon 240        26 5.16261e+05      3.08e-05\npolygon 241        13 9.24908e+04      5.52e-06\npolygon 242        25 4.18653e+04      2.50e-06\npolygon 243         7 3.83476e+03      2.29e-07\npolygon 244        82 4.38420e+05      2.62e-05\npolygon 245       164 3.46334e+06      2.07e-04\npolygon 246        11 5.20050e+03      3.10e-07\npolygon 247        13 3.27494e+04      1.95e-06\npolygon 248         6 3.01213e+04      1.80e-06\npolygon 249        13 2.03114e+05      1.21e-05\npolygon 250        38 2.87869e+04      1.72e-06\npolygon 251        14 4.11781e+03      2.46e-07\npolygon 252        44 1.67050e+05      9.97e-06\npolygon 253        11 6.66399e+04      3.98e-06\npolygon 254       129 2.29310e+06      1.37e-04\npolygon 255        22 6.48307e+03      3.87e-07\npolygon 256       107 1.06884e+06      6.38e-05\npolygon 257         9 2.30080e+04      1.37e-06\npolygon 258        34 9.10976e+03      5.43e-07\npolygon 259        72 1.08609e+05      6.48e-06\npolygon 260        64 2.19815e+05      1.31e-05\npolygon 261        25 2.57976e+05      1.54e-05\npolygon 262        26 4.60002e+04      2.74e-06\npolygon 263        57 8.30086e+04      4.95e-06\npolygon 264        83 1.14012e+06      6.80e-05\npolygon 265        11 3.01000e+04      1.80e-06\npolygon 266        14 1.30459e+05      7.78e-06\npolygon 267        22 2.37055e+05      1.41e-05\npolygon 268        22 1.84821e+05      1.10e-05\npolygon 269      8736 1.15970e+10      6.92e-01\npolygon 270      5944 4.61753e+09      2.75e-01\nenclosing rectangle: [512010.4, 928107.4] x [9621858, 9833989] units\n                     (416100 x 212100 units)\nWindow area = 16761600000 square units\nFraction of frame area: 0.19"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-default-bandwidth",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-default-bandwidth",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "6.2 Computing STKDE with Default Bandwidth",
    "text": "6.2 Computing STKDE with Default Bandwidth\n\n\nShow code\n# Compute STKDE with day of year\ntryCatch({\n  fire_doy_stkde &lt;- spattemp.density(\n    pp = fire_doy_owin,\n    h = NULL,\n    lambda = NULL,\n    verbose = FALSE\n  )\n}, error = function(e) {\n  message(\"Automatic bandwidth failed. Using manual bandwidth...\")\n  \n  # Calculate manual bandwidth\n  coords &lt;- st_coordinates(fire_doy)\n  h_manual &lt;- diff(range(coords[,1])) / 5\n  lambda_manual &lt;- 30  # approximately monthly for day of year\n  \n  fire_doy_stkde &lt;&lt;- spattemp.density(\n    pp = fire_doy_owin,\n    h = h_manual,\n    lambda = lambda_manual,\n    verbose = FALSE\n  )\n})\n\n# Display summary\nif(exists(\"fire_doy_stkde\")) {\n  summary(fire_doy_stkde)\n} else {\n  message(\"STKDE computation failed\")\n}\n\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 34921.4 (spatial)\n  lambda = 2.1446 (temporal)\n\nNo. of observations\n  31 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512010.4, 928107.4] x [9621858, 9833989]\n\nTemporal bound\n  [279, 336]\n\nEvaluation\n  128 x 128 x 58 trivariate lattice\n  Density range: [3.678581e-30, 2.813632e-11]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#bandwidth-selection-using-bootstrap",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#bandwidth-selection-using-bootstrap",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "7.1 Bandwidth Selection using Bootstrap",
    "text": "7.1 Bandwidth Selection using Bootstrap\n\n\nShow code\n# Note: This may take several minutes to run\n# Uncomment to run bandwidth optimization\n\n# message(\"Starting bandwidth optimization (this may take a few minutes)...\")\n# fire_doy_boot &lt;- BOOT.spattemp(\n#   pp = fire_doy_owin,\n#   nboot = 10,  # Reduced for faster computation\n#   verbose = FALSE\n# )\n# \n# # Display optimal bandwidths\n# message(\"Optimal spatial bandwidth (h): \", round(fire_doy_boot$h, 2))\n# message(\"Optimal temporal bandwidth (lambda): \", round(fire_doy_boot$lambda, 2))\n\n# For demonstration, we'll use reasonable default values\nh_optimal &lt;- 9000\nlambda_optimal &lt;- 19"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-optimized-bandwidth",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-optimized-bandwidth",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "7.2 Computing STKDE with Optimized Bandwidth",
    "text": "7.2 Computing STKDE with Optimized Bandwidth\n\n\nShow code\n# Compute STKDE with optimized bandwidths\nfire_doy_stkde_opt &lt;- spattemp.density(\n  pp = fire_doy_owin,\n  h = h_optimal,\n  lambda = lambda_optimal,\n  verbose = FALSE\n)\n\n# Display summary\nsummary(fire_doy_stkde_opt)\n\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 9000 (spatial)\n  lambda = 19 (temporal)\n\nNo. of observations\n  31 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512010.4, 928107.4] x [9621858, 9833989]\n\nTemporal bound\n  [279, 336]\n\nEvaluation\n  128 x 128 x 58 trivariate lattice\n  Density range: [1.661956e-23, 1.511621e-11]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-optimized-stkde",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-optimized-stkde",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "7.3 Plotting Optimized STKDE",
    "text": "7.3 Plotting Optimized STKDE\n\n\nShow code\n# Check the actual time range in the data\nif(exists(\"fire_doy_stkde_opt\") && !is.null(fire_doy_stkde_opt)) {\n  # Get the actual temporal range\n  time_range &lt;- range(fire_doy_owin$marks)\n  message(\"Actual temporal range in data: Day \", time_range[1], \" to Day \", time_range[2])\n  \n  # Plot a sample of time slices within the actual range\n  par(mfrow = c(2, 3))\n  \n  # Select 6 representative days within the actual data range\n  min_day &lt;- time_range[1]\n  max_day &lt;- time_range[2]\n  \n  # Create evenly spaced days within the range\n  days_to_plot &lt;- round(seq(min_day, max_day, length.out = 6))\n  \n  for(day in days_to_plot) {\n    tryCatch({\n      plot(fire_doy_stkde_opt,\n           tselect = day,\n           main = paste(\"Day\", day, \"(\", format(as.Date(day-1, origin = \"2023-01-01\"), \"%b %d\"), \")\"))\n    }, error = function(e) {\n      plot.new()\n      text(0.5, 0.5, paste(\"Cannot plot Day\", day))\n    })\n  }\n  \n  par(mfrow = c(1, 1))\n} else {\n  message(\"STKDE optimization not computed\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-stpp",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-stpp",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.1 Preparing Data for stpp",
    "text": "8.1 Preparing Data for stpp\n\n\nShow code\n# Extract coordinates\ncoords &lt;- st_coordinates(fire_sf)\nfire_x &lt;- coords[, 1]\nfire_y &lt;- coords[, 2]\n\n# Use DayofYear as temporal coordinate\nfire_t &lt;- fire_sf$DayofYear\n\n# Create data frame\nfire_stpp_df &lt;- data.frame(\n  x = fire_x,\n  y = fire_y,\n  t = fire_t\n)\n\n# Remove any NA values\nfire_stpp_df &lt;- na.omit(fire_stpp_df)\n\n# Create stpp object\nfire_stpp &lt;- as.3dpoints(fire_stpp_df)\n\n# Check class\nclass(fire_stpp)\n\n\n[1] \"stpp\""
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#visualizing-stpp-object",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#visualizing-stpp-object",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.2 Visualizing stpp Object",
    "text": "8.2 Visualizing stpp Object\n\n\nShow code\n# Plot the 3D space-time point pattern\n# Note: stpp plot has its own parameter structure\ntryCatch({\n  # Simple plot without additional parameters\n  plot(fire_stpp)\n}, error = function(e) {\n  # If that fails, try plotting the data directly\n  message(\"Default plot failed, using alternative visualization...\")\n  \n  # Extract the data\n  if(length(fire_stpp) == 3) {\n    # Create manual 3D plot\n    library(scatterplot3d)\n    if(requireNamespace(\"scatterplot3d\", quietly = TRUE)) {\n      scatterplot3d(fire_stpp[,1], fire_stpp[,2], fire_stpp[,3],\n                    main = \"3D Visualization of Forest Fires\",\n                    xlab = \"X coordinate\",\n                    ylab = \"Y coordinate\", \n                    zlab = \"Day of Year\",\n                    color = \"red\",\n                    pch = 16)\n    } else {\n      # Fallback to 2D plots\n      par(mfrow = c(1, 2))\n      plot(fire_stpp[,1], fire_stpp[,2], \n           main = \"Spatial Distribution\",\n           xlab = \"X\", ylab = \"Y\", pch = 20, col = \"red\")\n      hist(fire_stpp[,3], \n           main = \"Temporal Distribution\",\n           xlab = \"Day of Year\", col = \"lightblue\")\n      par(mfrow = c(1, 1))\n    }\n  }\n})"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-space-time-k-function",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-space-time-k-function",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.3 Computing Space-Time K-function",
    "text": "8.3 Computing Space-Time K-function\n\n\nShow code\n# Define spatial and temporal distances\nu &lt;- seq(0, 20000, by = 2000)  # Spatial distances in meters\nv &lt;- seq(0, 60, by = 10)       # Temporal distances in days\n\n# Compute STIKhat (this may take a moment)\nfire_stik &lt;- STIKhat(\n  xyt = fire_stpp,\n  dist = u,\n  times = v,\n  infectious = FALSE\n)\n\n# Display structure\nstr(fire_stik)\n\n\nList of 6\n $ Khat      : num [1:10, 1:6] 2.36e+10 2.36e+10 2.36e+10 3.53e+10 4.12e+10 ...\n $ Ktheo     : num [1:10, 1:6] 2.51e+08 1.01e+09 2.26e+09 4.02e+09 6.28e+09 ...\n $ dist      : num [1:10] 2000 4000 6000 8000 10000 12000 14000 16000 18000 20000\n $ times     : num [1:6] 10 20 30 40 50 60\n $ correction: chr \"isotropic\"\n $ infectious: logi FALSE"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-space-time-k-function",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-space-time-k-function",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.4 Plotting Space-Time K-function",
    "text": "8.4 Plotting Space-Time K-function\n\n\nShow code\n# Create contour plot\nplotK(fire_stik,\n      main = \"Space-Time Inhomogeneous K-function\",\n      xlab = \"Spatial Distance (m)\",\n      ylab = \"Temporal Distance (days)\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#key-findings",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#key-findings",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.1 Key Findings",
    "text": "9.1 Key Findings\nBased on our spatio-temporal point pattern analysis of forest fires in Kepulauan Bangka Belitung:\n\n9.1.1 Spatial Distribution\n\nFire events show clear spatial clustering patterns\nCertain areas experience higher fire density consistently\n\n\n\n9.1.2 Temporal Patterns\n\nStrong seasonal variation in fire occurrence\nPeak fire activity during specific months (typically dry season)\n\n\n\n9.1.3 Spatio-temporal Clustering\n\nThe K-function analysis reveals significant spatio-temporal clustering\nFires tend to occur close together in both space and time\nThis suggests possible fire spread or common underlying causes"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#interpretation-guidelines",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#interpretation-guidelines",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.2 Interpretation Guidelines",
    "text": "9.2 Interpretation Guidelines\n\n9.2.1 For K-function Contour Plot:\n\nHigh values at small u and v: Indicates clustering at short spatial and temporal distances\nFlat contours: Suggests random distribution\nRapid increase in contours: Shows the spatial and temporal extent of clustering\n\n\n\n9.2.2 For STKDE:\n\nHigh density areas: Represent hotspots of fire activity\nTemporal evolution: Shows how fire risk areas change over time"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#conclusions",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.3 Conclusions",
    "text": "9.3 Conclusions\nThe analysis reveals that forest fires in Kepulauan Bangka Belitung are not randomly distributed in space and time. Instead, they exhibit:\n\nSpatial clustering: Fires concentrate in specific geographic areas\nTemporal clustering: Fires occur more frequently during certain periods\nSpatio-temporal dependence: Recent fires increase the likelihood of nearby fires\n\nThese patterns are likely driven by: - Environmental factors (vegetation type, moisture) - Human activities (land clearing, agricultural practices) - Weather conditions (dry season effects)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#session-information",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#session-information",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.4 Session Information",
    "text": "9.4 Session Information\n\n\nShow code\nsessionInfo()\n\n\nR version 4.5.0 (2025-04-11 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n  LAPACK version 3.12.1\n\nlocale:\n[1] LC_COLLATE=Chinese (Simplified)_Hong Kong SAR.utf8 \n[2] LC_CTYPE=Chinese (Simplified)_Hong Kong SAR.utf8   \n[3] LC_MONETARY=Chinese (Simplified)_Hong Kong SAR.utf8\n[4] LC_NUMERIC=C                                       \n[5] LC_TIME=Chinese (Simplified)_Hong Kong SAR.utf8    \n\ntime zone: Asia/Shanghai\ntzcode source: internal\n\nattached base packages:\n[1] tcltk     stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] stpp_2.0-8             splancs_2.01-45        rpanel_1.1-5.2        \n [4] here_1.0.2             geodata_0.6-6          terra_1.8-60          \n [7] lubridate_1.9.4        forcats_1.0.0          stringr_1.5.1         \n[10] dplyr_1.1.4            purrr_1.0.4            readr_2.1.5           \n[13] tidyr_1.3.1            tibble_3.3.0           ggplot2_3.5.2         \n[16] tidyverse_2.0.0        tmap_4.2               sparr_2.3-16          \n[19] spatstat_3.4-1         spatstat.linnet_3.3-2  spatstat.model_3.4-2  \n[22] rpart_4.1.24           spatstat.explore_3.5-3 nlme_3.1-168          \n[25] spatstat.random_3.4-2  spatstat.geom_3.6-0    spatstat.univar_3.1-4 \n[28] spatstat.data_3.1-8    raster_3.6-32          sp_2.2-0              \n[31] sf_1.0-21             \n\nloaded via a namespace (and not attached):\n [1] DBI_1.2.3             deldir_2.0-4          gridExtra_2.3        \n [4] tmaptools_3.3         s2_1.1.7              logger_0.4.0         \n [7] rlang_1.1.6           magrittr_2.0.3        e1071_1.7-16         \n[10] compiler_4.5.0        mgcv_1.9-1            png_0.1-8            \n[13] vctrs_0.6.5           crayon_1.5.3          pkgconfig_2.0.3      \n[16] wk_0.9.4              fastmap_1.2.0         lwgeom_0.2-14        \n[19] leafem_0.2.5          utf8_1.2.5            rmarkdown_2.29       \n[22] tzdb_0.5.0            spacesXYZ_1.5-1       bit_4.6.0            \n[25] xfun_0.52             jsonlite_2.0.0        goftest_1.2-3        \n[28] spatstat.utils_3.2-0  parallel_4.5.0        R6_2.6.1             \n[31] stringi_1.8.7         RColorBrewer_1.1-3    extrafontdb_1.0      \n[34] stars_0.6-8           Rcpp_1.0.14           iterators_1.0.14     \n[37] knitr_1.50            tensor_1.5.1          base64enc_0.1-3      \n[40] tidyselect_1.2.1      Matrix_1.7-3          splines_4.5.0        \n[43] timechange_0.3.0      rstudioapi_0.17.1     dichromat_2.0-0.1    \n[46] abind_1.4-8           yaml_2.3.10           maptiles_0.10.0      \n[49] doParallel_1.0.17     codetools_0.2-20      misc3d_0.9-1         \n[52] lattice_0.22-6        leafsync_0.1.0        withr_3.0.2          \n[55] evaluate_1.0.3        units_0.8-7           proxy_0.4-27         \n[58] polyclip_1.10-7       pillar_1.10.2         KernSmooth_2.23-26   \n[61] foreach_1.5.2         generics_0.1.3        vroom_1.6.5          \n[64] rprojroot_2.1.1       hms_1.1.3             scales_1.4.0         \n[67] class_7.3-23          glue_1.8.0            tools_4.5.0          \n[70] leaflegend_1.2.1      data.table_1.17.0     rgl_1.3.18           \n[73] XML_3.99-0.18         grid_4.5.0            crosstalk_1.2.1      \n[76] colorspace_2.1-1      cols4all_0.9          cli_3.6.5            \n[79] spatstat.sparse_3.1-0 rappdirs_0.3.3        plot3D_1.4.2         \n[82] gtable_0.3.6          digest_0.6.37         classInt_0.4-11      \n[85] htmlwidgets_1.6.4     farver_2.1.2          htmltools_0.5.8.1    \n[88] lifecycle_1.0.4       leaflet_2.2.3         bit64_4.6.0-1        \n[91] microbenchmark_1.5.0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In this hands-on exercise, you will learn how to compute Global Measures of Spatial Autocorrelation (GMSA) by using spdep package. By the end of this hands-on exercise, you will be able to:\n\nImport geospatial data using appropriate function(s) of sf package\nImport csv file using appropriate function of readr package\nPerform relational join using appropriate join function of dplyr package\nCompute Global Spatial Autocorrelation (GSA) statistics by using appropriate functions of spdep package\nPlot Moran scatterplot\nCompute and plot spatial correlogram using appropriate function of spdep package\nProvide statistically correct interpretation of GSA statistics\n\n\n\nIn spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China.\n\n\n\nTwo data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-analytical-question",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-analytical-question",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-study-area-and-data",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-study-area-and-data",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Two data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#setting-the-analytical-tools",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#setting-the-analytical-tools",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "2.1 Setting the Analytical Tools",
    "text": "2.1 Setting the Analytical Tools\nBefore we get started, we need to ensure that spdep, sf, tmap and tidyverse packages are installed and loaded.\n\nsf is used for importing and handling geospatial data in R\ntidyverse is mainly used for wrangling attribute data in R\nspdep will be used to compute spatial weights, global and local spatial autocorrelation statistics\ntmap will be used to prepare cartographic quality choropleth maps\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-shapefile-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-shapefile-into-r-environment",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.1 Import shapefile into R environment",
    "text": "3.1 Import shapefile into R environment\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be simple features object of sf.\n\n\nShow code\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\n\nReading layer `Hunan' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-csv-file-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-csv-file-into-r-environment",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.2 Import csv file into R environment",
    "text": "3.2 Import csv file into R environment\nNext, we will import Hunan_2012.csv into R by using read_csv() of readr package. The output is R data frame class.\n\n\nShow code\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\", show_col_types = FALSE)\n\n# Check the data structure\nglimpse(hunan2012)\n\n\nRows: 88\nColumns: 29\n$ County      &lt;chr&gt; \"Anhua\", \"Anren\", \"Anxiang\", \"Baojing\", \"Chaling\", \"Changn…\n$ City        &lt;chr&gt; \"Yiyang\", \"Chenzhou\", \"Changde\", \"Hunan West\", \"Zhuzhou\", …\n$ avg_wage    &lt;dbl&gt; 30544, 28058, 31935, 30843, 31251, 28518, 54540, 28597, 33…\n$ deposite    &lt;dbl&gt; 10967.0, 4598.9, 5517.2, 2250.0, 8241.4, 10860.0, 24332.0,…\n$ FAI         &lt;dbl&gt; 6831.7, 6386.1, 3541.0, 1005.4, 6508.4, 7920.0, 33624.0, 1…\n$ Gov_Rev     &lt;dbl&gt; 456.72, 220.57, 243.64, 192.59, 620.19, 769.86, 5350.00, 1…\n$ Gov_Exp     &lt;dbl&gt; 2703.0, 1454.7, 1779.5, 1379.1, 1947.0, 2631.6, 7885.5, 11…\n$ GDP         &lt;dbl&gt; 13225.0, 4941.2, 12482.0, 4087.9, 11585.0, 19886.0, 88009.…\n$ GDPPC       &lt;dbl&gt; 14567, 12761, 23667, 14563, 20078, 24418, 88656, 10132, 17…\n$ GIO         &lt;dbl&gt; 9276.90, 4189.20, 5108.90, 3623.50, 9157.70, 37392.00, 513…\n$ Loan        &lt;dbl&gt; 3954.90, 2555.30, 2806.90, 1253.70, 4287.40, 4242.80, 4053…\n$ NIPCR       &lt;dbl&gt; 3528.3, 3271.8, 7693.7, 4191.3, 3887.7, 9528.0, 17070.0, 3…\n$ Bed         &lt;dbl&gt; 2718, 970, 1931, 927, 1449, 3605, 3310, 582, 2170, 2179, 1…\n$ Emp         &lt;dbl&gt; 494.310, 290.820, 336.390, 195.170, 330.290, 548.610, 670.…\n$ EmpR        &lt;dbl&gt; 441.4, 255.4, 270.5, 145.6, 299.0, 415.1, 452.0, 127.6, 21…\n$ EmpRT       &lt;dbl&gt; 338.0, 99.4, 205.9, 116.4, 154.0, 273.7, 219.4, 94.4, 174.…\n$ Pri_Stu     &lt;dbl&gt; 54.175, 33.171, 19.584, 19.249, 33.906, 81.831, 59.151, 18…\n$ Sec_Stu     &lt;dbl&gt; 32.830, 17.505, 17.819, 11.831, 20.548, 44.485, 39.685, 7.…\n$ Household   &lt;dbl&gt; 290.4, 104.6, 148.1, 73.2, 148.7, 211.2, 300.3, 76.1, 139.…\n$ Household_R &lt;dbl&gt; 234.5, 121.9, 135.4, 69.9, 139.4, 211.7, 248.4, 59.6, 110.…\n$ NOIP        &lt;dbl&gt; 101, 34, 53, 18, 106, 115, 214, 17, 55, 70, 44, 84, 74, 17…\n$ Pop_R       &lt;dbl&gt; 670.3, 243.2, 346.0, 184.1, 301.6, 448.2, 475.1, 189.6, 31…\n$ RSCG        &lt;dbl&gt; 5760.60, 2386.40, 3957.90, 768.04, 4009.50, 5220.40, 22604…\n$ Pop_T       &lt;dbl&gt; 910.8, 388.7, 528.3, 281.3, 578.4, 816.3, 998.6, 256.7, 45…\n$ Agri        &lt;dbl&gt; 4942.253, 2357.764, 4524.410, 1118.561, 3793.550, 6430.782…\n$ Service     &lt;dbl&gt; 5414.5, 3814.1, 14100.0, 541.8, 5444.0, 13074.6, 17726.6, …\n$ Disp_Inc    &lt;dbl&gt; 12373, 16072, 16610, 13455, 20461, 20868, 183252, 12379, 1…\n$ RORP        &lt;dbl&gt; 0.7359464, 0.6256753, 0.6549309, 0.6544614, 0.5214385, 0.5…\n$ ROREmp      &lt;dbl&gt; 0.8929619, 0.8782065, 0.8041262, 0.7460163, 0.9052651, 0.7…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#performing-relational-join",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#performing-relational-join",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.3 Performing relational join",
    "text": "3.3 Performing relational join\nThe code chunk below will be used to update the attribute table of hunan’s SpatialPolygonsDataFrame with the attribute fields of hunan2012 dataframe. This is performed by using left_join() of dplyr package.\n\n\nShow code\nhunan &lt;- left_join(hunan, hunan2012, by = c(\"County\" = \"County\"))\n\n# Check the result\nglimpse(hunan)\n\n\nRows: 88\nColumns: 36\n$ NAME_2      &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ ID_3        &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 21…\n$ NAME_3      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ ENGTYPE_3   &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"Co…\n$ Shape_Leng  &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.171918…\n$ Shape_Area  &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.11450357…\n$ County      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ City        &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ avg_wage    &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 45…\n$ deposite    &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, 1…\n$ FAI         &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0,…\n$ Gov_Rev     &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, 2…\n$ Gov_Exp     &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 48…\n$ GDP         &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 81113…\n$ GDPPC       &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 70…\n$ GIO         &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254.…\n$ Loan        &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 23408…\n$ NIPCR       &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, 1…\n$ Bed         &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970, …\n$ Emp         &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 85…\n$ EmpR        &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 268…\n$ EmpRT       &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 131…\n$ Pri_Stu     &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80.…\n$ Sec_Stu     &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68.…\n$ Household   &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 161…\n$ Household_R &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 154…\n$ NOIP        &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, 4…\n$ Pop_R       &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 266…\n$ RSCG        &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, 1…\n$ Pop_T       &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5, …\n$ Agri        &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.510…\n$ Service     &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.8…\n$ Disp_Inc    &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 27…\n$ RORP        &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.6…\n$ ROREmp      &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.8…\n$ geometry    &lt;POLYGON [°]&gt; POLYGON ((112.0625 29.75523..., POLYGON ((112.2288…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-regional-development-indicator",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-regional-development-indicator",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.4 Visualising Regional Development Indicator",
    "text": "3.4 Visualising Regional Development Indicator\nNow, we are going to prepare a basemap and a choropleth map showing the distribution of GDPPC 2012 by using qtm() of tmap package.\n\n\nShow code\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Quantile classification\")\n\ntmap_arrange(equal, \n            quantile, \n            asp = 1, \n            ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-contiguity-spatial-weights",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-contiguity-spatial-weights",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "4.1 Computing Contiguity Spatial Weights",
    "text": "4.1 Computing Contiguity Spatial Weights\nBefore we can compute the global spatial autocorrelation statistics, we need to construct a spatial weights of the study area. The spatial weights is used to define the neighbourhood relationships between the geographical units (i.e. county) in the study area.\nIn the code chunk below, poly2nb() of spdep package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries.\n\n\nShow code\nwm_q &lt;- poly2nb(hunan, queen = TRUE)\nsummary(wm_q)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report above shows that: - There are 88 area units in Hunan - The most connected area unit has 11 neighbours - There are two area units with only one neighbour"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#row-standardised-weights-matrix",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#row-standardised-weights-matrix",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "4.2 Row-standardised weights matrix",
    "text": "4.2 Row-standardised weights matrix\nNext, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be assigned equal weight (style=“W”). This is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values.\n\n\nShow code\nrswm_q &lt;- nb2listw(wm_q, \n                   style = \"W\", \n                   zero.policy = TRUE)\nrswm_q\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#morans-i-test",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#morans-i-test",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "5.1 Moran’s I test",
    "text": "5.1 Moran’s I test\nThe code chunk below performs Moran’s I statistical testing using moran.test() of spdep.\n\n\nShow code\nmoran.test(hunan$GDPPC, \n           listw = rswm_q, \n           zero.policy = TRUE, \n           na.action = na.omit)\n\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\n\n5.1.1 Statistical Conclusion\nThe Moran’s I test results show: - Moran I statistic: 0.3008 (positive value indicates positive spatial autocorrelation) - Expected value: -0.0115 (expected value under null hypothesis of no spatial autocorrelation) - Variance: 0.0043 - Standard deviate: 4.7351 (Z-score) - P-value: 1.095e-06 (highly significant)\nSince the p-value is much less than 0.05, we reject the null hypothesis of spatial randomness. The positive Moran’s I value indicates that similar values tend to cluster together - there is significant positive spatial autocorrelation in GDPPC across Hunan counties."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-morans-i",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "5.2 Computing Monte Carlo Moran’s I",
    "text": "5.2 Computing Monte Carlo Moran’s I\nThe code chunk below performs permutation test for Moran’s I statistic by using moran.mc() of spdep. A total of 1000 simulations will be performed.\n\n\nShow code\nset.seed(1234)\nbperm &lt;- moran.mc(hunan$GDPPC, \n                  listw = rswm_q, \n                  nsim = 999, \n                  zero.policy = TRUE, \n                  na.action = na.omit)\nbperm\n\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n5.2.1 Statistical Conclusion\nThe Monte Carlo simulation results confirm our earlier findings: - Observed Moran I: 0.3008 - Observed rank: 1000 (highest among all simulations) - P-value: 0.001\nThis means that out of 1000 simulations, the observed Moran’s I value is the highest, giving strong evidence against spatial randomness."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-monte-carlo-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-monte-carlo-morans-i",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "5.3 Visualising Monte Carlo Moran’s I",
    "text": "5.3 Visualising Monte Carlo Moran’s I\nIt is always a good practice to examine the simulated Moran’s I test statistics in greater detail. This can be achieved by plotting the distribution of the statistical values as a histogram.\n\n\nShow code\n# Calculate mean and variance\nmean(bperm$res[1:999])\n\n\n[1] -0.01504572\n\n\nShow code\nvar(bperm$res[1:999])\n\n\n[1] 0.004371574\n\n\nShow code\n# Summary statistics\nsummary(bperm$res[1:999])\n\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\nShow code\n# Create histogram\nhist(bperm$res, \n     freq = TRUE, \n     breaks = 20, \n     xlab = \"Simulated Moran's I\", \n     main = \"Distribution of Monte Carlo Moran's I\",\n     col = \"lightblue\",\n     xlim = c(-0.20, 0.35))\nabline(v = 0, \n       col = \"red\", \n       lty = 2)\nabline(v = bperm$statistic, \n       col = \"red\", \n       lwd = 2)\nlegend(\"topright\", \n       legend = c(\"Observed\", \"Expected\"), \n       col = c(\"red\", \"red\"), \n       lty = c(1, 2), \n       lwd = c(2, 1))\n\n\n\n\n\n\n\n\n\n\n5.3.1 Statistical Observation\nThe histogram shows that: - The distribution of simulated Moran’s I values is approximately normal, centered around -0.015 - The observed value (0.3008) is far in the right tail of the distribution - This visual confirmation supports our conclusion of significant positive spatial autocorrelation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#gearys-c-test",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#gearys-c-test",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "6.1 Geary’s C test",
    "text": "6.1 Geary’s C test\nThe code chunk below performs Geary’s C test for spatial autocorrelation by using geary.test() of spdep.\n\n\nShow code\ngeary.test(hunan$GDPPC, listw = rswm_q)\n\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q   \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n\n6.1.1 Statistical Conclusion\nThe Geary’s C test results show: - Geary C statistic: 0.6907 (values less than 1 indicate positive spatial autocorrelation) - Expected value: 1.0000 (expected value under null hypothesis) - Variance: 0.0073 - Standard deviate: 3.6108 - P-value: 0.0001526\nSince the p-value is less than 0.05 and the Geary’s C value (0.69) is less than 1, we have evidence of positive spatial autocorrelation, confirming our Moran’s I results."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-gearys-c",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-gearys-c",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "6.2 Computing Monte Carlo Geary’s C",
    "text": "6.2 Computing Monte Carlo Geary’s C\nThe code chunk below performs permutation test for Geary’s C statistic by using geary.mc() of spdep.\n\n\nShow code\nset.seed(1234)\nbperm_c &lt;- geary.mc(hunan$GDPPC, \n                    listw = rswm_q, \n                    nsim = 999)\nbperm_c\n\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n6.2.1 Statistical Conclusion\nThe Monte Carlo simulation for Geary’s C shows: - Observed Geary C: 0.6907 - Observed rank: 1 (lowest among all simulations) - P-value: 0.001\nThis confirms significant positive spatial autocorrelation (clustering of similar values)."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-the-monte-carlo-gearys-c",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-the-monte-carlo-gearys-c",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "6.3 Visualising the Monte Carlo Geary’s C",
    "text": "6.3 Visualising the Monte Carlo Geary’s C\nNext, we will plot a histogram to reveal the distribution of the simulated values.\n\n\nShow code\n# Calculate mean and variance\nmean(bperm_c$res[1:999])\n\n\n[1] 1.004402\n\n\nShow code\nvar(bperm_c$res[1:999])\n\n\n[1] 0.007436493\n\n\nShow code\n# Summary statistics\nsummary(bperm_c$res[1:999])\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\nShow code\n# Create histogram\nhist(bperm_c$res, \n     freq = TRUE, \n     breaks = 20, \n     xlab = \"Simulated Geary's C\", \n     main = \"Distribution of Monte Carlo Geary's C\",\n     col = \"lightgreen\",\n     xlim = c(0.6, 1.3))\nabline(v = 1, \n       col = \"red\", \n       lty = 2)\nabline(v = bperm_c$statistic, \n       col = \"red\", \n       lwd = 2)\nlegend(\"topleft\", \n       legend = c(\"Observed\", \"Expected\"), \n       col = c(\"red\", \"red\"), \n       lty = c(1, 2), \n       lwd = c(2, 1))\n\n\n\n\n\n\n\n\n\n\n6.3.1 Statistical Observation\nThe histogram shows: - The distribution of simulated Geary’s C values is centered around 1.004 - The observed value (0.6907) is in the extreme left tail - This provides strong visual evidence of positive spatial autocorrelation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-morans-i-correlogram",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-morans-i-correlogram",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "7.1 Compute Moran’s I correlogram",
    "text": "7.1 Compute Moran’s I correlogram\nIn the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used is Moran’s I.\n\n\nShow code\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order = 6, \n                          method = \"I\", \n                          style = \"W\")\nplot(MI_corr)\n\n\n\n\n\n\n\n\n\nBy plotting the output might not allow us to provide complete interpretation. Hence, it is important to examine the full analysis report.\n\n\nShow code\nprint(MI_corr)\n\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n7.1.1 Statistical Observation\nThe Moran’s I correlogram shows: - Lag 1-2: Significant positive spatial autocorrelation (p &lt; 0.001) - Lag 3: Weakly significant positive autocorrelation (p = 0.04) - Lag 4: No significant autocorrelation (p = 0.226) - Lag 5: Significant negative spatial autocorrelation (p &lt; 0.001) - Lag 6: Significant negative spatial autocorrelation (p &lt; 0.01)\nThis pattern suggests that spatial clustering is strongest at immediate neighbors (lag 1-2), weakens at intermediate distances, and becomes negative (dissimilar values) at greater distances."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-gearys-c-correlogram-and-plot",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-gearys-c-correlogram-and-plot",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "7.2 Compute Geary’s C correlogram and plot",
    "text": "7.2 Compute Geary’s C correlogram and plot\nIn the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used is Geary’s C.\n\n\nShow code\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order = 6, \n                          method = \"C\", \n                          style = \"W\")\nplot(GC_corr)\n\n\n\n\n\n\n\n\n\nSimilar to the previous step, we will print out the analysis report.\n\n\nShow code\nprint(GC_corr)\n\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n7.2.1 Statistical Observation\nThe Geary’s C correlogram shows: - Lag 1-2: Significant positive spatial autocorrelation (C &lt; 1, p &lt; 0.001) - Lag 3-4: No significant autocorrelation (C ≈ 1, p &gt; 0.05) - Lag 5: Significant negative spatial autocorrelation (C &gt; 1, p &lt; 0.001) - Lag 6: No significant autocorrelation\nThis pattern confirms the Moran’s I findings: strong local clustering that weakens with distance and becomes negative at lag 5."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to perform spatially constrained clustering using Myanmar township data. We will explore three clustering methods:\n\nHierarchical clustering (non-spatial)\nSKATER (Spatial ’K’luster Analysis by Tree Edge Removal)\nClustGeo (Hierarchical clustering with spatial constraints)\n\nThe analysis focuses on ICT (Information and Communication Technology) development patterns in Shan State, Myanmar."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#overview",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to perform spatially constrained clustering using Myanmar township data. We will explore three clustering methods:\n\nHierarchical clustering (non-spatial)\nSKATER (Spatial ’K’luster Analysis by Tree Edge Removal)\nClustGeo (Hierarchical clustering with spatial constraints)\n\nThe analysis focuses on ICT (Information and Communication Technology) development patterns in Shan State, Myanmar."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#getting-started",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "2. Getting Started",
    "text": "2. Getting Started\n\n2.1 Loading Required Packages\n\npacman::p_load(sf, tidyverse, tmap, spdep, cluster, \n               ClustGeo, heatmaply, GGally, \n               factoextra, NbClust, corrplot, \n               ggpubr, plotly, psych, DT)\n\n\n\n2.2 Data Import\n\n2.2.1 Import Geospatial Data\n\n# Import Myanmar township boundaries\nmyanmar_sf &lt;- st_read(dsn = \"data/geospatial\", \n                       layer = \"myanmar_township_boundaries\",\n                       quiet = TRUE) %&gt;%\n  st_transform(crs = 32647)  # Transform to UTM Zone 47N for Myanmar\n\n# Check the data structure\nglimpse(myanmar_sf)\n\nRows: 330\nColumns: 15\n$ OBJECTID   &lt;dbl&gt; 250, 163, 96, 147, 263, 167, 25, 300, 284, 148, 232, 29, 20…\n$ ST         &lt;chr&gt; \"Kachin\", \"Shan (North)\", \"Bago (East)\", \"Bago (West)\", \"Ma…\n$ ST_PCODE   &lt;chr&gt; \"MMR001\", \"MMR015\", \"MMR007\", \"MMR008\", \"MMR010\", \"MMR001\",…\n$ DT         &lt;chr&gt; \"Mohnyin\", \"Mongmit\", \"Bago\", \"Pyay\", \"Pyinoolwin\", \"Bhamo\"…\n$ DT_PCODE   &lt;chr&gt; \"MMR001D002\", \"MMR015D008\", \"MMR007D001\", \"MMR008D001\", \"MM…\n$ TS         &lt;chr&gt; \"Hpakant\", \"Mongmit\", \"Waw\", \"Paukkhaung\", \"Mogoke\", \"Shweg…\n$ TS_PCODE   &lt;chr&gt; \"MMR001009\", \"MMR015017\", \"MMR007004\", \"MMR008002\", \"MMR010…\n$ ST_2       &lt;chr&gt; \"Kachin State\", \"Shan State (North)\", \"Bago Region (East)\",…\n$ LABEL2     &lt;chr&gt; \"Hpakant\\n169795\", \"Mongmit\\n61072\", \"Waw\\n199032\", \"Paukkh…\n$ SELF_ADMIN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"Danu\", \"Da…\n$ ST_RG      &lt;chr&gt; \"State\", \"State\", \"Region\", \"Region\", \"Region\", \"State\", \"R…\n$ T_NAME_WIN &lt;chr&gt; \"zm;uefU\", \"rdk;rdwf\", \"a0g\", \"aygufacgif;\", \"rdk;ukwf\", \"a…\n$ T_NAME_M3  &lt;chr&gt; \"ဖားကန့်\", \"မိုးမိတ်\", \"ဝေါ\", \"ပေါက်ခေါင်း\", \"မိုးကုတ်\", \"ရွှေကူ\", \"ကျောက်ကြီး\", \"သုံ…\n$ AREA       &lt;dbl&gt; 5761.29637, 2703.61143, 952.43979, 1918.67341, 1178.50763, …\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((215945.2 28..., MULTIPOLYGON (…\n\n# Display first few rows\nhead(myanmar_sf, n = 3)\n\nSimple feature collection with 3 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 194025.7 ymin: 1919833 xmax: 303401 ymax: 2893747\nProjected CRS: WGS 84 / UTM zone 47N\n  OBJECTID           ST ST_PCODE      DT   DT_PCODE      TS  TS_PCODE\n1      250       Kachin   MMR001 Mohnyin MMR001D002 Hpakant MMR001009\n2      163 Shan (North)   MMR015 Mongmit MMR015D008 Mongmit MMR015017\n3       96  Bago (East)   MMR007    Bago MMR007D001     Waw MMR007004\n                ST_2          LABEL2 SELF_ADMIN  ST_RG T_NAME_WIN T_NAME_M3\n1       Kachin State Hpakant\\n169795       &lt;NA&gt;  State    zm;uefU     ဖားကန့်\n2 Shan State (North)  Mongmit\\n61072       &lt;NA&gt;  State   rdk;rdwf      မိုးမိတ်\n3 Bago Region (East)     Waw\\n199032       &lt;NA&gt; Region        a0g       ဝေါ\n       AREA                       geometry\n1 5761.2964 MULTIPOLYGON (((215945.2 28...\n2 2703.6114 MULTIPOLYGON (((291179.2 25...\n3  952.4398 MULTIPOLYGON (((246886.7 19...\n\n\n\n\n2.2.2 Import ICT Indicator Data\n\n# Read ICT data\nict &lt;- read_csv(\"data/aspatial/Shan-ICT.csv\",\n                show_col_types = FALSE)\n\n# Check data structure\nglimpse(ict)\n\nRows: 55\nColumns: 11\n$ `District Pcode`   &lt;chr&gt; \"MMR014D001\", \"MMR014D001\", \"MMR014D001\", \"MMR014D0…\n$ `District Name`    &lt;chr&gt; \"Taunggyi\", \"Taunggyi\", \"Taunggyi\", \"Taunggyi\", \"Ta…\n$ `Township Pcode`   &lt;chr&gt; \"MMR014001\", \"MMR014002\", \"MMR014003\", \"MMR014004\",…\n$ `Township Name`    &lt;chr&gt; \"Taunggyi\", \"Nyaungshwe\", \"Hopong\", \"Hsihseng\", \"Ka…\n$ `Total households` &lt;dbl&gt; 82604, 42634, 24728, 32771, 41341, 17544, 18348, 25…\n$ Radio              &lt;dbl&gt; 30176, 13801, 5083, 8087, 11607, 7324, 8890, 10048,…\n$ Television         &lt;dbl&gt; 62388, 23640, 11272, 16568, 25285, 8862, 4781, 1635…\n$ `Land line phone`  &lt;dbl&gt; 6736, 810, 799, 1042, 1739, 348, 219, 818, 728, 800…\n$ `Mobile phone`     &lt;dbl&gt; 48461, 14973, 5192, 4755, 16900, 2849, 2207, 8321, …\n$ Computer           &lt;dbl&gt; 6705, 669, 358, 325, 1225, 226, 81, 565, 351, 381, …\n$ `Internet at home` &lt;dbl&gt; 9746, 1604, 631, 580, 1741, 136, 152, 556, 737, 316…\n\n# Display summary statistics\nsummary(ict[,5:11])  # Assuming ICT indicators are in columns 5-11\n\n Total households     Radio         Television    Land line phone \n Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685    Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  \n  Mobile phone      Computer      Internet at home\n Min.   :  150   Min.   :  20.0   Min.   :   8.0  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  \n Median : 3559   Median : 244.0   Median : 316.0  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#data-wrangling",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#data-wrangling",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "3. Data Wrangling",
    "text": "3. Data Wrangling\n\n3.1 Extract Shan State\n\n# Filter townships in Shan State\nshan_sf &lt;- myanmar_sf %&gt;%\n  filter(ST %in% c(\"Shan (East)\", \"Shan (North)\", \"Shan (South)\"))\n\n# Check the result\ncat(\"Number of townships in Shan State:\", nrow(shan_sf), \"\\n\")\n\nNumber of townships in Shan State: 55 \n\nunique(shan_sf$ST)\n\n[1] \"Shan (North)\" \"Shan (South)\" \"Shan (East)\" \n\n# Plot to verify\ntmap_mode(\"plot\")\ntm_shape(shan_sf) +\n  tm_polygons(\"ST\", \n              palette = \"Set2\",\n              title = \"Shan State\") +\n  tm_layout(main.title = \"Townships in Shan State, Myanmar\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n3.2 Join Geospatial and Aspatial Data\n\n# Prepare join key - ensure column names match\n# Check column names first\ncat(\"Shapefile columns:\\n\")\n\nShapefile columns:\n\nprint(names(shan_sf))\n\n [1] \"OBJECTID\"   \"ST\"         \"ST_PCODE\"   \"DT\"         \"DT_PCODE\"  \n [6] \"TS\"         \"TS_PCODE\"   \"ST_2\"       \"LABEL2\"     \"SELF_ADMIN\"\n[11] \"ST_RG\"      \"T_NAME_WIN\" \"T_NAME_M3\"  \"AREA\"       \"geometry\"  \n\ncat(\"\\nICT data columns:\\n\")\n\n\nICT data columns:\n\nprint(names(ict))\n\n [1] \"District Pcode\"   \"District Name\"    \"Township Pcode\"   \"Township Name\"   \n [5] \"Total households\" \"Radio\"            \"Television\"       \"Land line phone\" \n [9] \"Mobile phone\"     \"Computer\"         \"Internet at home\"\n\n# Perform the join - 注意列名有空格！\n# TS_PCODE in shapefile matches with \"Township Pcode\" in ICT data\nshan_ict &lt;- left_join(shan_sf, \n                      ict, \n                      by = c(\"TS_PCODE\" = \"Township Pcode\"))\n\n# Alternative: 如果上面的还是不行，可以先重命名ICT的列\n# ict &lt;- ict %&gt;%\n#   rename(TS_PCODE = `Township Pcode`,\n#          DT_PCODE = `District Pcode`,\n#          Total_households = `Total households`,\n#          Land_line_phone = `Land line phone`,\n#          Mobile_phone = `Mobile phone`,\n#          Internet_at_home = `Internet at home`)\n# \n# shan_ict &lt;- left_join(shan_sf, ict, by = \"TS_PCODE\")\n\n# Check for missing values after join\nmissing_check &lt;- shan_ict %&gt;%\n  st_drop_geometry() %&gt;%\n  select(Radio, Television, \n         `Land line phone`, `Mobile phone`, \n         Computer, `Internet at home`) %&gt;%\n  summarise_all(~sum(is.na(.)))\n\nprint(\"Missing values in ICT columns:\")\n\n[1] \"Missing values in ICT columns:\"\n\nprint(missing_check)\n\n  Radio Television Land line phone Mobile phone Computer Internet at home\n1     0          0               0            0        0                0\n\n# Check if join was successful\ncat(\"\\nNumber of rows after join:\", nrow(shan_ict), \"\\n\")\n\n\nNumber of rows after join: 55 \n\ncat(\"Number of townships with ICT data:\", \n    sum(!is.na(shan_ict$Radio)), \"\\n\")\n\nNumber of townships with ICT data: 55 \n\n\n\n\n3.3 Derive ICT Penetration Rates\n\n# Calculate penetration rates (per 1000 households)\n# 注意列名有空格，需要使用反引号\nshan_ict &lt;- shan_ict %&gt;%\n  mutate(\n    RADIO_PR = Radio / `Total households` * 1000,\n    TV_PR = Television / `Total households` * 1000,\n    LLPHONE_PR = `Land line phone` / `Total households` * 1000,\n    MOBILE_PR = `Mobile phone` / `Total households` * 1000,\n    COMPUTER_PR = Computer / `Total households` * 1000,\n    INTERNET_PR = `Internet at home` / `Total households` * 1000\n  )\n\n# Check the calculated rates\nsummary(shan_ict[c(\"RADIO_PR\", \"TV_PR\", \"LLPHONE_PR\", \n                   \"MOBILE_PR\", \"COMPUTER_PR\", \"INTERNET_PR\")])\n\n    RADIO_PR          TV_PR         LLPHONE_PR       MOBILE_PR     \n Min.   : 21.05   Min.   :116.0   Min.   :  2.78   Min.   : 36.42  \n 1st Qu.:138.95   1st Qu.:450.2   1st Qu.: 22.84   1st Qu.:190.14  \n Median :210.95   Median :517.2   Median : 37.59   Median :305.27  \n Mean   :215.68   Mean   :509.5   Mean   : 51.09   Mean   :314.05  \n 3rd Qu.:268.07   3rd Qu.:606.4   3rd Qu.: 69.72   3rd Qu.:428.43  \n Max.   :484.52   Max.   :842.5   Max.   :181.49   Max.   :735.43  \n  COMPUTER_PR      INTERNET_PR               geometry \n Min.   : 3.278   Min.   :  1.041   MULTIPOLYGON :55  \n 1st Qu.:11.832   1st Qu.:  8.617   epsg:32647   : 0  \n Median :18.970   Median : 22.829   +proj=utm ...: 0  \n Mean   :24.393   Mean   : 30.644                     \n 3rd Qu.:29.897   3rd Qu.: 41.281                     \n Max.   :92.402   Max.   :117.985                     \n\n# Check for any infinite or NaN values (divide by zero)\ninf_check &lt;- shan_ict %&gt;%\n  st_drop_geometry() %&gt;%\n  select(RADIO_PR:INTERNET_PR) %&gt;%\n  summarise_all(~sum(is.infinite(.))) \n\nnan_check &lt;- shan_ict %&gt;%\n  st_drop_geometry() %&gt;%\n  select(RADIO_PR:INTERNET_PR) %&gt;%\n  summarise_all(~sum(is.nan(.)))\n\nprint(\"Infinite values:\")\n\n[1] \"Infinite values:\"\n\nprint(inf_check)\n\n  RADIO_PR TV_PR LLPHONE_PR MOBILE_PR COMPUTER_PR INTERNET_PR\n1        0     0          0         0           0           0\n\nprint(\"NaN values:\")\n\n[1] \"NaN values:\"\n\nprint(nan_check)\n\n  RADIO_PR TV_PR LLPHONE_PR MOBILE_PR COMPUTER_PR INTERNET_PR\n1        0     0          0         0           0           0\n\n\n\n\n3.4 Data Cleaning\n\n# Save the complete dataset first\nwrite_rds(shan_ict, \"data/rds/shan_ict_complete.rds\")\n\n# Remove rows with missing values in penetration rates\nshan_ict_clean &lt;- shan_ict %&gt;%\n  filter(complete.cases(RADIO_PR, TV_PR, LLPHONE_PR, \n                        MOBILE_PR, COMPUTER_PR, INTERNET_PR))\n\ncat(\"Rows before cleaning:\", nrow(shan_ict), \"\\n\")\n\nRows before cleaning: 55 \n\ncat(\"Rows after cleaning:\", nrow(shan_ict_clean), \"\\n\")\n\nRows after cleaning: 55 \n\ncat(\"Rows removed:\", nrow(shan_ict) - nrow(shan_ict_clean), \"\\n\")\n\nRows removed: 0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#exploratory-data-analysis",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#exploratory-data-analysis",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "4. Exploratory Data Analysis",
    "text": "4. Exploratory Data Analysis\n\n4.1 Statistical Summary\n\n# Create summary table for ICT indicators\nict_vars &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  select(RADIO_PR, TV_PR, LLPHONE_PR, MOBILE_PR, COMPUTER_PR, INTERNET_PR)\n\n# Summary statistics\ndescribe(ict_vars)\n\n            vars  n   mean     sd median trimmed    mad    min    max  range\nRADIO_PR       1 55 215.68 105.36 210.95  209.36  99.53  21.05 484.52 463.47\nTV_PR          2 55 509.49 159.40 517.25  515.08 124.43 116.03 842.53 726.50\nLLPHONE_PR     3 55  51.09  40.71  37.59   45.17  27.56   2.78 181.49 178.71\nMOBILE_PR      4 55 314.05 175.67 305.27  303.29 177.50  36.42 735.43 699.01\nCOMPUTER_PR    5 55  24.39  20.52  18.97   20.68  13.03   3.28  92.40  89.12\nINTERNET_PR    6 55  30.64  28.58  22.83   26.20  23.20   1.04 117.98 116.94\n             skew kurtosis    se\nRADIO_PR     0.48    -0.27 14.21\nTV_PR       -0.38    -0.23 21.49\nLLPHONE_PR   1.37     1.49  5.49\nMOBILE_PR    0.48    -0.34 23.69\nCOMPUTER_PR  1.80     2.96  2.77\nINTERNET_PR  1.32     1.24  3.85\n\n\n\n\n4.2 Distribution of ICT Indicators\n\n# Create histogram for each ICT indicator\nict_long &lt;- ict_vars %&gt;%\n  pivot_longer(everything(), \n               names_to = \"ICT_Type\", \n               values_to = \"Rate\")\n\np1 &lt;- ggplot(ict_long, aes(x = Rate)) +\n  geom_histogram(bins = 20, fill = \"steelblue\", color = \"white\") +\n  facet_wrap(~ ICT_Type, scales = \"free\", ncol = 3) +\n  theme_minimal() +\n  labs(title = \"Distribution of ICT Penetration Rates\",\n       subtitle = \"Per 1000 households\",\n       x = \"Penetration Rate\", y = \"Frequency\")\n\nprint(p1)\n\n\n\n\n\n\n\n\n\n\n4.3 Correlation Analysis\n\n# Correlation matrix\ncor_matrix &lt;- cor(ict_vars, use = \"complete.obs\")\ncorrplot(cor_matrix, \n         method = \"circle\", \n         type = \"upper\", \n         order = \"hclust\",\n         tl.col = \"black\",\n         tl.srt = 45,\n         title = \"Correlation Matrix of ICT Indicators\",\n         mar = c(0,0,2,0))\n\n\n\n\n\n\n\n\n\n\n4.4 Spatial Distribution\n\n# Create maps for each ICT indicator\ntmap_mode(\"plot\")\n\ntm1 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"RADIO_PR\", \n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"Radio\") +\n  tm_layout(main.title = \"Radio Penetration\",\n            main.title.size = 0.8)\n\ntm2 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"TV_PR\",\n              style = \"quantile\", \n              palette = \"Greens\",\n              title = \"Television\") +\n  tm_layout(main.title = \"TV Penetration\",\n            main.title.size = 0.8)\n\ntm3 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"MOBILE_PR\",\n              style = \"quantile\",\n              palette = \"Oranges\",\n              title = \"Mobile Phone\") +\n  tm_layout(main.title = \"Mobile Penetration\",\n            main.title.size = 0.8)\n\ntm4 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"INTERNET_PR\",\n              style = \"quantile\",\n              palette = \"Purples\",\n              title = \"Internet\") +\n  tm_layout(main.title = \"Internet Penetration\",\n            main.title.size = 0.8)\n\ntmap_arrange(tm1, tm2, tm3, tm4, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#hierarchical-clustering-non-spatial",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#hierarchical-clustering-non-spatial",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "5. Hierarchical Clustering (Non-Spatial)",
    "text": "5. Hierarchical Clustering (Non-Spatial)\n\n5.1 Data Preparation\n\n# Extract clustering variables\ncluster_vars &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  select(TS_PCODE, RADIO_PR, TV_PR, LLPHONE_PR, \n         MOBILE_PR, COMPUTER_PR, INTERNET_PR) %&gt;%\n  column_to_rownames(\"TS_PCODE\")\n\n# Check for any remaining NA values\nif(any(is.na(cluster_vars))) {\n  cat(\"Warning: NA values found. Removing incomplete cases.\\n\")\n  cluster_vars &lt;- na.omit(cluster_vars)\n}\n\n# Standardize the variables\ncluster_vars_scaled &lt;- scale(cluster_vars)\nsummary(cluster_vars_scaled)\n\n    RADIO_PR            TV_PR            LLPHONE_PR        MOBILE_PR       \n Min.   :-1.84729   Min.   :-2.46839   Min.   :-1.1867   Min.   :-1.58041  \n 1st Qu.:-0.72823   1st Qu.:-0.37192   1st Qu.:-0.6939   1st Qu.:-0.70539  \n Median :-0.04483   Median : 0.04865   Median :-0.3317   Median :-0.05001  \n Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000  \n 3rd Qu.: 0.49724   3rd Qu.: 0.60794   3rd Qu.: 0.4577   3rd Qu.: 0.65107  \n Max.   : 2.55176   Max.   : 2.08932   Max.   : 3.2033   Max.   : 2.39865  \n  COMPUTER_PR       INTERNET_PR     \n Min.   :-1.0292   Min.   :-1.0357  \n 1st Qu.:-0.6123   1st Qu.:-0.7706  \n Median :-0.2643   Median :-0.2734  \n Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.: 0.2683   3rd Qu.: 0.3722  \n Max.   : 3.3149   Max.   : 3.0558  \n\n\n\n\n5.2 Computing Distance Matrix\n\n# Compute Euclidean distance\ndist_matrix &lt;- dist(cluster_vars_scaled, method = \"euclidean\")\n\n\n\n5.3 Hierarchical Clustering\n\n# Perform hierarchical clustering using Ward method\nhclust_ward &lt;- hclust(dist_matrix, method = \"ward.D2\")\n\n# Plot dendrogram\nplot(hclust_ward, cex = 0.6, hang = -1,\n     main = \"Hierarchical Clustering Dendrogram (Ward Method)\",\n     xlab = \"Township\", sub = \"\")\n\n\n\n\n\n\n\n\n\n\n5.4 Determine Optimal Number of Clusters\n\n# Elbow method\nfviz_nbclust(cluster_vars_scaled, \n             FUN = hcut, \n             method = \"wss\",\n             k.max = 10) +\n  labs(title = \"Elbow Method for Optimal Clusters\")\n\n\n\n\n\n\n\n# Silhouette method\nfviz_nbclust(cluster_vars_scaled,\n             FUN = hcut,\n             method = \"silhouette\",\n             k.max = 10) +\n  labs(title = \"Silhouette Method for Optimal Clusters\")\n\n\n\n\n\n\n\n\n\n\n5.5 Cutting the Dendrogram\n\n# Cut tree to form 5 clusters (adjust based on optimal k)\ngroups &lt;- cutree(hclust_ward, k = 5)\n\n# Add cluster membership to data\nshan_ict_clean$CLUSTER_HC &lt;- as.factor(groups[rownames(cluster_vars)])\n\n# Summary of clusters\ntable(shan_ict_clean$CLUSTER_HC)\n\n\n 1  2  3  4  5 \n21 12  6  9  7 \n\n\n\n\n5.6 Visualize Clustering Results\n\n# Plot dendrogram with cluster boxes\nplot(hclust_ward, cex = 0.6, hang = -1,\n     main = \"Hierarchical Clustering with 5 Clusters\")\nrect.hclust(hclust_ward, k = 5, border = 2:6)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---skater",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---skater",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "6. Spatially Constrained Clustering - SKATER",
    "text": "6. Spatially Constrained Clustering - SKATER\n\n6.1 Create Spatial Neighbors\n\n# Create spatial neighbors using Queen contiguity\ncoords &lt;- st_coordinates(st_centroid(shan_ict_clean))\nk_neighbors &lt;- knn2nb(knearneigh(coords, k = 6), \n                      row.names = shan_ict_clean$TS_PCODE)\n\n# Convert to neighbor list\nnb_queen &lt;- poly2nb(shan_ict_clean, queen = TRUE)\n\n# Check neighbor summary\nsummary(nb_queen)\n\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\n\n\n\n6.2 Calculate Edge Costs\n\n# Calculate edge costs based on dissimilarity\nlcosts &lt;- nbcosts(nb_queen, cluster_vars_scaled)\n\n# Create weights object\nnb_weights &lt;- nb2listw(nb_queen, \n                       lcosts, \n                       style = \"B\")\n\n# Check the weights\nsummary(unlist(nb_weights$weights))\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.551   1.495   2.390   2.709   3.680   6.587 \n\n\n\n\n6.3 Compute Minimum Spanning Tree\n\n# Create minimum spanning tree\nshan_mst &lt;- mstree(nb_weights)\n\n# Check MST\nclass(shan_mst)\n\n[1] \"mst\"    \"matrix\"\n\ndim(shan_mst)\n\n[1] 54  3\n\nhead(shan_mst)\n\n     [,1] [,2]      [,3]\n[1,]   31   25 1.4792876\n[2,]   25   17 1.1421910\n[3,]   17   54 0.7990177\n[4,]   54   48 0.5509777\n[5,]   54   45 1.1720984\n[6,]   25   55 1.3030189\n\n\n\n\n6.4 SKATER Clustering\n\n# Perform SKATER clustering\nskater_result &lt;- skater(edges = shan_mst[,1:2], \n                        data = cluster_vars_scaled, \n                        ncuts = 4)  # Creates 5 clusters\n\n# Extract cluster membership\nshan_ict_clean$CLUSTER_SKATER &lt;- as.factor(skater_result$groups)\n\n# Summary of SKATER clusters\ntable(shan_ict_clean$CLUSTER_SKATER)\n\n\n 1  2  3  4  5 \n12 14  5 12 12 \n\n\n\n\n6.5 Visualize SKATER Results\n\n# Plot SKATER clustering results\ntm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_SKATER\",\n              palette = \"Set2\",\n              title = \"SKATER Clusters\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Spatially Constrained Clustering (SKATER)\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---clustgeo",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---clustgeo",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "7. Spatially Constrained Clustering - ClustGeo",
    "text": "7. Spatially Constrained Clustering - ClustGeo\n\n7.1 Calculate Distance Matrices\n\n# Non-spatial distance matrix (attribute distance)\ndist_attrib &lt;- dist(cluster_vars_scaled)\n\n# Spatial distance matrix\ndist_spatial &lt;- st_distance(shan_ict_clean, shan_ict_clean)\ndist_spatial &lt;- as.dist(as.matrix(dist_spatial))\n\n\n\n7.2 Determine Optimal Alpha\n\n# Test different alpha values\nalpha_values &lt;- seq(0, 1, 0.1)\nclustgeo_results &lt;- list()\n\nfor(alpha in alpha_values) {\n  clustgeo_results[[as.character(alpha)]] &lt;- \n    hclustgeo(D0 = dist_attrib, \n              D1 = dist_spatial, \n              alpha = alpha)\n}\n\n# Create plot to choose optimal alpha\nchoicealpha(D0 = dist_attrib, \n            D1 = dist_spatial, \n            range.alpha = alpha_values, \n            K = 5, \n            graph = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n$Q\n                 Q0        Q1\nalpha=0   0.6651705 0.2614688\nalpha=0.1 0.6638556 0.3168636\nalpha=0.2 0.6422151 0.4568419\nalpha=0.3 0.5751905 0.5122824\nalpha=0.4 0.4905858 0.6599012\nalpha=0.5 0.3775200 0.8468879\nalpha=0.6 0.3299302 0.8898670\nalpha=0.7 0.3242517 0.8835126\nalpha=0.8 0.2773430 0.9027532\nalpha=0.9 0.2761906 0.9023238\nalpha=1   0.1153535 0.9184389\n\n$Qnorm\n             Q0norm    Q1norm\nalpha=0   1.0000000 0.2846883\nalpha=0.1 0.9980232 0.3450024\nalpha=0.2 0.9654895 0.4974113\nalpha=0.3 0.8647264 0.5577751\nalpha=0.4 0.7375340 0.7185031\nalpha=0.5 0.5675537 0.9220950\nalpha=0.6 0.4960084 0.9688909\nalpha=0.7 0.4874715 0.9619721\nalpha=0.8 0.4169503 0.9829214\nalpha=0.9 0.4152178 0.9824539\nalpha=1   0.1734194 1.0000000\n\n$range.alpha\n [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\n\n$K\n[1] 5\n\nattr(,\"class\")\n[1] \"choicealpha\"\n\n\n\n\n7.3 ClustGeo with Optimal Alpha\n\n# Perform ClustGeo with optimal alpha (example: 0.3)\nclustgeo_final &lt;- hclustgeo(D0 = dist_attrib,\n                            D1 = dist_spatial,\n                            alpha = 0.3)\n\n# Cut tree to get clusters\nshan_ict_clean$CLUSTER_GEO &lt;- as.factor(cutree(clustgeo_final, k = 5))\n\n# Summary\ntable(shan_ict_clean$CLUSTER_GEO)\n\n\n 1  2  3  4  5 \n 7 19  9 13  7 \n\n\n\n\n7.4 Visualize ClustGeo Results\n\n# Map ClustGeo results\ntm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_GEO\",\n              palette = \"Set3\",\n              title = \"ClustGeo Clusters\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"ClustGeo Clustering (α = 0.3)\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#cluster-evaluation-and-comparison",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#cluster-evaluation-and-comparison",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "8. Cluster Evaluation and Comparison",
    "text": "8. Cluster Evaluation and Comparison\n\n8.1 Compare All Three Methods\n\n# Create comparison maps\ntm1 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_HC\",\n              palette = \"Set2\",\n              title = \"Clusters\") +\n  tm_layout(main.title = \"Hierarchical\",\n            main.title.size = 0.9,\n            legend.position = c(\"right\", \"bottom\"))\n\ntm2 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_SKATER\",\n              palette = \"Set2\",\n              title = \"Clusters\") +\n  tm_layout(main.title = \"SKATER\",\n            main.title.size = 0.9,\n            legend.position = c(\"right\", \"bottom\"))\n\ntm3 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_GEO\",\n              palette = \"Set2\",\n              title = \"Clusters\") +\n  tm_layout(main.title = \"ClustGeo\",\n            main.title.size = 0.9,\n            legend.position = c(\"right\", \"bottom\"))\n\ntmap_arrange(tm1, tm2, tm3, ncol = 3)\n\n\n\n\n\n\n\n\n\n\n8.2 Cluster Profiles\n\n# Calculate mean values for each cluster\ncluster_profiles_hc &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(CLUSTER_HC) %&gt;%\n  summarise(across(c(RADIO_PR, TV_PR, LLPHONE_PR, \n                     MOBILE_PR, COMPUTER_PR, INTERNET_PR), \n                   mean, na.rm = TRUE)) %&gt;%\n  mutate(Method = \"Hierarchical\")\n\ncluster_profiles_skater &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(CLUSTER_SKATER) %&gt;%\n  summarise(across(c(RADIO_PR, TV_PR, LLPHONE_PR, \n                     MOBILE_PR, COMPUTER_PR, INTERNET_PR), \n                   mean, na.rm = TRUE)) %&gt;%\n  mutate(Method = \"SKATER\") %&gt;%\n  rename(Cluster = CLUSTER_SKATER)\n\ncluster_profiles_geo &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(CLUSTER_GEO) %&gt;%\n  summarise(across(c(RADIO_PR, TV_PR, LLPHONE_PR, \n                     MOBILE_PR, COMPUTER_PR, INTERNET_PR), \n                   mean, na.rm = TRUE)) %&gt;%\n  mutate(Method = \"ClustGeo\") %&gt;%\n  rename(Cluster = CLUSTER_GEO)\n\n# Display profiles\nknitr::kable(cluster_profiles_hc, \n             caption = \"Hierarchical Clustering Profiles\",\n             digits = 2)\n\n\nHierarchical Clustering Profiles\n\n\n\n\n\n\n\n\n\n\n\n\nCLUSTER_HC\nRADIO_PR\nTV_PR\nLLPHONE_PR\nMOBILE_PR\nCOMPUTER_PR\nINTERNET_PR\nMethod\n\n\n\n\n1\n287.84\n522.12\n39.25\n230.40\n16.04\n19.83\nHierarchical\n\n\n2\n201.92\n534.75\n38.27\n349.40\n30.06\n45.32\nHierarchical\n\n\n3\n248.33\n724.83\n82.95\n590.22\n72.54\n95.67\nHierarchical\n\n\n4\n139.32\n260.41\n18.94\n161.24\n7.00\n5.14\nHierarchical\n\n\n5\n92.95\n563.97\n122.60\n464.18\n20.85\n14.97\nHierarchical\n\n\n\n\n\n\n\n8.3 Interactive Heatmap\n\n# 期望使用的列名与友好展示名\ncol_map &lt;- c(\n  RADIO_PR    = \"Radio\",\n  TV_PR       = \"TV\",\n  LLPHONE_PR  = \"Landline\",\n  MOBILE_PR   = \"Mobile\",\n  COMPUTER_PR = \"Computer\",\n  INTERNET_PR = \"Internet\"\n)\n\n# ---- 1) 预处理：容错处理列名/类型 ----\nstopifnot(\"shan_ict_clean\" %in% ls())\n\ndat &lt;- shan_ict_clean\n\n# 兼容：若存在 LANDLINE_PR 列但没有 LLPHONE_PR，则做别名\nif (!\"LLPHONE_PR\" %in% names(dat) && \"LANDLINE_PR\" %in% names(dat)) {\n  dat &lt;- dplyr::mutate(dat, LLPHONE_PR = .data$LANDLINE_PR)\n}\n\n# 需要的列中，哪些真实存在\ncols_present &lt;- intersect(names(col_map), names(dat))\n\n# 如果一个都没有，给出提示并优雅退出本节绘图\nif (length(cols_present) == 0L) {\n  cat(\"**Note:** No ICT rate columns found in data. Skipping cluster summary/plot.\\n\")\n} else {\n  # 分群列检查\n  if (!\"CLUSTER_HC\" %in% names(dat)) {\n    stop(\"Missing `CLUSTER_HC` column. Please create the cluster labels first.\")\n  }\n  dat &lt;- dplyr::mutate(dat, CLUSTER_HC = as.factor(.data$CLUSTER_HC))\n\n  # ---- 2) 汇总表（自动跳过全 NA 列）----\n  # 只保留真的有观测值的列\n  keep_cols &lt;- purrr::map_lgl(cols_present, ~ sum(!is.na(dat[[.x]])) &gt; 0)\n  cols_present &lt;- cols_present[keep_cols]\n\n  # 若清洗后列不足 1，同样优雅退出\n  if (length(cols_present) == 0L) {\n    cat(\"**Note:** All ICT rate columns are entirely NA. Skipping cluster summary/plot.\\n\")\n  } else {\n    cluster_summary &lt;- dat |&gt;\n      sf::st_drop_geometry() |&gt;\n      dplyr::group_by(CLUSTER_HC) |&gt;\n      dplyr::summarise(\n        Count = dplyr::n(),\n        dplyr::across(\n          dplyr::all_of(cols_present),\n          ~ round(mean(.x, na.rm = TRUE), 1)\n        ),\n        .groups = \"drop\"\n      )\n\n    # 用友好名重命名（只对实际存在的列）\n    pretty_names &lt;- unname(col_map[cols_present])\n    cluster_summary &lt;- dplyr::rename(\n      cluster_summary,\n      !!!setNames(cols_present, pretty_names)  # new = old\n    )\n\n    # 打印表格\n    knitr::kable(\n      cluster_summary,\n      caption = \"Mean ICT Penetration Rates by Cluster\"\n    )\n\n    # ---- 3) 条形图（长表）----\n    value_cols &lt;- pretty_names  # 已经改成友好名后的列\n    cluster_long &lt;- cluster_summary |&gt;\n      tidyr::pivot_longer(\n        cols = dplyr::any_of(value_cols),\n        names_to = \"ICT_Type\",\n        values_to = \"Rate\"\n      )\n\n    # 若还存在 Rate 全 NA 的情况，过滤掉\n    cluster_long &lt;- dplyr::filter(cluster_long, !is.na(Rate))\n\n    if (nrow(cluster_long) == 0L) {\n      cat(\"**Note:** No non-missing values available for plotting.\\n\")\n    } else {\n      cluster_long$ICT_Type &lt;- factor(\n        cluster_long$ICT_Type,\n        levels = c(\"Radio\",\"TV\",\"Landline\",\"Mobile\",\"Computer\",\"Internet\")\n      )\n\n      ggplot(cluster_long, aes(x = ICT_Type, y = Rate, fill = CLUSTER_HC)) +\n        geom_col(position = \"dodge\") +\n        scale_fill_brewer(palette = \"Set2\") +\n        theme_minimal() +\n        labs(\n          title = \"ICT Penetration by Cluster\",\n          x = NULL, y = \"Mean Penetration (%)\",\n          fill = \"Cluster\"\n        )\n    }\n  }\n}\n\n\n\n\n\n\n\n\n\n\n8.4 Parallel Coordinates Plot\n\n# 准备数据 - 转换为长格式\nparallel_data &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  select(TS_PCODE, CLUSTER_HC, RADIO_PR:INTERNET_PR) %&gt;%\n  mutate(CLUSTER_HC = as.factor(CLUSTER_HC)) %&gt;%\n  # 标准化数据\n  mutate(across(RADIO_PR:INTERNET_PR, scale)) %&gt;%\n  pivot_longer(cols = RADIO_PR:INTERNET_PR,\n               names_to = \"Variable\",\n               values_to = \"Value\")\n\n# 创建变量顺序\nvar_order &lt;- c(\"RADIO_PR\", \"TV_PR\", \"LLPHONE_PR\", \n               \"MOBILE_PR\", \"COMPUTER_PR\", \"INTERNET_PR\")\n\nparallel_data$Variable &lt;- factor(parallel_data$Variable, levels = var_order)\n\n# 绘制平行坐标图\nggplot(parallel_data, aes(x = Variable, y = Value, \n                          group = TS_PCODE, \n                          color = CLUSTER_HC)) +\n  geom_line(alpha = 0.3) +\n  geom_point(alpha = 0.5, size = 0.8) +\n  scale_color_brewer(palette = \"Set1\", name = \"Cluster\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        plot.title = element_text(size = 14, face = \"bold\")) +\n  labs(title = \"Parallel Coordinates Plot - ICT Indicators by Cluster\",\n       x = \"ICT Indicators\",\n       y = \"Standardized Value\") +\n  facet_wrap(~ CLUSTER_HC, ncol = 5)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatial-autocorrelation-test",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatial-autocorrelation-test",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "9. Spatial Autocorrelation Test",
    "text": "9. Spatial Autocorrelation Test\n\n# Test spatial autocorrelation of clusters\n# Convert cluster to numeric for Moran's I test\ncluster_numeric &lt;- as.numeric(shan_ict_clean$CLUSTER_HC)\n\n# Create spatial weights\nw &lt;- nb2listw(nb_queen, style = \"W\", zero.policy = TRUE)\n\n# Moran's I test\nmoran_test &lt;- moran.test(cluster_numeric, w, zero.policy = TRUE)\nprint(moran_test)\n\n\n    Moran I test under randomisation\n\ndata:  cluster_numeric  \nweights: w    \n\nMoran I statistic standard deviate = 3.1314, p-value = 0.0008699\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.255660976      -0.018518519       0.007666402 \n\n# Interpretation\nif(moran_test$p.value &lt; 0.05) {\n  cat(\"\\nSignificant spatial autocorrelation detected (p &lt;\", \n      round(moran_test$p.value, 4), \")\\n\")\n  cat(\"Moran's I:\", round(moran_test$estimate[1], 4), \"\\n\")\n  cat(\"This suggests spatial clustering of the clusters.\\n\")\n} else {\n  cat(\"\\nNo significant spatial autocorrelation detected.\\n\")\n}\n\n\nSignificant spatial autocorrelation detected (p &lt; 9e-04 )\nMoran's I: 0.2557 \nThis suggests spatial clustering of the clusters."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#save-results",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#save-results",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "10. Save Results",
    "text": "10. Save Results\n\n# Save the final dataset with all clustering results\nwrite_rds(shan_ict_clean, \"data/rds/shan_ict_clustered.rds\")\n\n# Create summary table\nsummary_table &lt;- data.frame(\n  Method = c(\"Hierarchical\", \"SKATER\", \"ClustGeo\"),\n  Num_Clusters = c(5, 5, 5),\n  Spatial_Constraint = c(\"No\", \"Yes\", \"Partial\"),\n  Alpha_Parameter = c(NA, NA, 0.3)\n)\n\nknitr::kable(summary_table, \n             caption = \"Summary of Clustering Methods\")\n\n\nSummary of Clustering Methods\n\n\nMethod\nNum_Clusters\nSpatial_Constraint\nAlpha_Parameter\n\n\n\n\nHierarchical\n5\nNo\nNA\n\n\nSKATER\n5\nYes\nNA\n\n\nClustGeo\n5\nPartial\n0.3"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#conclusions",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "11. Conclusions",
    "text": "11. Conclusions\nThis analysis compared three clustering methods for identifying ICT development patterns in Shan State:\n\nHierarchical Clustering: Pure attribute-based clustering without spatial constraints\nSKATER: Fully spatially constrained clustering using minimum spanning tree\nClustGeo: Mixed approach balancing attribute similarity and spatial contiguity\n\n\nKey Findings:\n\nHierarchical clustering may produce spatially fragmented clusters\nSKATER ensures spatial contiguity but may sacrifice attribute homogeneity\nClustGeo provides a balance through the alpha parameter\nICT penetration shows clear spatial patterns across Shan State townships\n\n\n\nRecommendations:\n\nFor policy implementation requiring geographic coherence, SKATER or ClustGeo are preferred\nThe optimal alpha value for ClustGeo should be chosen based on the specific application needs\nConsider local infrastructure and accessibility when interpreting ICT development clusters"
  }
]