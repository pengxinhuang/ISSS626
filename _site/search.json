[
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "",
    "text": "Geographically Weighted Regression (GWR) is a spatial statistical technique that recognizes that traditional “global” regression models may be limited when spatial processes vary across a study area. In this hands-on exercise, we will learn how to build hedonic pricing models using GWR methods to examine the relationships between condo selling prices and various structural and locational characteristics in Singapore.\n\n\nBy the end of this session, you will be able to:\n\nBuild hedonic pricing models using OLS and GWR methods\nCalibrate GWR models using fixed and adaptive bandwidths\nVisualize and interpret GWR outputs\nCompare global and local regression models"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#overview",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "",
    "text": "Geographically Weighted Regression (GWR) is a spatial statistical technique that recognizes that traditional “global” regression models may be limited when spatial processes vary across a study area. In this hands-on exercise, we will learn how to build hedonic pricing models using GWR methods to examine the relationships between condo selling prices and various structural and locational characteristics in Singapore.\n\n\nBy the end of this session, you will be able to:\n\nBuild hedonic pricing models using OLS and GWR methods\nCalibrate GWR models using fixed and adaptive bandwidths\nVisualize and interpret GWR outputs\nCompare global and local regression models"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#the-data",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#the-data",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "2. The Data",
    "text": "2. The Data\nTwo datasets will be used:\n\nURA Master Plan 2014 subzone boundaries (geospatial)\nCondo resale prices 2015 (aspatial)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#getting-started",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "3. Getting Started",
    "text": "3. Getting Started\n\n3.1 Loading Required Packages\n\npacman::p_load(sf, tidyverse, tmap, spdep, GWmodel, \n               ggpubr, corrplot, plotly, \n               olsrr, devtools, parallel)\n\n\n\n3.2 Importing Geospatial Data\n\n# Read Master Plan 2014 Subzone Boundary\nmpsz &lt;- st_read(dsn = \"data/geospatial\", \n                layer = \"MP14_SUBZONE_WEB_PL\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)  # SVY21\n\n# Check the data\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#importing-and-preparing-aspatial-data",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#importing-and-preparing-aspatial-data",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "4. Importing and Preparing Aspatial Data",
    "text": "4. Importing and Preparing Aspatial Data\n\n4.1 Import Condo Resale Data\n\n# Read condo resale data\ncondo_resale &lt;- read_csv(\"data/aspatial/Condo_resale_2015.csv\",\n                         show_col_types = FALSE)\n\n# Check data structure\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n# Check variable names and fix case sensitivity issues\nnames(condo_resale)\n\n [1] \"LATITUDE\"             \"LONGITUDE\"            \"POSTCODE\"            \n [4] \"SELLING_PRICE\"        \"AREA_SQM\"             \"AGE\"                 \n [7] \"PROX_CBD\"             \"PROX_CHILDCARE\"       \"PROX_ELDERLYCARE\"    \n[10] \"PROX_URA_GROWTH_AREA\" \"PROX_HAWKER_MARKET\"   \"PROX_KINDERGARTEN\"   \n[13] \"PROX_MRT\"             \"PROX_PARK\"            \"PROX_PRIMARY_SCH\"    \n[16] \"PROX_TOP_PRIMARY_SCH\" \"PROX_SHOPPING_MALL\"   \"PROX_SUPERMARKET\"    \n[19] \"PROX_BUS_STOP\"        \"NO_Of_UNITS\"          \"FAMILY_FRIENDLY\"     \n[22] \"FREEHOLD\"             \"LEASEHOLD_99YR\"      \n\n# Standardize variable names if needed\nif(\"NO_Of_UNITS\" %in% names(condo_resale)) {\n  condo_resale &lt;- condo_resale %&gt;%\n    rename(NO_OF_UNITS = NO_Of_UNITS)\n}\n\n# Summary statistics\nsummary(condo_resale)\n\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05352   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_OF_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151711   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n\n\n\n\n4.2 Data Preprocessing\n\n# Function to convert factor/character to 0/1\nto01 &lt;- function(x) as.numeric(as.factor(x)) - 1\n\n# Convert binary variables to numeric if they aren't already\ncondo_resale &lt;- condo_resale %&gt;%\n  mutate(\n    FREEHOLD = if(is.numeric(FREEHOLD)) FREEHOLD else to01(FREEHOLD),\n    FAMILY_FRIENDLY = if(is.numeric(FAMILY_FRIENDLY)) FAMILY_FRIENDLY else to01(FAMILY_FRIENDLY),\n    LEASEHOLD_99YR = if(exists(\"LEASEHOLD_99YR\") && !is.numeric(LEASEHOLD_99YR)) to01(LEASEHOLD_99YR) else LEASEHOLD_99YR\n  )\n\n# Check for required variables\nrequired_vars &lt;- c(\"SELLING_PRICE\", \"AREA_SQM\", \"AGE\", \"PROX_CBD\", \"PROX_MRT\")\nstopifnot(all(required_vars %in% names(condo_resale)))\n\n# Remove rows with NA values in key variables\ncondo_resale &lt;- condo_resale %&gt;%\n  drop_na(SELLING_PRICE, AREA_SQM, AGE)\n\n\n\n4.3 Convert Aspatial Data to sf Object\n\n# Convert to sf object using coordinates\ncondo_resale_sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs = 4326) %&gt;%\n  st_transform(crs = 3414)\n\n# Check the result\nhead(condo_resale_sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_OF_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#exploratory-data-analysis",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#exploratory-data-analysis",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "5. Exploratory Data Analysis",
    "text": "5. Exploratory Data Analysis\n\n5.1 Distribution of Selling Prices\n\n# Histogram of selling price\np1 &lt;- ggplot(data = condo_resale, aes(x = SELLING_PRICE)) +\n  geom_histogram(bins = 20, fill = \"lightblue\", color = \"black\") +\n  labs(title = \"Distribution of Selling Prices\",\n       x = \"Selling Price ($)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\n# Log-transformed selling price\np2 &lt;- ggplot(data = condo_resale, \n             aes(x = log(SELLING_PRICE))) +\n  geom_histogram(bins = 20, fill = \"lightgreen\", color = \"black\") +\n  labs(title = \"Distribution of Log Selling Prices\",\n       x = \"Log(Selling Price)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\nggarrange(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n5.2 Geographic Distribution of Condo Sales\n\n# Use plot mode for better performance\ntmap_mode(\"plot\")\n\ntm_shape(mpsz) +\n  tm_polygons(alpha = 0.3) +\ntm_shape(condo_resale_sf) +\n  tm_dots(col = \"SELLING_PRICE\",\n          size = 0.02,  # Reduced size for better visibility\n          border.col = \"black\",\n          border.lwd = 0.5,\n          style = \"quantile\",\n          palette = \"YlOrRd\",\n          title = \"Selling Price\") +\n  tm_layout(main.title = \"Geographic Distribution of Condo Sales\",\n            main.title.size = 1.2)\n\n\n\n\n\n\n\n\n\n\n5.3 Statistical Summary by Variables\n\n# Summary of key variables\ncondo_resale %&gt;%\n  select(SELLING_PRICE, AREA_SQM, AGE, PROX_CBD, \n         PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_MRT,\n         PROX_SHOPPING_MALL, NO_OF_UNITS) %&gt;%\n  summary()\n\n SELLING_PRICE         AREA_SQM          AGE           PROX_CBD      \n Min.   :  540000   Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869  \n 1st Qu.: 1100000   1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574  \n Median : 1383222   Median :121.0   Median :11.00   Median : 9.3567  \n Mean   : 1751211   Mean   :136.5   Mean   :12.14   Mean   : 9.3254  \n 3rd Qu.: 1950000   3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661  \n Max.   :18000000   Max.   :619.0   Max.   :37.00   Max.   :19.1804  \n PROX_CHILDCARE     PROX_ELDERLYCARE     PROX_MRT       PROX_SHOPPING_MALL\n Min.   :0.004927   Min.   :0.05451   Min.   :0.05278   Min.   :0.0000    \n 1st Qu.:0.174481   1st Qu.:0.61254   1st Qu.:0.34646   1st Qu.:0.5258    \n Median :0.258135   Median :0.94179   Median :0.57430   Median :0.9357    \n Mean   :0.326313   Mean   :1.05352   Mean   :0.67316   Mean   :1.0455    \n 3rd Qu.:0.368293   3rd Qu.:1.35122   3rd Qu.:0.84844   3rd Qu.:1.3994    \n Max.   :3.465726   Max.   :3.94916   Max.   :3.48037   Max.   :3.4774    \n  NO_OF_UNITS    \n Min.   :  18.0  \n 1st Qu.: 188.8  \n Median : 360.0  \n Mean   : 409.2  \n 3rd Qu.: 590.0  \n Max.   :1703.0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-model-using-ols",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-model-using-ols",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "6. Building Hedonic Pricing Model using OLS",
    "text": "6. Building Hedonic Pricing Model using OLS\n\n6.1 Simple Linear Regression\n\n# Build simple OLS model with AREA_SQM\ncondo_ols_simple &lt;- lm(SELLING_PRICE ~ AREA_SQM, \n                       data = condo_resale)\nsummary(condo_ols_simple)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n# Visualize the relationship\nggplot(condo_resale, aes(x = AREA_SQM, y = SELLING_PRICE)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", col = \"red\") +\n  labs(title = \"Selling Price vs Floor Area\",\n       x = \"Floor Area (sqm)\",\n       y = \"Selling Price ($)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n6.2 Multiple Linear Regression\n\n# Build multiple regression model with all available variables\ncondo_mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n                  PROX_KINDERGARTEN + PROX_MRT + \n                  PROX_PARK + PROX_PRIMARY_SCH + PROX_TOP_PRIMARY_SCH + \n                  PROX_SHOPPING_MALL + PROX_SUPERMARKET + PROX_BUS_STOP +\n                  NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD + LEASEHOLD_99YR,\n                data = condo_resale)\n\nsummary(condo_mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD + \n    LEASEHOLD_99YR, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3471036  -286903   -22426   239412 12254549 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           543071.4   136210.9   3.987 7.03e-05 ***\nAREA_SQM               12688.7      370.1  34.283  &lt; 2e-16 ***\nAGE                   -24566.0     2766.0  -8.881  &lt; 2e-16 ***\nPROX_CBD              -78122.0     6791.4 -11.503  &lt; 2e-16 ***\nPROX_CHILDCARE       -333219.0   111020.3  -3.001 0.002734 ** \nPROX_ELDERLYCARE      170950.0    42110.8   4.060 5.19e-05 ***\nPROX_URA_GROWTH_AREA   38507.6    12523.7   3.075 0.002147 ** \nPROX_HAWKER_MARKET     23801.2    29299.9   0.812 0.416739    \nPROX_KINDERGARTEN     144098.0    82738.7   1.742 0.081795 .  \nPROX_MRT             -322775.9    58528.1  -5.515 4.14e-08 ***\nPROX_PARK             564487.9    66563.0   8.481  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      186170.5    65515.2   2.842 0.004553 ** \nPROX_TOP_PRIMARY_SCH    -477.1    20598.0  -0.023 0.981525    \nPROX_SHOPPING_MALL   -207721.5    42855.5  -4.847 1.39e-06 ***\nPROX_SUPERMARKET      -48074.7    77145.3  -0.623 0.533273    \nPROX_BUS_STOP         675755.0   138552.0   4.877 1.20e-06 ***\nNO_OF_UNITS             -216.2       90.3  -2.394 0.016797 *  \nFAMILY_FRIENDLY       142128.3    47055.1   3.020 0.002569 ** \nFREEHOLD              300646.5    77296.5   3.890 0.000105 ***\nLEASEHOLD_99YR        -77137.4    77570.9  -0.994 0.320192    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1416 degrees of freedom\nMultiple R-squared:  0.652, Adjusted R-squared:  0.6474 \nF-statistic: 139.6 on 19 and 1416 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n6.3 Check for Multicollinearity\n\n# Prepare numeric data without NA values\nnum_df &lt;- condo_resale %&gt;%\n  select(-LATITUDE, -LONGITUDE, -POSTCODE) %&gt;%\n  select(where(is.numeric)) %&gt;%\n  drop_na()\n\n# Calculate correlation matrix\ncor_matrix &lt;- cor(num_df)\n\n# Plot correlation matrix\ncorrplot(cor_matrix, \n         method = \"circle\", \n         type = \"upper\",\n         diag = FALSE,\n         order = \"hclust\",\n         tl.cex = 0.7,\n         tl.col = \"black\",\n         tl.srt = 45,\n         title = \"Correlation Matrix\")\n\n\n\n\n\n\n\n# VIF check using olsrr\nols_vif_tol(condo_mlr)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8601326 1.162611\n2                   AGE 0.7011585 1.426211\n3              PROX_CBD 0.4575471 2.185567\n4        PROX_CHILDCARE 0.2898233 3.450378\n5      PROX_ELDERLYCARE 0.5922238 1.688551\n6  PROX_URA_GROWTH_AREA 0.6614081 1.511926\n7    PROX_HAWKER_MARKET 0.4373874 2.286303\n8     PROX_KINDERGARTEN 0.8356793 1.196631\n9              PROX_MRT 0.4949877 2.020252\n10            PROX_PARK 0.8015728 1.247547\n11     PROX_PRIMARY_SCH 0.3823248 2.615577\n12 PROX_TOP_PRIMARY_SCH 0.4878620 2.049760\n13   PROX_SHOPPING_MALL 0.4903052 2.039546\n14     PROX_SUPERMARKET 0.6142127 1.628100\n15        PROX_BUS_STOP 0.3311024 3.020213\n16          NO_OF_UNITS 0.6543336 1.528272\n17      FAMILY_FRIENDLY 0.7191719 1.390488\n18             FREEHOLD 0.2728521 3.664990\n19       LEASEHOLD_99YR 0.2645988 3.779307\n\n\n\n\n6.4 Revised Model (Removing Multicollinear Variables)\n\n# Build revised model excluding highly correlated variables\ncondo_mlr2 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n                   PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n                   FREEHOLD,\n                 data = condo_resale)\n\nsummary(condo_mlr2)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n    PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_OF_UNITS + \n    FAMILY_FRIENDLY + FREEHOLD, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\nAREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\nAGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\nPROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\nPROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \nPROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\nPROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\nPROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\nPROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \nPROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\nPROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\nNO_OF_UNITS             -245.48      87.95  -2.791 0.005321 ** \nFAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \nFREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 756000 on 1421 degrees of freedom\nMultiple R-squared:  0.6507,    Adjusted R-squared:  0.6472 \nF-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16\n\nols_vif_tol(condo_mlr2)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_OF_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\n\n\n6.5 Model Diagnostics\n\n# Diagnostic plots\npar(mfrow = c(2, 2))\nplot(condo_mlr2)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Additional diagnostic tests\n# Normality test\nols_test_normality(condo_mlr2)\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n# Breusch-Pagan test for heteroscedasticity\nols_test_breusch_pagan(condo_mlr2)\n\n\n Breusch Pagan Test for Heteroskedasticity\n -----------------------------------------\n Ho: the variance is constant            \n Ha: the variance is not constant        \n\n                  Data                    \n -----------------------------------------\n Response : SELLING_PRICE \n Variables: fitted values of SELLING_PRICE \n\n        Test Summary         \n ----------------------------\n DF            =    1 \n Chi2          =    4573.0707 \n Prob &gt; Chi2   =    0.0000"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#test-for-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#test-for-spatial-autocorrelation",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "7. Test for Spatial Autocorrelation",
    "text": "7. Test for Spatial Autocorrelation\n\n7.1 Prepare Spatial Data\n\n# Extract residuals\nmlr_residuals &lt;- residuals(condo_mlr2)\ncondo_resale$mlr_residuals &lt;- mlr_residuals\n\n# Add residuals to sf object\ncondo_resale_sf$mlr_residuals &lt;- mlr_residuals\n\n# Convert to sp object for GWmodel\ncondo_resale_sp &lt;- as(condo_resale_sf, \"Spatial\")\ncondo_resale_sp@data$mlr_residuals &lt;- mlr_residuals\n\n\n\n7.2 Visualize Residuals\n\n# Map residuals\ntmap_mode(\"plot\")\ntm_shape(mpsz) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale_sf) +\n  tm_dots(col = \"mlr_residuals\",\n          size = 0.01,  # Further reduced size\n          style = \"quantile\",\n          palette = \"-RdBu\",\n          title = \"MLR Residuals\") +\n  tm_layout(main.title = \"Spatial Distribution of OLS Residuals\",\n            main.title.size = 1.2)\n\n\n\n\n\n\n\n\n\n\n7.3 Moran’s I Test\n\n# Create neighbors\ncoords &lt;- st_coordinates(condo_resale_sf)\nknn_nb &lt;- knn2nb(knearneigh(coords, k = 8))\nknn_listw &lt;- nb2listw(knn_nb, style = \"W\")\n\n# Moran's I test on residuals\nmoran.test(mlr_residuals, knn_listw)\n\n\n    Moran I test under randomisation\n\ndata:  mlr_residuals  \nweights: knn_listw    \n\nMoran I statistic standard deviate = 25.806, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.3098623365     -0.0006968641      0.0001448283 \n\n# Moran scatterplot\nmoran.plot(mlr_residuals, knn_listw,\n           main = \"Moran Scatterplot of OLS Residuals\",\n           xlab = \"Residuals\",\n           ylab = \"Spatially Lagged Residuals\",\n           labels = FALSE, \n           quiet = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-models-using-gwr",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-models-using-gwr",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "8. Building Hedonic Pricing Models using GWR",
    "text": "8. Building Hedonic Pricing Models using GWR\n\n8.1 Adaptive Bandwidth GWR with Optimization\n\n# Check for cache file\ncache_file &lt;- \"gwr_cache.rds\"\n\nif(file.exists(cache_file)){\n  cat(\"Loading cached GWR results...\\n\")\n  gwc &lt;- readRDS(cache_file)\n  bw_adaptive &lt;- gwc$bw\n  gwr_adaptive &lt;- gwc$gwr\n  cat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n} else {\n  cat(\"Calculating optimal bandwidth (this may take a few minutes)...\\n\")\n  \n  # Determine optimal adaptive bandwidth using AICc with parallel processing\n  bw_adaptive &lt;- bw.gwr(\n    formula = SELLING_PRICE ~ AREA_SQM + AGE + \n              PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n              PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n              PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n              PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n              FREEHOLD,\n    data = condo_resale_sp,\n    approach = \"AICc\",       # Use AICc for small sample correction\n    kernel = \"bisquare\",     # Bisquare kernel for adaptive bandwidth\n    adaptive = TRUE,\n    longlat = FALSE,\n    parallel.method = \"omp\", # Enable parallel processing\n    parallel.arg = max(1, parallel::detectCores() - 1)\n  )\n  \n  cat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n  \n  # Calibrate adaptive GWR model\n  cat(\"Calibrating GWR model...\\n\")\n  gwr_adaptive &lt;- gwr.basic(\n    formula = SELLING_PRICE ~ AREA_SQM + AGE + \n              PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n              PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n              PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n              PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n              FREEHOLD,\n    data = condo_resale_sp,\n    bw = bw_adaptive,\n    kernel = \"bisquare\",\n    adaptive = TRUE,\n    longlat = FALSE\n  )\n  \n  # Save to cache\n  saveRDS(list(bw = bw_adaptive, gwr = gwr_adaptive), cache_file)\n  cat(\"Results cached for future use.\\n\")\n}\n\nLoading cached GWR results...\nOptimal adaptive bandwidth: 84 neighbors\n\n# Display model results\ngwr_adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2025-11-08 02:23:00.479815 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale_sp, bw = bw_adaptive, kernel = \"bisquare\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_OF_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_OF_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: bisquare \n   Adaptive bandwidth: 84 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5398e+07 -1.1560e+06  6.8662e+05  2.4084e+06\n   AREA_SQM              2.5627e+03  5.5805e+03  7.3041e+03  1.1216e+04\n   AGE                  -1.6687e+05 -2.0869e+04 -1.0666e+04 -3.8618e+03\n   PROX_CBD             -1.4632e+07 -3.2429e+05 -5.1360e+04  2.2112e+05\n   PROX_CHILDCARE       -3.4212e+06 -4.7125e+05 -6.7941e+04  3.6997e+05\n   PROX_ELDERLYCARE     -3.6267e+06 -2.3989e+05  3.3240e+04  3.3964e+05\n   PROX_URA_GROWTH_AREA -6.1100e+07 -9.6781e+04  1.3331e+05  4.2131e+05\n   PROX_MRT             -6.4860e+06 -6.1694e+05 -1.3437e+05  1.3506e+05\n   PROX_PARK            -3.6830e+06 -2.5607e+05  3.7533e+04  3.8025e+05\n   PROX_PRIMARY_SCH     -2.1930e+06 -3.6164e+05 -6.3626e+04  2.4156e+05\n   PROX_SHOPPING_MALL   -2.0284e+06 -1.7434e+05  4.6397e+04  4.1171e+05\n   PROX_BUS_STOP        -5.2211e+06 -3.3468e+05  2.8355e+05  1.0325e+06\n   NO_OF_UNITS          -5.4491e+03 -2.5148e+02  6.6151e+00  2.9492e+02\n   FAMILY_FRIENDLY      -9.7656e+05 -8.7245e+04  8.7541e+03  1.4713e+05\n   FREEHOLD             -9.9036e+05 -1.6249e+04  1.0203e+05  3.3881e+05\n                              Max.\n   Intercept            58509448.1\n   AREA_SQM                25681.7\n   AGE                     43602.6\n   PROX_CBD             61068846.4\n   PROX_CHILDCARE        4619480.5\n   PROX_ELDERLYCARE      7712244.1\n   PROX_URA_GROWTH_AREA 17914463.2\n   PROX_MRT              2069561.2\n   PROX_PARK             4068834.5\n   PROX_PRIMARY_SCH      5912050.6\n   PROX_SHOPPING_MALL    2944099.7\n   PROX_BUS_STOP        15313047.4\n   NO_OF_UNITS              2425.1\n   FAMILY_FRIENDLY       3852139.1\n   FREEHOLD              2690147.6\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 468.9826 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 967.0174 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41712.41 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 40971.7 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42101.93 \n   Residual sum of squares: 1.556343e+14 \n   R-square value:  0.9330503 \n   Adjusted R-square value:  0.9005476 \n\n   ***********************************************************************\n   Program stops at: 2025-11-08 02:23:01.100378"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#visualizing-gwr-results",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#visualizing-gwr-results",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "9. Visualizing GWR Results",
    "text": "9. Visualizing GWR Results\n\n9.1 Extract GWR Results (Robust Method)\n\n# Extract GWR results dataframe\ngdf &lt;- gwr_adaptive$SDF@data\n\n# Define coefficient names\ncoef_names &lt;- c(\"Intercept\", \"AREA_SQM\", \"AGE\", \"PROX_CBD\", \n                \"PROX_CHILDCARE\", \"PROX_ELDERLYCARE\",\n                \"PROX_URA_GROWTH_AREA\", \"PROX_MRT\", \"PROX_PARK\",\n                \"PROX_PRIMARY_SCH\", \"PROX_SHOPPING_MALL\",\n                \"PROX_BUS_STOP\", \"NO_OF_UNITS\", \"FAMILY_FRIENDLY\",\n                \"FREEHOLD\")\n\n# Extract coefficients using column names\nfor(nm in coef_names){\n  if(nm %in% names(gdf)) {\n    condo_resale_sf[[paste0(\"gwr_\", nm)]] &lt;- gdf[[nm]]\n  }\n}\n\n# Extract Local R2, fitted values, and residuals (fixed column names)\nif(\"Local_R2\" %in% names(gdf)) condo_resale_sf$gwr_localR2 &lt;- gdf$Local_R2\nif(\"yhat\" %in% names(gdf)) condo_resale_sf$gwr_yhat &lt;- gdf$yhat\nif(\"residual\" %in% names(gdf)) condo_resale_sf$gwr_residual &lt;- gdf$residual\n\n# Extract standard errors using pattern matching\nse_cols &lt;- grep(\"\\\\.SE$|_SE$\", names(gdf), value = TRUE)\nfor(nm in coef_names){\n  se_nm &lt;- se_cols[grepl(nm, se_cols)]\n  if(length(se_nm) &gt; 0) {\n    condo_resale_sf[[paste0(\"gwr_SE_\", nm)]] &lt;- gdf[[se_nm[1]]]\n  }\n}\n\n# Extract t-values using pattern matching\ntv_cols &lt;- grep(\"\\\\.TV$|_TV$\", names(gdf), value = TRUE)\nfor(nm in coef_names){\n  tv_nm &lt;- tv_cols[grepl(nm, tv_cols)]\n  if(length(tv_nm) &gt; 0) {\n    condo_resale_sf[[paste0(\"gwr_TV_\", nm)]] &lt;- gdf[[tv_nm[1]]]\n  }\n}\n\n# Verify extraction\ncat(\"✓ GWR results successfully extracted\\n\")\n\n✓ GWR results successfully extracted\n\ncat(\"Number of observations:\", nrow(condo_resale_sf), \"\\n\")\n\nNumber of observations: 1436 \n\ncat(\"\\nLocal R² Summary:\\n\")\n\n\nLocal R² Summary:\n\nsummary(condo_resale_sf$gwr_localR2)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.6141  0.9008  0.9370  0.9229  0.9711  0.9957 \n\n\n\n\n9.2 Visualize Local R-squared\n\ntmap_mode(\"plot\")\n\n# Create Local R² map\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\", \n              border.col = \"grey60\",\n              lwd = 0.5) +\ntm_shape(condo_resale_sf) +\n  tm_dots(\"gwr_localR2\",\n          size = 0.02,\n          border.col = \"black\",\n          border.lwd = 0.3,\n          style = \"quantile\",\n          n = 5,\n          palette = \"RdPu\",\n          title = \"Local R²\") +\n  tm_layout(main.title = \"GWR Local R-squared Values\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\n\n\n# Print statistics\ncat(\"\\nLocal R² Statistics:\\n\")\n\n\nLocal R² Statistics:\n\ncat(\"Minimum:\", round(min(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMinimum: 0.614 \n\ncat(\"Maximum:\", round(max(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMaximum: 0.996 \n\ncat(\"Mean:\", round(mean(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean: 0.923 \n\ncat(\"Median:\", round(median(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMedian: 0.937 \n\n\n\n\n9.3 Visualize Coefficient Estimates\n\n# Create maps for key coefficients\ntm1 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_AREA_SQM\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"Area Coefficient\") +\n       tm_layout(main.title = \"AREA_SQM\", main.title.size = 0.8)\n\ntm2 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_AGE\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"Age Coefficient\") +\n       tm_layout(main.title = \"AGE\", main.title.size = 0.8)\n\ntm3 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_PROX_CBD\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"CBD Distance\") +\n       tm_layout(main.title = \"PROX_CBD\", main.title.size = 0.8)\n\ntm4 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_PROX_MRT\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"MRT Distance\") +\n       tm_layout(main.title = \"PROX_MRT\", main.title.size = 0.8)\n\ntmap_arrange(tm1, tm2, tm3, tm4, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n9.4 Visualize GWR Residuals\n\n# Compare OLS and GWR residuals\ntm_ols &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n          tm_shape(condo_resale_sf) +\n          tm_dots(col = \"mlr_residuals\", size = 0.01,\n                  style = \"quantile\", palette = \"-RdBu\",\n                  title = \"Residuals\") +\n          tm_layout(main.title = \"OLS Residuals\",\n                    main.title.size = 0.9)\n\ntm_gwr &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n          tm_shape(condo_resale_sf) +\n          tm_dots(col = \"gwr_residual\", size = 0.01,\n                  style = \"quantile\", palette = \"-RdBu\",\n                  title = \"Residuals\") +\n          tm_layout(main.title = \"GWR Residuals\",\n                    main.title.size = 0.9)\n\ntmap_arrange(tm_ols, tm_gwr, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#model-comparison-and-evaluation",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#model-comparison-and-evaluation",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "10. Model Comparison and Evaluation",
    "text": "10. Model Comparison and Evaluation\n\n10.1 Compare Model Performance\n\n# Create comparison table\nmodel_comparison &lt;- data.frame(\n  Model = c(\"OLS\", \"GWR Adaptive\"),\n  AICc = c(AIC(condo_mlr2), \n          gwr_adaptive$GW.diagnostic$AICc),\n  Adj_R2 = c(summary(condo_mlr2)$adj.r.squared,\n             gwr_adaptive$GW.diagnostic$R2.adj),\n  RSS = c(sum(residuals(condo_mlr2)^2),\n          gwr_adaptive$GW.diagnostic$RSS.gw)\n)\n\nknitr::kable(model_comparison,\n             caption = \"Model Performance Comparison\",\n             digits = 3)\n\n\nModel Performance Comparison\n\n\nModel\nAICc\nAdj_R2\nRSS\n\n\n\n\nOLS\n42966.76\n0.647\n8.120609e+14\n\n\nGWR Adaptive\n41712.41\n0.647\n1.556343e+14\n\n\n\n\n\n\n\n10.2 Statistical Test for Spatial Variability\n\n# Test for spatial non-stationarity\n# Calculate t-statistics\nt_stats &lt;- data.frame(\n  Variable = coef_names,\n  Min_t = NA,\n  Q1_t = NA,\n  Median_t = NA,\n  Q3_t = NA,\n  Max_t = NA,\n  Pct_Significant = NA\n)\n\nfor(i in 1:length(coef_names)) {\n  coef_col &lt;- paste0(\"gwr_\", coef_names[i])\n  se_col &lt;- paste0(\"gwr_SE_\", coef_names[i])\n  \n  if(coef_col %in% names(condo_resale_sf) && se_col %in% names(condo_resale_sf)) {\n    t_values &lt;- condo_resale_sf[[coef_col]] / condo_resale_sf[[se_col]]\n    \n    t_stats$Min_t[i] &lt;- min(t_values, na.rm = TRUE)\n    t_stats$Q1_t[i] &lt;- quantile(t_values, 0.25, na.rm = TRUE)\n    t_stats$Median_t[i] &lt;- median(t_values, na.rm = TRUE)\n    t_stats$Q3_t[i] &lt;- quantile(t_values, 0.75, na.rm = TRUE)\n    t_stats$Max_t[i] &lt;- max(t_values, na.rm = TRUE)\n    t_stats$Pct_Significant[i] &lt;- sum(abs(t_values) &gt; 1.96, na.rm = TRUE) / \n                                   sum(!is.na(t_values)) * 100\n  }\n}\n\nknitr::kable(t_stats,\n             caption = \"Summary of t-statistics and % Significant\",\n             digits = 2)\n\n\nSummary of t-statistics and % Significant\n\n\n\n\n\n\n\n\n\n\n\nVariable\nMin_t\nQ1_t\nMedian_t\nQ3_t\nMax_t\nPct_Significant\n\n\n\n\nIntercept\n-7.58\n-0.33\n0.23\n0.84\n7.38\n11.70\n\n\nAREA_SQM\n0.90\n2.87\n4.92\n8.57\n32.65\n92.27\n\n\nAGE\n-17.67\n-1.69\n-0.72\n-0.24\n2.26\n22.35\n\n\nPROX_CBD\n-6.46\n-0.78\n-0.21\n0.37\n8.12\n14.35\n\n\nPROX_CHILDCARE\n-4.35\n-0.52\n-0.07\n0.47\n7.26\n10.38\n\n\nPROX_ELDERLYCARE\n-7.55\n-0.38\n0.07\n0.60\n12.67\n11.91\n\n\nPROX_URA_GROWTH_AREA\n-7.98\n-0.14\n0.41\n1.14\n5.65\n13.23\n\n\nPROX_MRT\n-11.97\n-1.06\n-0.22\n0.28\n3.74\n16.99\n\n\nPROX_PARK\n-4.48\n-0.37\n0.05\n0.58\n7.35\n12.40\n\n\nPROX_PRIMARY_SCH\n-4.23\n-0.60\n-0.13\n0.47\n12.09\n12.19\n\n\nPROX_SHOPPING_MALL\n-4.50\n-0.36\n0.08\n0.68\n3.86\n11.91\n\n\nPROX_BUS_STOP\n-4.54\n-0.22\n0.24\n1.09\n18.64\n19.50\n\n\nNO_OF_UNITS\n-6.28\n-0.52\n0.01\n0.48\n4.44\n11.77\n\n\nFAMILY_FRIENDLY\n-3.63\n-0.43\n0.03\n0.77\n21.87\n19.08\n\n\nFREEHOLD\n-1.46\n-0.06\n0.48\n1.55\n14.33\n16.09\n\n\n\n\n\n\n\n10.3 Residual Autocorrelation Test\n\n# Test GWR residuals for spatial autocorrelation\nmoran_gwr &lt;- moran.test(condo_resale_sf$gwr_residual, knn_listw)\nmoran_ols &lt;- moran.test(mlr_residuals, knn_listw)\n\n# Compare Moran's I\ncat(\"\\nComparison of Moran's I:\\n\")\n\n\nComparison of Moran's I:\n\ncat(\"OLS Residuals Moran's I:\", round(moran_ols$estimate[1], 4), \"\\n\")\n\nOLS Residuals Moran's I: 0.3099 \n\ncat(\"GWR Residuals Moran's I:\", round(moran_gwr$estimate[1], 4), \"\\n\")\n\nGWR Residuals Moran's I: -0.1053 \n\ncat(\"\\n\")\nprint(moran_gwr)\n\n\n    Moran I test under randomisation\n\ndata:  condo_resale_sf$gwr_residual  \nweights: knn_listw    \n\nMoran I statistic standard deviate = -8.5562, p-value = 1\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n    -0.1053491274     -0.0006968641      0.0001496017"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#key-findings-and-conclusions",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#key-findings-and-conclusions",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "11. Key Findings and Conclusions",
    "text": "11. Key Findings and Conclusions\n\n11.1 Summary of Results\n\n# Calculate improvement metrics\nr2_improvement &lt;- (gwr_adaptive$GW.diagnostic$R2.adj - \n                  summary(condo_mlr2)$adj.r.squared) / \n                  summary(condo_mlr2)$adj.r.squared * 100\n\naic_improvement &lt;- (AIC(condo_mlr2) - \n                   gwr_adaptive$GW.diagnostic$AICc) / \n                   AIC(condo_mlr2) * 100\n\ncat(\"Model Improvements (GWR vs OLS):\\n\")\n\nModel Improvements (GWR vs OLS):\n\ncat(\"--------------------------------\\n\")\n\n--------------------------------\n\ncat(\"Adjusted R² improvement:\", round(r2_improvement, 1), \"%\\n\")\n\nAdjusted R² improvement:  %\n\ncat(\"AICc improvement:\", round(aic_improvement, 1), \"%\\n\")\n\nAICc improvement: 2.9 %\n\ncat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n\nOptimal adaptive bandwidth: 84 neighbors\n\ncat(\"Mean Local R²:\", round(mean(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.923 \n\ncat(\"Range of Local R²:\", \n    round(min(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"-\",\n    round(max(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nRange of Local R²: 0.614 - 0.996 \n\n\n\n\n11.2 Spatial Pattern Summary\n\n# Identify areas with high and low local R²\nhigh_r2 &lt;- condo_resale_sf[condo_resale_sf$gwr_localR2 &gt; \n                           quantile(condo_resale_sf$gwr_localR2, 0.9, na.rm = TRUE), ]\nlow_r2 &lt;- condo_resale_sf[condo_resale_sf$gwr_localR2 &lt; \n                          quantile(condo_resale_sf$gwr_localR2, 0.1, na.rm = TRUE), ]\n\ncat(\"\\nAreas with High Model Performance (Top 10% Local R²):\\n\")\n\n\nAreas with High Model Performance (Top 10% Local R²):\n\ncat(\"Number of units:\", nrow(high_r2), \"\\n\")\n\nNumber of units: 144 \n\ncat(\"Mean Local R²:\", round(mean(high_r2$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.989 \n\ncat(\"Mean Selling Price:\", round(mean(high_r2$SELLING_PRICE, na.rm = TRUE)), \"\\n\")\n\nMean Selling Price: 1021523 \n\ncat(\"\\nAreas with Low Model Performance (Bottom 10% Local R²):\\n\")\n\n\nAreas with Low Model Performance (Bottom 10% Local R²):\n\ncat(\"Number of units:\", nrow(low_r2), \"\\n\")\n\nNumber of units: 144 \n\ncat(\"Mean Local R²:\", round(mean(low_r2$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.781 \n\ncat(\"Mean Selling Price:\", round(mean(low_r2$SELLING_PRICE, na.rm = TRUE)), \"\\n\")\n\nMean Selling Price: 2040447"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#conclusions",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "12. Conclusions",
    "text": "12. Conclusions\nThis analysis demonstrates the power of Geographically Weighted Regression in capturing spatial heterogeneity in housing prices:\n\nKey Findings:\n\nSpatial Non-stationarity: The relationships between condo prices and their predictors vary significantly across Singapore\nModel Performance: GWR provides substantial improvement over OLS regression in terms of both R² and AICc\nLocal Variations: Different factors influence prices differently in various parts of Singapore:\n\nCBD proximity matters more in certain areas\nMRT accessibility has varying importance\nAge depreciation effects differ spatially\n\nResidual Analysis: GWR successfully reduces spatial autocorrelation in residuals\n\n\n\nImplications:\n\nHousing valuation models should account for spatial variations\nPolicy interventions should consider local context\nReal estate investment strategies should be location-specific\n\n\n\nFuture Work:\n\nExplore temporal variations using panel GWR\nInclude more neighborhood characteristics\nTest alternative kernel functions and bandwidth selection methods\nConsider standardized variables for better interpretation"
  }
]