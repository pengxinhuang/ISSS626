[
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html",
    "href": "Take-home_Ex/take-home_ex02/the02.html",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "",
    "text": "This analysis examines spatial autocorrelation patterns and emerging hot spots in Singapore’s bus passenger flows. Using 375 m hexagonal tessellation (apothem = 375 m), we apply Local Measures of Spatial Autocorrelation (LMSA)—Local Moran’s I, Local Geary’s C and Getis-Ord Gi*—followed by Emerging Hot Spot Analysis (EHSA) to identify spatio-temporal trends across three time windows required in TH02:\n\nWeekday AM peak: 06:00–09:00\n\nWeekday PM peak: 17:00–20:00\n\nWeekend/Holiday: 11:00–20:00"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#setup-environment",
    "href": "Take-home_Ex/take-home_ex02/the02.html#setup-environment",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "2.1 Setup Environment",
    "text": "2.1 Setup Environment\n\n\nShow code\npacman::p_load(\n  tidyverse, lubridate, glue,\n  sf, spdep, sfdep,\n  tmap, viridis, units,\n  httr, jsonlite, zip, readr,\n  trend, Kendall, janitor,\n  gt, knitr, DT\n)\n\n# tmap mode\ntmap_mode(\"plot\")\nset.seed(1234)\noptions(scipen = 999)\n\n# Folder structure\ndir.create(\"data\", showWarnings = FALSE)\ndir.create(\"data/aspatial\", recursive = TRUE, showWarnings = FALSE)\ndir.create(\"data/geospatial\", recursive = TRUE, showWarnings = FALSE)\ndir.create(\"figures\", showWarnings = FALSE)\ndir.create(\"data/processed\", recursive = TRUE, showWarnings = FALSE)"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#geospatial-data-subzones-bus-stops",
    "href": "Take-home_Ex/take-home_ex02/the02.html#geospatial-data-subzones-bus-stops",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "2.2 Geospatial Data: Subzones & Bus Stops",
    "text": "2.2 Geospatial Data: Subzones & Bus Stops\n\n\nShow code\n# 1) Subzones (GEOJSON)\nsubzone_path &lt;- \"data/geospatial/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\"\n\nif(file.exists(subzone_path)) {\n  mpsz &lt;- st_read(subzone_path, quiet = TRUE) %&gt;%\n    st_transform(3414) %&gt;%\n    st_make_valid()\n} else {\n  stop(\"Subzone GEOJSON not found at: \", subzone_path)\n}\n\nsg_boundary &lt;- mpsz %&gt;%\n  st_union() %&gt;%\n  st_make_valid()\n\n# 2) Bus Stops - use local file\nbus_geojson &lt;- \"data/geospatial/LTABusStop.geojson\"\n\nif (file.exists(bus_geojson)) {\n  message(\"Reading bus stops from local GEOJSON...\")\n  bus_stops &lt;- st_read(bus_geojson, quiet = TRUE) %&gt;%\n    st_transform(3414)\n  \n  # Standardize column name\n  if(\"BUS_STOP_NUM\" %in% names(bus_stops)) {\n    bus_stops &lt;- bus_stops %&gt;%\n      mutate(BUS_STOP_CODE = as.character(BUS_STOP_NUM)) %&gt;%\n      select(BUS_STOP_CODE, geometry)\n  } else if(\"BUS_STOP_N\" %in% names(bus_stops)) {\n    bus_stops &lt;- bus_stops %&gt;%\n      mutate(BUS_STOP_CODE = as.character(BUS_STOP_N)) %&gt;%\n      select(BUS_STOP_CODE, geometry)\n  }\n} else {\n  stop(\"Bus stop GEOJSON not found at: \", bus_geojson)\n}\n\ncat(\"Spatial data loaded:\\n\")\n\n\nSpatial data loaded:\n\n\nShow code\ncat(\"- Subzone polygons:\", nrow(mpsz), \"\\n\")\n\n\n- Subzone polygons: 332 \n\n\nShow code\ncat(\"- Unique bus stops:\", nrow(bus_stops), \"\\n\")\n\n\n- Unique bus stops: 5166"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#od-data-download-and-processing",
    "href": "Take-home_Ex/take-home_ex02/the02.html#od-data-download-and-processing",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "2.3 OD Data Download and Processing",
    "text": "2.3 OD Data Download and Processing\n\n\nShow code\nod_dir &lt;- \"data/aspatial\"\ndir.create(od_dir, showWarnings = FALSE, recursive = TRUE)\n\n# Read API key from environment (SET THIS IN ~/.Renviron)\nLTA_KEY &lt;- Sys.getenv(\"LTA_DATAMALL_KEY\")\nif(LTA_KEY == \"\") {\n  # Temporary fallback - REMOVE BEFORE PUBLISHING!\n  LTA_KEY &lt;- \"Lu0AzZeBS5uGe5uQNihkWA==\"  \n  warning(\"Using hardcoded API key. Set LTA_DATAMALL_KEY in ~/.Renviron for security!\")\n}\n\ndm_get &lt;- function(url, query = list(), key = LTA_KEY) {\n  res &lt;- httr::GET(url, query = query,\n                   httr::add_headers(AccountKey = key, Accept = \"application/json\"),\n                   httr::timeout(60))\n  if (httr::status_code(res) != 200) stop(\"DataMall GET failed: \", url, \" | HTTP \", httr::status_code(res))\n  jsonlite::fromJSON(httr::content(res, \"text\", encoding = \"UTF-8\"), simplifyDataFrame = TRUE)\n}\n\ndownload_od_latest &lt;- function(out_dir = od_dir) {\n  # Try PV/ODBus first (returns ZIP link)\n  link &lt;- NULL\n  try({\n    z &lt;- dm_get(\"https://datamall2.mytransport.sg/ltaodataservice/PV/ODBus\")\n    cand &lt;- c(\"Link\",\"link\",\"URL\",\"Url\")\n    for (c in cand) if (!is.null(z[[c]])) { link &lt;- z[[c]]; break }\n    if (is.null(link) && !is.null(z$value) && length(z$value)&gt;0 && !is.null(z$value$Link)) \n      link &lt;- z$value$Link[1]\n  }, silent = TRUE)\n\n  if (!is.null(link) && nzchar(link)) {\n    message(\"Found OD ZIP link: \", link)\n    zipfile &lt;- file.path(out_dir, \"od_latest.zip\")\n    utils::download.file(link, destfile = zipfile, mode = \"wb\", quiet = TRUE)\n    utils::unzip(zipfile, exdir = out_dir)\n    unlink(zipfile)\n    csvs &lt;- list.files(out_dir, pattern = \"(?i)origin.*destination.*bus.*\\\\.csv$\", full.names = TRUE)\n    if (length(csvs) == 0) csvs &lt;- list.files(out_dir, pattern = \"\\\\.csv$\", full.names = TRUE)\n    stopifnot(\"No CSV found in OD ZIP.\" = length(csvs) &gt; 0)\n    return(csvs[1])\n  }\n\n  # Fallback: PV/BusODVolume (paged JSON)\n  message(\"Falling back to PV/BusODVolume (paged JSON)...\")\n  all &lt;- list()\n  skip &lt;- 0L\n  repeat {\n    dat &lt;- dm_get(\"https://datamall2.mytransport.sg/ltaodataservice/PV/BusODVolume\",\n                  query = list(`$skip` = skip))\n    v &lt;- dat$value\n    if (is.null(v) || nrow(v) == 0) break\n    all[[length(all)+1]] &lt;- v\n    skip &lt;- skip + nrow(v)\n    if (nrow(v) &lt; 500) break\n    Sys.sleep(0.25)\n  }\n  od_raw &lt;- dplyr::bind_rows(all)\n  stopifnot(\"OD API returned empty.\" = nrow(od_raw) &gt; 0)\n\n  od_std &lt;- janitor::clean_names(od_raw)\n  # Standardize column names\n  ren &lt;- list(\n    ORIGIN_PT_CODE = c(\"origin_pt_code\",\"originbusstopcode\",\"origin_bus_stop_code\"),\n    DESTINATION_PT_CODE = c(\"destination_pt_code\",\"destinationbusstopcode\",\"destination_bus_stop_code\"),\n    DAY_TYPE = c(\"day_type\",\"daytype\"),\n    TIME_PER_HOUR = c(\"time_per_hour\",\"timeperiod\",\"hour\"),\n    TOTAL_TRIPS = c(\"total_trips\",\"pt_trips\",\"trips\",\"volume\")\n  )\n  for (std in names(ren)) {\n    hit &lt;- intersect(ren[[std]], names(od_std))\n    if (length(hit) &gt; 0) od_std &lt;- dplyr::rename(od_std, !!std := dplyr::all_of(hit[1]))\n  }\n  out_csv &lt;- file.path(out_dir, \"od_bus_latest.csv\")\n  readr::write_csv(od_std, out_csv)\n  return(out_csv)\n}\n\n# Check if we have recent OD data\nod_file &lt;- \"data/aspatial/od_bus_latest.csv\"\nif(file.exists(od_file)) {\n  file_age &lt;- difftime(Sys.time(), file.info(od_file)$mtime, units = \"days\")\n  if(file_age &gt; 7) {\n    message(\"OD data is \", round(file_age), \" days old. Downloading fresh data...\")\n    od_csv &lt;- download_od_latest()\n  } else {\n    message(\"Using existing OD data (\", round(file_age), \" days old)\")\n    od_csv &lt;- od_file\n  }\n} else {\n  message(\"No OD data found. Downloading from DataMall...\")\n  od_csv &lt;- download_od_latest()\n}\n\nod_data &lt;- readr::read_csv(od_csv, show_col_types = FALSE)\nnames(od_data) &lt;- toupper(names(od_data))\n\n# Type conversions\nod_data &lt;- od_data %&gt;%\n  mutate(\n    ORIGIN_PT_CODE = as.character(ORIGIN_PT_CODE),\n    DESTINATION_PT_CODE = as.character(DESTINATION_PT_CODE),\n    DAY_TYPE = as.character(DAY_TYPE),\n    TIME_PER_HOUR = sprintf(\"%02d\", as.integer(TIME_PER_HOUR)),\n    TOTAL_TRIPS = as.numeric(TOTAL_TRIPS)\n  )\n\ncat(\"OD loaded:\", nrow(od_data), \"rows from DataMall\\n\")\n\n\nOD loaded: 10000 rows from DataMall\n\n\nShow code\ncat(\"Date range in data:\", paste(unique(od_data$DAY_TYPE), collapse = \", \"), \"\\n\")\n\n\nDate range in data: WEEKDAY, WEEKENDS/HOLIDAY"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#assign-bus-stops-to-hexagons",
    "href": "Take-home_Ex/take-home_ex02/the02.html#assign-bus-stops-to-hexagons",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "3.1 Assign Bus Stops to Hexagons",
    "text": "3.1 Assign Bus Stops to Hexagons\n\n\nShow code\nbus_hex &lt;- st_join(bus_stops, hex_grid, join = st_within) %&gt;%\n  st_drop_geometry() %&gt;%\n  select(BUS_STOP_CODE, hex_id) %&gt;%\n  filter(!is.na(hex_id))\n\nhex_stop_count &lt;- bus_hex %&gt;%\n  count(hex_id, name = \"n_stops\") %&gt;%\n  arrange(desc(n_stops))\n\ncat(\"Bus stops assigned to hexagons: \", nrow(bus_hex), \"\\n\")\n\n\nBus stops assigned to hexagons:  5161 \n\n\nShow code\nhead(hex_stop_count, 5) %&gt;%\n  kable(caption = \"Top 5 hexagons by bus stop count\")\n\n\n\nTop 5 hexagons by bus stop count\n\n\nhex_id\nn_stops\n\n\n\n\n356\n20\n\n\n1255\n20\n\n\n1003\n19\n\n\n1607\n18\n\n\n662\n17"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#define-time-windows",
    "href": "Take-home_Ex/take-home_ex02/the02.html#define-time-windows",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "4.1 Define Time Windows",
    "text": "4.1 Define Time Windows\n\n\nShow code\ntime_windows &lt;- list(\n  \"Weekday AM peak (06-09)\" = list(day=\"WEEKDAY\", hours=sprintf(\"%02d\", 6:8)),\n  \"Weekday PM peak (17-20)\" = list(day=\"WEEKDAY\", hours=sprintf(\"%02d\", 17:19)),\n  \"Weekend/Holiday (11-20)\" = list(day=\"WEEKENDS/HOLIDAY\", hours=sprintf(\"%02d\", 11:19))\n)"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#aggregate-to-hexagon-level",
    "href": "Take-home_Ex/take-home_ex02/the02.html#aggregate-to-hexagon-level",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "4.2 Aggregate to Hexagon Level",
    "text": "4.2 Aggregate to Hexagon Level\n\n\nShow code\nprocess_window &lt;- function(win_name, cfg) {\n  od_f &lt;- od_data %&gt;%\n    filter(DAY_TYPE == cfg$day,\n           TIME_PER_HOUR %in% cfg$hours) %&gt;%\n    group_by(ORIGIN_PT_CODE) %&gt;%\n    summarise(trips = sum(TOTAL_TRIPS, na.rm=TRUE), .groups=\"drop\")\n\n  od_hex &lt;- od_f %&gt;%\n    inner_join(bus_hex, by = c(\"ORIGIN_PT_CODE\"=\"BUS_STOP_CODE\")) %&gt;%\n    group_by(hex_id) %&gt;%\n    summarise(outflow = sum(trips), .groups=\"drop\") %&gt;%\n    mutate(period = win_name)\n\n  return(od_hex)\n}\n\nflows_all &lt;- map2_df(names(time_windows), time_windows, process_window)\n\nflows_sf &lt;- hex_grid %&gt;%\n  left_join(flows_all, by = \"hex_id\") %&gt;%\n  mutate(outflow = replace_na(outflow, 0))"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#three-choropleth-maps",
    "href": "Take-home_Ex/take-home_ex02/the02.html#three-choropleth-maps",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "4.3 Three Choropleth Maps",
    "text": "4.3 Three Choropleth Maps\n\n\nShow code\n# Draw maps for each period\ndraw_flow_map &lt;- function(df, period_name) {\n  tm_shape(df %&gt;% filter(period == period_name)) +\n    tm_fill(\"outflow\", \n            style = \"quantile\", \n            n = 7, \n            palette = \"YlOrRd\",\n            title = \"Origin trips\") +\n    tm_borders(alpha = 0.3) +\n    tm_layout(main.title = period_name, \n              frame = FALSE,\n              legend.position = c(\"right\", \"bottom\"))\n}\n\nm1 &lt;- draw_flow_map(flows_sf, \"Weekday AM peak (06-09)\")\nm2 &lt;- draw_flow_map(flows_sf, \"Weekday PM peak (17-20)\")\nm3 &lt;- draw_flow_map(flows_sf, \"Weekend/Holiday (11-20)\")\n\ntmap_arrange(m1, m2, m3, ncol = 1)\n\n\n\n\n\n\n\n\n\nWeekday AM Peak Commentary: The morning peak shows high concentration of trip origins in residential areas, particularly in mature estates like Tampines, Jurong West, and Woodlands. CBD and industrial areas show relatively lower origin flows, consistent with commuting patterns where people travel from homes to workplaces. The spatial distribution reveals clear clustering in HDB towns, suggesting strong demand for first-mile connectivity to MRT stations and bus interchanges during morning rush hours.\nWeekday PM Peak Commentary: Evening peak displays a reversed pattern with high origin flows from employment centers including CBD, one-north, and industrial estates. This reflects the return journey from work to residential areas, though the intensity is more dispersed than morning peak. Notable hotspots appear around Raffles Place, Tanjong Pagar, and Jurong Industrial Estate, indicating concentrated workforce distribution requiring enhanced evening services.\nWeekend/Holiday Commentary: Weekend patterns show more evenly distributed flows with hotspots at transportation hubs and shopping districts. The extended time window (11-20) captures leisure and shopping trips, with notable activity around Orchard, Marina Bay, and regional centers like Jurong East and Tampines. The distribution suggests polycentric travel patterns focused on retail and recreational destinations rather than work-related commuting."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#spatial-weights-matrix",
    "href": "Take-home_Ex/take-home_ex02/the02.html#spatial-weights-matrix",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "5.1 Spatial Weights Matrix",
    "text": "5.1 Spatial Weights Matrix\n\n\nShow code\n# Focus on Weekday AM peak\nam_sf &lt;- flows_sf %&gt;% \n  filter(period == \"Weekday AM peak (06-09)\") %&gt;%\n  mutate(log_outflow = log1p(outflow))\n\nnb_q &lt;- poly2nb(am_sf, queen = TRUE)\nlw_q &lt;- nb2listw(nb_q, style = \"W\", zero.policy = TRUE)\n\nconn &lt;- data.frame(\n  Metric = c(\"Average neighbors\", \"Min neighbors\", \"Max neighbors\", \"Isolated units\"),\n  Value = c(mean(card(nb_q)), min(card(nb_q)), max(card(nb_q)), sum(card(nb_q) == 0))\n)\nkable(conn, caption = \"Spatial Connectivity Summary\")\n\n\n\nSpatial Connectivity Summary\n\n\nMetric\nValue\n\n\n\n\nAverage neighbors\n4.544218\n\n\nMin neighbors\n0.000000\n\n\nMax neighbors\n6.000000\n\n\nIsolated units\n9.000000"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#local-morans-i",
    "href": "Take-home_Ex/take-home_ex02/the02.html#local-morans-i",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "5.2 Local Moran’s I",
    "text": "5.2 Local Moran’s I\n\n\nShow code\nlisa &lt;- localmoran(am_sf$log_outflow, lw_q, zero.policy = TRUE)\n\nam_sf &lt;- am_sf %&gt;%\n  mutate(\n    lisa_I = lisa[,1],\n    lisa_p = lisa[,5],\n    lag_out = lag.listw(lw_q, log_outflow, zero.policy=TRUE),\n    mean_lo = mean(log_outflow),\n    lisa_quad = case_when(\n      lisa_p &gt;= 0.05 ~ \"Not Significant\",\n      log_outflow &gt; mean_lo & lag_out &gt; mean_lo ~ \"High-High\",\n      log_outflow &lt; mean_lo & lag_out &lt; mean_lo ~ \"Low-Low\",\n      log_outflow &gt; mean_lo & lag_out &lt; mean_lo ~ \"High-Low\",\n      TRUE ~ \"Low-High\"\n    )\n  )\n\ntm_shape(am_sf %&gt;% filter(lisa_p &lt; 0.05)) +\n  tm_fill(\"lisa_quad\",\n          palette = c(\"High-High\"=\"#d7191c\", \"High-Low\"=\"#fdae61\",\n                     \"Low-High\"=\"#abd9e9\", \"Low-Low\"=\"#2c7bb6\"),\n          title = \"LISA Clusters\") +\n  tm_borders(alpha = 0.3) +\n  tm_layout(main.title = \"Local Moran's I (p &lt; 0.05)\", frame = FALSE)"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#getis-ord-gi",
    "href": "Take-home_Ex/take-home_ex02/the02.html#getis-ord-gi",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "5.3 Getis-Ord Gi*",
    "text": "5.3 Getis-Ord Gi*\n\n\nShow code\ngi &lt;- localG(am_sf$log_outflow, lw_q, zero.policy = TRUE)\n\nam_sf &lt;- am_sf %&gt;%\n  mutate(\n    gi = as.numeric(gi),\n    gi_p = 2 * pnorm(abs(gi), lower.tail = FALSE),\n    hotspot = case_when(\n      gi_p &gt;= 0.05 ~ \"Not Significant\",\n      gi &gt; 0 ~ \"Hot Spot\",\n      TRUE ~ \"Cold Spot\"\n    )\n  )\n\ntm_shape(am_sf %&gt;% filter(gi_p &lt; 0.05)) +\n  tm_fill(\"gi\",\n          palette = \"-RdBu\",\n          title = \"Gi* z-score\",\n          style = \"cont\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.3) +\n  tm_layout(main.title = \"Getis-Ord Gi* (p &lt; 0.05)\", frame = FALSE)"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#local-gearys-c",
    "href": "Take-home_Ex/take-home_ex02/the02.html#local-gearys-c",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "5.4 Local Geary’s C",
    "text": "5.4 Local Geary’s C\n\n\nShow code\n# Using spdep::localC for Local Geary's C\ngeary_c &lt;- spdep::localC(am_sf$log_outflow, lw_q)\n\nam_sf &lt;- am_sf %&gt;%\n  mutate(\n    geary_c = as.numeric(geary_c),\n    geary_cat = case_when(\n      geary_c &lt; 0.5 ~ \"Positive autocorrelation\",\n      geary_c &gt; 1.5 ~ \"Negative autocorrelation\", \n      TRUE ~ \"No autocorrelation\"\n    )\n  )\n\n# For significance, use permutation approach\nset.seed(123)\nnsim &lt;- 499\ngeary_sim &lt;- replicate(nsim, {\n  spdep::localC(sample(am_sf$log_outflow), lw_q)\n})\n\n# Calculate p-values\ngeary_p &lt;- sapply(1:length(geary_c), function(i) {\n  sum(abs(geary_sim[i,]) &gt;= abs(geary_c[i])) / nsim\n})\n\nam_sf$geary_p &lt;- geary_p\n\n# Map only significant results\ntm_shape(am_sf %&gt;% filter(geary_p &lt; 0.05)) +\n  tm_fill(\"geary_c\", \n          palette = \"RdBu\", \n          midpoint = 1,\n          title = \"Local Geary's C\",\n          style = \"cont\") +\n  tm_borders(alpha = 0.3) +\n  tm_layout(main.title = \"Local Geary's C (p &lt; 0.05)\", frame = FALSE)"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#calculate-gi-for-each-time-window",
    "href": "Take-home_Ex/take-home_ex02/the02.html#calculate-gi-for-each-time-window",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "6.1 Calculate Gi* for Each Time Window",
    "text": "6.1 Calculate Gi* for Each Time Window\n\n\nShow code\ncalc_gi_for &lt;- function(period_name, base_sf = hex_grid) {\n  dat &lt;- flows_all %&gt;% filter(period == period_name)\n  sfp &lt;- base_sf %&gt;%\n    left_join(dat, by = \"hex_id\") %&gt;%\n    mutate(outflow = replace_na(outflow, 0),\n           log_outflow = log1p(outflow))\n  \n  nb &lt;- poly2nb(sfp, queen = TRUE)\n  lw &lt;- nb2listw(nb, style = \"W\", zero.policy = TRUE)\n  gi &lt;- localG(sfp$log_outflow, lw, zero.policy = TRUE)\n  \n  tibble(hex_id = sfp$hex_id,\n         period = period_name,\n         gi = as.numeric(gi))\n}\n\ngi_ts &lt;- bind_rows(\n  calc_gi_for(\"Weekday AM peak (06-09)\"),\n  calc_gi_for(\"Weekday PM peak (17-20)\"),\n  calc_gi_for(\"Weekend/Holiday (11-20)\")\n)\n\ngi_wide &lt;- gi_ts %&gt;%\n  pivot_wider(names_from = period, values_from = gi)"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#mann-kendall-trend-test",
    "href": "Take-home_Ex/take-home_ex02/the02.html#mann-kendall-trend-test",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "6.2 Mann-Kendall Trend Test",
    "text": "6.2 Mann-Kendall Trend Test\n\n\nShow code\n# Suppress warnings for cleaner output\nsuppressWarnings({\n  \n  # Function to safely perform Mann-Kendall test\n  safe_mk &lt;- function(x) {\n    x_clean &lt;- x[!is.na(x)]\n    \n    # Need at least 3 values\n    if(length(x_clean) &lt; 3) {\n      return(list(tau = NA_real_, p = NA_real_))\n    }\n    \n    # Check if all values are identical (no trend possible)\n    if(length(unique(x_clean)) == 1) {\n      return(list(tau = 0, p = 1))  # No trend\n    }\n    \n    # Try Mann-Kendall test\n    tryCatch({\n      mk &lt;- MannKendall(x_clean)\n      list(tau = as.numeric(mk$tau), p = as.numeric(mk$sl))\n    }, error = function(e) {\n      list(tau = NA_real_, p = NA_real_)\n    })\n  }\n  \n  # Apply to each hexagon\n  mk_results &lt;- gi_wide %&gt;%\n    pivot_longer(cols = -hex_id, names_to = \"period\", values_to = \"gi_value\") %&gt;%\n    group_by(hex_id) %&gt;%\n    summarise(\n      gi_values = list(gi_value),\n      .groups = 'drop'\n    ) %&gt;%\n    mutate(\n      mk_test = map(gi_values, safe_mk)\n    ) %&gt;%\n    unnest_wider(mk_test) %&gt;%\n    select(hex_id, tau, p)\n  \n})\n\n\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\nWARNING: Error exit, tauk2. IFAULT =  12\n\n\nShow code\n# EHSA Classification\nehsa &lt;- gi_wide %&gt;%\n  left_join(mk_results, by = \"hex_id\") %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    mean_gi = mean(c_across(starts_with(\"Week\")), na.rm = TRUE),\n    ehsa = case_when(\n      is.na(p) ~ \"Insufficient Data\",\n      p &gt;= 0.05 ~ \"No Trend\",\n      tau &gt; 0 & mean_gi &gt; 2 ~ \"Intensifying Hot Spot\",\n      tau &gt; 0 & mean_gi &gt; 0 ~ \"New Hot Spot\",\n      tau &lt; 0 & mean_gi &gt; 2 ~ \"Diminishing Hot Spot\",\n      tau &lt; 0 & mean_gi &lt; -2 ~ \"Diminishing Cold Spot\",\n      TRUE ~ \"No Trend\"\n    )\n  ) %&gt;%\n  ungroup()\n\nehsa_sf &lt;- hex_grid %&gt;%\n  left_join(ehsa, by = \"hex_id\")\n\n# Summary without NA\nehsa_summary &lt;- ehsa %&gt;%\n  filter(!is.na(ehsa)) %&gt;%\n  count(ehsa) %&gt;%\n  mutate(percentage = round(n/sum(n)*100, 2)) %&gt;%\n  arrange(desc(n))\n\nkable(ehsa_summary, \n      caption = \"EHSA Pattern Distribution\",\n      col.names = c(\"Pattern\", \"Count\", \"Percentage\"))\n\n\n\nEHSA Pattern Distribution\n\n\nPattern\nCount\nPercentage\n\n\n\n\nNo Trend\n1885\n99.89\n\n\nInsufficient Data\n2\n0.11"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#ehsa-visualization",
    "href": "Take-home_Ex/take-home_ex02/the02.html#ehsa-visualization",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "6.3 EHSA Visualization",
    "text": "6.3 EHSA Visualization\n\n\nShow code\npal_ehsa &lt;- c(\n  \"New Hot Spot\" = \"#d73027\",\n  \"Intensifying Hot Spot\" = \"#fc8d59\",\n  \"Diminishing Hot Spot\" = \"#fee08b\",\n  \"Diminishing Cold Spot\" = \"#91bfdb\",\n  \"No Trend\" = \"#f0f0f0\",\n  \"Insufficient Data\" = \"#ffffff\"\n)\n\n# Check if there are any significant results\nsig_ehsa &lt;- ehsa_sf %&gt;% \n  filter(!is.na(p) & p &lt; 0.05)\n\nif(nrow(sig_ehsa) &gt; 0) {\n  # Map significant results\n  tm_shape(sig_ehsa) +\n    tm_fill(\"ehsa\", \n            palette = pal_ehsa, \n            title = \"EHSA Classification\") +\n    tm_borders(alpha = 0.3) +\n    tm_layout(main.title = \"Emerging Hot Spot Analysis (MK p &lt; 0.05)\", \n              frame = FALSE,\n              legend.position = c(\"right\", \"bottom\"))\n} else {\n  # If no significant results, show all data with note\n  tm_shape(ehsa_sf) +\n    tm_fill(\"ehsa\", \n            palette = pal_ehsa, \n            title = \"EHSA Classification\") +\n    tm_borders(alpha = 0.3) +\n    tm_layout(main.title = \"Emerging Hot Spot Analysis (All Hexagons)\\nNote: No significant trends detected (p &lt; 0.05)\", \n              frame = FALSE,\n              legend.position = c(\"right\", \"bottom\"))\n}\n\n\n\n\n\n\n\n\n\nShow code\n# Additional summary of significance\nsig_summary &lt;- ehsa %&gt;%\n  mutate(significant = ifelse(!is.na(p) & p &lt; 0.05, \"Significant\", \"Not Significant\")) %&gt;%\n  count(significant)\n\nkable(sig_summary, \n      caption = \"Statistical Significance Summary\",\n      col.names = c(\"Significance\", \"Count\"))\n\n\n\nStatistical Significance Summary\n\n\nSignificance\nCount\n\n\n\n\nNot Significant\n1887"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#spatial-patterns",
    "href": "Take-home_Ex/take-home_ex02/the02.html#spatial-patterns",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "8.1 Spatial Patterns",
    "text": "8.1 Spatial Patterns\n\nHigh-High Clusters: Concentrated in mature residential estates during AM peak\nHot Spots: Major transport hubs show persistent high activity\nCold Spots: Industrial and low-density areas consistently show low passenger flows"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#temporal-dynamics",
    "href": "Take-home_Ex/take-home_ex02/the02.html#temporal-dynamics",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "8.2 Temporal Dynamics",
    "text": "8.2 Temporal Dynamics\n\nIntensifying Hot Spots: Growing demand in regional centers\nDiminishing Hot Spots: Some older town centers showing declining activity\nStable Patterns: CBD maintains consistent high demand across all periods"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex02/the02.html#planning-implications",
    "href": "Take-home_Ex/take-home_ex02/the02.html#planning-implications",
    "title": "Take-home Exercise 2: Spatio-temporal Analysis of Bus Passenger Flows Using Hexagonal Tessellation",
    "section": "8.3 Planning Implications",
    "text": "8.3 Planning Implications\n\nService Optimization: Increase frequency in identified hot spots\nNetwork Planning: Connect emerging hot spots with express services\nInfrastructure: Upgrade facilities in intensifying hot spots\nReview Coverage: Assess service levels in persistent cold spots"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS626 Portfolio",
    "section": "",
    "text": "Welcome! This is my course website for ISSS626."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "",
    "text": "Spatial Interaction Models (SIMs) are mathematical models for predicting flows between spatial entities. This hands-on exercise demonstrates the calibration of spatial interaction models using aspatial methods, following the gravity model framework.\n\n\n\nBy the end of this exercise, you will be able to:\n\nBuild and prepare Origin-Destination (OD) flow data from scratch\nCalibrate unconstrained, singly-constrained, and doubly-constrained spatial interaction models\nInterpret distance decay effects and model parameters\nCompare model performance using appropriate metrics\nVisualize interaction patterns and flow maps\n\n\n\n\nWe will use: - Planning subzone boundaries (MP14_SUBZONE_NO_SEA_PL) - Synthetic OD flow data (generated based on spatial principles) - Population and employment attributes (synthetic but realistic)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#introduction",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#introduction",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "",
    "text": "Spatial Interaction Models (SIMs) are mathematical models for predicting flows between spatial entities. This hands-on exercise demonstrates the calibration of spatial interaction models using aspatial methods, following the gravity model framework."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#learning-objectives",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#learning-objectives",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "",
    "text": "By the end of this exercise, you will be able to:\n\nBuild and prepare Origin-Destination (OD) flow data from scratch\nCalibrate unconstrained, singly-constrained, and doubly-constrained spatial interaction models\nInterpret distance decay effects and model parameters\nCompare model performance using appropriate metrics\nVisualize interaction patterns and flow maps"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#the-data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#the-data",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "",
    "text": "We will use: - Planning subzone boundaries (MP14_SUBZONE_NO_SEA_PL) - Synthetic OD flow data (generated based on spatial principles) - Population and employment attributes (synthetic but realistic)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#loading-required-packages",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#loading-required-packages",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "2.1 Loading Required Packages",
    "text": "2.1 Loading Required Packages\n\npacman::p_load(tidyverse, sf, spdep, sp, tmap,\n               performance, reshape2, knitr,\n               ggpubr, corrplot, plotly,\n               DT, broom)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#setting-up-environment",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#setting-up-environment",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "2.2 Setting Up Environment",
    "text": "2.2 Setting Up Environment\n\n# Set tmap mode\ntmap_mode(\"plot\")\n\n# Set seed for reproducibility\nset.seed(1234)\n\n# Set number formatting\noptions(scipen = 999)\noptions(digits = 4)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#load-geospatial-data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#load-geospatial-data",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "3.1 Load Geospatial Data",
    "text": "3.1 Load Geospatial Data\n\n# Load planning subzones from local file\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                layer = \"MP14_SUBZONE_NO_SEA_PL\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\n# Check the data\ncat(\"Number of planning subzones:\", nrow(mpsz), \"\\n\")\n\nNumber of planning subzones: 323 \n\ncat(\"CRS:\", st_crs(mpsz)$input, \"\\n\")\n\nCRS: EPSG:3414 \n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 2, 2, 3, 4, 5, 4, 10, 12, 4, 6, 1, 1, 3, 8, 3, 7, 9, 2, 15,…\n$ SUBZONE_N  &lt;chr&gt; \"PEOPLE'S PARK\", \"BUKIT MERAH\", \"CHINATOWN\", \"PHILLIP\", \"RA…\n$ SUBZONE_C  &lt;chr&gt; \"OTSZ02\", \"BMSZ02\", \"OTSZ03\", \"DTSZ04\", \"DTSZ05\", \"OTSZ04\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"N\", \"Y\", \"Y\", \"Y\", \"Y\", \"N\", \"Y\", \"N\", \"Y\", \"Y\", \"Y\",…\n$ PLN_AREA_N &lt;chr&gt; \"OUTRAM\", \"BUKIT MERAH\", \"OUTRAM\", \"DOWNTOWN CORE\", \"DOWNTO…\n$ PLN_AREA_C &lt;chr&gt; \"OT\", \"BM\", \"OT\", \"DT\", \"DT\", \"OT\", \"BM\", \"DT\", \"BM\", \"DT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"B4120D23006C932A\", \"1C51019439A68700\", \"0FF1661344C84AED\",…\n$ FMEL_UPD_D &lt;date&gt; 2016-05-11, 2016-05-11, 2016-05-11, 2016-05-11, 2016-05-11…\n$ X_ADDR     &lt;dbl&gt; 28832, 26361, 29154, 29707, 29969, 29510, 27786, 30806, 272…\n$ Y_ADDR     &lt;dbl&gt; 29420, 29384, 29158, 29745, 29573, 29646, 29590, 29530, 296…\n$ SHAPE_Leng &lt;dbl&gt; 1822.2, 3075.0, 4297.6, 871.6, 1872.8, 1605.3, 3303.2, 2897…\n$ SHAPE_Area &lt;dbl&gt; 93140, 411723, 587223, 39438, 188767, 133007, 448128, 52120…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((29099 29640..., MULTIPOLYGON (…\n\n# Display first few records\nhead(mpsz, 3)\n\nSimple feature collection with 3 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25740 ymin: 28520 xmax: 29770 ymax: 29740\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND  PLN_AREA_N PLN_AREA_C\n1        1          2 PEOPLE'S PARK    OTSZ02      Y      OUTRAM         OT\n2        2          2   BUKIT MERAH    BMSZ02      N BUKIT MERAH         BM\n3        3          3     CHINATOWN    OTSZ03      Y      OUTRAM         OT\n        REGION_N REGION_C          INC_CRC FMEL_UPD_D X_ADDR Y_ADDR SHAPE_Leng\n1 CENTRAL REGION       CR B4120D23006C932A 2016-05-11  28832  29420       1822\n2 CENTRAL REGION       CR 1C51019439A68700 2016-05-11  26361  29384       3075\n3 CENTRAL REGION       CR 0FF1661344C84AED 2016-05-11  29154  29158       4298\n  SHAPE_Area                       geometry\n1      93140 MULTIPOLYGON (((29099 29640...\n2     411723 MULTIPOLYGON (((26750 29216...\n3     587223 MULTIPOLYGON (((29161 29723..."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#generate-population-and-employment-data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#generate-population-and-employment-data",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "3.2 Generate Population and Employment Data",
    "text": "3.2 Generate Population and Employment Data\n\n# Generate synthetic population data for each subzone\nset.seed(1234)\nn_zones &lt;- nrow(mpsz)\nzone_names &lt;- mpsz$SUBZONE_C\n\n# Create population by age groups\npop_data &lt;- data.frame(\n  SUBZONE_C = zone_names,\n  TOTAL_POP = round(runif(n_zones, 1000, 50000)),\n  AGE7_12 = round(runif(n_zones, 100, 5000)),    # School age\n  AGE13_24 = round(runif(n_zones, 200, 8000)),   # Young adults\n  AGE25_64 = round(runif(n_zones, 500, 30000))   # Working age\n) %&gt;%\n  mutate(\n    # Ensure age groups sum to less than total\n    AGE7_12 = pmin(AGE7_12, TOTAL_POP * 0.15),\n    AGE13_24 = pmin(AGE13_24, TOTAL_POP * 0.20),\n    AGE25_64 = pmin(AGE25_64, TOTAL_POP * 0.60)\n  )\n\n# Add employment data (correlated with working age population)\npop_data &lt;- pop_data %&gt;%\n  mutate(\n    EMPLOYMENT = round(AGE25_64 * runif(n_zones, 0.3, 0.7))\n  )\n\n# Display summary\nsummary(pop_data[, c(\"TOTAL_POP\", \"AGE25_64\", \"EMPLOYMENT\")])\n\n   TOTAL_POP        AGE25_64       EMPLOYMENT   \n Min.   : 1161   Min.   :  539   Min.   :  312  \n 1st Qu.:14031   1st Qu.: 4404   1st Qu.: 1990  \n Median :25227   Median : 8539   Median : 4123  \n Mean   :25119   Mean   : 9982   Mean   : 4885  \n 3rd Qu.:37351   3rd Qu.:14862   3rd Qu.: 6936  \n Max.   :49938   Max.   :28539   Max.   :16298"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#calculate-distance-matrix",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#calculate-distance-matrix",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "3.3 Calculate Distance Matrix",
    "text": "3.3 Calculate Distance Matrix\n\n# Calculate centroids\ncentroids &lt;- st_centroid(mpsz)\n\n# Calculate distance matrix\ndist_matrix &lt;- st_distance(centroids, centroids)\ndist_matrix &lt;- as.matrix(dist_matrix)\n\n# Set row and column names\nrownames(dist_matrix) &lt;- zone_names\ncolnames(dist_matrix) &lt;- zone_names\n\ncat(\"Distance matrix dimensions:\", dim(dist_matrix), \"\\n\")\n\nDistance matrix dimensions: 323 323 \n\ncat(\"Distance range (m):\", range(dist_matrix), \"\\n\")\n\nDistance range (m): 0 48233 \n\n# Convert to long format\ndist_df &lt;- as.data.frame(as.table(dist_matrix))\nnames(dist_df) &lt;- c(\"ORIGIN_SZ\", \"DESTIN_SZ\", \"dist\")\n\n# Remove intra-zonal flows\ndist_df &lt;- dist_df %&gt;%\n  filter(ORIGIN_SZ != DESTIN_SZ)\n\nhead(dist_df)\n\n  ORIGIN_SZ DESTIN_SZ       dist\n1    BMSZ02    OTSZ02 2471.2 [m]\n2    OTSZ03    OTSZ02  415.0 [m]\n3    DTSZ04    OTSZ02  933.4 [m]\n4    DTSZ05    OTSZ02 1147.1 [m]\n5    OTSZ04    OTSZ02  714.8 [m]\n6    BMSZ10    OTSZ02 1060.0 [m]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#generate-od-flow-data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#generate-od-flow-data",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "3.4 Generate OD Flow Data",
    "text": "3.4 Generate OD Flow Data\n\n# Generate realistic OD flows based on gravity model principles\nset.seed(1234)\n\n# Merge distance with population data\nod_base &lt;- dist_df %&gt;%\n  mutate(dist = as.numeric(dist)) %&gt;%  # 转换为数值，去除单位\n  left_join(pop_data %&gt;% select(SUBZONE_C, ORIG_POP = AGE25_64, ORIG_EMP = EMPLOYMENT),\n            by = c(\"ORIGIN_SZ\" = \"SUBZONE_C\")) %&gt;%\n  left_join(pop_data %&gt;% select(SUBZONE_C, DEST_POP = AGE25_64, DEST_EMP = EMPLOYMENT),\n            by = c(\"DESTIN_SZ\" = \"SUBZONE_C\"))\n\n# Generate flows using gravity model with noise\nod_flows &lt;- od_base %&gt;%\n  mutate(\n    # Basic gravity model: Flow = k * (Pop_i * Emp_j) / distance^beta\n    expected_flow = 0.01 * (ORIG_POP * DEST_EMP) / (dist^1.5),\n    # Add random variation\n    TRIPS = pmax(0, round(expected_flow * exp(rnorm(n(), 0, 0.5))))\n  ) %&gt;%\n  select(ORIGIN_SZ, DESTIN_SZ, dist, TRIPS)\n\n# Summary of generated flows\ncat(\"\\nGenerated OD flows summary:\\n\")\n\n\nGenerated OD flows summary:\n\ncat(\"Total OD pairs:\", nrow(od_flows), \"\\n\")\n\nTotal OD pairs: 104006 \n\ncat(\"Total trips:\", sum(od_flows$TRIPS), \"\\n\")\n\nTotal trips: 107448 \n\ncat(\"Zero flows:\", sum(od_flows$TRIPS == 0), \n    \"(\", round(sum(od_flows$TRIPS == 0)/nrow(od_flows)*100, 2), \"%)\\n\")\n\nZero flows: 68572 ( 65.93 %)\n\nsummary(od_flows$TRIPS)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    0.00    1.03    1.00  447.00"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#create-complete-sim_data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#create-complete-sim_data",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "3.5 Create Complete SIM_data",
    "text": "3.5 Create Complete SIM_data\n\n# Create the complete SIM_data dataset - OPTIMIZED VERSION\n\n# 1) Prepare attributes WITHOUT geometry (much faster!)\norig_attr &lt;- pop_data %&gt;%\n  select(SUBZONE_C, \n         ORIGIN_AGE7_12 = AGE7_12,\n         ORIGIN_AGE13_24 = AGE13_24,\n         ORIGIN_AGE25_64 = AGE25_64) %&gt;%\n  distinct(SUBZONE_C, .keep_all = TRUE)\n\ndest_attr &lt;- pop_data %&gt;%\n  select(SUBZONE_C,\n         DESTIN_AGE7_12 = AGE7_12,\n         DESTIN_AGE13_24 = AGE13_24,\n         DESTIN_AGE25_64 = AGE25_64) %&gt;%\n  distinct(SUBZONE_C, .keep_all = TRUE)\n\n# 2) Ensure character keys for consistent joining (check type first)\nod_flows &lt;- od_flows %&gt;%\n  mutate(ORIGIN_SZ = as.character(ORIGIN_SZ),\n         DESTIN_SZ = as.character(DESTIN_SZ))\n\n# Only convert if not already character\nif (!is.character(orig_attr$SUBZONE_C)) {\n  orig_attr &lt;- orig_attr %&gt;%\n    mutate(SUBZONE_C = as.character(SUBZONE_C))\n}\n\nif (!is.character(dest_attr$SUBZONE_C)) {\n  dest_attr &lt;- dest_attr %&gt;%\n    mutate(SUBZONE_C = as.character(SUBZONE_C))\n}\n\n# 3) Clean memory before big joins\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 3841016 205.2    6933212 370.3  6933212 370.3\nVcells 7480987  57.1   14786712 112.9 12255456  93.6\n\n# 4) Join without geometry - MUCH FASTER!\nSIM_data &lt;- od_flows %&gt;%\n  left_join(orig_attr, by = c(\"ORIGIN_SZ\" = \"SUBZONE_C\")) %&gt;%\n  left_join(dest_attr, by = c(\"DESTIN_SZ\" = \"SUBZONE_C\"))\n\n# 5) Handle potential zeros for log transformations\nage_columns &lt;- c(\"ORIGIN_AGE7_12\", \"ORIGIN_AGE13_24\", \"ORIGIN_AGE25_64\",\n                 \"DESTIN_AGE7_12\", \"DESTIN_AGE13_24\", \"DESTIN_AGE25_64\")\n\nfor (col in age_columns) {\n  if (col %in% names(SIM_data)) {\n    SIM_data[[col]] &lt;- ifelse(is.na(SIM_data[[col]]) | SIM_data[[col]] == 0, \n                              0.99, \n                              SIM_data[[col]])\n  }\n}\n\n# 6) Verify the dataset\nstopifnot(all(c(\"ORIGIN_SZ\", \"DESTIN_SZ\", \"TRIPS\", \"dist\") %in% names(SIM_data)))\n\n# Check the final dataset\nglimpse(SIM_data)\n\nRows: 104,006\nColumns: 10\n$ ORIGIN_SZ       &lt;chr&gt; \"BMSZ02\", \"OTSZ03\", \"DTSZ04\", \"DTSZ05\", \"OTSZ04\", \"BMS…\n$ DESTIN_SZ       &lt;chr&gt; \"OTSZ02\", \"OTSZ02\", \"OTSZ02\", \"OTSZ02\", \"OTSZ02\", \"OTS…\n$ dist            &lt;dbl&gt; 2471.2, 415.0, 933.4, 1147.1, 714.8, 1060.0, 1977.6, 1…\n$ TRIPS           &lt;dbl&gt; 2, 48, 1, 4, 8, 1, 1, 2, 4, 1, 32, 3, 0, 1, 4, 3, 1, 1…\n$ ORIGIN_AGE7_12  &lt;dbl&gt; 1762.0, 1899.0, 2194.0, 1013.0, 3324.0, 219.8, 1859.2,…\n$ ORIGIN_AGE13_24 &lt;dbl&gt; 6299, 4194, 6309, 2047, 5557, 293, 2479, 1529, 4168, 6…\n$ ORIGIN_AGE25_64 &lt;dbl&gt; 18896, 18512, 594, 23207, 6407, 879, 7437, 7531, 15719…\n$ DESTIN_AGE7_12  &lt;dbl&gt; 851, 851, 851, 851, 851, 851, 851, 851, 851, 851, 851,…\n$ DESTIN_AGE13_24 &lt;dbl&gt; 644, 644, 644, 644, 644, 644, 644, 644, 644, 644, 644,…\n$ DESTIN_AGE25_64 &lt;dbl&gt; 3943, 3943, 3943, 3943, 3943, 3943, 3943, 3943, 3943, …\n\ncat(\"\\nFinal SIM_data dimensions:\", dim(SIM_data), \"\\n\")\n\n\nFinal SIM_data dimensions: 104006 10 \n\ncat(\"Missing values in dist:\", sum(is.na(SIM_data$dist)), \"\\n\")\n\nMissing values in dist: 0 \n\ncat(\"Zero trips:\", sum(SIM_data$TRIPS == 0), \"\\n\")\n\nZero trips: 68572 \n\n# 7) Create directory if it doesn't exist and save\nif (!dir.exists(\"data/rds\")) {\n  dir.create(\"data/rds\", recursive = TRUE, showWarnings = FALSE)\n  cat(\"Created directory: data/rds\\n\")\n}\n\n# Save the data\nwrite_rds(SIM_data, \"data/rds/SIM_data.rds\")\ncat(\"\\nSIM_data successfully saved to data/rds/SIM_data.rds for use in Exercise 10b\\n\")\n\n\nSIM_data successfully saved to data/rds/SIM_data.rds for use in Exercise 10b\n\n# Verify file was saved\nif (file.exists(\"data/rds/SIM_data.rds\")) {\n  file_size &lt;- file.size(\"data/rds/SIM_data.rds\") / 1024 / 1024  # Convert to MB\n  cat(\"File size:\", round(file_size, 2), \"MB\\n\")\n} else {\n  cat(\"Warning: File was not saved successfully!\\n\")\n}\n\nFile size: 9.13 MB"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#flow-distribution",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#flow-distribution",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "4.1 Flow Distribution",
    "text": "4.1 Flow Distribution\n\n# Distribution of flows\np1 &lt;- ggplot(data = SIM_data,\n             aes(x = TRIPS)) +\n  geom_histogram(bins = 50,\n                 fill = \"lightblue\",\n                 color = \"black\") +\n  labs(title = \"Distribution of Trips\",\n       x = \"Number of Trips\",\n       y = \"Frequency\") +\n  theme_minimal()\n\np2 &lt;- ggplot(data = SIM_data %&gt;% filter(TRIPS &gt; 0),\n             aes(x = log(TRIPS + 1))) +\n  geom_histogram(bins = 50,\n                 fill = \"lightgreen\",\n                 color = \"black\") +\n  labs(title = \"Distribution of Log(Trips + 1)\",\n       x = \"Log(Number of Trips + 1)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\nggarrange(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n# Statistics\ncat(\"\\nFlow Statistics:\\n\")\n\n\nFlow Statistics:\n\nsummary(SIM_data$TRIPS)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    0.00    1.03    1.00  447.00 \n\ncat(\"Percentage of zero flows:\", \n    round(sum(SIM_data$TRIPS == 0)/nrow(SIM_data)*100, 2), \"%\\n\")\n\nPercentage of zero flows: 65.93 %"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#distance-decay-effect",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#distance-decay-effect",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "4.2 Distance Decay Effect",
    "text": "4.2 Distance Decay Effect\n\n# Filter and sample data for visualization (use sample for smooth calculation)\nSIM_data_positive &lt;- SIM_data %&gt;% \n  filter(TRIPS &gt; 0)\n\n# For smooth line, use a sample to speed up calculation\nSIM_data_sample &lt;- SIM_data_positive %&gt;%\n  sample_n(min(1000, nrow(SIM_data_positive)))\n\n# Distance decay plot - optimized version\nggplot() +\n  # All points with transparency\n  geom_point(data = SIM_data_positive,\n             aes(x = dist/1000, y = TRIPS),\n             alpha = 0.1, size = 0.5, color = \"darkblue\") +\n  # Smooth line using sample only\n  geom_smooth(data = SIM_data_sample,\n              aes(x = dist/1000, y = TRIPS),\n              method = \"loess\", color = \"red\", se = TRUE) +\n  scale_y_log10() +\n  scale_x_continuous(breaks = seq(0, 50, 10)) +\n  labs(title = \"Distance Decay Effect on Trips\",\n       subtitle = paste(\"Based on\", nrow(SIM_data_positive), \"positive flows\"),\n       x = \"Distance (km)\",\n       y = \"Number of Trips (log scale)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n# Correlation\ncor_test &lt;- cor.test(SIM_data$dist, SIM_data$TRIPS)\ncat(\"\\nCorrelation between distance and flow:\", \n    round(cor_test$estimate, 3), \"\\n\")\n\n\nCorrelation between distance and flow: -0.242"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#top-origin-destination-pairs",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#top-origin-destination-pairs",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "4.3 Top Origin-Destination Pairs",
    "text": "4.3 Top Origin-Destination Pairs\n\n# Top 15 OD pairs\ntop_flows &lt;- SIM_data %&gt;%\n  arrange(desc(TRIPS)) %&gt;%\n  head(15) %&gt;%\n  select(ORIGIN_SZ, DESTIN_SZ, TRIPS, dist, ORIGIN_AGE25_64, DESTIN_AGE25_64)\n\nkable(top_flows,\n      col.names = c(\"Origin\", \"Destination\", \"Trips\", \n                    \"Distance(m)\", \"Origin Working Age\", \"Dest Working Age\"),\n      caption = \"Top 15 Origin-Destination Pairs by Trip Volume\",\n      digits = 0)\n\n\nTop 15 Origin-Destination Pairs by Trip Volume\n\n\n\n\n\n\n\n\n\n\nOrigin\nDestination\nTrips\nDistance(m)\nOrigin Working Age\nDest Working Age\n\n\n\n\nRCSZ04\nRCSZ03\n447\n206\n15043\n11547\n\n\nRCSZ06\nRCSZ07\n344\n434\n15101\n17904\n\n\nRCSZ03\nRCSZ04\n333\n206\n11547\n15043\n\n\nDTSZ06\nDTSZ05\n324\n459\n15719\n23207\n\n\nRCSZ04\nRCSZ05\n305\n311\n15043\n11247\n\n\nTPSZ04\nTPSZ07\n195\n728\n14992\n12650\n\n\nAMSZ09\nAMSZ10\n193\n841\n22032\n23328\n\n\nAMSZ10\nAMSZ09\n180\n841\n23328\n22032\n\n\nRCSZ05\nRCSZ04\n175\n311\n11247\n15043\n\n\nPGSZ06\nPGSZ07\n173\n551\n18496\n16724\n\n\nMPSZ04\nMPSZ03\n169\n366\n9762\n6422\n\n\nBMSZ12\nBMSZ07\n166\n595\n15359\n25216\n\n\nDTSZ05\nDTSZ06\n165\n459\n23207\n15719\n\n\nAMSZ09\nAMSZ06\n161\n866\n22032\n22887\n\n\nMUSZ01\nRCSZ07\n153\n474\n15211\n17904"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#correlation-analysis",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#correlation-analysis",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "4.4 Correlation Analysis",
    "text": "4.4 Correlation Analysis\n\n# Select variables for correlation\ncor_data &lt;- SIM_data %&gt;%\n  select(TRIPS, dist, \n         ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,\n         DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64) %&gt;%\n  rename(\"Trips\" = TRIPS,\n         \"Distance\" = dist,\n         \"O_School\" = ORIGIN_AGE7_12,\n         \"O_Young\" = ORIGIN_AGE13_24,\n         \"O_Work\" = ORIGIN_AGE25_64,\n         \"D_School\" = DESTIN_AGE7_12,\n         \"D_Young\" = DESTIN_AGE13_24,\n         \"D_Work\" = DESTIN_AGE25_64)\n\n# Correlation matrix\ncor_matrix &lt;- cor(cor_data, use = \"complete.obs\")\n\n# Visualize\ncorrplot(cor_matrix,\n         method = \"color\",\n         type = \"upper\",\n         order = \"hclust\",\n         tl.cex = 0.8,\n         tl.col = \"black\",\n         addCoef.col = \"black\",\n         number.cex = 0.6)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#prepare-modeling-data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#prepare-modeling-data",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "5.1 Prepare Modeling Data",
    "text": "5.1 Prepare Modeling Data\n\n# Remove flows with zero or missing values for log transformation\nSIM_data_model &lt;- SIM_data %&gt;%\n  filter(TRIPS &gt; 0,\n         dist &gt; 0,\n         ORIGIN_AGE25_64 &gt; 0,\n         DESTIN_AGE25_64 &gt; 0) %&gt;%\n  mutate(\n    log_TRIPS = log(TRIPS),\n    log_DIST = log(dist),\n    log_ORIG_WORK = log(ORIGIN_AGE25_64),\n    log_DEST_WORK = log(DESTIN_AGE25_64)\n  )\n\ncat(\"Number of observations for modeling:\", nrow(SIM_data_model), \"\\n\")\n\nNumber of observations for modeling: 35434 \n\ncat(\"Percentage of data retained:\", \n    round(nrow(SIM_data_model)/nrow(SIM_data)*100, 2), \"%\\n\")\n\nPercentage of data retained: 34.07 %"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#unconstrained-model",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#unconstrained-model",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "5.2 Unconstrained Model",
    "text": "5.2 Unconstrained Model\n\n5.2.1 Basic Gravity Model\n\n# Unconstrained gravity model\nuncSIM &lt;- lm(log_TRIPS ~ log_ORIG_WORK + log_DEST_WORK + log_DIST,\n             data = SIM_data_model)\n\nsummary(uncSIM)\n\n\nCall:\nlm(formula = log_TRIPS ~ log_ORIG_WORK + log_DEST_WORK + log_DIST, \n    data = SIM_data_model)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.6649 -0.3100 -0.0135  0.2943  2.4018 \n\nCoefficients:\n              Estimate Std. Error t value            Pr(&gt;|t|)    \n(Intercept)   -2.56180    0.05349   -47.9 &lt;0.0000000000000002 ***\nlog_ORIG_WORK  0.65323    0.00437   149.3 &lt;0.0000000000000002 ***\nlog_DEST_WORK  0.64695    0.00434   149.1 &lt;0.0000000000000002 ***\nlog_DIST      -1.03215    0.00383  -269.7 &lt;0.0000000000000002 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.464 on 35430 degrees of freedom\nMultiple R-squared:  0.68,  Adjusted R-squared:  0.68 \nF-statistic: 2.51e+04 on 3 and 35430 DF,  p-value: &lt;0.0000000000000002\n\n# Extract parameters\nbeta_dist &lt;- -coef(uncSIM)[\"log_DIST\"]\ncat(\"\\nDistance decay parameter (β):\", round(beta_dist, 3), \"\\n\")\n\n\nDistance decay parameter (β): 1.032 \n\ncat(\"Interpretation: 1% increase in distance reduces flow by\", \n    round(beta_dist, 2), \"%\\n\")\n\nInterpretation: 1% increase in distance reduces flow by 1.03 %\n\n\n\n\n5.2.2 Model Diagnostics\n\n# Diagnostic plots\npar(mfrow = c(2, 2))\nplot(uncSIM)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Performance metrics\ncat(\"\\nModel Performance:\\n\")\n\n\nModel Performance:\n\ncat(\"R-squared:\", round(summary(uncSIM)$r.squared, 4), \"\\n\")\n\nR-squared: 0.6798 \n\ncat(\"Adjusted R-squared:\", round(summary(uncSIM)$adj.r.squared, 4), \"\\n\")\n\nAdjusted R-squared: 0.6798 \n\ncat(\"AIC:\", round(AIC(uncSIM), 2), \"\\n\")\n\nAIC: 46155 \n\ncat(\"BIC:\", round(BIC(uncSIM), 2), \"\\n\")\n\nBIC: 46198"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#origin-constrained-model",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#origin-constrained-model",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "5.3 Origin-Constrained Model",
    "text": "5.3 Origin-Constrained Model\n\n# Origin-constrained model with fixed effects\norcSIM &lt;- lm(log_TRIPS ~ ORIGIN_SZ + log_DEST_WORK + log_DIST,\n             data = SIM_data_model)\n\n# Display non-fixed effect coefficients\ncoef_summary &lt;- summary(orcSIM)$coefficients\nnon_fe_coefs &lt;- coef_summary[c(\"log_DEST_WORK\", \"log_DIST\"), ]\nprint(non_fe_coefs)\n\n              Estimate Std. Error t value Pr(&gt;|t|)\nlog_DEST_WORK   0.6459   0.004344   148.7        0\nlog_DIST       -1.0368   0.003956  -262.1        0\n\n# Model performance\ncat(\"\\nOrigin-Constrained Model Performance:\\n\")\n\n\nOrigin-Constrained Model Performance:\n\ncat(\"R-squared:\", round(summary(orcSIM)$r.squared, 4), \"\\n\")\n\nR-squared: 0.6839 \n\ncat(\"Adjusted R-squared:\", round(summary(orcSIM)$adj.r.squared, 4), \"\\n\")\n\nAdjusted R-squared: 0.681 \n\ncat(\"AIC:\", round(AIC(orcSIM), 2), \"\\n\")\n\nAIC: 46340"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#destination-constrained-model",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#destination-constrained-model",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "5.4 Destination-Constrained Model",
    "text": "5.4 Destination-Constrained Model\n\n# Destination-constrained model\ndecSIM &lt;- lm(log_TRIPS ~ DESTIN_SZ + log_ORIG_WORK + log_DIST,\n             data = SIM_data_model)\n\n# Display non-fixed effect coefficients\ncoef_summary_dec &lt;- summary(decSIM)$coefficients\nnon_fe_coefs_dec &lt;- coef_summary_dec[c(\"log_ORIG_WORK\", \"log_DIST\"), ]\nprint(non_fe_coefs_dec)\n\n              Estimate Std. Error t value Pr(&gt;|t|)\nlog_ORIG_WORK   0.6791   0.004145   163.9        0\nlog_DIST       -1.0680   0.003751  -284.8        0\n\n# Model performance\ncat(\"\\nDestination-Constrained Model Performance:\\n\")\n\n\nDestination-Constrained Model Performance:\n\ncat(\"R-squared:\", round(summary(decSIM)$r.squared, 4), \"\\n\")\n\nR-squared: 0.7195 \n\ncat(\"Adjusted R-squared:\", round(summary(decSIM)$adj.r.squared, 4), \"\\n\")\n\nAdjusted R-squared: 0.7169 \n\ncat(\"AIC:\", round(AIC(decSIM), 2), \"\\n\")\n\nAIC: 42112"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#doubly-constrained-model",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#doubly-constrained-model",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "5.5 Doubly-Constrained Model",
    "text": "5.5 Doubly-Constrained Model\n\n# Doubly-constrained model\ndbcSIM &lt;- lm(log_TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log_DIST,\n             data = SIM_data_model)\n\n# Extract distance coefficient\ndistance_coef &lt;- coef(dbcSIM)[\"log_DIST\"]\ncat(\"Distance decay parameter (β):\", round(-distance_coef, 3), \"\\n\")\n\nDistance decay parameter (β): 1.071 \n\ncat(\"Standard error:\", round(summary(dbcSIM)$coefficients[\"log_DIST\", 2], 4), \"\\n\")\n\nStandard error: 0.0039 \n\ncat(\"t-value:\", round(summary(dbcSIM)$coefficients[\"log_DIST\", 3], 2), \"\\n\")\n\nt-value: -278 \n\n# Model performance\ncat(\"\\nDoubly-Constrained Model Performance:\\n\")\n\n\nDoubly-Constrained Model Performance:\n\ncat(\"R-squared:\", round(summary(dbcSIM)$r.squared, 4), \"\\n\")\n\nR-squared: 0.7233 \n\ncat(\"Adjusted R-squared:\", round(summary(dbcSIM)$adj.r.squared, 4), \"\\n\")\n\nAdjusted R-squared: 0.7182 \n\ncat(\"AIC:\", round(AIC(dbcSIM), 2), \"\\n\")\n\nAIC: 42262"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#enhanced-model-with-multiple-age-groups",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#enhanced-model-with-multiple-age-groups",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "5.6 Enhanced Model with Multiple Age Groups",
    "text": "5.6 Enhanced Model with Multiple Age Groups\n\n# Add multiple age group variables\nattSIM &lt;- lm(log_TRIPS ~ log_ORIG_WORK + log_DEST_WORK + log_DIST +\n             log(ORIGIN_AGE13_24 + 1) + log(DESTIN_AGE13_24 + 1) +\n             log(ORIGIN_AGE7_12 + 1) + log(DESTIN_AGE7_12 + 1),\n             data = SIM_data_model)\n\nsummary(attSIM)\n\n\nCall:\nlm(formula = log_TRIPS ~ log_ORIG_WORK + log_DEST_WORK + log_DIST + \n    log(ORIGIN_AGE13_24 + 1) + log(DESTIN_AGE13_24 + 1) + log(ORIGIN_AGE7_12 + \n    1) + log(DESTIN_AGE7_12 + 1), data = SIM_data_model)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.6596 -0.3082 -0.0137  0.2948  2.4033 \n\nCoefficients:\n                         Estimate Std. Error t value            Pr(&gt;|t|)    \n(Intercept)              -2.66894    0.06055  -44.08 &lt;0.0000000000000002 ***\nlog_ORIG_WORK             0.65351    0.00451  144.89 &lt;0.0000000000000002 ***\nlog_DEST_WORK             0.64078    0.00448  143.04 &lt;0.0000000000000002 ***\nlog_DIST                 -1.03242    0.00383 -269.64 &lt;0.0000000000000002 ***\nlog(ORIGIN_AGE13_24 + 1) -0.00221    0.00301   -0.74              0.4623    \nlog(DESTIN_AGE13_24 + 1)  0.00914    0.00302    3.03              0.0024 ** \nlog(ORIGIN_AGE7_12 + 1)   0.00174    0.00347    0.50              0.6147    \nlog(DESTIN_AGE7_12 + 1)   0.01286    0.00345    3.72              0.0002 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.464 on 35426 degrees of freedom\nMultiple R-squared:  0.68,  Adjusted R-squared:  0.68 \nF-statistic: 1.08e+04 on 7 and 35426 DF,  p-value: &lt;0.0000000000000002\n\n# Model performance\ncat(\"\\nEnhanced Model Performance:\\n\")\n\n\nEnhanced Model Performance:\n\ncat(\"R-squared:\", round(summary(attSIM)$r.squared, 4), \"\\n\")\n\nR-squared: 0.6801 \n\ncat(\"Adjusted R-squared:\", round(summary(attSIM)$adj.r.squared, 4), \"\\n\")\n\nAdjusted R-squared: 0.68 \n\ncat(\"AIC:\", round(AIC(attSIM), 2), \"\\n\")\n\nAIC: 46132"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#performance-metrics-comparison",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#performance-metrics-comparison",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "6.1 Performance Metrics Comparison",
    "text": "6.1 Performance Metrics Comparison\n\n# Create comparison table\nmodel_comparison &lt;- data.frame(\n  Model = c(\"Unconstrained\", \"Origin-Constrained\", \n            \"Destination-Constrained\", \"Doubly-Constrained\",\n            \"Enhanced\"),\n  R2 = c(summary(uncSIM)$r.squared,\n         summary(orcSIM)$r.squared,\n         summary(decSIM)$r.squared,\n         summary(dbcSIM)$r.squared,\n         summary(attSIM)$r.squared),\n  Adj_R2 = c(summary(uncSIM)$adj.r.squared,\n             summary(orcSIM)$adj.r.squared,\n             summary(decSIM)$adj.r.squared,\n             summary(dbcSIM)$adj.r.squared,\n             summary(attSIM)$adj.r.squared),\n  AIC = c(AIC(uncSIM), AIC(orcSIM), AIC(decSIM), \n          AIC(dbcSIM), AIC(attSIM)),\n  BIC = c(BIC(uncSIM), BIC(orcSIM), BIC(decSIM), \n          BIC(dbcSIM), BIC(attSIM))\n) %&gt;%\n  arrange(desc(R2))\n\nkable(model_comparison,\n      digits = 4,\n      caption = \"Model Performance Comparison\")\n\n\nModel Performance Comparison\n\n\nModel\nR2\nAdj_R2\nAIC\nBIC\n\n\n\n\nDoubly-Constrained\n0.7233\n0.7182\n42262\n47746\n\n\nDestination-Constrained\n0.7195\n0.7169\n42112\n44875\n\n\nOrigin-Constrained\n0.6839\n0.6810\n46340\n49103\n\n\nEnhanced\n0.6801\n0.6800\n46132\n46208\n\n\nUnconstrained\n0.6798\n0.6798\n46155\n46198\n\n\n\n\n# Visualize comparison\nmodel_comp_long &lt;- model_comparison %&gt;%\n  select(Model, R2, Adj_R2) %&gt;%\n  pivot_longer(cols = c(R2, Adj_R2),\n               names_to = \"Metric\",\n               values_to = \"Value\")\n\nggplot(model_comp_long,\n       aes(x = reorder(Model, Value), y = Value, fill = Metric)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  coord_flip() +\n  labs(title = \"Model Performance Comparison\",\n       x = \"Model\",\n       y = \"R-squared Value\") +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Set2\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#residual-analysis",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#residual-analysis",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "6.2 Residual Analysis",
    "text": "6.2 Residual Analysis\n\n# Prepare residuals\nmodels &lt;- list(\n  \"Unconstrained\" = uncSIM,\n  \"Origin-Constrained\" = orcSIM,\n  \"Destination-Constrained\" = decSIM,\n  \"Doubly-Constrained\" = dbcSIM\n)\n\n# Create residual plots\npar(mfrow = c(2, 2))\nfor(name in names(models)) {\n  plot(fitted(models[[name]]), residuals(models[[name]]),\n       main = paste(name, \"Model\"),\n       xlab = \"Fitted Values\",\n       ylab = \"Residuals\",\n       pch = 20, col = rgb(0, 0, 1, 0.3))\n  abline(h = 0, col = \"red\", lty = 2)\n}\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#prediction-comparison",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#prediction-comparison",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "6.3 Prediction Comparison",
    "text": "6.3 Prediction Comparison\n\n# Compare predictions from unconstrained and doubly-constrained models\nSIM_data_model &lt;- SIM_data_model %&gt;%\n  mutate(\n    pred_unc = exp(fitted(uncSIM)),\n    pred_dbc = exp(fitted(dbcSIM)),\n    actual = TRIPS\n  )\n\n# Scatter plots\np1 &lt;- ggplot(SIM_data_model,\n             aes(x = actual, y = pred_unc)) +\n  geom_point(alpha = 0.3, size = 0.8, color = \"blue\") +\n  geom_abline(intercept = 0, slope = 1, color = \"red\", linetype = \"dashed\") +\n  scale_x_log10() +\n  scale_y_log10() +\n  labs(title = \"Unconstrained Model\",\n       x = \"Actual Trips (log scale)\",\n       y = \"Predicted Trips (log scale)\") +\n  theme_minimal()\n\np2 &lt;- ggplot(SIM_data_model,\n             aes(x = actual, y = pred_dbc)) +\n  geom_point(alpha = 0.3, size = 0.8, color = \"green\") +\n  geom_abline(intercept = 0, slope = 1, color = \"red\", linetype = \"dashed\") +\n  scale_x_log10() +\n  scale_y_log10() +\n  labs(title = \"Doubly-Constrained Model\",\n       x = \"Actual Trips (log scale)\",\n       y = \"Predicted Trips (log scale)\") +\n  theme_minimal()\n\nggarrange(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n# Calculate prediction metrics\ncalc_metrics &lt;- function(actual, predicted) {\n  rmse &lt;- sqrt(mean((actual - predicted)^2))\n  mae &lt;- mean(abs(actual - predicted))\n  mape &lt;- mean(abs((actual - predicted) / actual)) * 100\n  return(c(RMSE = rmse, MAE = mae, MAPE = mape))\n}\n\nmetrics_unc &lt;- calc_metrics(SIM_data_model$actual, SIM_data_model$pred_unc)\nmetrics_dbc &lt;- calc_metrics(SIM_data_model$actual, SIM_data_model$pred_dbc)\n\nmetrics_table &lt;- data.frame(\n  Model = c(\"Unconstrained\", \"Doubly-Constrained\"),\n  RMSE = c(metrics_unc[\"RMSE\"], metrics_dbc[\"RMSE\"]),\n  MAE = c(metrics_unc[\"MAE\"], metrics_dbc[\"MAE\"]),\n  MAPE = c(metrics_unc[\"MAPE\"], metrics_dbc[\"MAPE\"])\n)\n\nkable(metrics_table,\n      digits = 2,\n      caption = \"Prediction Error Metrics\")\n\n\nPrediction Error Metrics\n\n\nModel\nRMSE\nMAE\nMAPE\n\n\n\n\nUnconstrained\n6.20\n1.37\n38.54\n\n\nDoubly-Constrained\n5.82\n1.27\n35.74"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#flow-maps",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#flow-maps",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "7.1 Flow Maps",
    "text": "7.1 Flow Maps\n\n# Select top 50 flows for visualization\ntop_flows &lt;- SIM_data %&gt;%\n  arrange(desc(TRIPS)) %&gt;%\n  head(50)\n\n# Get coordinates for flow lines\norigin_coords &lt;- centroids %&gt;%\n  filter(SUBZONE_C %in% top_flows$ORIGIN_SZ) %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  mutate(ORIGIN_SZ = centroids$SUBZONE_C[centroids$SUBZONE_C %in% top_flows$ORIGIN_SZ])\n\ndest_coords &lt;- centroids %&gt;%\n  filter(SUBZONE_C %in% top_flows$DESTIN_SZ) %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  mutate(DESTIN_SZ = centroids$SUBZONE_C[centroids$SUBZONE_C %in% top_flows$DESTIN_SZ])\n\n# Create flow lines\nflow_lines &lt;- top_flows %&gt;%\n  left_join(origin_coords, by = \"ORIGIN_SZ\") %&gt;%\n  rename(o_X = X, o_Y = Y) %&gt;%\n  left_join(dest_coords, by = \"DESTIN_SZ\") %&gt;%\n  rename(d_X = X, d_Y = Y)\n\n# Function to create line\ncreate_line &lt;- function(row) {\n  if(!is.na(row$o_X) && !is.na(row$d_X)) {\n    coords &lt;- matrix(c(row$o_X, row$o_Y, row$d_X, row$d_Y),\n                     ncol = 2, byrow = TRUE)\n    st_linestring(coords)\n  } else {\n    NULL\n  }\n}\n\n# Create sf object with lines\nflow_sf &lt;- flow_lines %&gt;%\n  filter(!is.na(o_X) & !is.na(d_X)) %&gt;%\n  rowwise() %&gt;%\n  mutate(geometry = list(create_line(cur_data()))) %&gt;%\n  ungroup() %&gt;%\n  st_as_sf() %&gt;%\n  st_set_crs(3414)\n\n# Map\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey90\",\n              border.col = \"grey50\",\n              lwd = 0.5) +\ntm_shape(flow_sf) +\n  tm_lines(col = \"TRIPS\",\n           lwd = \"TRIPS\",\n           scale = 5,\n           style = \"quantile\",\n           palette = \"YlOrRd\",\n           alpha = 0.6,\n           title.col = \"Trip Volume\",\n           title.lwd = \"Flow Volume\",\n           legend.lwd.show = FALSE) +\n  tm_layout(main.title = \"Top 50 Origin-Destination Flows\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#distance-decay-curves",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#distance-decay-curves",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "7.2 Distance Decay Curves",
    "text": "7.2 Distance Decay Curves\n\n# Extract distance decay parameters\nmodels_beta &lt;- data.frame(\n  Model = c(\"Unconstrained\", \"Origin-Constrained\", \n            \"Destination-Constrained\", \"Doubly-Constrained\"),\n  Beta = c(-coef(uncSIM)[\"log_DIST\"],\n           -coef(orcSIM)[\"log_DIST\"],\n           -coef(decSIM)[\"log_DIST\"],\n           -coef(dbcSIM)[\"log_DIST\"])\n)\n\n# Create distance decay curves\ndist_seq &lt;- seq(0.5, 50, by = 0.5)  # Distance in km\ndecay_curves &lt;- data.frame(Distance = dist_seq)\n\nfor(i in 1:nrow(models_beta)) {\n  decay_curves[[models_beta$Model[i]]] &lt;- exp(-models_beta$Beta[i] * log(dist_seq))\n}\n\n# Reshape for plotting\ndecay_long &lt;- decay_curves %&gt;%\n  pivot_longer(cols = -Distance,\n               names_to = \"Model\",\n               values_to = \"Interaction\")\n\n# Plot\nggplot(decay_long,\n       aes(x = Distance, y = Interaction, color = Model)) +\n  geom_line(size = 1.2) +\n  labs(title = \"Distance Decay Functions by Model Type\",\n       x = \"Distance (km)\",\n       y = \"Relative Interaction Intensity\") +\n  theme_minimal() +\n  scale_color_brewer(palette = \"Set1\") +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#interactive-visualization",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#interactive-visualization",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "7.3 Interactive Visualization",
    "text": "7.3 Interactive Visualization\n\n# Create interactive plot\nlibrary(plotly)\n\n# Sample data for performance\nplot_data &lt;- SIM_data_model %&gt;%\n  sample_n(min(1000, nrow(.)))\n\np &lt;- plot_ly(data = plot_data,\n             x = ~dist/1000,\n             y = ~TRIPS,\n             color = ~log(DESTIN_AGE25_64),\n             size = ~ORIGIN_AGE25_64,\n             text = ~paste(\"Origin:\", ORIGIN_SZ,\n                          \"&lt;br&gt;Destination:\", DESTIN_SZ,\n                          \"&lt;br&gt;Trips:\", TRIPS,\n                          \"&lt;br&gt;Distance:\", round(dist/1000, 1), \"km\",\n                          \"&lt;br&gt;Origin Working Pop:\", ORIGIN_AGE25_64,\n                          \"&lt;br&gt;Dest Working Pop:\", DESTIN_AGE25_64),\n             type = 'scatter',\n             mode = 'markers',\n             marker = list(sizemode = 'diameter',\n                          opacity = 0.5),\n             hoverinfo = 'text') %&gt;%\n  layout(title = \"Interactive Flow Visualization\",\n         xaxis = list(title = \"Distance (km)\",\n                     type = \"log\"),\n         yaxis = list(title = \"Trips\",\n                     type = \"log\"),\n         showlegend = FALSE)\n\np"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#summary-of-results",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#summary-of-results",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "8.1 Summary of Results",
    "text": "8.1 Summary of Results\n\n# Extract key parameters from best models\nkey_params &lt;- data.frame(\n  Parameter = c(\"Distance Decay (Unconstrained)\",\n                \"Distance Decay (Doubly-Constrained)\",\n                \"Origin Working Pop Elasticity\",\n                \"Destination Working Pop Elasticity\"),\n  Value = c(round(-coef(uncSIM)[\"log_DIST\"], 3),\n            round(-coef(dbcSIM)[\"log_DIST\"], 3),\n            round(coef(uncSIM)[\"log_ORIG_WORK\"], 3),\n            round(coef(uncSIM)[\"log_DEST_WORK\"], 3)),\n  Interpretation = c(\n    \"1% increase in distance reduces flow by this %\",\n    \"Distance effect when controlling for zone sizes\",\n    \"1% increase in origin working pop increases flow by this %\",\n    \"1% increase in destination working pop increases flow by this %\"\n  )\n)\n\nkable(key_params,\n      caption = \"Key Model Parameters and Their Interpretations\")\n\n\nKey Model Parameters and Their Interpretations\n\n\n\n\n\n\n\nParameter\nValue\nInterpretation\n\n\n\n\nDistance Decay (Unconstrained)\n1.032\n1% increase in distance reduces flow by this %\n\n\nDistance Decay (Doubly-Constrained)\n1.071\nDistance effect when controlling for zone sizes\n\n\nOrigin Working Pop Elasticity\n0.653\n1% increase in origin working pop increases flow by this %\n\n\nDestination Working Pop Elasticity\n0.647\n1% increase in destination working pop increases flow by this %"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#model-selection-guidance",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#model-selection-guidance",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "8.2 Model Selection Guidance",
    "text": "8.2 Model Selection Guidance\n\ncat(\"Model Selection Recommendations:\\n\")\n\nModel Selection Recommendations:\n\ncat(strrep(\"=\", 50), \"\\n\\n\")  # 修正：使用 strrep 而不是 * \n\n================================================== \n\n# Best model by criterion\nbest_r2 &lt;- model_comparison$Model[which.max(model_comparison$R2)]\nbest_aic &lt;- model_comparison$Model[which.min(model_comparison$AIC)]\n\ncat(\"1. Highest R-squared:\", best_r2, \n    \"(R² =\", round(max(model_comparison$R2), 3), \")\\n\")\n\n1. Highest R-squared: Doubly-Constrained (R² = 0.723 )\n\ncat(\"2. Lowest AIC:\", best_aic,\n    \"(AIC =\", round(min(model_comparison$AIC), 0), \")\\n\\n\")\n\n2. Lowest AIC: Destination-Constrained (AIC = 42112 )\n\ncat(\"Practical Recommendations:\\n\")\n\nPractical Recommendations:\n\ncat(\"- For understanding general patterns: Use Unconstrained Model\\n\")\n\n- For understanding general patterns: Use Unconstrained Model\n\ncat(\"- For trip generation studies: Use Origin-Constrained Model\\n\")\n\n- For trip generation studies: Use Origin-Constrained Model\n\ncat(\"- For destination choice: Use Destination-Constrained Model\\n\")\n\n- For destination choice: Use Destination-Constrained Model\n\ncat(\"- For fixed trip matrices: Use Doubly-Constrained Model\\n\")\n\n- For fixed trip matrices: Use Doubly-Constrained Model\n\ncat(\"- For policy analysis: Include demographic variables\\n\")\n\n- For policy analysis: Include demographic variables"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#key-insights",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#key-insights",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "9.1 Key Insights",
    "text": "9.1 Key Insights\nThis analysis of spatial interaction models reveals:\n\nStrong Distance Decay: Distance is consistently the strongest predictor of interaction flows\nConstraint Effects: Adding constraints significantly improves model fit, with doubly-constrained models achieving the highest R²\nDemographic Influences: Working-age population is the key demographic driver of flows\nModel Trade-offs:\n\nUnconstrained models: Most interpretable but lowest fit\nConstrained models: Better fit but less generalizable\nEnhanced models: Balance between fit and interpretability"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#applications",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#applications",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "9.2 Applications",
    "text": "9.2 Applications\nThese models can inform: - Transport Planning: Predict traffic flows for new infrastructure - Service Location: Optimize facility placement - Urban Development: Understand and predict movement patterns - Policy Analysis: Evaluate impacts of demographic changes"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#data-export-for-exercise-10b",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#data-export-for-exercise-10b",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "9.3 Data Export for Exercise 10b",
    "text": "9.3 Data Export for Exercise 10b\n\n# Ensure data is saved for next exercise\ncat(\"Data exported for Exercise 10b:\\n\")\n\nData exported for Exercise 10b:\n\ncat(\"- SIM_data saved to: data/rds/SIM_data.rds\\n\")\n\n- SIM_data saved to: data/rds/SIM_data.rds\n\ncat(\"- Number of OD pairs:\", nrow(SIM_data), \"\\n\")\n\n- Number of OD pairs: 104006 \n\ncat(\"- Variables included:\", paste(names(SIM_data), collapse = \", \"), \"\\n\")\n\n- Variables included: ORIGIN_SZ, DESTIN_SZ, dist, TRIPS, ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64, DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10a.html#next-steps",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10a.html#next-steps",
    "title": "Hands-on Exercise 10a: Aspatial Spatial Interaction Models",
    "section": "9.4 Next Steps",
    "text": "9.4 Next Steps\nIn Exercise 10b, we will: - Account for spatial autocorrelation in flows - Apply spatial econometric models using the spflow package - Compare aspatial vs spatial model performance - Explore network effects and spatial spillovers\n\nEnd of Exercise 10a: Aspatial Spatial Interaction Models"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/data/geospatial/ELDERCARE.html",
    "href": "Hands-on_Ex/Hands-on_ex10/data/geospatial/ELDERCARE.html",
    "title": "ISSS626 Portfolio — HUANG PENGXIN",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;  ELDERCARE  ENG dataset\n\nELDERCARE\n\n                 0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/data/geospatial/hexagons.html",
    "href": "Hands-on_Ex/Hands-on_ex09/data/geospatial/hexagons.html",
    "title": "ISSS626 Portfolio — HUANG PENGXIN",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n                 0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to compute Global and Local Measures of Spatial Autocorrelation (GLSA) using Singapore HDB resale price data. We will explore spatial patterns in housing prices and identify clusters of high and low value properties.\n\n\nBy the end of this session, you will be able to:\n\nCompute global spatial autocorrelation statistics (Moran’s I and Geary’s C)\nPerform permutation tests for global spatial autocorrelation\nCompute and visualize local indicators of spatial association (LISA)\nDetect hot spots and cold spots using Getis-Ord Gi* statistics\nCreate various spatial autocorrelation visualizations"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#overview",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to compute Global and Local Measures of Spatial Autocorrelation (GLSA) using Singapore HDB resale price data. We will explore spatial patterns in housing prices and identify clusters of high and low value properties.\n\n\nBy the end of this session, you will be able to:\n\nCompute global spatial autocorrelation statistics (Moran’s I and Geary’s C)\nPerform permutation tests for global spatial autocorrelation\nCompute and visualize local indicators of spatial association (LISA)\nDetect hot spots and cold spots using Getis-Ord Gi* statistics\nCreate various spatial autocorrelation visualizations"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#getting-started",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "2. Getting Started",
    "text": "2. Getting Started\n\n2.1 Setting Global Options\n\n# 全局防止打印过多输出\nknitr::opts_chunk$set(message = FALSE, warning = FALSE)\noptions(max.print = 1000, \n        tibble.print_max = 60, \n        tibble.width = Inf,\n        dplyr.print_max = 60)\n\n\n\n2.2 Loading Required Packages\n\npacman::p_load(sf, spdep, tmap, tidyverse, \n               plotly, ggplot2, GGally, viridis, \n               knitr, DT)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#importing-and-exploring-data",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#importing-and-exploring-data",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "3. Importing and Exploring Data",
    "text": "3. Importing and Exploring Data\n\n3.1 Import the Data\n\n# Load the preprocessed data\nmdata &lt;- readRDS(\"data/rawdata/mdata.rds\")\n\n# Display data information\ncat(\"Dataset Information:\\n\")\n\nDataset Information:\n\ncat(\"- Type:\", class(mdata)[1], \"\\n\")\n\n- Type: sf \n\ncat(\"- Observations:\", format(nrow(mdata), big.mark = \",\"), \"\\n\")\n\n- Observations: 15,901 \n\ncat(\"- Variables:\", ncol(mdata), \"\\n\")\n\n- Variables: 18 \n\ncat(\"- Geometry:\", unique(st_geometry_type(mdata)), \"\\n\")\n\n- Geometry: 2 \n\ncat(\"- CRS:\", st_crs(mdata)$input, \"\\n\")\n\n- CRS: EPSG:3414 \n\n\n\n\n3.2 Data Summary\n\n# Summary statistics of key variables\nmdata %&gt;%\n  st_drop_geometry() %&gt;%\n  select(resale_price, floor_area_sqm, remaining_lease_mths, \n         PROX_CBD, PROX_MRT, PROX_MALL) %&gt;%\n  summary()\n\n  resale_price     floor_area_sqm   remaining_lease_mths    PROX_CBD      \n Min.   : 218000   Min.   : 74.00   Min.   : 546.0       Min.   : 0.9994  \n 1st Qu.: 353000   1st Qu.: 91.00   1st Qu.: 798.0       1st Qu.:10.1651  \n Median : 405000   Median : 93.00   Median : 936.0       Median :13.4356  \n Mean   : 433588   Mean   : 95.15   Mean   : 939.8       Mean   :12.5368  \n 3rd Qu.: 470000   3rd Qu.:102.00   3rd Qu.:1111.0       3rd Qu.:15.4162  \n Max.   :1186888   Max.   :138.00   Max.   :1164.0       Max.   :19.6501  \n    PROX_MRT         PROX_MALL     \n Min.   :0.02204   Min.   :0.0000  \n 1st Qu.:0.30141   1st Qu.:0.3690  \n Median :0.53671   Median :0.5701  \n Mean   :0.60983   Mean   :0.6358  \n 3rd Qu.:0.82722   3rd Qu.:0.8319  \n Max.   :2.13061   Max.   :2.2710"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#visualizing-the-study-area",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#visualizing-the-study-area",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "4. Visualizing the Study Area",
    "text": "4. Visualizing the Study Area\n\n4.1 Distribution of Resale Prices\n\n# Histogram\np1 &lt;- ggplot(data = mdata, \n             aes(x = resale_price/1000)) +\n  geom_histogram(bins = 50, \n                 fill = \"lightblue\", \n                 color = \"black\") +\n  labs(title = \"Distribution of HDB Resale Prices\",\n       x = \"Resale Price (S$'000)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\n# Log-transformed prices\np2 &lt;- ggplot(data = mdata,\n             aes(x = log(resale_price))) +\n  geom_histogram(bins = 50,\n                fill = \"lightgreen\",\n                color = \"black\") +\n  labs(title = \"Distribution of Log Resale Prices\",\n       x = \"Log(Resale Price)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\nlibrary(gridExtra)\ngrid.arrange(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n4.2 Spatial Distribution of Resale Prices\n\n# Map resale prices with smaller points\ntmap_mode(\"plot\")\ntm_shape(mdata) +\n  tm_dots(\"resale_price\",\n          size = 0.008,\n          style = \"quantile\",\n          palette = \"YlOrRd\",\n          title = \"Resale Price (S$)\",\n          n = 5,\n          alpha = 0.6) +\n  tm_layout(main.title = \"Distribution of HDB Resale Prices in Singapore\",\n            main.title.size = 1.0,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n4.3 Relationship with Key Variables (Sample)\n\n# Sample data for plotting\nset.seed(1234)\nmdata_sample &lt;- mdata[sample(nrow(mdata), 2000), ]\n\n# Price vs Floor Area\np1 &lt;- ggplot(mdata_sample, aes(x = floor_area_sqm, y = resale_price/1000)) +\n  geom_point(alpha = 0.5, size = 1) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\") +\n  labs(title = \"Price vs Floor Area (n=2000)\",\n       x = \"Floor Area (sqm)\",\n       y = \"Price (S$'000)\") +\n  theme_minimal()\n\n# Price vs Distance to CBD\np2 &lt;- ggplot(mdata_sample, aes(x = PROX_CBD, y = resale_price/1000)) +\n  geom_point(alpha = 0.5, size = 1) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"blue\") +\n  labs(title = \"Price vs Distance to CBD\",\n       x = \"Distance to CBD (km)\",\n       y = \"Price (S$'000)\") +\n  theme_minimal()\n\ngrid.arrange(p1, p2, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#computing-spatial-weights-matrix",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#computing-spatial-weights-matrix",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "5. Computing Spatial Weights Matrix",
    "text": "5. Computing Spatial Weights Matrix\n\n5.1 K-Nearest Neighbors\n\n# Extract coordinates\ncoords &lt;- st_coordinates(mdata)\n\n# Create k-nearest neighbors (k=8)\nknn8 &lt;- knn2nb(knearneigh(coords, k = 8))\n\n# Display summary only\ncat(\"K-Nearest Neighbors (k=8) Summary:\\n\")\n\nK-Nearest Neighbors (k=8) Summary:\n\ncat(\"- Number of regions:\", format(length(knn8), big.mark = \",\"), \"\\n\")\n\n- Number of regions: 15,901 \n\ncat(\"- Number of nonzero links:\", format(sum(card(knn8)), big.mark = \",\"), \"\\n\")\n\n- Number of nonzero links: 127,208 \n\ncat(\"- All regions have exactly\", unique(card(knn8)), \"neighbors\\n\")\n\n- All regions have exactly 8 neighbors\n\n\n\n\n5.2 Creating Spatial Weights\n\n# Row-standardized weights for KNN\nknn8_lw &lt;- nb2listw(knn8, style = \"W\")\n\n# Display info only\ncat(\"Spatial weights created successfully:\\n\")\n\nSpatial weights created successfully:\n\ncat(\"- Style: W (row-standardized)\\n\")\n\n- Style: W (row-standardized)\n\ncat(\"- Zero policy: FALSE\\n\")\n\n- Zero policy: FALSE\n\n\n\n\n5.3 Visualizing Spatial Weights (Small Sample)\n\n# Small sample for visualization\nset.seed(1234)\nsample_idx &lt;- sample(1:nrow(mdata), 200)\nmdata_sample &lt;- mdata[sample_idx, ]\ncoords_sample &lt;- coords[sample_idx, ]\nknn8_sample &lt;- knn2nb(knearneigh(coords_sample, k = 8))\n\n# Plot\nplot(st_geometry(mdata_sample), col = \"lightgrey\", \n     main = \"K-Nearest Neighbors (k=8) - Sample of 200 Points\")\nplot(knn8_sample, coords_sample, add = TRUE, col = \"red\", lwd = 0.5)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#global-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#global-spatial-autocorrelation",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "6. Global Spatial Autocorrelation",
    "text": "6. Global Spatial Autocorrelation\n\n6.1 Moran’s I Test\n\n# Moran's I test\nmoran_result &lt;- moran.test(mdata$resale_price, \n                           listw = knn8_lw, \n                           zero.policy = TRUE, \n                           na.action = na.omit)\nprint(moran_result)\n\n\n    Moran I test under randomisation\n\ndata:  mdata$resale_price  \nweights: knn8_lw    \n\nMoran I statistic standard deviate = 250.21, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     9.271867e-01     -6.289308e-05      1.373381e-05 \n\n\n\n\n6.2 Monte Carlo Moran’s I (Optimized)\n\n# Set seed\nset.seed(1234)\n\n# Monte Carlo simulation with 499 simulations (faster)\nMC_moran &lt;- moran.mc(mdata$resale_price, \n                     listw = knn8_lw, \n                     nsim = 499,  # Reduced from 999\n                     zero.policy = TRUE, \n                     na.action = na.omit)\n\nprint(MC_moran)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  mdata$resale_price \nweights: knn8_lw  \nnumber of simulations + 1: 500 \n\nstatistic = 0.92719, observed rank = 500, p-value = 0.002\nalternative hypothesis: greater\n\n# Visualization\nhist(MC_moran$res, \n     freq = TRUE, \n     breaks = 40,\n     col = \"lightblue\",\n     main = \"Monte Carlo Simulation of Moran's I (499 simulations)\",\n     xlab = \"Simulated Moran's I\")\nabline(v = MC_moran$statistic, \n       col = \"red\", \n       lwd = 2)\n\n\n\n\n\n\n\n\n\n\n6.3 Geary’s C Test (Optimized)\n\n# Geary's C test\ngeary_result &lt;- geary.test(mdata$resale_price, \n                           listw = knn8_lw,\n                           zero.policy = TRUE)\nprint(geary_result)\n\n\n    Geary C test under randomisation\n\ndata:  mdata$resale_price \nweights: knn8_lw   \n\nGeary C statistic standard deviate = 147.8, p-value &lt; 2.2e-16\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n     8.688547e-02      1.000000e+00      3.816706e-05 \n\n# Monte Carlo Geary's C with reduced simulations\nset.seed(1234)\nMC_geary &lt;- geary.mc(mdata$resale_price, \n                     listw = knn8_lw, \n                     nsim = 499,  # Reduced from 999\n                     zero.policy = TRUE)\nprint(MC_geary)\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  mdata$resale_price \nweights: knn8_lw  \nnumber of simulations + 1: 500 \n\nstatistic = 0.086885, observed rank = 1, p-value = 0.002\nalternative hypothesis: greater"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#spatial-correlogram-optimized",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#spatial-correlogram-optimized",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "7. Spatial Correlogram (Optimized)",
    "text": "7. Spatial Correlogram (Optimized)\n\n# Create correlogram for different k values\nk_values &lt;- c(5, 10, 15, 20, 30, 50, 75, 100)\n\ncorrelogram_data &lt;- data.frame(\n  k = integer(),\n  moran_i = numeric(),\n  p_value = numeric()\n)\n\nfor(k in k_values) {\n  # 每个k值都需要重新计算knn\n  knn_temp &lt;- knn2nb(knearneigh(coords, k = k))\n  knn_temp_lw &lt;- nb2listw(knn_temp, style = \"W\")\n  \n  moran_result &lt;- moran.test(mdata$resale_price, \n                             listw = knn_temp_lw,\n                             zero.policy = TRUE)\n  \n  correlogram_data &lt;- rbind(correlogram_data,\n                            data.frame(k = k,\n                                     moran_i = moran_result$estimate[1],\n                                     p_value = moran_result$p.value))\n}\n\n# Plot\nggplot(correlogram_data, aes(x = k, y = moran_i)) +\n  geom_line(color = \"blue\", size = 1) +\n  geom_point(color = \"red\", size = 3) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"grey50\") +\n  labs(title = \"Spatial Correlogram - Moran's I\",\n       subtitle = \"Effect of number of neighbors on spatial autocorrelation\",\n       x = \"Number of Nearest Neighbors (k)\",\n       y = \"Moran's I\") +\n  theme_minimal()"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#local-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#local-spatial-autocorrelation",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "8. Local Spatial Autocorrelation",
    "text": "8. Local Spatial Autocorrelation\n\n8.1 Computing Local Moran’s I\n\n# Compute local Moran's I\nlocalMI &lt;- localmoran(mdata$resale_price, \n                      knn8_lw,\n                      zero.policy = TRUE,\n                      na.action = na.omit)\n\n# Add to data\nmdata$Ii &lt;- localMI[, \"Ii\"]\nmdata$Z_Ii &lt;- localMI[, \"Z.Ii\"]\nmdata$P_value &lt;- localMI[, \"Pr(z != E(Ii))\"]\n\n# Summary only\ncat(\"Local Moran's I computed for\", format(nrow(localMI), big.mark = \",\"), \"observations\\n\")\n\nLocal Moran's I computed for 15,901 observations\n\ncat(\"\\nLocal Moran's I Summary:\\n\")\n\n\nLocal Moran's I Summary:\n\nsummary(mdata$Ii)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-2.27777  0.04857  0.30138  0.92719  0.81068 27.64117 \n\n\n\n\n8.2 Mapping Local Moran’s I Statistics\n\n# Create significance categories\nmdata$P_sig &lt;- cut(mdata$P_value,\n                   breaks = c(0, 0.001, 0.01, 0.05, 1),\n                   labels = c(\"p &lt; 0.001\", \"p &lt; 0.01\", \"p &lt; 0.05\", \"Not Sig.\"),\n                   include.lowest = TRUE)\n\n# Maps with very small dots\ntm1 &lt;- tm_shape(mdata) +\n  tm_dots(\"Ii\",\n          size = 0.003,\n          style = \"quantile\",\n          palette = \"-RdBu\",\n          title = \"Local Moran's I\",\n          n = 5,\n          alpha = 0.7) +\n  tm_layout(main.title = \"Local Moran's I Values\",\n            main.title.size = 0.8)\n\ntm2 &lt;- tm_shape(mdata) +\n  tm_dots(\"P_sig\",\n          size = 0.003,\n          palette = c(\"darkgreen\", \"green\", \"lightgreen\", \"grey95\"),\n          title = \"Significance\",\n          alpha = 0.7) +\n  tm_layout(main.title = \"P-values\",\n            main.title.size = 0.8)\n\ntmap_arrange(tm1, tm2, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n8.3 Creating LISA Cluster Map\n\n# Standardize variables\nmdata$z_price &lt;- scale(mdata$resale_price)[,1]\nmdata$lag_z_price &lt;- lag.listw(knn8_lw, mdata$z_price,\n                                zero.policy = TRUE)\n\n# Define LISA categories\nmdata$quadrant &lt;- NA\nmdata$quadrant[mdata$z_price &gt; 0 & mdata$lag_z_price &gt; 0] &lt;- \"HH\"\nmdata$quadrant[mdata$z_price &lt; 0 & mdata$lag_z_price &lt; 0] &lt;- \"LL\"  \nmdata$quadrant[mdata$z_price &gt; 0 & mdata$lag_z_price &lt; 0] &lt;- \"HL\"\nmdata$quadrant[mdata$z_price &lt; 0 & mdata$lag_z_price &gt; 0] &lt;- \"LH\"\n\n# Keep only significant clusters\nmdata$quadrant_sig &lt;- ifelse(mdata$P_value &lt;= 0.05,\n                              mdata$quadrant,\n                              \"Not Significant\")\n\n# Summary table\ncat(\"LISA Cluster Distribution:\\n\")\n\nLISA Cluster Distribution:\n\ntable(mdata$quadrant_sig) %&gt;% \n  as.data.frame() %&gt;%\n  kable(col.names = c(\"Cluster Type\", \"Count\"),\n        format = \"simple\")\n\n\n\n\nCluster Type\nCount\n\n\n\n\nHH\n2829\n\n\nHL\n2\n\n\nLH\n50\n\n\nLL\n3662\n\n\nNot Significant\n9358\n\n\n\n\n\n\n\n8.4 Visualizing LISA Clusters\n\n# LISA cluster map\ntm_shape(mdata) +\n  tm_dots(\"quadrant_sig\",\n          size = 0.008,\n          palette = c(\"red\", \"lightblue\", \"pink\", \"blue\", \"grey95\"),\n          title = \"LISA Clusters\",\n          alpha = 0.8) +\n  tm_layout(main.title = \"LISA Cluster Map - HDB Resale Prices (p &lt; 0.05)\",\n            main.title.size = 1.0,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n8.5 Moran Scatterplot\n\n# Moran scatterplot without labels\npar(mar = c(5, 4, 4, 2))\nmoran.plot(mdata$resale_price, knn8_lw,\n           labels = FALSE,\n           xlab = \"Resale Price\",\n           ylab = \"Spatially Lagged Resale Price\",\n           main = \"Moran Scatterplot\",\n           quiet = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#hot-spot-and-cold-spot-analysis",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#hot-spot-and-cold-spot-analysis",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "9. Hot Spot and Cold Spot Analysis",
    "text": "9. Hot Spot and Cold Spot Analysis\n\n9.1 Computing Getis-Ord Gi* Statistics\n\n# Create binary weights for Gi*\nknn8_lw_B &lt;- nb2listw(knn8, style = \"B\")\n\n# Compute Gi* statistics\ngi_stats &lt;- localG(mdata$resale_price, knn8_lw_B)\n\n# Add to data\nmdata$gi_stats &lt;- as.numeric(gi_stats)\n\n# Summary\ncat(\"Gi* Statistics Summary:\\n\")\n\nGi* Statistics Summary:\n\nsummary(mdata$gi_stats)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-4.52464 -1.84222 -0.67625  0.02955  0.81311 13.49530 \n\n\n\n\n9.2 Visualizing Hot and Cold Spots\n\n# Create categories\nmdata$gi_category &lt;- cut(mdata$gi_stats,\n                         breaks = c(-Inf, -2.58, -1.96, -1.65,\n                                   1.65, 1.96, 2.58, Inf),\n                         labels = c(\"Cold Spot (99%)\",\n                                   \"Cold Spot (95%)\",\n                                   \"Cold Spot (90%)\",\n                                   \"Not Significant\",\n                                   \"Hot Spot (90%)\",\n                                   \"Hot Spot (95%)\",\n                                   \"Hot Spot (99%)\"),\n                         include.lowest = TRUE)\n\n# Map\ntm_shape(mdata) +\n  tm_dots(\"gi_category\",\n          size = 0.008,\n          palette = c(\"darkblue\", \"blue\", \"lightblue\",\n                     \"grey95\",\n                     \"pink\", \"red\", \"darkred\"),\n          title = \"Hot/Cold Spots\",\n          alpha = 0.8) +\n  tm_layout(main.title = \"Hot and Cold Spots of HDB Resale Prices\",\n            main.title.size = 1.0,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n# Summary table\ncat(\"\\nHot/Cold Spot Distribution:\\n\")\n\n\nHot/Cold Spot Distribution:\n\ntable(mdata$gi_category) %&gt;%\n  as.data.frame() %&gt;%\n  kable(col.names = c(\"Category\", \"Count\"),\n        format = \"simple\")\n\n\n\n\nCategory\nCount\n\n\n\n\nCold Spot (99%)\n1671\n\n\nCold Spot (95%)\n1993\n\n\nCold Spot (90%)\n881\n\n\nNot Significant\n8155\n\n\nHot Spot (90%)\n322\n\n\nHot Spot (95%)\n578\n\n\nHot Spot (99%)\n2301"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#summary-results",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#summary-results",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "10. Summary Results",
    "text": "10. Summary Results\n\n10.1 Overall Statistics\n\n# Summary table\nsummary_stats &lt;- data.frame(\n  Statistic = c(\"Observations\",\n                \"Global Moran's I\",\n                \"Global Geary's C\",\n                \"Significant LISA (p&lt;0.05)\",\n                \"HH Clusters\",\n                \"LL Clusters\",\n                \"Hot Spots (95%)\",\n                \"Cold Spots (95%)\"),\n  Value = c(format(nrow(mdata), big.mark = \",\"),\n            round(MC_moran$statistic, 4),\n            round(MC_geary$statistic, 4),\n            format(sum(mdata$P_value &lt;= 0.05), big.mark = \",\"),\n            format(sum(mdata$quadrant_sig == \"HH\"), big.mark = \",\"),\n            format(sum(mdata$quadrant_sig == \"LL\"), big.mark = \",\"),\n            format(sum(mdata$gi_stats &gt; 1.96), big.mark = \",\"),\n            format(sum(mdata$gi_stats &lt; -1.96), big.mark = \",\"))\n)\n\nkable(summary_stats, \n      caption = \"Summary of Spatial Autocorrelation Results\",\n      format = \"simple\")\n\n\nSummary of Spatial Autocorrelation Results\n\n\nStatistic\nValue\n\n\n\n\nObservations\n15,901\n\n\nGlobal Moran’s I\n0.9272\n\n\nGlobal Geary’s C\n0.0869\n\n\nSignificant LISA (p&lt;0.05)\n6,543\n\n\nHH Clusters\n2,829\n\n\nLL Clusters\n3,662\n\n\nHot Spots (95%)\n2,879\n\n\nCold Spots (95%)\n3,664\n\n\n\n\n\n\n\n10.2 Top Locations (Interactive Table)\n\n# Top hot spots\ntop_hotspots &lt;- mdata %&gt;%\n  st_drop_geometry() %&gt;%\n  filter(gi_stats &gt; 2.58) %&gt;%\n  arrange(desc(gi_stats)) %&gt;%\n  select(resale_price, floor_area_sqm, PROX_CBD, gi_stats) %&gt;%\n  slice_head(n = 10) %&gt;%\n  mutate(resale_price = format(resale_price, big.mark = \",\"),\n         across(c(floor_area_sqm, PROX_CBD, gi_stats), ~round(., 2)))\n\ncat(\"Top 10 Hot Spots:\\n\")\n\nTop 10 Hot Spots:\n\nDT::datatable(top_hotspots, \n              options = list(dom = 't', \n                            pageLength = 10),\n              rownames = FALSE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#interactive-visualization-optimized",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#interactive-visualization-optimized",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "11. Interactive Visualization (Optimized)",
    "text": "11. Interactive Visualization (Optimized)\n\n# Sample for interactive map\nset.seed(1234)\nmdata_interactive &lt;- mdata[sample(nrow(mdata), 1500), ]\n\ntmap_mode(\"view\")\ntm_shape(mdata_interactive) +\n  tm_dots(\"resale_price\",\n          size = 0.02,\n          style = \"quantile\",\n          palette = \"YlOrRd\",\n          title = \"Price\",\n          popup.vars = c(\"Price\" = \"resale_price\",\n                        \"Floor Area\" = \"floor_area_sqm\",\n                        \"LISA\" = \"quadrant_sig\",\n                        \"Hot/Cold\" = \"gi_category\"),\n          clustering = TRUE)  # Enable clustering for performance\n\n\n\n\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#save-results",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#save-results",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "12. Save Results",
    "text": "12. Save Results\n\n# Save enhanced dataset\nsaveRDS(mdata, \"data/model/mdata_analyzed.rds\")\n\n# Create compact summary\nresults_summary &lt;- list(\n  n_obs = nrow(mdata),\n  global_moran = round(MC_moran$statistic, 4),\n  global_geary = round(MC_geary$statistic, 4),\n  n_significant = sum(mdata$P_value &lt;= 0.05),\n  date = Sys.Date()\n)\n\nsaveRDS(results_summary, \"data/model/spatial_autocorr_results.rds\")\n\ncat(\"✅ Analysis complete! Results saved to data/model/\\n\")\n\n✅ Analysis complete! Results saved to data/model/"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#conclusions",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "13. Conclusions",
    "text": "13. Conclusions\n\nKey Findings\nThis spatial autocorrelation analysis of 15,901 HDB resale transactions reveals:\n\nStrong Positive Spatial Autocorrelation:\n\nGlobal Moran’s I confirms significant spatial clustering\nSimilar-priced properties cluster together\n\nDistinct Spatial Patterns:\n\nHH clusters in prime locations\nLL clusters in peripheral areas\nSpatial outliers indicate transitional zones\n\nPolicy Implications:\n\nSpatial spillover effects are significant\nTargeted area-based interventions needed\nInfrastructure improvements can reduce spatial inequality\n\n\n\n\nMethodological Notes\n\nLarge dataset (15,901 points) requires computational optimization\nK=8 nearest neighbors appropriate for dense point patterns\nResults robust across different specifications"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to perform spatially constrained clustering using Myanmar township data. We will explore three clustering methods:\n\nHierarchical clustering (non-spatial)\nSKATER (Spatial ’K’luster Analysis by Tree Edge Removal)\nClustGeo (Hierarchical clustering with spatial constraints)\n\nThe analysis focuses on ICT (Information and Communication Technology) development patterns in Shan State, Myanmar."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#overview",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to perform spatially constrained clustering using Myanmar township data. We will explore three clustering methods:\n\nHierarchical clustering (non-spatial)\nSKATER (Spatial ’K’luster Analysis by Tree Edge Removal)\nClustGeo (Hierarchical clustering with spatial constraints)\n\nThe analysis focuses on ICT (Information and Communication Technology) development patterns in Shan State, Myanmar."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#getting-started",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "2. Getting Started",
    "text": "2. Getting Started\n\n2.1 Loading Required Packages\n\npacman::p_load(sf, tidyverse, tmap, spdep, cluster, \n               ClustGeo, heatmaply, GGally, \n               factoextra, NbClust, corrplot, \n               ggpubr, plotly, psych, DT)\n\n\n\n2.2 Data Import\n\n2.2.1 Import Geospatial Data\n\n# Import Myanmar township boundaries\nmyanmar_sf &lt;- st_read(dsn = \"data/geospatial\", \n                       layer = \"myanmar_township_boundaries\",\n                       quiet = TRUE) %&gt;%\n  st_transform(crs = 32647)  # Transform to UTM Zone 47N for Myanmar\n\n# Check the data structure\nglimpse(myanmar_sf)\n\nRows: 330\nColumns: 15\n$ OBJECTID   &lt;dbl&gt; 250, 163, 96, 147, 263, 167, 25, 300, 284, 148, 232, 29, 20…\n$ ST         &lt;chr&gt; \"Kachin\", \"Shan (North)\", \"Bago (East)\", \"Bago (West)\", \"Ma…\n$ ST_PCODE   &lt;chr&gt; \"MMR001\", \"MMR015\", \"MMR007\", \"MMR008\", \"MMR010\", \"MMR001\",…\n$ DT         &lt;chr&gt; \"Mohnyin\", \"Mongmit\", \"Bago\", \"Pyay\", \"Pyinoolwin\", \"Bhamo\"…\n$ DT_PCODE   &lt;chr&gt; \"MMR001D002\", \"MMR015D008\", \"MMR007D001\", \"MMR008D001\", \"MM…\n$ TS         &lt;chr&gt; \"Hpakant\", \"Mongmit\", \"Waw\", \"Paukkhaung\", \"Mogoke\", \"Shweg…\n$ TS_PCODE   &lt;chr&gt; \"MMR001009\", \"MMR015017\", \"MMR007004\", \"MMR008002\", \"MMR010…\n$ ST_2       &lt;chr&gt; \"Kachin State\", \"Shan State (North)\", \"Bago Region (East)\",…\n$ LABEL2     &lt;chr&gt; \"Hpakant\\n169795\", \"Mongmit\\n61072\", \"Waw\\n199032\", \"Paukkh…\n$ SELF_ADMIN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"Danu\", \"Da…\n$ ST_RG      &lt;chr&gt; \"State\", \"State\", \"Region\", \"Region\", \"Region\", \"State\", \"R…\n$ T_NAME_WIN &lt;chr&gt; \"zm;uefU\", \"rdk;rdwf\", \"a0g\", \"aygufacgif;\", \"rdk;ukwf\", \"a…\n$ T_NAME_M3  &lt;chr&gt; \"ဖားကန့်\", \"မိုးမိတ်\", \"ဝေါ\", \"ပေါက်ခေါင်း\", \"မိုးကုတ်\", \"ရွှေကူ\", \"ကျောက်ကြီး\", \"သုံ…\n$ AREA       &lt;dbl&gt; 5761.29637, 2703.61143, 952.43979, 1918.67341, 1178.50763, …\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((215945.2 28..., MULTIPOLYGON (…\n\n# Display first few rows\nhead(myanmar_sf, n = 3)\n\nSimple feature collection with 3 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 194025.7 ymin: 1919833 xmax: 303401 ymax: 2893747\nProjected CRS: WGS 84 / UTM zone 47N\n  OBJECTID           ST ST_PCODE      DT   DT_PCODE      TS  TS_PCODE\n1      250       Kachin   MMR001 Mohnyin MMR001D002 Hpakant MMR001009\n2      163 Shan (North)   MMR015 Mongmit MMR015D008 Mongmit MMR015017\n3       96  Bago (East)   MMR007    Bago MMR007D001     Waw MMR007004\n                ST_2          LABEL2 SELF_ADMIN  ST_RG T_NAME_WIN T_NAME_M3\n1       Kachin State Hpakant\\n169795       &lt;NA&gt;  State    zm;uefU     ဖားကန့်\n2 Shan State (North)  Mongmit\\n61072       &lt;NA&gt;  State   rdk;rdwf      မိုးမိတ်\n3 Bago Region (East)     Waw\\n199032       &lt;NA&gt; Region        a0g       ဝေါ\n       AREA                       geometry\n1 5761.2964 MULTIPOLYGON (((215945.2 28...\n2 2703.6114 MULTIPOLYGON (((291179.2 25...\n3  952.4398 MULTIPOLYGON (((246886.7 19...\n\n\n\n\n2.2.2 Import ICT Indicator Data\n\n# Read ICT data\nict &lt;- read_csv(\"data/aspatial/Shan-ICT.csv\",\n                show_col_types = FALSE)\n\n# Check data structure\nglimpse(ict)\n\nRows: 55\nColumns: 11\n$ `District Pcode`   &lt;chr&gt; \"MMR014D001\", \"MMR014D001\", \"MMR014D001\", \"MMR014D0…\n$ `District Name`    &lt;chr&gt; \"Taunggyi\", \"Taunggyi\", \"Taunggyi\", \"Taunggyi\", \"Ta…\n$ `Township Pcode`   &lt;chr&gt; \"MMR014001\", \"MMR014002\", \"MMR014003\", \"MMR014004\",…\n$ `Township Name`    &lt;chr&gt; \"Taunggyi\", \"Nyaungshwe\", \"Hopong\", \"Hsihseng\", \"Ka…\n$ `Total households` &lt;dbl&gt; 82604, 42634, 24728, 32771, 41341, 17544, 18348, 25…\n$ Radio              &lt;dbl&gt; 30176, 13801, 5083, 8087, 11607, 7324, 8890, 10048,…\n$ Television         &lt;dbl&gt; 62388, 23640, 11272, 16568, 25285, 8862, 4781, 1635…\n$ `Land line phone`  &lt;dbl&gt; 6736, 810, 799, 1042, 1739, 348, 219, 818, 728, 800…\n$ `Mobile phone`     &lt;dbl&gt; 48461, 14973, 5192, 4755, 16900, 2849, 2207, 8321, …\n$ Computer           &lt;dbl&gt; 6705, 669, 358, 325, 1225, 226, 81, 565, 351, 381, …\n$ `Internet at home` &lt;dbl&gt; 9746, 1604, 631, 580, 1741, 136, 152, 556, 737, 316…\n\n# Display summary statistics\nsummary(ict[,5:11])  # Assuming ICT indicators are in columns 5-11\n\n Total households     Radio         Television    Land line phone \n Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685    Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  \n  Mobile phone      Computer      Internet at home\n Min.   :  150   Min.   :  20.0   Min.   :   8.0  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  \n Median : 3559   Median : 244.0   Median : 316.0  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#data-wrangling",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#data-wrangling",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "3. Data Wrangling",
    "text": "3. Data Wrangling\n\n3.1 Extract Shan State\n\n# Filter townships in Shan State\nshan_sf &lt;- myanmar_sf %&gt;%\n  filter(ST %in% c(\"Shan (East)\", \"Shan (North)\", \"Shan (South)\"))\n\n# Check the result\ncat(\"Number of townships in Shan State:\", nrow(shan_sf), \"\\n\")\n\nNumber of townships in Shan State: 55 \n\nunique(shan_sf$ST)\n\n[1] \"Shan (North)\" \"Shan (South)\" \"Shan (East)\" \n\n# Plot to verify\ntmap_mode(\"plot\")\ntm_shape(shan_sf) +\n  tm_polygons(\"ST\", \n              palette = \"Set2\",\n              title = \"Shan State\") +\n  tm_layout(main.title = \"Townships in Shan State, Myanmar\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n3.2 Join Geospatial and Aspatial Data\n\n# Prepare join key - ensure column names match\n# Check column names first\ncat(\"Shapefile columns:\\n\")\n\nShapefile columns:\n\nprint(names(shan_sf))\n\n [1] \"OBJECTID\"   \"ST\"         \"ST_PCODE\"   \"DT\"         \"DT_PCODE\"  \n [6] \"TS\"         \"TS_PCODE\"   \"ST_2\"       \"LABEL2\"     \"SELF_ADMIN\"\n[11] \"ST_RG\"      \"T_NAME_WIN\" \"T_NAME_M3\"  \"AREA\"       \"geometry\"  \n\ncat(\"\\nICT data columns:\\n\")\n\n\nICT data columns:\n\nprint(names(ict))\n\n [1] \"District Pcode\"   \"District Name\"    \"Township Pcode\"   \"Township Name\"   \n [5] \"Total households\" \"Radio\"            \"Television\"       \"Land line phone\" \n [9] \"Mobile phone\"     \"Computer\"         \"Internet at home\"\n\n# Perform the join - 注意列名有空格！\n# TS_PCODE in shapefile matches with \"Township Pcode\" in ICT data\nshan_ict &lt;- left_join(shan_sf, \n                      ict, \n                      by = c(\"TS_PCODE\" = \"Township Pcode\"))\n\n# Alternative: 如果上面的还是不行，可以先重命名ICT的列\n# ict &lt;- ict %&gt;%\n#   rename(TS_PCODE = `Township Pcode`,\n#          DT_PCODE = `District Pcode`,\n#          Total_households = `Total households`,\n#          Land_line_phone = `Land line phone`,\n#          Mobile_phone = `Mobile phone`,\n#          Internet_at_home = `Internet at home`)\n# \n# shan_ict &lt;- left_join(shan_sf, ict, by = \"TS_PCODE\")\n\n# Check for missing values after join\nmissing_check &lt;- shan_ict %&gt;%\n  st_drop_geometry() %&gt;%\n  select(Radio, Television, \n         `Land line phone`, `Mobile phone`, \n         Computer, `Internet at home`) %&gt;%\n  summarise_all(~sum(is.na(.)))\n\nprint(\"Missing values in ICT columns:\")\n\n[1] \"Missing values in ICT columns:\"\n\nprint(missing_check)\n\n  Radio Television Land line phone Mobile phone Computer Internet at home\n1     0          0               0            0        0                0\n\n# Check if join was successful\ncat(\"\\nNumber of rows after join:\", nrow(shan_ict), \"\\n\")\n\n\nNumber of rows after join: 55 \n\ncat(\"Number of townships with ICT data:\", \n    sum(!is.na(shan_ict$Radio)), \"\\n\")\n\nNumber of townships with ICT data: 55 \n\n\n\n\n3.3 Derive ICT Penetration Rates\n\n# Calculate penetration rates (per 1000 households)\n# 注意列名有空格，需要使用反引号\nshan_ict &lt;- shan_ict %&gt;%\n  mutate(\n    RADIO_PR = Radio / `Total households` * 1000,\n    TV_PR = Television / `Total households` * 1000,\n    LLPHONE_PR = `Land line phone` / `Total households` * 1000,\n    MOBILE_PR = `Mobile phone` / `Total households` * 1000,\n    COMPUTER_PR = Computer / `Total households` * 1000,\n    INTERNET_PR = `Internet at home` / `Total households` * 1000\n  )\n\n# Check the calculated rates\nsummary(shan_ict[c(\"RADIO_PR\", \"TV_PR\", \"LLPHONE_PR\", \n                   \"MOBILE_PR\", \"COMPUTER_PR\", \"INTERNET_PR\")])\n\n    RADIO_PR          TV_PR         LLPHONE_PR       MOBILE_PR     \n Min.   : 21.05   Min.   :116.0   Min.   :  2.78   Min.   : 36.42  \n 1st Qu.:138.95   1st Qu.:450.2   1st Qu.: 22.84   1st Qu.:190.14  \n Median :210.95   Median :517.2   Median : 37.59   Median :305.27  \n Mean   :215.68   Mean   :509.5   Mean   : 51.09   Mean   :314.05  \n 3rd Qu.:268.07   3rd Qu.:606.4   3rd Qu.: 69.72   3rd Qu.:428.43  \n Max.   :484.52   Max.   :842.5   Max.   :181.49   Max.   :735.43  \n  COMPUTER_PR      INTERNET_PR               geometry \n Min.   : 3.278   Min.   :  1.041   MULTIPOLYGON :55  \n 1st Qu.:11.832   1st Qu.:  8.617   epsg:32647   : 0  \n Median :18.970   Median : 22.829   +proj=utm ...: 0  \n Mean   :24.393   Mean   : 30.644                     \n 3rd Qu.:29.897   3rd Qu.: 41.281                     \n Max.   :92.402   Max.   :117.985                     \n\n# Check for any infinite or NaN values (divide by zero)\ninf_check &lt;- shan_ict %&gt;%\n  st_drop_geometry() %&gt;%\n  select(RADIO_PR:INTERNET_PR) %&gt;%\n  summarise_all(~sum(is.infinite(.))) \n\nnan_check &lt;- shan_ict %&gt;%\n  st_drop_geometry() %&gt;%\n  select(RADIO_PR:INTERNET_PR) %&gt;%\n  summarise_all(~sum(is.nan(.)))\n\nprint(\"Infinite values:\")\n\n[1] \"Infinite values:\"\n\nprint(inf_check)\n\n  RADIO_PR TV_PR LLPHONE_PR MOBILE_PR COMPUTER_PR INTERNET_PR\n1        0     0          0         0           0           0\n\nprint(\"NaN values:\")\n\n[1] \"NaN values:\"\n\nprint(nan_check)\n\n  RADIO_PR TV_PR LLPHONE_PR MOBILE_PR COMPUTER_PR INTERNET_PR\n1        0     0          0         0           0           0\n\n\n\n\n3.4 Data Cleaning\n\n# Save the complete dataset first\nwrite_rds(shan_ict, \"data/rds/shan_ict_complete.rds\")\n\n# Remove rows with missing values in penetration rates\nshan_ict_clean &lt;- shan_ict %&gt;%\n  filter(complete.cases(RADIO_PR, TV_PR, LLPHONE_PR, \n                        MOBILE_PR, COMPUTER_PR, INTERNET_PR))\n\ncat(\"Rows before cleaning:\", nrow(shan_ict), \"\\n\")\n\nRows before cleaning: 55 \n\ncat(\"Rows after cleaning:\", nrow(shan_ict_clean), \"\\n\")\n\nRows after cleaning: 55 \n\ncat(\"Rows removed:\", nrow(shan_ict) - nrow(shan_ict_clean), \"\\n\")\n\nRows removed: 0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#exploratory-data-analysis",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#exploratory-data-analysis",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "4. Exploratory Data Analysis",
    "text": "4. Exploratory Data Analysis\n\n4.1 Statistical Summary\n\n# Create summary table for ICT indicators\nict_vars &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  select(RADIO_PR, TV_PR, LLPHONE_PR, MOBILE_PR, COMPUTER_PR, INTERNET_PR)\n\n# Summary statistics\ndescribe(ict_vars)\n\n            vars  n   mean     sd median trimmed    mad    min    max  range\nRADIO_PR       1 55 215.68 105.36 210.95  209.36  99.53  21.05 484.52 463.47\nTV_PR          2 55 509.49 159.40 517.25  515.08 124.43 116.03 842.53 726.50\nLLPHONE_PR     3 55  51.09  40.71  37.59   45.17  27.56   2.78 181.49 178.71\nMOBILE_PR      4 55 314.05 175.67 305.27  303.29 177.50  36.42 735.43 699.01\nCOMPUTER_PR    5 55  24.39  20.52  18.97   20.68  13.03   3.28  92.40  89.12\nINTERNET_PR    6 55  30.64  28.58  22.83   26.20  23.20   1.04 117.98 116.94\n             skew kurtosis    se\nRADIO_PR     0.48    -0.27 14.21\nTV_PR       -0.38    -0.23 21.49\nLLPHONE_PR   1.37     1.49  5.49\nMOBILE_PR    0.48    -0.34 23.69\nCOMPUTER_PR  1.80     2.96  2.77\nINTERNET_PR  1.32     1.24  3.85\n\n\n\n\n4.2 Distribution of ICT Indicators\n\n# Create histogram for each ICT indicator\nict_long &lt;- ict_vars %&gt;%\n  pivot_longer(everything(), \n               names_to = \"ICT_Type\", \n               values_to = \"Rate\")\n\np1 &lt;- ggplot(ict_long, aes(x = Rate)) +\n  geom_histogram(bins = 20, fill = \"steelblue\", color = \"white\") +\n  facet_wrap(~ ICT_Type, scales = \"free\", ncol = 3) +\n  theme_minimal() +\n  labs(title = \"Distribution of ICT Penetration Rates\",\n       subtitle = \"Per 1000 households\",\n       x = \"Penetration Rate\", y = \"Frequency\")\n\nprint(p1)\n\n\n\n\n\n\n\n\n\n\n4.3 Correlation Analysis\n\n# Correlation matrix\ncor_matrix &lt;- cor(ict_vars, use = \"complete.obs\")\ncorrplot(cor_matrix, \n         method = \"circle\", \n         type = \"upper\", \n         order = \"hclust\",\n         tl.col = \"black\",\n         tl.srt = 45,\n         title = \"Correlation Matrix of ICT Indicators\",\n         mar = c(0,0,2,0))\n\n\n\n\n\n\n\n\n\n\n4.4 Spatial Distribution\n\n# Create maps for each ICT indicator\ntmap_mode(\"plot\")\n\ntm1 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"RADIO_PR\", \n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"Radio\") +\n  tm_layout(main.title = \"Radio Penetration\",\n            main.title.size = 0.8)\n\ntm2 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"TV_PR\",\n              style = \"quantile\", \n              palette = \"Greens\",\n              title = \"Television\") +\n  tm_layout(main.title = \"TV Penetration\",\n            main.title.size = 0.8)\n\ntm3 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"MOBILE_PR\",\n              style = \"quantile\",\n              palette = \"Oranges\",\n              title = \"Mobile Phone\") +\n  tm_layout(main.title = \"Mobile Penetration\",\n            main.title.size = 0.8)\n\ntm4 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"INTERNET_PR\",\n              style = \"quantile\",\n              palette = \"Purples\",\n              title = \"Internet\") +\n  tm_layout(main.title = \"Internet Penetration\",\n            main.title.size = 0.8)\n\ntmap_arrange(tm1, tm2, tm3, tm4, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#hierarchical-clustering-non-spatial",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#hierarchical-clustering-non-spatial",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "5. Hierarchical Clustering (Non-Spatial)",
    "text": "5. Hierarchical Clustering (Non-Spatial)\n\n5.1 Data Preparation\n\n# Extract clustering variables\ncluster_vars &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  select(TS_PCODE, RADIO_PR, TV_PR, LLPHONE_PR, \n         MOBILE_PR, COMPUTER_PR, INTERNET_PR) %&gt;%\n  column_to_rownames(\"TS_PCODE\")\n\n# Check for any remaining NA values\nif(any(is.na(cluster_vars))) {\n  cat(\"Warning: NA values found. Removing incomplete cases.\\n\")\n  cluster_vars &lt;- na.omit(cluster_vars)\n}\n\n# Standardize the variables\ncluster_vars_scaled &lt;- scale(cluster_vars)\nsummary(cluster_vars_scaled)\n\n    RADIO_PR            TV_PR            LLPHONE_PR        MOBILE_PR       \n Min.   :-1.84729   Min.   :-2.46839   Min.   :-1.1867   Min.   :-1.58041  \n 1st Qu.:-0.72823   1st Qu.:-0.37192   1st Qu.:-0.6939   1st Qu.:-0.70539  \n Median :-0.04483   Median : 0.04865   Median :-0.3317   Median :-0.05001  \n Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000  \n 3rd Qu.: 0.49724   3rd Qu.: 0.60794   3rd Qu.: 0.4577   3rd Qu.: 0.65107  \n Max.   : 2.55176   Max.   : 2.08932   Max.   : 3.2033   Max.   : 2.39865  \n  COMPUTER_PR       INTERNET_PR     \n Min.   :-1.0292   Min.   :-1.0357  \n 1st Qu.:-0.6123   1st Qu.:-0.7706  \n Median :-0.2643   Median :-0.2734  \n Mean   : 0.0000   Mean   : 0.0000  \n 3rd Qu.: 0.2683   3rd Qu.: 0.3722  \n Max.   : 3.3149   Max.   : 3.0558  \n\n\n\n\n5.2 Computing Distance Matrix\n\n# Compute Euclidean distance\ndist_matrix &lt;- dist(cluster_vars_scaled, method = \"euclidean\")\n\n\n\n5.3 Hierarchical Clustering\n\n# Perform hierarchical clustering using Ward method\nhclust_ward &lt;- hclust(dist_matrix, method = \"ward.D2\")\n\n# Plot dendrogram\nplot(hclust_ward, cex = 0.6, hang = -1,\n     main = \"Hierarchical Clustering Dendrogram (Ward Method)\",\n     xlab = \"Township\", sub = \"\")\n\n\n\n\n\n\n\n\n\n\n5.4 Determine Optimal Number of Clusters\n\n# Elbow method\nfviz_nbclust(cluster_vars_scaled, \n             FUN = hcut, \n             method = \"wss\",\n             k.max = 10) +\n  labs(title = \"Elbow Method for Optimal Clusters\")\n\n\n\n\n\n\n\n# Silhouette method\nfviz_nbclust(cluster_vars_scaled,\n             FUN = hcut,\n             method = \"silhouette\",\n             k.max = 10) +\n  labs(title = \"Silhouette Method for Optimal Clusters\")\n\n\n\n\n\n\n\n\n\n\n5.5 Cutting the Dendrogram\n\n# Cut tree to form 5 clusters (adjust based on optimal k)\ngroups &lt;- cutree(hclust_ward, k = 5)\n\n# Add cluster membership to data\nshan_ict_clean$CLUSTER_HC &lt;- as.factor(groups[rownames(cluster_vars)])\n\n# Summary of clusters\ntable(shan_ict_clean$CLUSTER_HC)\n\n\n 1  2  3  4  5 \n21 12  6  9  7 \n\n\n\n\n5.6 Visualize Clustering Results\n\n# Plot dendrogram with cluster boxes\nplot(hclust_ward, cex = 0.6, hang = -1,\n     main = \"Hierarchical Clustering with 5 Clusters\")\nrect.hclust(hclust_ward, k = 5, border = 2:6)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---skater",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---skater",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "6. Spatially Constrained Clustering - SKATER",
    "text": "6. Spatially Constrained Clustering - SKATER\n\n6.1 Create Spatial Neighbors\n\n# Create spatial neighbors using Queen contiguity\ncoords &lt;- st_coordinates(st_centroid(shan_ict_clean))\nk_neighbors &lt;- knn2nb(knearneigh(coords, k = 6), \n                      row.names = shan_ict_clean$TS_PCODE)\n\n# Convert to neighbor list\nnb_queen &lt;- poly2nb(shan_ict_clean, queen = TRUE)\n\n# Check neighbor summary\nsummary(nb_queen)\n\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\n\n\n\n6.2 Calculate Edge Costs\n\n# Calculate edge costs based on dissimilarity\nlcosts &lt;- nbcosts(nb_queen, cluster_vars_scaled)\n\n# Create weights object\nnb_weights &lt;- nb2listw(nb_queen, \n                       lcosts, \n                       style = \"B\")\n\n# Check the weights\nsummary(unlist(nb_weights$weights))\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.551   1.495   2.390   2.709   3.680   6.587 \n\n\n\n\n6.3 Compute Minimum Spanning Tree\n\n# Create minimum spanning tree\nshan_mst &lt;- mstree(nb_weights)\n\n# Check MST\nclass(shan_mst)\n\n[1] \"mst\"    \"matrix\"\n\ndim(shan_mst)\n\n[1] 54  3\n\nhead(shan_mst)\n\n     [,1] [,2]      [,3]\n[1,]   31   25 1.4792876\n[2,]   25   17 1.1421910\n[3,]   17   54 0.7990177\n[4,]   54   48 0.5509777\n[5,]   54   45 1.1720984\n[6,]   25   55 1.3030189\n\n\n\n\n6.4 SKATER Clustering\n\n# Perform SKATER clustering\nskater_result &lt;- skater(edges = shan_mst[,1:2], \n                        data = cluster_vars_scaled, \n                        ncuts = 4)  # Creates 5 clusters\n\n# Extract cluster membership\nshan_ict_clean$CLUSTER_SKATER &lt;- as.factor(skater_result$groups)\n\n# Summary of SKATER clusters\ntable(shan_ict_clean$CLUSTER_SKATER)\n\n\n 1  2  3  4  5 \n12 14  5 12 12 \n\n\n\n\n6.5 Visualize SKATER Results\n\n# Plot SKATER clustering results\ntm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_SKATER\",\n              palette = \"Set2\",\n              title = \"SKATER Clusters\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Spatially Constrained Clustering (SKATER)\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---clustgeo",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatially-constrained-clustering---clustgeo",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "7. Spatially Constrained Clustering - ClustGeo",
    "text": "7. Spatially Constrained Clustering - ClustGeo\n\n7.1 Calculate Distance Matrices\n\n# Non-spatial distance matrix (attribute distance)\ndist_attrib &lt;- dist(cluster_vars_scaled)\n\n# Spatial distance matrix\ndist_spatial &lt;- st_distance(shan_ict_clean, shan_ict_clean)\ndist_spatial &lt;- as.dist(as.matrix(dist_spatial))\n\n\n\n7.2 Determine Optimal Alpha\n\n# Test different alpha values\nalpha_values &lt;- seq(0, 1, 0.1)\nclustgeo_results &lt;- list()\n\nfor(alpha in alpha_values) {\n  clustgeo_results[[as.character(alpha)]] &lt;- \n    hclustgeo(D0 = dist_attrib, \n              D1 = dist_spatial, \n              alpha = alpha)\n}\n\n# Create plot to choose optimal alpha\nchoicealpha(D0 = dist_attrib, \n            D1 = dist_spatial, \n            range.alpha = alpha_values, \n            K = 5, \n            graph = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n$Q\n                 Q0        Q1\nalpha=0   0.6651705 0.2614688\nalpha=0.1 0.6638556 0.3168636\nalpha=0.2 0.6422151 0.4568419\nalpha=0.3 0.5751905 0.5122824\nalpha=0.4 0.4905858 0.6599012\nalpha=0.5 0.3775200 0.8468879\nalpha=0.6 0.3299302 0.8898670\nalpha=0.7 0.3242517 0.8835126\nalpha=0.8 0.2773430 0.9027532\nalpha=0.9 0.2761906 0.9023238\nalpha=1   0.1153535 0.9184389\n\n$Qnorm\n             Q0norm    Q1norm\nalpha=0   1.0000000 0.2846883\nalpha=0.1 0.9980232 0.3450024\nalpha=0.2 0.9654895 0.4974113\nalpha=0.3 0.8647264 0.5577751\nalpha=0.4 0.7375340 0.7185031\nalpha=0.5 0.5675537 0.9220950\nalpha=0.6 0.4960084 0.9688909\nalpha=0.7 0.4874715 0.9619721\nalpha=0.8 0.4169503 0.9829214\nalpha=0.9 0.4152178 0.9824539\nalpha=1   0.1734194 1.0000000\n\n$range.alpha\n [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\n\n$K\n[1] 5\n\nattr(,\"class\")\n[1] \"choicealpha\"\n\n\n\n\n7.3 ClustGeo with Optimal Alpha\n\n# Perform ClustGeo with optimal alpha (example: 0.3)\nclustgeo_final &lt;- hclustgeo(D0 = dist_attrib,\n                            D1 = dist_spatial,\n                            alpha = 0.3)\n\n# Cut tree to get clusters\nshan_ict_clean$CLUSTER_GEO &lt;- as.factor(cutree(clustgeo_final, k = 5))\n\n# Summary\ntable(shan_ict_clean$CLUSTER_GEO)\n\n\n 1  2  3  4  5 \n 7 19  9 13  7 \n\n\n\n\n7.4 Visualize ClustGeo Results\n\n# Map ClustGeo results\ntm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_GEO\",\n              palette = \"Set3\",\n              title = \"ClustGeo Clusters\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"ClustGeo Clustering (α = 0.3)\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#cluster-evaluation-and-comparison",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#cluster-evaluation-and-comparison",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "8. Cluster Evaluation and Comparison",
    "text": "8. Cluster Evaluation and Comparison\n\n8.1 Compare All Three Methods\n\n# Create comparison maps\ntm1 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_HC\",\n              palette = \"Set2\",\n              title = \"Clusters\") +\n  tm_layout(main.title = \"Hierarchical\",\n            main.title.size = 0.9,\n            legend.position = c(\"right\", \"bottom\"))\n\ntm2 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_SKATER\",\n              palette = \"Set2\",\n              title = \"Clusters\") +\n  tm_layout(main.title = \"SKATER\",\n            main.title.size = 0.9,\n            legend.position = c(\"right\", \"bottom\"))\n\ntm3 &lt;- tm_shape(shan_ict_clean) +\n  tm_polygons(\"CLUSTER_GEO\",\n              palette = \"Set2\",\n              title = \"Clusters\") +\n  tm_layout(main.title = \"ClustGeo\",\n            main.title.size = 0.9,\n            legend.position = c(\"right\", \"bottom\"))\n\ntmap_arrange(tm1, tm2, tm3, ncol = 3)\n\n\n\n\n\n\n\n\n\n\n8.2 Cluster Profiles\n\n# Calculate mean values for each cluster\ncluster_profiles_hc &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(CLUSTER_HC) %&gt;%\n  summarise(across(c(RADIO_PR, TV_PR, LLPHONE_PR, \n                     MOBILE_PR, COMPUTER_PR, INTERNET_PR), \n                   mean, na.rm = TRUE)) %&gt;%\n  mutate(Method = \"Hierarchical\")\n\ncluster_profiles_skater &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(CLUSTER_SKATER) %&gt;%\n  summarise(across(c(RADIO_PR, TV_PR, LLPHONE_PR, \n                     MOBILE_PR, COMPUTER_PR, INTERNET_PR), \n                   mean, na.rm = TRUE)) %&gt;%\n  mutate(Method = \"SKATER\") %&gt;%\n  rename(Cluster = CLUSTER_SKATER)\n\ncluster_profiles_geo &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(CLUSTER_GEO) %&gt;%\n  summarise(across(c(RADIO_PR, TV_PR, LLPHONE_PR, \n                     MOBILE_PR, COMPUTER_PR, INTERNET_PR), \n                   mean, na.rm = TRUE)) %&gt;%\n  mutate(Method = \"ClustGeo\") %&gt;%\n  rename(Cluster = CLUSTER_GEO)\n\n# Display profiles\nknitr::kable(cluster_profiles_hc, \n             caption = \"Hierarchical Clustering Profiles\",\n             digits = 2)\n\n\nHierarchical Clustering Profiles\n\n\n\n\n\n\n\n\n\n\n\n\nCLUSTER_HC\nRADIO_PR\nTV_PR\nLLPHONE_PR\nMOBILE_PR\nCOMPUTER_PR\nINTERNET_PR\nMethod\n\n\n\n\n1\n287.84\n522.12\n39.25\n230.40\n16.04\n19.83\nHierarchical\n\n\n2\n201.92\n534.75\n38.27\n349.40\n30.06\n45.32\nHierarchical\n\n\n3\n248.33\n724.83\n82.95\n590.22\n72.54\n95.67\nHierarchical\n\n\n4\n139.32\n260.41\n18.94\n161.24\n7.00\n5.14\nHierarchical\n\n\n5\n92.95\n563.97\n122.60\n464.18\n20.85\n14.97\nHierarchical\n\n\n\n\n\n\n\n8.3 Interactive Heatmap\n\n# 期望使用的列名与友好展示名\ncol_map &lt;- c(\n  RADIO_PR    = \"Radio\",\n  TV_PR       = \"TV\",\n  LLPHONE_PR  = \"Landline\",\n  MOBILE_PR   = \"Mobile\",\n  COMPUTER_PR = \"Computer\",\n  INTERNET_PR = \"Internet\"\n)\n\n# ---- 1) 预处理：容错处理列名/类型 ----\nstopifnot(\"shan_ict_clean\" %in% ls())\n\ndat &lt;- shan_ict_clean\n\n# 兼容：若存在 LANDLINE_PR 列但没有 LLPHONE_PR，则做别名\nif (!\"LLPHONE_PR\" %in% names(dat) && \"LANDLINE_PR\" %in% names(dat)) {\n  dat &lt;- dplyr::mutate(dat, LLPHONE_PR = .data$LANDLINE_PR)\n}\n\n# 需要的列中，哪些真实存在\ncols_present &lt;- intersect(names(col_map), names(dat))\n\n# 如果一个都没有，给出提示并优雅退出本节绘图\nif (length(cols_present) == 0L) {\n  cat(\"**Note:** No ICT rate columns found in data. Skipping cluster summary/plot.\\n\")\n} else {\n  # 分群列检查\n  if (!\"CLUSTER_HC\" %in% names(dat)) {\n    stop(\"Missing `CLUSTER_HC` column. Please create the cluster labels first.\")\n  }\n  dat &lt;- dplyr::mutate(dat, CLUSTER_HC = as.factor(.data$CLUSTER_HC))\n\n  # ---- 2) 汇总表（自动跳过全 NA 列）----\n  # 只保留真的有观测值的列\n  keep_cols &lt;- purrr::map_lgl(cols_present, ~ sum(!is.na(dat[[.x]])) &gt; 0)\n  cols_present &lt;- cols_present[keep_cols]\n\n  # 若清洗后列不足 1，同样优雅退出\n  if (length(cols_present) == 0L) {\n    cat(\"**Note:** All ICT rate columns are entirely NA. Skipping cluster summary/plot.\\n\")\n  } else {\n    cluster_summary &lt;- dat |&gt;\n      sf::st_drop_geometry() |&gt;\n      dplyr::group_by(CLUSTER_HC) |&gt;\n      dplyr::summarise(\n        Count = dplyr::n(),\n        dplyr::across(\n          dplyr::all_of(cols_present),\n          ~ round(mean(.x, na.rm = TRUE), 1)\n        ),\n        .groups = \"drop\"\n      )\n\n    # 用友好名重命名（只对实际存在的列）\n    pretty_names &lt;- unname(col_map[cols_present])\n    cluster_summary &lt;- dplyr::rename(\n      cluster_summary,\n      !!!setNames(cols_present, pretty_names)  # new = old\n    )\n\n    # 打印表格\n    knitr::kable(\n      cluster_summary,\n      caption = \"Mean ICT Penetration Rates by Cluster\"\n    )\n\n    # ---- 3) 条形图（长表）----\n    value_cols &lt;- pretty_names  # 已经改成友好名后的列\n    cluster_long &lt;- cluster_summary |&gt;\n      tidyr::pivot_longer(\n        cols = dplyr::any_of(value_cols),\n        names_to = \"ICT_Type\",\n        values_to = \"Rate\"\n      )\n\n    # 若还存在 Rate 全 NA 的情况，过滤掉\n    cluster_long &lt;- dplyr::filter(cluster_long, !is.na(Rate))\n\n    if (nrow(cluster_long) == 0L) {\n      cat(\"**Note:** No non-missing values available for plotting.\\n\")\n    } else {\n      cluster_long$ICT_Type &lt;- factor(\n        cluster_long$ICT_Type,\n        levels = c(\"Radio\",\"TV\",\"Landline\",\"Mobile\",\"Computer\",\"Internet\")\n      )\n\n      ggplot(cluster_long, aes(x = ICT_Type, y = Rate, fill = CLUSTER_HC)) +\n        geom_col(position = \"dodge\") +\n        scale_fill_brewer(palette = \"Set2\") +\n        theme_minimal() +\n        labs(\n          title = \"ICT Penetration by Cluster\",\n          x = NULL, y = \"Mean Penetration (%)\",\n          fill = \"Cluster\"\n        )\n    }\n  }\n}\n\n\n\n\n\n\n\n\n\n\n8.4 Parallel Coordinates Plot\n\n# 准备数据 - 转换为长格式\nparallel_data &lt;- shan_ict_clean %&gt;%\n  st_drop_geometry() %&gt;%\n  select(TS_PCODE, CLUSTER_HC, RADIO_PR:INTERNET_PR) %&gt;%\n  mutate(CLUSTER_HC = as.factor(CLUSTER_HC)) %&gt;%\n  # 标准化数据\n  mutate(across(RADIO_PR:INTERNET_PR, scale)) %&gt;%\n  pivot_longer(cols = RADIO_PR:INTERNET_PR,\n               names_to = \"Variable\",\n               values_to = \"Value\")\n\n# 创建变量顺序\nvar_order &lt;- c(\"RADIO_PR\", \"TV_PR\", \"LLPHONE_PR\", \n               \"MOBILE_PR\", \"COMPUTER_PR\", \"INTERNET_PR\")\n\nparallel_data$Variable &lt;- factor(parallel_data$Variable, levels = var_order)\n\n# 绘制平行坐标图\nggplot(parallel_data, aes(x = Variable, y = Value, \n                          group = TS_PCODE, \n                          color = CLUSTER_HC)) +\n  geom_line(alpha = 0.3) +\n  geom_point(alpha = 0.5, size = 0.8) +\n  scale_color_brewer(palette = \"Set1\", name = \"Cluster\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        plot.title = element_text(size = 14, face = \"bold\")) +\n  labs(title = \"Parallel Coordinates Plot - ICT Indicators by Cluster\",\n       x = \"ICT Indicators\",\n       y = \"Standardized Value\") +\n  facet_wrap(~ CLUSTER_HC, ncol = 5)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatial-autocorrelation-test",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#spatial-autocorrelation-test",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "9. Spatial Autocorrelation Test",
    "text": "9. Spatial Autocorrelation Test\n\n# Test spatial autocorrelation of clusters\n# Convert cluster to numeric for Moran's I test\ncluster_numeric &lt;- as.numeric(shan_ict_clean$CLUSTER_HC)\n\n# Create spatial weights\nw &lt;- nb2listw(nb_queen, style = \"W\", zero.policy = TRUE)\n\n# Moran's I test\nmoran_test &lt;- moran.test(cluster_numeric, w, zero.policy = TRUE)\nprint(moran_test)\n\n\n    Moran I test under randomisation\n\ndata:  cluster_numeric  \nweights: w    \n\nMoran I statistic standard deviate = 3.1314, p-value = 0.0008699\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.255660976      -0.018518519       0.007666402 \n\n# Interpretation\nif(moran_test$p.value &lt; 0.05) {\n  cat(\"\\nSignificant spatial autocorrelation detected (p &lt;\", \n      round(moran_test$p.value, 4), \")\\n\")\n  cat(\"Moran's I:\", round(moran_test$estimate[1], 4), \"\\n\")\n  cat(\"This suggests spatial clustering of the clusters.\\n\")\n} else {\n  cat(\"\\nNo significant spatial autocorrelation detected.\\n\")\n}\n\n\nSignificant spatial autocorrelation detected (p &lt; 9e-04 )\nMoran's I: 0.2557 \nThis suggests spatial clustering of the clusters."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#save-results",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#save-results",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "10. Save Results",
    "text": "10. Save Results\n\n# Save the final dataset with all clustering results\nwrite_rds(shan_ict_clean, \"data/rds/shan_ict_clustered.rds\")\n\n# Create summary table\nsummary_table &lt;- data.frame(\n  Method = c(\"Hierarchical\", \"SKATER\", \"ClustGeo\"),\n  Num_Clusters = c(5, 5, 5),\n  Spatial_Constraint = c(\"No\", \"Yes\", \"Partial\"),\n  Alpha_Parameter = c(NA, NA, 0.3)\n)\n\nknitr::kable(summary_table, \n             caption = \"Summary of Clustering Methods\")\n\n\nSummary of Clustering Methods\n\n\nMethod\nNum_Clusters\nSpatial_Constraint\nAlpha_Parameter\n\n\n\n\nHierarchical\n5\nNo\nNA\n\n\nSKATER\n5\nYes\nNA\n\n\nClustGeo\n5\nPartial\n0.3"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex06/ex06.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex06/ex06.html#conclusions",
    "title": "Hands-on Exercise 06: Spatially Constrained Clustering - Geospatial Analytics for Social Good",
    "section": "11. Conclusions",
    "text": "11. Conclusions\nThis analysis compared three clustering methods for identifying ICT development patterns in Shan State:\n\nHierarchical Clustering: Pure attribute-based clustering without spatial constraints\nSKATER: Fully spatially constrained clustering using minimum spanning tree\nClustGeo: Mixed approach balancing attribute similarity and spatial contiguity\n\n\nKey Findings:\n\nHierarchical clustering may produce spatially fragmented clusters\nSKATER ensures spatial contiguity but may sacrifice attribute homogeneity\nClustGeo provides a balance through the alpha parameter\nICT penetration shows clear spatial patterns across Shan State townships\n\n\n\nRecommendations:\n\nFor policy implementation requiring geographic coherence, SKATER or ClustGeo are preferred\nThe optimal alpha value for ClustGeo should be chosen based on the specific application needs\nConsider local infrastructure and accessibility when interpreting ICT development clusters"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In this hands-on exercise, you will learn how to compute Global Measures of Spatial Autocorrelation (GMSA) by using spdep package. By the end of this hands-on exercise, you will be able to:\n\nImport geospatial data using appropriate function(s) of sf package\nImport csv file using appropriate function of readr package\nPerform relational join using appropriate join function of dplyr package\nCompute Global Spatial Autocorrelation (GSA) statistics by using appropriate functions of spdep package\nPlot Moran scatterplot\nCompute and plot spatial correlogram using appropriate function of spdep package\nProvide statistically correct interpretation of GSA statistics\n\n\n\nIn spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China.\n\n\n\nTwo data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-analytical-question",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-analytical-question",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-study-area-and-data",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#the-study-area-and-data",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Two data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#setting-the-analytical-tools",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#setting-the-analytical-tools",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "2.1 Setting the Analytical Tools",
    "text": "2.1 Setting the Analytical Tools\nBefore we get started, we need to ensure that spdep, sf, tmap and tidyverse packages are installed and loaded.\n\nsf is used for importing and handling geospatial data in R\ntidyverse is mainly used for wrangling attribute data in R\nspdep will be used to compute spatial weights, global and local spatial autocorrelation statistics\ntmap will be used to prepare cartographic quality choropleth maps\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-shapefile-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-shapefile-into-r-environment",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.1 Import shapefile into R environment",
    "text": "3.1 Import shapefile into R environment\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be simple features object of sf.\n\n\nShow code\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\n\nReading layer `Hunan' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-csv-file-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#import-csv-file-into-r-environment",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.2 Import csv file into R environment",
    "text": "3.2 Import csv file into R environment\nNext, we will import Hunan_2012.csv into R by using read_csv() of readr package. The output is R data frame class.\n\n\nShow code\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\", show_col_types = FALSE)\n\n# Check the data structure\nglimpse(hunan2012)\n\n\nRows: 88\nColumns: 29\n$ County      &lt;chr&gt; \"Anhua\", \"Anren\", \"Anxiang\", \"Baojing\", \"Chaling\", \"Changn…\n$ City        &lt;chr&gt; \"Yiyang\", \"Chenzhou\", \"Changde\", \"Hunan West\", \"Zhuzhou\", …\n$ avg_wage    &lt;dbl&gt; 30544, 28058, 31935, 30843, 31251, 28518, 54540, 28597, 33…\n$ deposite    &lt;dbl&gt; 10967.0, 4598.9, 5517.2, 2250.0, 8241.4, 10860.0, 24332.0,…\n$ FAI         &lt;dbl&gt; 6831.7, 6386.1, 3541.0, 1005.4, 6508.4, 7920.0, 33624.0, 1…\n$ Gov_Rev     &lt;dbl&gt; 456.72, 220.57, 243.64, 192.59, 620.19, 769.86, 5350.00, 1…\n$ Gov_Exp     &lt;dbl&gt; 2703.0, 1454.7, 1779.5, 1379.1, 1947.0, 2631.6, 7885.5, 11…\n$ GDP         &lt;dbl&gt; 13225.0, 4941.2, 12482.0, 4087.9, 11585.0, 19886.0, 88009.…\n$ GDPPC       &lt;dbl&gt; 14567, 12761, 23667, 14563, 20078, 24418, 88656, 10132, 17…\n$ GIO         &lt;dbl&gt; 9276.90, 4189.20, 5108.90, 3623.50, 9157.70, 37392.00, 513…\n$ Loan        &lt;dbl&gt; 3954.90, 2555.30, 2806.90, 1253.70, 4287.40, 4242.80, 4053…\n$ NIPCR       &lt;dbl&gt; 3528.3, 3271.8, 7693.7, 4191.3, 3887.7, 9528.0, 17070.0, 3…\n$ Bed         &lt;dbl&gt; 2718, 970, 1931, 927, 1449, 3605, 3310, 582, 2170, 2179, 1…\n$ Emp         &lt;dbl&gt; 494.310, 290.820, 336.390, 195.170, 330.290, 548.610, 670.…\n$ EmpR        &lt;dbl&gt; 441.4, 255.4, 270.5, 145.6, 299.0, 415.1, 452.0, 127.6, 21…\n$ EmpRT       &lt;dbl&gt; 338.0, 99.4, 205.9, 116.4, 154.0, 273.7, 219.4, 94.4, 174.…\n$ Pri_Stu     &lt;dbl&gt; 54.175, 33.171, 19.584, 19.249, 33.906, 81.831, 59.151, 18…\n$ Sec_Stu     &lt;dbl&gt; 32.830, 17.505, 17.819, 11.831, 20.548, 44.485, 39.685, 7.…\n$ Household   &lt;dbl&gt; 290.4, 104.6, 148.1, 73.2, 148.7, 211.2, 300.3, 76.1, 139.…\n$ Household_R &lt;dbl&gt; 234.5, 121.9, 135.4, 69.9, 139.4, 211.7, 248.4, 59.6, 110.…\n$ NOIP        &lt;dbl&gt; 101, 34, 53, 18, 106, 115, 214, 17, 55, 70, 44, 84, 74, 17…\n$ Pop_R       &lt;dbl&gt; 670.3, 243.2, 346.0, 184.1, 301.6, 448.2, 475.1, 189.6, 31…\n$ RSCG        &lt;dbl&gt; 5760.60, 2386.40, 3957.90, 768.04, 4009.50, 5220.40, 22604…\n$ Pop_T       &lt;dbl&gt; 910.8, 388.7, 528.3, 281.3, 578.4, 816.3, 998.6, 256.7, 45…\n$ Agri        &lt;dbl&gt; 4942.253, 2357.764, 4524.410, 1118.561, 3793.550, 6430.782…\n$ Service     &lt;dbl&gt; 5414.5, 3814.1, 14100.0, 541.8, 5444.0, 13074.6, 17726.6, …\n$ Disp_Inc    &lt;dbl&gt; 12373, 16072, 16610, 13455, 20461, 20868, 183252, 12379, 1…\n$ RORP        &lt;dbl&gt; 0.7359464, 0.6256753, 0.6549309, 0.6544614, 0.5214385, 0.5…\n$ ROREmp      &lt;dbl&gt; 0.8929619, 0.8782065, 0.8041262, 0.7460163, 0.9052651, 0.7…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#performing-relational-join",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#performing-relational-join",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.3 Performing relational join",
    "text": "3.3 Performing relational join\nThe code chunk below will be used to update the attribute table of hunan’s SpatialPolygonsDataFrame with the attribute fields of hunan2012 dataframe. This is performed by using left_join() of dplyr package.\n\n\nShow code\nhunan &lt;- left_join(hunan, hunan2012, by = c(\"County\" = \"County\"))\n\n# Check the result\nglimpse(hunan)\n\n\nRows: 88\nColumns: 36\n$ NAME_2      &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ ID_3        &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 21…\n$ NAME_3      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ ENGTYPE_3   &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"Co…\n$ Shape_Leng  &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.171918…\n$ Shape_Area  &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.11450357…\n$ County      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ City        &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ avg_wage    &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 45…\n$ deposite    &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, 1…\n$ FAI         &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0,…\n$ Gov_Rev     &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, 2…\n$ Gov_Exp     &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 48…\n$ GDP         &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 81113…\n$ GDPPC       &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 70…\n$ GIO         &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254.…\n$ Loan        &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 23408…\n$ NIPCR       &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, 1…\n$ Bed         &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970, …\n$ Emp         &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 85…\n$ EmpR        &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 268…\n$ EmpRT       &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 131…\n$ Pri_Stu     &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80.…\n$ Sec_Stu     &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68.…\n$ Household   &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 161…\n$ Household_R &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 154…\n$ NOIP        &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, 4…\n$ Pop_R       &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 266…\n$ RSCG        &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, 1…\n$ Pop_T       &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5, …\n$ Agri        &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.510…\n$ Service     &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.8…\n$ Disp_Inc    &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 27…\n$ RORP        &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.6…\n$ ROREmp      &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.8…\n$ geometry    &lt;POLYGON [°]&gt; POLYGON ((112.0625 29.75523..., POLYGON ((112.2288…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-regional-development-indicator",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-regional-development-indicator",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "3.4 Visualising Regional Development Indicator",
    "text": "3.4 Visualising Regional Development Indicator\nNow, we are going to prepare a basemap and a choropleth map showing the distribution of GDPPC 2012 by using qtm() of tmap package.\n\n\nShow code\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Quantile classification\")\n\ntmap_arrange(equal, \n            quantile, \n            asp = 1, \n            ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-contiguity-spatial-weights",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-contiguity-spatial-weights",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "4.1 Computing Contiguity Spatial Weights",
    "text": "4.1 Computing Contiguity Spatial Weights\nBefore we can compute the global spatial autocorrelation statistics, we need to construct a spatial weights of the study area. The spatial weights is used to define the neighbourhood relationships between the geographical units (i.e. county) in the study area.\nIn the code chunk below, poly2nb() of spdep package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries.\n\n\nShow code\nwm_q &lt;- poly2nb(hunan, queen = TRUE)\nsummary(wm_q)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report above shows that: - There are 88 area units in Hunan - The most connected area unit has 11 neighbours - There are two area units with only one neighbour"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#row-standardised-weights-matrix",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#row-standardised-weights-matrix",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "4.2 Row-standardised weights matrix",
    "text": "4.2 Row-standardised weights matrix\nNext, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be assigned equal weight (style=“W”). This is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values.\n\n\nShow code\nrswm_q &lt;- nb2listw(wm_q, \n                   style = \"W\", \n                   zero.policy = TRUE)\nrswm_q\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#morans-i-test",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#morans-i-test",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "5.1 Moran’s I test",
    "text": "5.1 Moran’s I test\nThe code chunk below performs Moran’s I statistical testing using moran.test() of spdep.\n\n\nShow code\nmoran.test(hunan$GDPPC, \n           listw = rswm_q, \n           zero.policy = TRUE, \n           na.action = na.omit)\n\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\n\n5.1.1 Statistical Conclusion\nThe Moran’s I test results show: - Moran I statistic: 0.3008 (positive value indicates positive spatial autocorrelation) - Expected value: -0.0115 (expected value under null hypothesis of no spatial autocorrelation) - Variance: 0.0043 - Standard deviate: 4.7351 (Z-score) - P-value: 1.095e-06 (highly significant)\nSince the p-value is much less than 0.05, we reject the null hypothesis of spatial randomness. The positive Moran’s I value indicates that similar values tend to cluster together - there is significant positive spatial autocorrelation in GDPPC across Hunan counties."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-morans-i",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "5.2 Computing Monte Carlo Moran’s I",
    "text": "5.2 Computing Monte Carlo Moran’s I\nThe code chunk below performs permutation test for Moran’s I statistic by using moran.mc() of spdep. A total of 1000 simulations will be performed.\n\n\nShow code\nset.seed(1234)\nbperm &lt;- moran.mc(hunan$GDPPC, \n                  listw = rswm_q, \n                  nsim = 999, \n                  zero.policy = TRUE, \n                  na.action = na.omit)\nbperm\n\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n5.2.1 Statistical Conclusion\nThe Monte Carlo simulation results confirm our earlier findings: - Observed Moran I: 0.3008 - Observed rank: 1000 (highest among all simulations) - P-value: 0.001\nThis means that out of 1000 simulations, the observed Moran’s I value is the highest, giving strong evidence against spatial randomness."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-monte-carlo-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-monte-carlo-morans-i",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "5.3 Visualising Monte Carlo Moran’s I",
    "text": "5.3 Visualising Monte Carlo Moran’s I\nIt is always a good practice to examine the simulated Moran’s I test statistics in greater detail. This can be achieved by plotting the distribution of the statistical values as a histogram.\n\n\nShow code\n# Calculate mean and variance\nmean(bperm$res[1:999])\n\n\n[1] -0.01504572\n\n\nShow code\nvar(bperm$res[1:999])\n\n\n[1] 0.004371574\n\n\nShow code\n# Summary statistics\nsummary(bperm$res[1:999])\n\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\nShow code\n# Create histogram\nhist(bperm$res, \n     freq = TRUE, \n     breaks = 20, \n     xlab = \"Simulated Moran's I\", \n     main = \"Distribution of Monte Carlo Moran's I\",\n     col = \"lightblue\",\n     xlim = c(-0.20, 0.35))\nabline(v = 0, \n       col = \"red\", \n       lty = 2)\nabline(v = bperm$statistic, \n       col = \"red\", \n       lwd = 2)\nlegend(\"topright\", \n       legend = c(\"Observed\", \"Expected\"), \n       col = c(\"red\", \"red\"), \n       lty = c(1, 2), \n       lwd = c(2, 1))\n\n\n\n\n\n\n\n\n\n\n5.3.1 Statistical Observation\nThe histogram shows that: - The distribution of simulated Moran’s I values is approximately normal, centered around -0.015 - The observed value (0.3008) is far in the right tail of the distribution - This visual confirmation supports our conclusion of significant positive spatial autocorrelation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#gearys-c-test",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#gearys-c-test",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "6.1 Geary’s C test",
    "text": "6.1 Geary’s C test\nThe code chunk below performs Geary’s C test for spatial autocorrelation by using geary.test() of spdep.\n\n\nShow code\ngeary.test(hunan$GDPPC, listw = rswm_q)\n\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q   \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n\n6.1.1 Statistical Conclusion\nThe Geary’s C test results show: - Geary C statistic: 0.6907 (values less than 1 indicate positive spatial autocorrelation) - Expected value: 1.0000 (expected value under null hypothesis) - Variance: 0.0073 - Standard deviate: 3.6108 - P-value: 0.0001526\nSince the p-value is less than 0.05 and the Geary’s C value (0.69) is less than 1, we have evidence of positive spatial autocorrelation, confirming our Moran’s I results."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-gearys-c",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#computing-monte-carlo-gearys-c",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "6.2 Computing Monte Carlo Geary’s C",
    "text": "6.2 Computing Monte Carlo Geary’s C\nThe code chunk below performs permutation test for Geary’s C statistic by using geary.mc() of spdep.\n\n\nShow code\nset.seed(1234)\nbperm_c &lt;- geary.mc(hunan$GDPPC, \n                    listw = rswm_q, \n                    nsim = 999)\nbperm_c\n\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n6.2.1 Statistical Conclusion\nThe Monte Carlo simulation for Geary’s C shows: - Observed Geary C: 0.6907 - Observed rank: 1 (lowest among all simulations) - P-value: 0.001\nThis confirms significant positive spatial autocorrelation (clustering of similar values)."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-the-monte-carlo-gearys-c",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#visualising-the-monte-carlo-gearys-c",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "6.3 Visualising the Monte Carlo Geary’s C",
    "text": "6.3 Visualising the Monte Carlo Geary’s C\nNext, we will plot a histogram to reveal the distribution of the simulated values.\n\n\nShow code\n# Calculate mean and variance\nmean(bperm_c$res[1:999])\n\n\n[1] 1.004402\n\n\nShow code\nvar(bperm_c$res[1:999])\n\n\n[1] 0.007436493\n\n\nShow code\n# Summary statistics\nsummary(bperm_c$res[1:999])\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\nShow code\n# Create histogram\nhist(bperm_c$res, \n     freq = TRUE, \n     breaks = 20, \n     xlab = \"Simulated Geary's C\", \n     main = \"Distribution of Monte Carlo Geary's C\",\n     col = \"lightgreen\",\n     xlim = c(0.6, 1.3))\nabline(v = 1, \n       col = \"red\", \n       lty = 2)\nabline(v = bperm_c$statistic, \n       col = \"red\", \n       lwd = 2)\nlegend(\"topleft\", \n       legend = c(\"Observed\", \"Expected\"), \n       col = c(\"red\", \"red\"), \n       lty = c(1, 2), \n       lwd = c(2, 1))\n\n\n\n\n\n\n\n\n\n\n6.3.1 Statistical Observation\nThe histogram shows: - The distribution of simulated Geary’s C values is centered around 1.004 - The observed value (0.6907) is in the extreme left tail - This provides strong visual evidence of positive spatial autocorrelation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-morans-i-correlogram",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-morans-i-correlogram",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "7.1 Compute Moran’s I correlogram",
    "text": "7.1 Compute Moran’s I correlogram\nIn the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used is Moran’s I.\n\n\nShow code\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order = 6, \n                          method = \"I\", \n                          style = \"W\")\nplot(MI_corr)\n\n\n\n\n\n\n\n\n\nBy plotting the output might not allow us to provide complete interpretation. Hence, it is important to examine the full analysis report.\n\n\nShow code\nprint(MI_corr)\n\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n7.1.1 Statistical Observation\nThe Moran’s I correlogram shows: - Lag 1-2: Significant positive spatial autocorrelation (p &lt; 0.001) - Lag 3: Weakly significant positive autocorrelation (p = 0.04) - Lag 4: No significant autocorrelation (p = 0.226) - Lag 5: Significant negative spatial autocorrelation (p &lt; 0.001) - Lag 6: Significant negative spatial autocorrelation (p &lt; 0.01)\nThis pattern suggests that spatial clustering is strongest at immediate neighbors (lag 1-2), weakens at intermediate distances, and becomes negative (dissimilar values) at greater distances."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-gearys-c-correlogram-and-plot",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05a.html#compute-gearys-c-correlogram-and-plot",
    "title": "Hands-on Exercise 05a: Global Measures of Spatial Autocorrelation",
    "section": "7.2 Compute Geary’s C correlogram and plot",
    "text": "7.2 Compute Geary’s C correlogram and plot\nIn the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used is Geary’s C.\n\n\nShow code\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order = 6, \n                          method = \"C\", \n                          style = \"W\")\nplot(GC_corr)\n\n\n\n\n\n\n\n\n\nSimilar to the previous step, we will print out the analysis report.\n\n\nShow code\nprint(GC_corr)\n\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n7.2.1 Statistical Observation\nThe Geary’s C correlogram shows: - Lag 1-2: Significant positive spatial autocorrelation (C &lt; 1, p &lt; 0.001) - Lag 3-4: No significant autocorrelation (C ≈ 1, p &gt; 0.05) - Lag 5: Significant negative spatial autocorrelation (C &gt; 1, p &lt; 0.001) - Lag 6: No significant autocorrelation\nThis pattern confirms the Moran’s I findings: strong local clustering that weakens with distance and becomes negative at lag 5."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "",
    "text": "A spatio-temporal point process is a random collection of points, where each point represents the time and location of an event. In this exercise, we will analyze forest fire events in Kepulauan Bangka Belitung, Indonesia using MODIS sensor data.\n\n\n\nAre the locations of forest fire in Kepulauan Bangka Belitung spatial and spatio-temporally independent?\nIf the answer is NO, where and when do the observed forest fire locations tend to cluster?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#research-questions",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#research-questions",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "",
    "text": "Are the locations of forest fire in Kepulauan Bangka Belitung spatial and spatio-temporally independent?\nIf the answer is NO, where and when do the observed forest fire locations tend to cluster?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-study-area-boundary",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-study-area-boundary",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.1 Importing Study Area Boundary",
    "text": "3.1 Importing Study Area Boundary\nWe’ll use the geodata package to automatically download Indonesian administrative boundaries from GADM.\n\n\nShow code\n# Set data directory\ndata_dir &lt;- here(\"Hands-on_Ex\", \"Hands-on_ex03\", \"data\")\nif (!dir.exists(data_dir)) dir.create(data_dir, recursive = TRUE)\n\n# Check if boundary file exists, if not, download it\nboundary_file &lt;- file.path(data_dir, \"bangka_belitung_kecamatan.gpkg\")\n\nif (!file.exists(boundary_file)) {\n  # Download Indonesia Level 3 boundaries (Kecamatan/Sub-district)\n  message(\"Downloading Indonesia administrative boundaries...\")\n  idn_lvl3 &lt;- geodata::gadm(\"IDN\", level = 3, path = data_dir)\n  \n  # Convert to sf object\n  idn3_sf &lt;- st_as_sf(idn_lvl3)\n  \n  # Filter for Bangka Belitung (correct name from GADM)\n  bangka_sf &lt;- idn3_sf %&gt;%\n    filter(NAME_1 == \"Bangka Belitung\")\n  \n  # Save as GeoPackage\n  st_write(bangka_sf, boundary_file, delete_dsn = TRUE, quiet = TRUE)\n  message(\"Boundary data saved to: \", boundary_file)\n}\n\n# Read the boundary data - with detailed diagnostics\nkbb_original &lt;- st_read(boundary_file, quiet = TRUE)\n\n# Diagnostic Step 1: Check what was downloaded\nmessage(\"=== DIAGNOSTIC INFO ===\")\nmessage(\"Total polygons downloaded: \", nrow(kbb_original))\nmessage(\"Column names: \", paste(names(kbb_original), collapse = \", \"))\n\n# Check if NAME_1 column exists and what provinces are there\nif (\"NAME_1\" %in% names(kbb_original)) {\n  province_list &lt;- unique(kbb_original$NAME_1)\n  message(\"Provinces found (first 10): \", paste(head(province_list, 10), collapse = \" | \"))\n  \n  # Check for Bangka variations\n  bangka_matches &lt;- grep(\"Bangka|bangka|BANGKA\", province_list, value = TRUE)\n  if (length(bangka_matches) &gt; 0) {\n    message(\"Found Bangka-related entries: \", paste(bangka_matches, collapse = \" | \"))\n  } else {\n    message(\"WARNING: No 'Bangka' found in province names!\")\n    message(\"Searching for 'Belitung'...\")\n    belitung_matches &lt;- grep(\"Belitung|belitung|BELITUNG\", province_list, value = TRUE)\n    message(\"Belitung matches: \", paste(belitung_matches, collapse = \" | \"))\n  }\n}\n\n# Try different name variations\npossible_names &lt;- c(\"Kepulauan Bangka Belitung\", \n                   \"Bangka Belitung\",\n                   \"Bangka-Belitung\",\n                   \"KEPULAUAN BANGKA BELITUNG\")\n\nkbb_sf &lt;- NULL\nfor (name_try in possible_names) {\n  temp_sf &lt;- kbb_original %&gt;%\n    filter(NAME_1 == name_try)\n  \n  if (nrow(temp_sf) &gt; 0) {\n    message(\"SUCCESS: Found data using name: '\", name_try, \"' with \", nrow(temp_sf), \" polygons\")\n    kbb_sf &lt;- temp_sf\n    break\n  }\n}\n\n# If still no data, check the structure\nif (is.null(kbb_sf) || nrow(kbb_sf) == 0) {\n  message(\"\\n=== FALLBACK: Showing sample of data ===\")\n  print(head(kbb_original[, c(\"NAME_0\", \"NAME_1\", \"NAME_2\", \"NAME_3\")], 20))\n  \n  message(\"\\n=== Manual selection needed ===\")\n  message(\"Please check the province names above and modify the filter accordingly.\")\n  \n  # Use all Indonesia data as fallback for now\n  message(\"Using all Indonesia data as fallback...\")\n  kbb_sf &lt;- kbb_original\n}\n\n# Transform to UTM Zone 48S\nkbb_sf &lt;- kbb_sf %&gt;%\n  st_transform(crs = 32748) %&gt;%\n  st_make_valid()\n\n# Check if geometries are valid\nmessage(\"\\n=== Geometry Check ===\")\nmessage(\"Valid geometries: \", sum(st_is_valid(kbb_sf)))\nmessage(\"Empty geometries: \", sum(st_is_empty(kbb_sf)))\n\n# Get bounding box\nbbox_check &lt;- st_bbox(kbb_sf)\nmessage(\"Bounding box: \")\nprint(bbox_check)\n\n\n     xmin      ymin      xmax      ymax \n 512010.4 9621858.3  928107.4 9833989.1 \n\n\nShow code\n# Plot only if we have valid geometries\nif (!any(is.na(bbox_check)) && nrow(kbb_sf) &gt; 0) {\n  plot(st_geometry(kbb_sf), \n       col = \"lightblue\",\n       border = \"darkblue\",\n       main = \"Study Area\")\n} else {\n  message(\"WARNING: Cannot plot due to invalid geometries. Continuing with analysis...\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#converting-to-owin-object",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#converting-to-owin-object",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.2 Converting to OWIN Object",
    "text": "3.2 Converting to OWIN Object\n\n\nShow code\n# Convert to owin object for spatstat\nkbb_owin &lt;- as.owin(kbb_sf)\n\n# Check the class\nclass(kbb_owin)\n\n\n[1] \"owin\"\n\n\nShow code\n# Display summary\nsummary(kbb_owin)\n\n\nWindow: polygonal boundary\n270 separate polygons (no holes)\n             vertices        area relative.area\npolygon 1           6 5.15790e+04      3.08e-06\npolygon 2           7 9.35325e+04      5.58e-06\npolygon 3          20 1.26679e+04      7.56e-07\npolygon 4          23 9.26107e+04      5.53e-06\npolygon 5          18 4.98850e+05      2.98e-05\npolygon 6          30 3.37290e+04      2.01e-06\npolygon 7          54 3.25363e+05      1.94e-05\npolygon 8          33 1.30250e+06      7.77e-05\npolygon 9         132 1.16490e+06      6.95e-05\npolygon 10         69 1.91355e+05      1.14e-05\npolygon 11        117 1.51905e+05      9.06e-06\npolygon 12         95 1.14409e+05      6.83e-06\npolygon 13         22 4.54503e+03      2.71e-07\npolygon 14         25 1.18153e+04      7.05e-07\npolygon 15        131 1.52345e+05      9.09e-06\npolygon 16         39 1.07779e+04      6.43e-07\npolygon 17         54 3.46837e+05      2.07e-05\npolygon 18         72 2.15853e+05      1.29e-05\npolygon 19         16 1.85061e+03      1.10e-07\npolygon 20         79 1.05702e+05      6.31e-06\npolygon 21         20 4.26450e+03      2.54e-07\npolygon 22        119 1.64729e+05      9.83e-06\npolygon 23         40 1.16146e+04      6.93e-07\npolygon 24         16 3.52284e+03      2.10e-07\npolygon 25        328 3.08592e+06      1.84e-04\npolygon 26        191 2.36937e+06      1.41e-04\npolygon 27         77 8.82506e+04      5.27e-06\npolygon 28         49 6.13179e+04      3.66e-06\npolygon 29        121 7.64910e+04      4.56e-06\npolygon 30          5 1.73815e+04      1.04e-06\npolygon 31          4 6.39020e+03      3.81e-07\npolygon 32         16 1.18396e+05      7.06e-06\npolygon 33          5 2.11407e+04      1.26e-06\npolygon 34         11 3.52360e+04      2.10e-06\npolygon 35         13 6.20570e+04      3.70e-06\npolygon 36          8 1.23128e+04      7.35e-07\npolygon 37          5 9.16907e+03      5.47e-07\npolygon 38         31 1.54528e+06      9.22e-05\npolygon 39         13 6.02786e+04      3.60e-06\npolygon 40         19 8.71573e+04      5.20e-06\npolygon 41         15 6.16242e+04      3.68e-06\npolygon 42          8 1.56726e+04      9.35e-07\npolygon 43          6 1.35363e+04      8.08e-07\npolygon 44          4 4.29360e+03      2.56e-07\npolygon 45         23 1.77052e+05      1.06e-05\npolygon 46         45 4.35839e+04      2.60e-06\npolygon 47          5 6.83224e+03      4.08e-07\npolygon 48          5 6.68328e+03      3.99e-07\npolygon 49          5 2.25570e+03      1.35e-07\npolygon 50          7 2.61716e+04      1.56e-06\npolygon 51          9 1.20125e+04      7.17e-07\npolygon 52          8 2.24884e+04      1.34e-06\npolygon 53          6 1.21058e+04      7.22e-07\npolygon 54          5 8.79539e+03      5.25e-07\npolygon 55          9 2.28045e+04      1.36e-06\npolygon 56          6 9.20554e+03      5.49e-07\npolygon 57         49 1.00131e+05      5.97e-06\npolygon 58          5 4.47493e+03      2.67e-07\npolygon 59          4 2.88084e+03      1.72e-07\npolygon 60          4 3.66452e+03      2.19e-07\npolygon 61         69 9.92186e+04      5.92e-06\npolygon 62          5 3.03623e+03      1.81e-07\npolygon 63          6 1.05413e+04      6.29e-07\npolygon 64          8 9.42911e+03      5.63e-07\npolygon 65         13 6.94883e+04      4.15e-06\npolygon 66         34 2.01331e+05      1.20e-05\npolygon 67        227 1.23408e+06      7.36e-05\npolygon 68          4 2.59824e+03      1.55e-07\npolygon 69          7 8.47540e+03      5.06e-07\npolygon 70          5 8.12486e+03      4.85e-07\npolygon 71         95 2.08341e+05      1.24e-05\npolygon 72         18 7.79145e+04      4.65e-06\npolygon 73         24 1.59007e+04      9.49e-07\npolygon 74          4 8.81028e+02      5.26e-08\npolygon 75         43 4.25653e+04      2.54e-06\npolygon 76          5 4.41923e+03      2.64e-07\npolygon 77          4 2.43914e+03      1.46e-07\npolygon 78          5 4.71226e+03      2.81e-07\npolygon 79        217 2.22687e+06      1.33e-04\npolygon 80         63 5.45427e+04      3.25e-06\npolygon 81          6 4.61991e+03      2.76e-07\npolygon 82          6 1.47370e+04      8.79e-07\npolygon 83          6 1.35588e+04      8.09e-07\npolygon 84         51 9.00805e+04      5.37e-06\npolygon 85          4 1.55335e+03      9.27e-08\npolygon 86         32 4.34625e+04      2.59e-06\npolygon 87        146 5.46576e+05      3.26e-05\npolygon 88         36 7.39133e+04      4.41e-06\npolygon 89         42 9.17378e+04      5.47e-06\npolygon 90        141 1.10143e+06      6.57e-05\npolygon 91         96 2.55421e+05      1.52e-05\npolygon 92         75 3.74798e+04      2.24e-06\npolygon 93         71 9.11194e+05      5.44e-05\npolygon 94          5 4.25220e+03      2.54e-07\npolygon 95         48 1.10263e+05      6.58e-06\npolygon 96          6 1.00670e+04      6.01e-07\npolygon 97         33 2.35513e+04      1.41e-06\npolygon 98          4 1.39953e+02      8.35e-09\npolygon 99        120 3.80319e+05      2.27e-05\npolygon 100        19 3.13896e+04      1.87e-06\npolygon 101        42 1.21247e+05      7.23e-06\npolygon 102        24 3.83865e+04      2.29e-06\npolygon 103        88 4.57022e+05      2.73e-05\npolygon 104        20 1.78068e+04      1.06e-06\npolygon 105        20 2.39368e+04      1.43e-06\npolygon 106         5 6.64860e+03      3.97e-07\npolygon 107         5 5.41661e+03      3.23e-07\npolygon 108        53 4.54957e+05      2.71e-05\npolygon 109       263 1.76196e+07      1.05e-03\npolygon 110         4 6.76374e+03      4.04e-07\npolygon 111        17 5.83732e+03      3.48e-07\npolygon 112        25 2.16843e+05      1.29e-05\npolygon 113         9 3.13706e+03      1.87e-07\npolygon 114        10 1.13374e+04      6.76e-07\npolygon 115        45 1.05289e+05      6.28e-06\npolygon 116         7 4.71437e+03      2.81e-07\npolygon 117       527 4.88599e+07      2.91e-03\npolygon 118       632 1.19875e+08      7.15e-03\npolygon 119        68 3.72752e+06      2.22e-04\npolygon 120        10 1.01946e+05      6.08e-06\npolygon 121        19 8.27040e+04      4.93e-06\npolygon 122        17 4.01684e+04      2.40e-06\npolygon 123        11 4.06518e+04      2.43e-06\npolygon 124       111 1.46837e+06      8.76e-05\npolygon 125       110 3.73961e+06      2.23e-04\npolygon 126        19 1.91715e+04      1.14e-06\npolygon 127        73 3.61882e+06      2.16e-04\npolygon 128        10 3.05396e+04      1.82e-06\npolygon 129         6 1.63086e+04      9.73e-07\npolygon 130        81 2.65410e+05      1.58e-05\npolygon 131         8 2.10497e+04      1.26e-06\npolygon 132         9 2.23051e+04      1.33e-06\npolygon 133        11 1.96429e+04      1.17e-06\npolygon 134       145 7.13724e+06      4.26e-04\npolygon 135        60 1.45303e+05      8.67e-06\npolygon 136        74 2.06450e+06      1.23e-04\npolygon 137        36 2.64395e+04      1.58e-06\npolygon 138       926 2.12401e+08      1.27e-02\npolygon 139        25 2.21142e+05      1.32e-05\npolygon 140         6 6.85335e+03      4.09e-07\npolygon 141        31 1.67739e+06      1.00e-04\npolygon 142         7 8.96845e+03      5.35e-07\npolygon 143        12 6.31109e+04      3.77e-06\npolygon 144       202 2.25183e+07      1.34e-03\npolygon 145        46 2.39836e+06      1.43e-04\npolygon 146        34 1.06861e+04      6.38e-07\npolygon 147         8 4.62274e+04      2.76e-06\npolygon 148         7 3.16257e+04      1.89e-06\npolygon 149         5 6.47214e+03      3.86e-07\npolygon 150        12 2.17322e+04      1.30e-06\npolygon 151         5 7.20136e+03      4.30e-07\npolygon 152       160 1.11856e+06      6.67e-05\npolygon 153       105 3.97161e+05      2.37e-05\npolygon 154        14 3.77546e+05      2.25e-05\npolygon 155        27 1.21328e+06      7.24e-05\npolygon 156       132 7.32320e+05      4.37e-05\npolygon 157        52 6.46488e+04      3.86e-06\npolygon 158        59 5.31644e+06      3.17e-04\npolygon 159        48 1.76605e+06      1.05e-04\npolygon 160        34 5.03181e+04      3.00e-06\npolygon 161        49 1.83632e+04      1.10e-06\npolygon 162        19 5.31559e+03      3.17e-07\npolygon 163       246 3.09440e+06      1.85e-04\npolygon 164        28 1.99191e+05      1.19e-05\npolygon 165        19 4.51980e+05      2.70e-05\npolygon 166        14 5.66638e+04      3.38e-06\npolygon 167        12 1.09882e+05      6.56e-06\npolygon 168        41 4.25466e+04      2.54e-06\npolygon 169       189 1.69035e+06      1.01e-04\npolygon 170       118 2.32814e+05      1.39e-05\npolygon 171         7 2.79374e+04      1.67e-06\npolygon 172        53 1.72586e+06      1.03e-04\npolygon 173        13 6.36463e+04      3.80e-06\npolygon 174       156 1.14531e+06      6.83e-05\npolygon 175        47 9.13932e+05      5.45e-05\npolygon 176        62 3.95152e+06      2.36e-04\npolygon 177       155 7.75116e+05      4.62e-05\npolygon 178        14 4.20349e+04      2.51e-06\npolygon 179        18 5.14007e+03      3.07e-07\npolygon 180        31 7.44696e+05      4.44e-05\npolygon 181        18 4.11037e+05      2.45e-05\npolygon 182        23 7.72702e+03      4.61e-07\npolygon 183         8 3.85828e+04      2.30e-06\npolygon 184       180 7.46362e+06      4.45e-04\npolygon 185        14 2.75557e+05      1.64e-05\npolygon 186         4 9.17061e+03      5.47e-07\npolygon 187         9 9.64342e+03      5.75e-07\npolygon 188         9 6.16694e+04      3.68e-06\npolygon 189        10 1.05264e+05      6.28e-06\npolygon 190         8 8.74118e+04      5.22e-06\npolygon 191         5 1.83999e+04      1.10e-06\npolygon 192         5 3.32417e+03      1.98e-07\npolygon 193        13 3.15953e+04      1.88e-06\npolygon 194        67 3.93589e+05      2.35e-05\npolygon 195         4 2.84280e+03      1.70e-07\npolygon 196        16 4.94144e+03      2.95e-07\npolygon 197         4 1.27360e+03      7.60e-08\npolygon 198         8 1.67265e+04      9.98e-07\npolygon 199        12 2.45940e+04      1.47e-06\npolygon 200        12 5.95411e+04      3.55e-06\npolygon 201        14 2.19831e+03      1.31e-07\npolygon 202        14 4.32480e+03      2.58e-07\npolygon 203        17 7.75234e+03      4.63e-07\npolygon 204        13 1.86854e+03      1.11e-07\npolygon 205        34 3.85424e+06      2.30e-04\npolygon 206         9 3.58530e+03      2.14e-07\npolygon 207        15 1.41276e+04      8.43e-07\npolygon 208        27 1.42520e+04      8.50e-07\npolygon 209        38 2.66059e+04      1.59e-06\npolygon 210        22 4.51365e+03      2.69e-07\npolygon 211        96 5.26123e+05      3.14e-05\npolygon 212        60 1.00574e+05      6.00e-06\npolygon 213        31 7.13409e+04      4.26e-06\npolygon 214        37 1.08935e+06      6.50e-05\npolygon 215       179 8.26972e+05      4.93e-05\npolygon 216        59 1.99001e+05      1.19e-05\npolygon 217        47 2.81875e+05      1.68e-05\npolygon 218       115 3.13327e+05      1.87e-05\npolygon 219       133 4.76117e+05      2.84e-05\npolygon 220        97 1.63408e+07      9.75e-04\npolygon 221        19 6.38976e+03      3.81e-07\npolygon 222        10 7.75421e+03      4.63e-07\npolygon 223       204 1.42141e+06      8.48e-05\npolygon 224       125 2.33616e+06      1.39e-04\npolygon 225        31 2.58857e+04      1.54e-06\npolygon 226        25 2.06725e+04      1.23e-06\npolygon 227        87 1.25180e+06      7.47e-05\npolygon 228        38 4.03858e+04      2.41e-06\npolygon 229        10 5.04629e+04      3.01e-06\npolygon 230         6 1.12888e+04      6.73e-07\npolygon 231        40 1.56849e+05      9.36e-06\npolygon 232        66 5.25038e+04      3.13e-06\npolygon 233         8 1.10747e+04      6.61e-07\npolygon 234        10 1.50784e+03      9.00e-08\npolygon 235        14 4.55332e+03      2.72e-07\npolygon 236        41 4.12940e+04      2.46e-06\npolygon 237         7 3.04017e+03      1.81e-07\npolygon 238        19 7.53923e+03      4.50e-07\npolygon 239        18 8.35187e+03      4.98e-07\npolygon 240        26 5.16261e+05      3.08e-05\npolygon 241        13 9.24908e+04      5.52e-06\npolygon 242        25 4.18653e+04      2.50e-06\npolygon 243         7 3.83476e+03      2.29e-07\npolygon 244        82 4.38420e+05      2.62e-05\npolygon 245       164 3.46334e+06      2.07e-04\npolygon 246        11 5.20050e+03      3.10e-07\npolygon 247        13 3.27494e+04      1.95e-06\npolygon 248         6 3.01213e+04      1.80e-06\npolygon 249        13 2.03114e+05      1.21e-05\npolygon 250        38 2.87869e+04      1.72e-06\npolygon 251        14 4.11781e+03      2.46e-07\npolygon 252        44 1.67050e+05      9.97e-06\npolygon 253        11 6.66399e+04      3.98e-06\npolygon 254       129 2.29310e+06      1.37e-04\npolygon 255        22 6.48307e+03      3.87e-07\npolygon 256       107 1.06884e+06      6.38e-05\npolygon 257         9 2.30080e+04      1.37e-06\npolygon 258        34 9.10976e+03      5.43e-07\npolygon 259        72 1.08609e+05      6.48e-06\npolygon 260        64 2.19815e+05      1.31e-05\npolygon 261        25 2.57976e+05      1.54e-05\npolygon 262        26 4.60002e+04      2.74e-06\npolygon 263        57 8.30086e+04      4.95e-06\npolygon 264        83 1.14012e+06      6.80e-05\npolygon 265        11 3.01000e+04      1.80e-06\npolygon 266        14 1.30459e+05      7.78e-06\npolygon 267        22 2.37055e+05      1.41e-05\npolygon 268        22 1.84821e+05      1.10e-05\npolygon 269      8736 1.15970e+10      6.92e-01\npolygon 270      5944 4.61753e+09      2.75e-01\nenclosing rectangle: [512010.4, 928107.4] x [9621858, 9833989] units\n                     (416100 x 212100 units)\nWindow area = 16761600000 square units\nFraction of frame area: 0.19"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-forest-fire-data",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#importing-forest-fire-data",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.3 Importing Forest Fire Data",
    "text": "3.3 Importing Forest Fire Data\n\n\nShow code\n# Read the MODIS fire data\nfire_data_path &lt;- \"C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex03/data/fire_archive_M-C61_674949.csv\"\n\n# Read the CSV file\nforestfires &lt;- read_csv(fire_data_path, show_col_types = FALSE)\n\n# Display structure and first few rows\nglimpse(forestfires)\n\n\nRows: 4,503\nColumns: 15\n$ latitude   &lt;dbl&gt; -7.6338, -7.6470, -8.3723, 1.0408, -2.5785, -2.5771, -2.582…\n$ longitude  &lt;dbl&gt; 138.7764, 138.7681, 137.9117, 120.8256, 121.3911, 121.3812,…\n$ brightness &lt;dbl&gt; 314.7, 317.9, 316.8, 318.5, 326.7, 345.7, 325.5, 322.9, 313…\n$ scan       &lt;dbl&gt; 3.1, 3.1, 3.5, 1.3, 1.1, 1.1, 1.1, 1.0, 1.1, 1.2, 1.2, 1.2,…\n$ track      &lt;dbl&gt; 1.7, 1.7, 1.8, 1.1, 1.1, 1.1, 1.1, 1.0, 1.1, 1.1, 1.1, 1.1,…\n$ acq_date   &lt;date&gt; 2020-10-01, 2020-10-01, 2020-10-01, 2020-10-01, 2020-10-01…\n$ acq_time   &lt;chr&gt; \"0037\", \"0037\", \"0037\", \"0213\", \"0214\", \"0214\", \"0214\", \"02…\n$ satellite  &lt;chr&gt; \"Terra\", \"Terra\", \"Terra\", \"Terra\", \"Terra\", \"Terra\", \"Terr…\n$ instrument &lt;chr&gt; \"MODIS\", \"MODIS\", \"MODIS\", \"MODIS\", \"MODIS\", \"MODIS\", \"MODI…\n$ confidence &lt;dbl&gt; 28, 65, 0, 58, 80, 93, 51, 60, 35, 32, 62, 26, 0, 70, 72, 8…\n$ version    &lt;dbl&gt; 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03, 6.03,…\n$ bright_t31 &lt;dbl&gt; 290.6, 291.4, 296.2, 296.4, 294.4, 294.9, 292.8, 296.1, 299…\n$ frp        &lt;dbl&gt; 30.8, 47.1, 55.1, 13.4, 19.7, 54.1, 19.3, 10.9, 8.5, 7.5, 1…\n$ daynight   &lt;chr&gt; \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\", \"D\",…\n$ type       &lt;dbl&gt; 0, 0, 0, 2, 2, 2, 2, 0, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0,…\n\n\nShow code\nhead(forestfires)\n\n\n# A tibble: 6 × 15\n  latitude longitude brightness  scan track acq_date   acq_time satellite\n     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;    \n1    -7.63      139.       315.   3.1   1.7 2020-10-01 0037     Terra    \n2    -7.65      139.       318.   3.1   1.7 2020-10-01 0037     Terra    \n3    -8.37      138.       317.   3.5   1.8 2020-10-01 0037     Terra    \n4     1.04      121.       318.   1.3   1.1 2020-10-01 0213     Terra    \n5    -2.58      121.       327.   1.1   1.1 2020-10-01 0214     Terra    \n6    -2.58      121.       346.   1.1   1.1 2020-10-01 0214     Terra    \n# ℹ 7 more variables: instrument &lt;chr&gt;, confidence &lt;dbl&gt;, version &lt;dbl&gt;,\n#   bright_t31 &lt;dbl&gt;, frp &lt;dbl&gt;, daynight &lt;chr&gt;, type &lt;dbl&gt;\n\n\nShow code\n# Check date range\nmessage(\"Date range: \", min(forestfires$acq_date), \" to \", max(forestfires$acq_date))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-forest-fire-data",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-forest-fire-data",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "3.4 Preparing Forest Fire Data",
    "text": "3.4 Preparing Forest Fire Data\n\n\nShow code\n# Convert to sf object and transform to UTM 48S\nfire_sf &lt;- forestfires %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), \n           crs = 4326) %&gt;%\n  st_transform(crs = 32748)\n\n# Convert date to proper format and extract temporal components\nfire_sf &lt;- fire_sf %&gt;%\n  mutate(\n    acq_date = as.Date(acq_date),\n    Month = month(acq_date),\n    DayofYear = yday(acq_date),\n    Year = year(acq_date)\n  )\n\n# Filter to study area (clip to Bangka Belitung boundary)\nfire_sf &lt;- fire_sf[kbb_sf, ]\n\nmessage(\"Total fire points after clipping to study area: \", nrow(fire_sf))\n\n# Check temporal distribution\ntable(fire_sf$Year)\n\n\n\n2020 \n  31"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#overall-distribution",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#overall-distribution",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "4.1 Overall Distribution",
    "text": "4.1 Overall Distribution\n\n\nShow code\n# Create base map with fire points\ntm_shape(kbb_sf) +\n  tm_polygons(col = \"lightgray\", \n              border.col = \"darkgray\") +\n  tm_shape(fire_sf) +\n  tm_dots(col = \"red\", \n          size = 0.02,\n          alpha = 0.6) +\n  tm_layout(main.title = \"Forest Fire Distribution in Kepulauan Bangka Belitung\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_compass(position = c(\"right\", \"top\")) +\n  tm_scale_bar(position = c(\"left\", \"bottom\"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#monthly-distribution",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#monthly-distribution",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "4.2 Monthly Distribution",
    "text": "4.2 Monthly Distribution\n\n\nShow code\n# Create monthly faceted map\ntm_shape(kbb_sf) +\n  tm_polygons(col = \"lightgray\", \n              border.col = \"darkgray\") +\n  tm_shape(fire_sf) +\n  tm_dots(col = \"red\", \n          size = 0.05,\n          alpha = 0.7) +\n  tm_facets(by = \"Month\",\n            ncol = 4,\n            nrow = 3,\n            free.coords = FALSE) +\n  tm_layout(main.title = \"Monthly Forest Fire Distribution\",\n            main.title.size = 1,\n            legend.show = FALSE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-spatstat",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-spatstat",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.1 Preparing Data for spatstat",
    "text": "5.1 Preparing Data for spatstat\n\n\nShow code\n# Extract only needed fields for ppp object\nfire_month &lt;- fire_sf %&gt;%\n  dplyr::select(Month) %&gt;%\n  mutate(Month = as.numeric(Month))\n\n# Create ppp object\nfire_month_ppp &lt;- as.ppp(fire_month)\n\n# Check the object\nsummary(fire_month_ppp)\n\n\nMarked planar point pattern:  31 points\nAverage intensity 6.623857e-10 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  10.00   10.00   10.00   10.19   10.00   12.00 \n\nWindow: rectangle = [545783, 843983.5] x [9648316, 9805259] units\n                    (298200 x 156900 units)\nWindow area = 46800500000 square units\n\n\nShow code\n# Check for duplicates\nany(duplicated(fire_month_ppp))\n\n\n[1] FALSE\n\n\nShow code\n# Handle duplicates if any\nif(any(duplicated(fire_month_ppp))) {\n  fire_month_ppp &lt;- unique(fire_month_ppp)\n  message(\"Duplicated points removed\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#including-owin-object",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#including-owin-object",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.2 Including OWIN Object",
    "text": "5.2 Including OWIN Object\n\n\nShow code\n# Combine ppp with owin\nfire_month_owin &lt;- fire_month_ppp[kbb_owin]\n\n# Display summary\nsummary(fire_month_owin)\n\n\nMarked planar point pattern:  31 points\nAverage intensity 1.849468e-09 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  10.00   10.00   10.00   10.19   10.00   12.00 \n\nWindow: polygonal boundary\n270 separate polygons (no holes)\n             vertices        area relative.area\npolygon 1           6 5.15790e+04      3.08e-06\npolygon 2           7 9.35325e+04      5.58e-06\npolygon 3          20 1.26679e+04      7.56e-07\npolygon 4          23 9.26107e+04      5.53e-06\npolygon 5          18 4.98850e+05      2.98e-05\npolygon 6          30 3.37290e+04      2.01e-06\npolygon 7          54 3.25363e+05      1.94e-05\npolygon 8          33 1.30250e+06      7.77e-05\npolygon 9         132 1.16490e+06      6.95e-05\npolygon 10         69 1.91355e+05      1.14e-05\npolygon 11        117 1.51905e+05      9.06e-06\npolygon 12         95 1.14409e+05      6.83e-06\npolygon 13         22 4.54503e+03      2.71e-07\npolygon 14         25 1.18153e+04      7.05e-07\npolygon 15        131 1.52345e+05      9.09e-06\npolygon 16         39 1.07779e+04      6.43e-07\npolygon 17         54 3.46837e+05      2.07e-05\npolygon 18         72 2.15853e+05      1.29e-05\npolygon 19         16 1.85061e+03      1.10e-07\npolygon 20         79 1.05702e+05      6.31e-06\npolygon 21         20 4.26450e+03      2.54e-07\npolygon 22        119 1.64729e+05      9.83e-06\npolygon 23         40 1.16146e+04      6.93e-07\npolygon 24         16 3.52284e+03      2.10e-07\npolygon 25        328 3.08592e+06      1.84e-04\npolygon 26        191 2.36937e+06      1.41e-04\npolygon 27         77 8.82506e+04      5.27e-06\npolygon 28         49 6.13179e+04      3.66e-06\npolygon 29        121 7.64910e+04      4.56e-06\npolygon 30          5 1.73815e+04      1.04e-06\npolygon 31          4 6.39020e+03      3.81e-07\npolygon 32         16 1.18396e+05      7.06e-06\npolygon 33          5 2.11407e+04      1.26e-06\npolygon 34         11 3.52360e+04      2.10e-06\npolygon 35         13 6.20570e+04      3.70e-06\npolygon 36          8 1.23128e+04      7.35e-07\npolygon 37          5 9.16907e+03      5.47e-07\npolygon 38         31 1.54528e+06      9.22e-05\npolygon 39         13 6.02786e+04      3.60e-06\npolygon 40         19 8.71573e+04      5.20e-06\npolygon 41         15 6.16242e+04      3.68e-06\npolygon 42          8 1.56726e+04      9.35e-07\npolygon 43          6 1.35363e+04      8.08e-07\npolygon 44          4 4.29360e+03      2.56e-07\npolygon 45         23 1.77052e+05      1.06e-05\npolygon 46         45 4.35839e+04      2.60e-06\npolygon 47          5 6.83224e+03      4.08e-07\npolygon 48          5 6.68328e+03      3.99e-07\npolygon 49          5 2.25570e+03      1.35e-07\npolygon 50          7 2.61716e+04      1.56e-06\npolygon 51          9 1.20125e+04      7.17e-07\npolygon 52          8 2.24884e+04      1.34e-06\npolygon 53          6 1.21058e+04      7.22e-07\npolygon 54          5 8.79539e+03      5.25e-07\npolygon 55          9 2.28045e+04      1.36e-06\npolygon 56          6 9.20554e+03      5.49e-07\npolygon 57         49 1.00131e+05      5.97e-06\npolygon 58          5 4.47493e+03      2.67e-07\npolygon 59          4 2.88084e+03      1.72e-07\npolygon 60          4 3.66452e+03      2.19e-07\npolygon 61         69 9.92186e+04      5.92e-06\npolygon 62          5 3.03623e+03      1.81e-07\npolygon 63          6 1.05413e+04      6.29e-07\npolygon 64          8 9.42911e+03      5.63e-07\npolygon 65         13 6.94883e+04      4.15e-06\npolygon 66         34 2.01331e+05      1.20e-05\npolygon 67        227 1.23408e+06      7.36e-05\npolygon 68          4 2.59824e+03      1.55e-07\npolygon 69          7 8.47540e+03      5.06e-07\npolygon 70          5 8.12486e+03      4.85e-07\npolygon 71         95 2.08341e+05      1.24e-05\npolygon 72         18 7.79145e+04      4.65e-06\npolygon 73         24 1.59007e+04      9.49e-07\npolygon 74          4 8.81028e+02      5.26e-08\npolygon 75         43 4.25653e+04      2.54e-06\npolygon 76          5 4.41923e+03      2.64e-07\npolygon 77          4 2.43914e+03      1.46e-07\npolygon 78          5 4.71226e+03      2.81e-07\npolygon 79        217 2.22687e+06      1.33e-04\npolygon 80         63 5.45427e+04      3.25e-06\npolygon 81          6 4.61991e+03      2.76e-07\npolygon 82          6 1.47370e+04      8.79e-07\npolygon 83          6 1.35588e+04      8.09e-07\npolygon 84         51 9.00805e+04      5.37e-06\npolygon 85          4 1.55335e+03      9.27e-08\npolygon 86         32 4.34625e+04      2.59e-06\npolygon 87        146 5.46576e+05      3.26e-05\npolygon 88         36 7.39133e+04      4.41e-06\npolygon 89         42 9.17378e+04      5.47e-06\npolygon 90        141 1.10143e+06      6.57e-05\npolygon 91         96 2.55421e+05      1.52e-05\npolygon 92         75 3.74798e+04      2.24e-06\npolygon 93         71 9.11194e+05      5.44e-05\npolygon 94          5 4.25220e+03      2.54e-07\npolygon 95         48 1.10263e+05      6.58e-06\npolygon 96          6 1.00670e+04      6.01e-07\npolygon 97         33 2.35513e+04      1.41e-06\npolygon 98          4 1.39953e+02      8.35e-09\npolygon 99        120 3.80319e+05      2.27e-05\npolygon 100        19 3.13896e+04      1.87e-06\npolygon 101        42 1.21247e+05      7.23e-06\npolygon 102        24 3.83865e+04      2.29e-06\npolygon 103        88 4.57022e+05      2.73e-05\npolygon 104        20 1.78068e+04      1.06e-06\npolygon 105        20 2.39368e+04      1.43e-06\npolygon 106         5 6.64860e+03      3.97e-07\npolygon 107         5 5.41661e+03      3.23e-07\npolygon 108        53 4.54957e+05      2.71e-05\npolygon 109       263 1.76196e+07      1.05e-03\npolygon 110         4 6.76374e+03      4.04e-07\npolygon 111        17 5.83732e+03      3.48e-07\npolygon 112        25 2.16843e+05      1.29e-05\npolygon 113         9 3.13706e+03      1.87e-07\npolygon 114        10 1.13374e+04      6.76e-07\npolygon 115        45 1.05289e+05      6.28e-06\npolygon 116         7 4.71437e+03      2.81e-07\npolygon 117       527 4.88599e+07      2.91e-03\npolygon 118       632 1.19875e+08      7.15e-03\npolygon 119        68 3.72752e+06      2.22e-04\npolygon 120        10 1.01946e+05      6.08e-06\npolygon 121        19 8.27040e+04      4.93e-06\npolygon 122        17 4.01684e+04      2.40e-06\npolygon 123        11 4.06518e+04      2.43e-06\npolygon 124       111 1.46837e+06      8.76e-05\npolygon 125       110 3.73961e+06      2.23e-04\npolygon 126        19 1.91715e+04      1.14e-06\npolygon 127        73 3.61882e+06      2.16e-04\npolygon 128        10 3.05396e+04      1.82e-06\npolygon 129         6 1.63086e+04      9.73e-07\npolygon 130        81 2.65410e+05      1.58e-05\npolygon 131         8 2.10497e+04      1.26e-06\npolygon 132         9 2.23051e+04      1.33e-06\npolygon 133        11 1.96429e+04      1.17e-06\npolygon 134       145 7.13724e+06      4.26e-04\npolygon 135        60 1.45303e+05      8.67e-06\npolygon 136        74 2.06450e+06      1.23e-04\npolygon 137        36 2.64395e+04      1.58e-06\npolygon 138       926 2.12401e+08      1.27e-02\npolygon 139        25 2.21142e+05      1.32e-05\npolygon 140         6 6.85335e+03      4.09e-07\npolygon 141        31 1.67739e+06      1.00e-04\npolygon 142         7 8.96845e+03      5.35e-07\npolygon 143        12 6.31109e+04      3.77e-06\npolygon 144       202 2.25183e+07      1.34e-03\npolygon 145        46 2.39836e+06      1.43e-04\npolygon 146        34 1.06861e+04      6.38e-07\npolygon 147         8 4.62274e+04      2.76e-06\npolygon 148         7 3.16257e+04      1.89e-06\npolygon 149         5 6.47214e+03      3.86e-07\npolygon 150        12 2.17322e+04      1.30e-06\npolygon 151         5 7.20136e+03      4.30e-07\npolygon 152       160 1.11856e+06      6.67e-05\npolygon 153       105 3.97161e+05      2.37e-05\npolygon 154        14 3.77546e+05      2.25e-05\npolygon 155        27 1.21328e+06      7.24e-05\npolygon 156       132 7.32320e+05      4.37e-05\npolygon 157        52 6.46488e+04      3.86e-06\npolygon 158        59 5.31644e+06      3.17e-04\npolygon 159        48 1.76605e+06      1.05e-04\npolygon 160        34 5.03181e+04      3.00e-06\npolygon 161        49 1.83632e+04      1.10e-06\npolygon 162        19 5.31559e+03      3.17e-07\npolygon 163       246 3.09440e+06      1.85e-04\npolygon 164        28 1.99191e+05      1.19e-05\npolygon 165        19 4.51980e+05      2.70e-05\npolygon 166        14 5.66638e+04      3.38e-06\npolygon 167        12 1.09882e+05      6.56e-06\npolygon 168        41 4.25466e+04      2.54e-06\npolygon 169       189 1.69035e+06      1.01e-04\npolygon 170       118 2.32814e+05      1.39e-05\npolygon 171         7 2.79374e+04      1.67e-06\npolygon 172        53 1.72586e+06      1.03e-04\npolygon 173        13 6.36463e+04      3.80e-06\npolygon 174       156 1.14531e+06      6.83e-05\npolygon 175        47 9.13932e+05      5.45e-05\npolygon 176        62 3.95152e+06      2.36e-04\npolygon 177       155 7.75116e+05      4.62e-05\npolygon 178        14 4.20349e+04      2.51e-06\npolygon 179        18 5.14007e+03      3.07e-07\npolygon 180        31 7.44696e+05      4.44e-05\npolygon 181        18 4.11037e+05      2.45e-05\npolygon 182        23 7.72702e+03      4.61e-07\npolygon 183         8 3.85828e+04      2.30e-06\npolygon 184       180 7.46362e+06      4.45e-04\npolygon 185        14 2.75557e+05      1.64e-05\npolygon 186         4 9.17061e+03      5.47e-07\npolygon 187         9 9.64342e+03      5.75e-07\npolygon 188         9 6.16694e+04      3.68e-06\npolygon 189        10 1.05264e+05      6.28e-06\npolygon 190         8 8.74118e+04      5.22e-06\npolygon 191         5 1.83999e+04      1.10e-06\npolygon 192         5 3.32417e+03      1.98e-07\npolygon 193        13 3.15953e+04      1.88e-06\npolygon 194        67 3.93589e+05      2.35e-05\npolygon 195         4 2.84280e+03      1.70e-07\npolygon 196        16 4.94144e+03      2.95e-07\npolygon 197         4 1.27360e+03      7.60e-08\npolygon 198         8 1.67265e+04      9.98e-07\npolygon 199        12 2.45940e+04      1.47e-06\npolygon 200        12 5.95411e+04      3.55e-06\npolygon 201        14 2.19831e+03      1.31e-07\npolygon 202        14 4.32480e+03      2.58e-07\npolygon 203        17 7.75234e+03      4.63e-07\npolygon 204        13 1.86854e+03      1.11e-07\npolygon 205        34 3.85424e+06      2.30e-04\npolygon 206         9 3.58530e+03      2.14e-07\npolygon 207        15 1.41276e+04      8.43e-07\npolygon 208        27 1.42520e+04      8.50e-07\npolygon 209        38 2.66059e+04      1.59e-06\npolygon 210        22 4.51365e+03      2.69e-07\npolygon 211        96 5.26123e+05      3.14e-05\npolygon 212        60 1.00574e+05      6.00e-06\npolygon 213        31 7.13409e+04      4.26e-06\npolygon 214        37 1.08935e+06      6.50e-05\npolygon 215       179 8.26972e+05      4.93e-05\npolygon 216        59 1.99001e+05      1.19e-05\npolygon 217        47 2.81875e+05      1.68e-05\npolygon 218       115 3.13327e+05      1.87e-05\npolygon 219       133 4.76117e+05      2.84e-05\npolygon 220        97 1.63408e+07      9.75e-04\npolygon 221        19 6.38976e+03      3.81e-07\npolygon 222        10 7.75421e+03      4.63e-07\npolygon 223       204 1.42141e+06      8.48e-05\npolygon 224       125 2.33616e+06      1.39e-04\npolygon 225        31 2.58857e+04      1.54e-06\npolygon 226        25 2.06725e+04      1.23e-06\npolygon 227        87 1.25180e+06      7.47e-05\npolygon 228        38 4.03858e+04      2.41e-06\npolygon 229        10 5.04629e+04      3.01e-06\npolygon 230         6 1.12888e+04      6.73e-07\npolygon 231        40 1.56849e+05      9.36e-06\npolygon 232        66 5.25038e+04      3.13e-06\npolygon 233         8 1.10747e+04      6.61e-07\npolygon 234        10 1.50784e+03      9.00e-08\npolygon 235        14 4.55332e+03      2.72e-07\npolygon 236        41 4.12940e+04      2.46e-06\npolygon 237         7 3.04017e+03      1.81e-07\npolygon 238        19 7.53923e+03      4.50e-07\npolygon 239        18 8.35187e+03      4.98e-07\npolygon 240        26 5.16261e+05      3.08e-05\npolygon 241        13 9.24908e+04      5.52e-06\npolygon 242        25 4.18653e+04      2.50e-06\npolygon 243         7 3.83476e+03      2.29e-07\npolygon 244        82 4.38420e+05      2.62e-05\npolygon 245       164 3.46334e+06      2.07e-04\npolygon 246        11 5.20050e+03      3.10e-07\npolygon 247        13 3.27494e+04      1.95e-06\npolygon 248         6 3.01213e+04      1.80e-06\npolygon 249        13 2.03114e+05      1.21e-05\npolygon 250        38 2.87869e+04      1.72e-06\npolygon 251        14 4.11781e+03      2.46e-07\npolygon 252        44 1.67050e+05      9.97e-06\npolygon 253        11 6.66399e+04      3.98e-06\npolygon 254       129 2.29310e+06      1.37e-04\npolygon 255        22 6.48307e+03      3.87e-07\npolygon 256       107 1.06884e+06      6.38e-05\npolygon 257         9 2.30080e+04      1.37e-06\npolygon 258        34 9.10976e+03      5.43e-07\npolygon 259        72 1.08609e+05      6.48e-06\npolygon 260        64 2.19815e+05      1.31e-05\npolygon 261        25 2.57976e+05      1.54e-05\npolygon 262        26 4.60002e+04      2.74e-06\npolygon 263        57 8.30086e+04      4.95e-06\npolygon 264        83 1.14012e+06      6.80e-05\npolygon 265        11 3.01000e+04      1.80e-06\npolygon 266        14 1.30459e+05      7.78e-06\npolygon 267        22 2.37055e+05      1.41e-05\npolygon 268        22 1.84821e+05      1.10e-05\npolygon 269      8736 1.15970e+10      6.92e-01\npolygon 270      5944 4.61753e+09      2.75e-01\nenclosing rectangle: [512010.4, 928107.4] x [9621858, 9833989] units\n                     (416100 x 212100 units)\nWindow area = 16761600000 square units\nFraction of frame area: 0.19\n\n\nShow code\n# Plot to verify\nplot(fire_month_owin, \n     main = \"Fire Points with Study Area Window\",\n     pch = 20,\n     cex = 0.5)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-spatio-temporal-kde",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-spatio-temporal-kde",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.3 Computing Spatio-temporal KDE",
    "text": "5.3 Computing Spatio-temporal KDE\n\n\nShow code\n# First check how many points we have\nmessage(\"Total fire points: \", nrow(fire_month))\nmessage(\"Points per month:\")\ntable(fire_month$Month)\n\n\n\n10 11 12 \n26  4  1 \n\n\nShow code\n# Check if we have enough data\nif(nrow(fire_month) &lt; 30) {\n  message(\"WARNING: Very few fire points detected. Analysis may not be meaningful.\")\n}\n\n# Compute STKDE with manual bandwidth specification to avoid sparse data error\ntryCatch({\n  # Try automatic bandwidth first\n  fire_month_stkde &lt;- spattemp.density(\n    pp = fire_month_owin,\n    h = NULL,\n    lambda = NULL,\n    verbose = FALSE\n  )\n}, error = function(e) {\n  message(\"Automatic bandwidth failed due to sparse data. Using manual bandwidth...\")\n  \n  # Use manual bandwidth based on spatial extent and temporal range\n  spatial_range &lt;- diff(range(st_coordinates(fire_month)[,1]))\n  temporal_range &lt;- diff(range(fire_month$Month))\n  \n  # Rule of thumb: bandwidth = range / 5\n  h_manual &lt;- spatial_range / 5  # spatial bandwidth\n  lambda_manual &lt;- max(1, temporal_range / 5)  # temporal bandwidth (at least 1)\n  \n  message(\"Using manual bandwidths: h = \", round(h_manual), \", lambda = \", round(lambda_manual, 2))\n  \n  # Compute with manual bandwidth\n  fire_month_stkde &lt;&lt;- spattemp.density(\n    pp = fire_month_owin,\n    h = h_manual,\n    lambda = lambda_manual,\n    verbose = FALSE\n  )\n})\n\n# Display summary\nif(exists(\"fire_month_stkde\")) {\n  summary(fire_month_stkde)\n} else {\n  message(\"STKDE computation failed. Skipping this analysis.\")\n}\n\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 59640.1 (spatial)\n  lambda = 1 (temporal)\n\nNo. of observations\n  31 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512010.4, 928107.4] x [9621858, 9833989]\n\nTemporal bound\n  [10, 12]\n\nEvaluation\n  128 x 128 x 3 trivariate lattice\n  Density range: [2.541332e-12, 6.107462e-11]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-stkde-by-month",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-stkde-by-month",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "5.4 Plotting STKDE by Month",
    "text": "5.4 Plotting STKDE by Month\n\n\nShow code\n# Plot STKDE for selected months (if computation was successful)\nif(exists(\"fire_month_stkde\")) {\n  # Check the structure of the STKDE object\n  if(!is.null(fire_month_stkde) && !is.null(fire_month_stkde$z)) {\n    # Get dimensions safely\n    z_dims &lt;- dim(fire_month_stkde$z)\n    \n    if(length(z_dims) == 3) {\n      n_times &lt;- z_dims[3]\n      message(\"STKDE has \", n_times, \" time points\")\n      \n      # Plot available time points\n      if(n_times &gt; 0) {\n        n_plots &lt;- min(6, n_times)\n        par(mfrow = c(2, 3))\n        \n        for(i in 1:n_plots) {\n          tryCatch({\n            plot(fire_month_stkde, \n                 tselect = i,\n                 main = paste(\"STKDE - Time\", i))\n          }, error = function(e) {\n            plot.new()\n            text(0.5, 0.5, paste(\"No data for time\", i))\n          })\n        }\n        par(mfrow = c(1, 1))\n      }\n    } else {\n      message(\"STKDE object has unexpected structure. Attempting simple plot...\")\n      tryCatch({\n        plot(fire_month_stkde)\n      }, error = function(e) {\n        message(\"Cannot plot STKDE: \", e$message)\n      })\n    }\n  } else {\n    message(\"STKDE object is incomplete\")\n  }\n} else {\n  message(\"STKDE not computed due to sparse data\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#creating-ppp-object-with-day-of-year",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#creating-ppp-object-with-day-of-year",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "6.1 Creating PPP Object with Day of Year",
    "text": "6.1 Creating PPP Object with Day of Year\n\n\nShow code\n# Prepare data with DayofYear\nfire_doy &lt;- fire_sf %&gt;%\n  dplyr::select(DayofYear) %&gt;%\n  mutate(DayofYear = as.numeric(DayofYear))\n\n# Create ppp object\nfire_doy_ppp &lt;- as.ppp(fire_doy)\n\n# Handle duplicates\nfire_doy_ppp &lt;- unique(fire_doy_ppp)\n\n# Combine with owin\nfire_doy_owin &lt;- fire_doy_ppp[kbb_owin]\n\n# Display summary\nsummary(fire_doy_owin)\n\n\nMarked planar point pattern:  31 points\nAverage intensity 1.849468e-09 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  279.0   280.0   293.0   293.7   302.0   336.0 \n\nWindow: polygonal boundary\n270 separate polygons (no holes)\n             vertices        area relative.area\npolygon 1           6 5.15790e+04      3.08e-06\npolygon 2           7 9.35325e+04      5.58e-06\npolygon 3          20 1.26679e+04      7.56e-07\npolygon 4          23 9.26107e+04      5.53e-06\npolygon 5          18 4.98850e+05      2.98e-05\npolygon 6          30 3.37290e+04      2.01e-06\npolygon 7          54 3.25363e+05      1.94e-05\npolygon 8          33 1.30250e+06      7.77e-05\npolygon 9         132 1.16490e+06      6.95e-05\npolygon 10         69 1.91355e+05      1.14e-05\npolygon 11        117 1.51905e+05      9.06e-06\npolygon 12         95 1.14409e+05      6.83e-06\npolygon 13         22 4.54503e+03      2.71e-07\npolygon 14         25 1.18153e+04      7.05e-07\npolygon 15        131 1.52345e+05      9.09e-06\npolygon 16         39 1.07779e+04      6.43e-07\npolygon 17         54 3.46837e+05      2.07e-05\npolygon 18         72 2.15853e+05      1.29e-05\npolygon 19         16 1.85061e+03      1.10e-07\npolygon 20         79 1.05702e+05      6.31e-06\npolygon 21         20 4.26450e+03      2.54e-07\npolygon 22        119 1.64729e+05      9.83e-06\npolygon 23         40 1.16146e+04      6.93e-07\npolygon 24         16 3.52284e+03      2.10e-07\npolygon 25        328 3.08592e+06      1.84e-04\npolygon 26        191 2.36937e+06      1.41e-04\npolygon 27         77 8.82506e+04      5.27e-06\npolygon 28         49 6.13179e+04      3.66e-06\npolygon 29        121 7.64910e+04      4.56e-06\npolygon 30          5 1.73815e+04      1.04e-06\npolygon 31          4 6.39020e+03      3.81e-07\npolygon 32         16 1.18396e+05      7.06e-06\npolygon 33          5 2.11407e+04      1.26e-06\npolygon 34         11 3.52360e+04      2.10e-06\npolygon 35         13 6.20570e+04      3.70e-06\npolygon 36          8 1.23128e+04      7.35e-07\npolygon 37          5 9.16907e+03      5.47e-07\npolygon 38         31 1.54528e+06      9.22e-05\npolygon 39         13 6.02786e+04      3.60e-06\npolygon 40         19 8.71573e+04      5.20e-06\npolygon 41         15 6.16242e+04      3.68e-06\npolygon 42          8 1.56726e+04      9.35e-07\npolygon 43          6 1.35363e+04      8.08e-07\npolygon 44          4 4.29360e+03      2.56e-07\npolygon 45         23 1.77052e+05      1.06e-05\npolygon 46         45 4.35839e+04      2.60e-06\npolygon 47          5 6.83224e+03      4.08e-07\npolygon 48          5 6.68328e+03      3.99e-07\npolygon 49          5 2.25570e+03      1.35e-07\npolygon 50          7 2.61716e+04      1.56e-06\npolygon 51          9 1.20125e+04      7.17e-07\npolygon 52          8 2.24884e+04      1.34e-06\npolygon 53          6 1.21058e+04      7.22e-07\npolygon 54          5 8.79539e+03      5.25e-07\npolygon 55          9 2.28045e+04      1.36e-06\npolygon 56          6 9.20554e+03      5.49e-07\npolygon 57         49 1.00131e+05      5.97e-06\npolygon 58          5 4.47493e+03      2.67e-07\npolygon 59          4 2.88084e+03      1.72e-07\npolygon 60          4 3.66452e+03      2.19e-07\npolygon 61         69 9.92186e+04      5.92e-06\npolygon 62          5 3.03623e+03      1.81e-07\npolygon 63          6 1.05413e+04      6.29e-07\npolygon 64          8 9.42911e+03      5.63e-07\npolygon 65         13 6.94883e+04      4.15e-06\npolygon 66         34 2.01331e+05      1.20e-05\npolygon 67        227 1.23408e+06      7.36e-05\npolygon 68          4 2.59824e+03      1.55e-07\npolygon 69          7 8.47540e+03      5.06e-07\npolygon 70          5 8.12486e+03      4.85e-07\npolygon 71         95 2.08341e+05      1.24e-05\npolygon 72         18 7.79145e+04      4.65e-06\npolygon 73         24 1.59007e+04      9.49e-07\npolygon 74          4 8.81028e+02      5.26e-08\npolygon 75         43 4.25653e+04      2.54e-06\npolygon 76          5 4.41923e+03      2.64e-07\npolygon 77          4 2.43914e+03      1.46e-07\npolygon 78          5 4.71226e+03      2.81e-07\npolygon 79        217 2.22687e+06      1.33e-04\npolygon 80         63 5.45427e+04      3.25e-06\npolygon 81          6 4.61991e+03      2.76e-07\npolygon 82          6 1.47370e+04      8.79e-07\npolygon 83          6 1.35588e+04      8.09e-07\npolygon 84         51 9.00805e+04      5.37e-06\npolygon 85          4 1.55335e+03      9.27e-08\npolygon 86         32 4.34625e+04      2.59e-06\npolygon 87        146 5.46576e+05      3.26e-05\npolygon 88         36 7.39133e+04      4.41e-06\npolygon 89         42 9.17378e+04      5.47e-06\npolygon 90        141 1.10143e+06      6.57e-05\npolygon 91         96 2.55421e+05      1.52e-05\npolygon 92         75 3.74798e+04      2.24e-06\npolygon 93         71 9.11194e+05      5.44e-05\npolygon 94          5 4.25220e+03      2.54e-07\npolygon 95         48 1.10263e+05      6.58e-06\npolygon 96          6 1.00670e+04      6.01e-07\npolygon 97         33 2.35513e+04      1.41e-06\npolygon 98          4 1.39953e+02      8.35e-09\npolygon 99        120 3.80319e+05      2.27e-05\npolygon 100        19 3.13896e+04      1.87e-06\npolygon 101        42 1.21247e+05      7.23e-06\npolygon 102        24 3.83865e+04      2.29e-06\npolygon 103        88 4.57022e+05      2.73e-05\npolygon 104        20 1.78068e+04      1.06e-06\npolygon 105        20 2.39368e+04      1.43e-06\npolygon 106         5 6.64860e+03      3.97e-07\npolygon 107         5 5.41661e+03      3.23e-07\npolygon 108        53 4.54957e+05      2.71e-05\npolygon 109       263 1.76196e+07      1.05e-03\npolygon 110         4 6.76374e+03      4.04e-07\npolygon 111        17 5.83732e+03      3.48e-07\npolygon 112        25 2.16843e+05      1.29e-05\npolygon 113         9 3.13706e+03      1.87e-07\npolygon 114        10 1.13374e+04      6.76e-07\npolygon 115        45 1.05289e+05      6.28e-06\npolygon 116         7 4.71437e+03      2.81e-07\npolygon 117       527 4.88599e+07      2.91e-03\npolygon 118       632 1.19875e+08      7.15e-03\npolygon 119        68 3.72752e+06      2.22e-04\npolygon 120        10 1.01946e+05      6.08e-06\npolygon 121        19 8.27040e+04      4.93e-06\npolygon 122        17 4.01684e+04      2.40e-06\npolygon 123        11 4.06518e+04      2.43e-06\npolygon 124       111 1.46837e+06      8.76e-05\npolygon 125       110 3.73961e+06      2.23e-04\npolygon 126        19 1.91715e+04      1.14e-06\npolygon 127        73 3.61882e+06      2.16e-04\npolygon 128        10 3.05396e+04      1.82e-06\npolygon 129         6 1.63086e+04      9.73e-07\npolygon 130        81 2.65410e+05      1.58e-05\npolygon 131         8 2.10497e+04      1.26e-06\npolygon 132         9 2.23051e+04      1.33e-06\npolygon 133        11 1.96429e+04      1.17e-06\npolygon 134       145 7.13724e+06      4.26e-04\npolygon 135        60 1.45303e+05      8.67e-06\npolygon 136        74 2.06450e+06      1.23e-04\npolygon 137        36 2.64395e+04      1.58e-06\npolygon 138       926 2.12401e+08      1.27e-02\npolygon 139        25 2.21142e+05      1.32e-05\npolygon 140         6 6.85335e+03      4.09e-07\npolygon 141        31 1.67739e+06      1.00e-04\npolygon 142         7 8.96845e+03      5.35e-07\npolygon 143        12 6.31109e+04      3.77e-06\npolygon 144       202 2.25183e+07      1.34e-03\npolygon 145        46 2.39836e+06      1.43e-04\npolygon 146        34 1.06861e+04      6.38e-07\npolygon 147         8 4.62274e+04      2.76e-06\npolygon 148         7 3.16257e+04      1.89e-06\npolygon 149         5 6.47214e+03      3.86e-07\npolygon 150        12 2.17322e+04      1.30e-06\npolygon 151         5 7.20136e+03      4.30e-07\npolygon 152       160 1.11856e+06      6.67e-05\npolygon 153       105 3.97161e+05      2.37e-05\npolygon 154        14 3.77546e+05      2.25e-05\npolygon 155        27 1.21328e+06      7.24e-05\npolygon 156       132 7.32320e+05      4.37e-05\npolygon 157        52 6.46488e+04      3.86e-06\npolygon 158        59 5.31644e+06      3.17e-04\npolygon 159        48 1.76605e+06      1.05e-04\npolygon 160        34 5.03181e+04      3.00e-06\npolygon 161        49 1.83632e+04      1.10e-06\npolygon 162        19 5.31559e+03      3.17e-07\npolygon 163       246 3.09440e+06      1.85e-04\npolygon 164        28 1.99191e+05      1.19e-05\npolygon 165        19 4.51980e+05      2.70e-05\npolygon 166        14 5.66638e+04      3.38e-06\npolygon 167        12 1.09882e+05      6.56e-06\npolygon 168        41 4.25466e+04      2.54e-06\npolygon 169       189 1.69035e+06      1.01e-04\npolygon 170       118 2.32814e+05      1.39e-05\npolygon 171         7 2.79374e+04      1.67e-06\npolygon 172        53 1.72586e+06      1.03e-04\npolygon 173        13 6.36463e+04      3.80e-06\npolygon 174       156 1.14531e+06      6.83e-05\npolygon 175        47 9.13932e+05      5.45e-05\npolygon 176        62 3.95152e+06      2.36e-04\npolygon 177       155 7.75116e+05      4.62e-05\npolygon 178        14 4.20349e+04      2.51e-06\npolygon 179        18 5.14007e+03      3.07e-07\npolygon 180        31 7.44696e+05      4.44e-05\npolygon 181        18 4.11037e+05      2.45e-05\npolygon 182        23 7.72702e+03      4.61e-07\npolygon 183         8 3.85828e+04      2.30e-06\npolygon 184       180 7.46362e+06      4.45e-04\npolygon 185        14 2.75557e+05      1.64e-05\npolygon 186         4 9.17061e+03      5.47e-07\npolygon 187         9 9.64342e+03      5.75e-07\npolygon 188         9 6.16694e+04      3.68e-06\npolygon 189        10 1.05264e+05      6.28e-06\npolygon 190         8 8.74118e+04      5.22e-06\npolygon 191         5 1.83999e+04      1.10e-06\npolygon 192         5 3.32417e+03      1.98e-07\npolygon 193        13 3.15953e+04      1.88e-06\npolygon 194        67 3.93589e+05      2.35e-05\npolygon 195         4 2.84280e+03      1.70e-07\npolygon 196        16 4.94144e+03      2.95e-07\npolygon 197         4 1.27360e+03      7.60e-08\npolygon 198         8 1.67265e+04      9.98e-07\npolygon 199        12 2.45940e+04      1.47e-06\npolygon 200        12 5.95411e+04      3.55e-06\npolygon 201        14 2.19831e+03      1.31e-07\npolygon 202        14 4.32480e+03      2.58e-07\npolygon 203        17 7.75234e+03      4.63e-07\npolygon 204        13 1.86854e+03      1.11e-07\npolygon 205        34 3.85424e+06      2.30e-04\npolygon 206         9 3.58530e+03      2.14e-07\npolygon 207        15 1.41276e+04      8.43e-07\npolygon 208        27 1.42520e+04      8.50e-07\npolygon 209        38 2.66059e+04      1.59e-06\npolygon 210        22 4.51365e+03      2.69e-07\npolygon 211        96 5.26123e+05      3.14e-05\npolygon 212        60 1.00574e+05      6.00e-06\npolygon 213        31 7.13409e+04      4.26e-06\npolygon 214        37 1.08935e+06      6.50e-05\npolygon 215       179 8.26972e+05      4.93e-05\npolygon 216        59 1.99001e+05      1.19e-05\npolygon 217        47 2.81875e+05      1.68e-05\npolygon 218       115 3.13327e+05      1.87e-05\npolygon 219       133 4.76117e+05      2.84e-05\npolygon 220        97 1.63408e+07      9.75e-04\npolygon 221        19 6.38976e+03      3.81e-07\npolygon 222        10 7.75421e+03      4.63e-07\npolygon 223       204 1.42141e+06      8.48e-05\npolygon 224       125 2.33616e+06      1.39e-04\npolygon 225        31 2.58857e+04      1.54e-06\npolygon 226        25 2.06725e+04      1.23e-06\npolygon 227        87 1.25180e+06      7.47e-05\npolygon 228        38 4.03858e+04      2.41e-06\npolygon 229        10 5.04629e+04      3.01e-06\npolygon 230         6 1.12888e+04      6.73e-07\npolygon 231        40 1.56849e+05      9.36e-06\npolygon 232        66 5.25038e+04      3.13e-06\npolygon 233         8 1.10747e+04      6.61e-07\npolygon 234        10 1.50784e+03      9.00e-08\npolygon 235        14 4.55332e+03      2.72e-07\npolygon 236        41 4.12940e+04      2.46e-06\npolygon 237         7 3.04017e+03      1.81e-07\npolygon 238        19 7.53923e+03      4.50e-07\npolygon 239        18 8.35187e+03      4.98e-07\npolygon 240        26 5.16261e+05      3.08e-05\npolygon 241        13 9.24908e+04      5.52e-06\npolygon 242        25 4.18653e+04      2.50e-06\npolygon 243         7 3.83476e+03      2.29e-07\npolygon 244        82 4.38420e+05      2.62e-05\npolygon 245       164 3.46334e+06      2.07e-04\npolygon 246        11 5.20050e+03      3.10e-07\npolygon 247        13 3.27494e+04      1.95e-06\npolygon 248         6 3.01213e+04      1.80e-06\npolygon 249        13 2.03114e+05      1.21e-05\npolygon 250        38 2.87869e+04      1.72e-06\npolygon 251        14 4.11781e+03      2.46e-07\npolygon 252        44 1.67050e+05      9.97e-06\npolygon 253        11 6.66399e+04      3.98e-06\npolygon 254       129 2.29310e+06      1.37e-04\npolygon 255        22 6.48307e+03      3.87e-07\npolygon 256       107 1.06884e+06      6.38e-05\npolygon 257         9 2.30080e+04      1.37e-06\npolygon 258        34 9.10976e+03      5.43e-07\npolygon 259        72 1.08609e+05      6.48e-06\npolygon 260        64 2.19815e+05      1.31e-05\npolygon 261        25 2.57976e+05      1.54e-05\npolygon 262        26 4.60002e+04      2.74e-06\npolygon 263        57 8.30086e+04      4.95e-06\npolygon 264        83 1.14012e+06      6.80e-05\npolygon 265        11 3.01000e+04      1.80e-06\npolygon 266        14 1.30459e+05      7.78e-06\npolygon 267        22 2.37055e+05      1.41e-05\npolygon 268        22 1.84821e+05      1.10e-05\npolygon 269      8736 1.15970e+10      6.92e-01\npolygon 270      5944 4.61753e+09      2.75e-01\nenclosing rectangle: [512010.4, 928107.4] x [9621858, 9833989] units\n                     (416100 x 212100 units)\nWindow area = 16761600000 square units\nFraction of frame area: 0.19"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-default-bandwidth",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-default-bandwidth",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "6.2 Computing STKDE with Default Bandwidth",
    "text": "6.2 Computing STKDE with Default Bandwidth\n\n\nShow code\n# Compute STKDE with day of year\ntryCatch({\n  fire_doy_stkde &lt;- spattemp.density(\n    pp = fire_doy_owin,\n    h = NULL,\n    lambda = NULL,\n    verbose = FALSE\n  )\n}, error = function(e) {\n  message(\"Automatic bandwidth failed. Using manual bandwidth...\")\n  \n  # Calculate manual bandwidth\n  coords &lt;- st_coordinates(fire_doy)\n  h_manual &lt;- diff(range(coords[,1])) / 5\n  lambda_manual &lt;- 30  # approximately monthly for day of year\n  \n  fire_doy_stkde &lt;&lt;- spattemp.density(\n    pp = fire_doy_owin,\n    h = h_manual,\n    lambda = lambda_manual,\n    verbose = FALSE\n  )\n})\n\n# Display summary\nif(exists(\"fire_doy_stkde\")) {\n  summary(fire_doy_stkde)\n} else {\n  message(\"STKDE computation failed\")\n}\n\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 34921.4 (spatial)\n  lambda = 2.1446 (temporal)\n\nNo. of observations\n  31 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512010.4, 928107.4] x [9621858, 9833989]\n\nTemporal bound\n  [279, 336]\n\nEvaluation\n  128 x 128 x 58 trivariate lattice\n  Density range: [3.678581e-30, 2.813632e-11]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#bandwidth-selection-using-bootstrap",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#bandwidth-selection-using-bootstrap",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "7.1 Bandwidth Selection using Bootstrap",
    "text": "7.1 Bandwidth Selection using Bootstrap\n\n\nShow code\n# Note: This may take several minutes to run\n# Uncomment to run bandwidth optimization\n\n# message(\"Starting bandwidth optimization (this may take a few minutes)...\")\n# fire_doy_boot &lt;- BOOT.spattemp(\n#   pp = fire_doy_owin,\n#   nboot = 10,  # Reduced for faster computation\n#   verbose = FALSE\n# )\n# \n# # Display optimal bandwidths\n# message(\"Optimal spatial bandwidth (h): \", round(fire_doy_boot$h, 2))\n# message(\"Optimal temporal bandwidth (lambda): \", round(fire_doy_boot$lambda, 2))\n\n# For demonstration, we'll use reasonable default values\nh_optimal &lt;- 9000\nlambda_optimal &lt;- 19"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-optimized-bandwidth",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-stkde-with-optimized-bandwidth",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "7.2 Computing STKDE with Optimized Bandwidth",
    "text": "7.2 Computing STKDE with Optimized Bandwidth\n\n\nShow code\n# Compute STKDE with optimized bandwidths\nfire_doy_stkde_opt &lt;- spattemp.density(\n  pp = fire_doy_owin,\n  h = h_optimal,\n  lambda = lambda_optimal,\n  verbose = FALSE\n)\n\n# Display summary\nsummary(fire_doy_stkde_opt)\n\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 9000 (spatial)\n  lambda = 19 (temporal)\n\nNo. of observations\n  31 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512010.4, 928107.4] x [9621858, 9833989]\n\nTemporal bound\n  [279, 336]\n\nEvaluation\n  128 x 128 x 58 trivariate lattice\n  Density range: [1.661956e-23, 1.511621e-11]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-optimized-stkde",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-optimized-stkde",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "7.3 Plotting Optimized STKDE",
    "text": "7.3 Plotting Optimized STKDE\n\n\nShow code\n# Check the actual time range in the data\nif(exists(\"fire_doy_stkde_opt\") && !is.null(fire_doy_stkde_opt)) {\n  # Get the actual temporal range\n  time_range &lt;- range(fire_doy_owin$marks)\n  message(\"Actual temporal range in data: Day \", time_range[1], \" to Day \", time_range[2])\n  \n  # Plot a sample of time slices within the actual range\n  par(mfrow = c(2, 3))\n  \n  # Select 6 representative days within the actual data range\n  min_day &lt;- time_range[1]\n  max_day &lt;- time_range[2]\n  \n  # Create evenly spaced days within the range\n  days_to_plot &lt;- round(seq(min_day, max_day, length.out = 6))\n  \n  for(day in days_to_plot) {\n    tryCatch({\n      plot(fire_doy_stkde_opt,\n           tselect = day,\n           main = paste(\"Day\", day, \"(\", format(as.Date(day-1, origin = \"2023-01-01\"), \"%b %d\"), \")\"))\n    }, error = function(e) {\n      plot.new()\n      text(0.5, 0.5, paste(\"Cannot plot Day\", day))\n    })\n  }\n  \n  par(mfrow = c(1, 1))\n} else {\n  message(\"STKDE optimization not computed\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-stpp",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#preparing-data-for-stpp",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.1 Preparing Data for stpp",
    "text": "8.1 Preparing Data for stpp\n\n\nShow code\n# Extract coordinates\ncoords &lt;- st_coordinates(fire_sf)\nfire_x &lt;- coords[, 1]\nfire_y &lt;- coords[, 2]\n\n# Use DayofYear as temporal coordinate\nfire_t &lt;- fire_sf$DayofYear\n\n# Create data frame\nfire_stpp_df &lt;- data.frame(\n  x = fire_x,\n  y = fire_y,\n  t = fire_t\n)\n\n# Remove any NA values\nfire_stpp_df &lt;- na.omit(fire_stpp_df)\n\n# Create stpp object\nfire_stpp &lt;- as.3dpoints(fire_stpp_df)\n\n# Check class\nclass(fire_stpp)\n\n\n[1] \"stpp\""
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#visualizing-stpp-object",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#visualizing-stpp-object",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.2 Visualizing stpp Object",
    "text": "8.2 Visualizing stpp Object\n\n\nShow code\n# Plot the 3D space-time point pattern\n# Note: stpp plot has its own parameter structure\ntryCatch({\n  # Simple plot without additional parameters\n  plot(fire_stpp)\n}, error = function(e) {\n  # If that fails, try plotting the data directly\n  message(\"Default plot failed, using alternative visualization...\")\n  \n  # Extract the data\n  if(length(fire_stpp) == 3) {\n    # Create manual 3D plot\n    library(scatterplot3d)\n    if(requireNamespace(\"scatterplot3d\", quietly = TRUE)) {\n      scatterplot3d(fire_stpp[,1], fire_stpp[,2], fire_stpp[,3],\n                    main = \"3D Visualization of Forest Fires\",\n                    xlab = \"X coordinate\",\n                    ylab = \"Y coordinate\", \n                    zlab = \"Day of Year\",\n                    color = \"red\",\n                    pch = 16)\n    } else {\n      # Fallback to 2D plots\n      par(mfrow = c(1, 2))\n      plot(fire_stpp[,1], fire_stpp[,2], \n           main = \"Spatial Distribution\",\n           xlab = \"X\", ylab = \"Y\", pch = 20, col = \"red\")\n      hist(fire_stpp[,3], \n           main = \"Temporal Distribution\",\n           xlab = \"Day of Year\", col = \"lightblue\")\n      par(mfrow = c(1, 1))\n    }\n  }\n})"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-space-time-k-function",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#computing-space-time-k-function",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.3 Computing Space-Time K-function",
    "text": "8.3 Computing Space-Time K-function\n\n\nShow code\n# Define spatial and temporal distances\nu &lt;- seq(0, 20000, by = 2000)  # Spatial distances in meters\nv &lt;- seq(0, 60, by = 10)       # Temporal distances in days\n\n# Compute STIKhat (this may take a moment)\nfire_stik &lt;- STIKhat(\n  xyt = fire_stpp,\n  dist = u,\n  times = v,\n  infectious = FALSE\n)\n\n# Display structure\nstr(fire_stik)\n\n\nList of 6\n $ Khat      : num [1:10, 1:6] 2.36e+10 2.36e+10 2.36e+10 3.53e+10 4.12e+10 ...\n $ Ktheo     : num [1:10, 1:6] 2.51e+08 1.01e+09 2.26e+09 4.02e+09 6.28e+09 ...\n $ dist      : num [1:10] 2000 4000 6000 8000 10000 12000 14000 16000 18000 20000\n $ times     : num [1:6] 10 20 30 40 50 60\n $ correction: chr \"isotropic\"\n $ infectious: logi FALSE"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-space-time-k-function",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#plotting-space-time-k-function",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "8.4 Plotting Space-Time K-function",
    "text": "8.4 Plotting Space-Time K-function\n\n\nShow code\n# Create contour plot\nplotK(fire_stik,\n      main = \"Space-Time Inhomogeneous K-function\",\n      xlab = \"Spatial Distance (m)\",\n      ylab = \"Temporal Distance (days)\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#key-findings",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#key-findings",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.1 Key Findings",
    "text": "9.1 Key Findings\nBased on our spatio-temporal point pattern analysis of forest fires in Kepulauan Bangka Belitung:\n\n9.1.1 Spatial Distribution\n\nFire events show clear spatial clustering patterns\nCertain areas experience higher fire density consistently\n\n\n\n9.1.2 Temporal Patterns\n\nStrong seasonal variation in fire occurrence\nPeak fire activity during specific months (typically dry season)\n\n\n\n9.1.3 Spatio-temporal Clustering\n\nThe K-function analysis reveals significant spatio-temporal clustering\nFires tend to occur close together in both space and time\nThis suggests possible fire spread or common underlying causes"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#interpretation-guidelines",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#interpretation-guidelines",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.2 Interpretation Guidelines",
    "text": "9.2 Interpretation Guidelines\n\n9.2.1 For K-function Contour Plot:\n\nHigh values at small u and v: Indicates clustering at short spatial and temporal distances\nFlat contours: Suggests random distribution\nRapid increase in contours: Shows the spatial and temporal extent of clustering\n\n\n\n9.2.2 For STKDE:\n\nHigh density areas: Represent hotspots of fire activity\nTemporal evolution: Shows how fire risk areas change over time"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#conclusions",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.3 Conclusions",
    "text": "9.3 Conclusions\nThe analysis reveals that forest fires in Kepulauan Bangka Belitung are not randomly distributed in space and time. Instead, they exhibit:\n\nSpatial clustering: Fires concentrate in specific geographic areas\nTemporal clustering: Fires occur more frequently during certain periods\nSpatio-temporal dependence: Recent fires increase the likelihood of nearby fires\n\nThese patterns are likely driven by: - Environmental factors (vegetation type, moisture) - Human activities (land clearing, agricultural practices) - Weather conditions (dry season effects)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex03/ex03.html#session-information",
    "href": "Hands-on_Ex/Hands-on_ex03/ex03.html#session-information",
    "title": "Hands-on Exercise 03: Spatio-Temporal Point Patterns Analysis",
    "section": "9.4 Session Information",
    "text": "9.4 Session Information\n\n\nShow code\nsessionInfo()\n\n\nR version 4.5.0 (2025-04-11 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n  LAPACK version 3.12.1\n\nlocale:\n[1] LC_COLLATE=Chinese (Simplified)_Hong Kong SAR.utf8 \n[2] LC_CTYPE=Chinese (Simplified)_Hong Kong SAR.utf8   \n[3] LC_MONETARY=Chinese (Simplified)_Hong Kong SAR.utf8\n[4] LC_NUMERIC=C                                       \n[5] LC_TIME=Chinese (Simplified)_Hong Kong SAR.utf8    \n\ntime zone: Asia/Shanghai\ntzcode source: internal\n\nattached base packages:\n[1] tcltk     stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] stpp_2.0-8             splancs_2.01-45        rpanel_1.1-5.2        \n [4] here_1.0.2             geodata_0.6-6          terra_1.8-60          \n [7] lubridate_1.9.4        forcats_1.0.0          stringr_1.5.1         \n[10] dplyr_1.1.4            purrr_1.0.4            readr_2.1.5           \n[13] tidyr_1.3.1            tibble_3.3.0           ggplot2_3.5.2         \n[16] tidyverse_2.0.0        tmap_4.2               sparr_2.3-16          \n[19] spatstat_3.4-1         spatstat.linnet_3.3-2  spatstat.model_3.4-2  \n[22] rpart_4.1.24           spatstat.explore_3.5-3 nlme_3.1-168          \n[25] spatstat.random_3.4-2  spatstat.geom_3.6-0    spatstat.univar_3.1-4 \n[28] spatstat.data_3.1-8    raster_3.6-32          sp_2.2-0              \n[31] sf_1.0-21             \n\nloaded via a namespace (and not attached):\n [1] DBI_1.2.3             deldir_2.0-4          gridExtra_2.3        \n [4] tmaptools_3.3         s2_1.1.7              logger_0.4.0         \n [7] rlang_1.1.6           magrittr_2.0.3        e1071_1.7-16         \n[10] compiler_4.5.0        mgcv_1.9-1            png_0.1-8            \n[13] vctrs_0.6.5           crayon_1.5.3          pkgconfig_2.0.3      \n[16] wk_0.9.4              fastmap_1.2.0         lwgeom_0.2-14        \n[19] leafem_0.2.5          utf8_1.2.5            rmarkdown_2.29       \n[22] tzdb_0.5.0            spacesXYZ_1.5-1       bit_4.6.0            \n[25] xfun_0.52             jsonlite_2.0.0        goftest_1.2-3        \n[28] spatstat.utils_3.2-0  parallel_4.5.0        R6_2.6.1             \n[31] stringi_1.8.7         RColorBrewer_1.1-3    extrafontdb_1.0      \n[34] stars_0.6-8           Rcpp_1.0.14           iterators_1.0.14     \n[37] knitr_1.50            tensor_1.5.1          base64enc_0.1-3      \n[40] tidyselect_1.2.1      Matrix_1.7-3          splines_4.5.0        \n[43] timechange_0.3.0      rstudioapi_0.17.1     dichromat_2.0-0.1    \n[46] abind_1.4-8           yaml_2.3.10           maptiles_0.10.0      \n[49] doParallel_1.0.17     codetools_0.2-20      misc3d_0.9-1         \n[52] lattice_0.22-6        leafsync_0.1.0        withr_3.0.2          \n[55] evaluate_1.0.3        units_0.8-7           proxy_0.4-27         \n[58] polyclip_1.10-7       pillar_1.10.2         KernSmooth_2.23-26   \n[61] foreach_1.5.2         generics_0.1.3        vroom_1.6.5          \n[64] rprojroot_2.1.1       hms_1.1.3             scales_1.4.0         \n[67] class_7.3-23          glue_1.8.0            tools_4.5.0          \n[70] leaflegend_1.2.1      data.table_1.17.0     rgl_1.3.18           \n[73] XML_3.99-0.18         grid_4.5.0            crosstalk_1.2.1      \n[76] colorspace_2.1-1      cols4all_0.9          cli_3.6.5            \n[79] spatstat.sparse_3.1-0 rappdirs_0.3.3        plot3D_1.4.2         \n[82] gtable_0.3.6          digest_0.6.37         classInt_0.4-11      \n[85] htmlwidgets_1.6.4     farver_2.1.2          htmltools_0.5.8.1    \n[88] lifecycle_1.0.4       leaflet_2.2.3         bit64_4.6.0-1        \n[91] microbenchmark_1.5.0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "",
    "text": "This exercise follows the Chapter 4 workflow from the course notes. We will:\n\nImport the 2019 Master Plan subzone polygons and the Early Childhood Development Agency (ECDA) child care point locations.\nClean and standardize the data, ensuring all geometries use the SVY21 / EPSG:3414 projection.\nCompute analytical summaries, including the number of centres and (when available) registered capacity by subzone and planning area.\nCreate exploratory maps (point overlay) and thematic choropleths that illustrate spatial patterns in the provision of child care services.\n\nThe original data files should be placed at:\n\nHands-on_Ex/Hands-on_ex02/data/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\nHands-on_Ex/Hands-on_ex02/data/ChildCareServices.geojson"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#overview",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "",
    "text": "This exercise follows the Chapter 4 workflow from the course notes. We will:\n\nImport the 2019 Master Plan subzone polygons and the Early Childhood Development Agency (ECDA) child care point locations.\nClean and standardize the data, ensuring all geometries use the SVY21 / EPSG:3414 projection.\nCompute analytical summaries, including the number of centres and (when available) registered capacity by subzone and planning area.\nCreate exploratory maps (point overlay) and thematic choropleths that illustrate spatial patterns in the provision of child care services.\n\nThe original data files should be placed at:\n\nHands-on_Ex/Hands-on_ex02/data/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\nHands-on_Ex/Hands-on_ex02/data/ChildCareServices.geojson"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#setup-and-environment",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#setup-and-environment",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Setup and Environment",
    "text": "Setup and Environment\n\n\nCode\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\npacman::p_load(\n  sf, tidyverse, janitor, stringr, rvest,\n  here, tmap, units, readr, sessioninfo)\n\ntmap_mode(\"plot\")\n\nroot_dir &lt;- here::here()\nexo_dir &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\")\nexo_data &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"data\")\nexo_fig &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"figures\")\n\nif (!dir.exists(exo_fig)) dir.create(exo_fig, recursive = TRUE, showWarnings = FALSE)\n\nmessage(\"Project root: \", root_dir)\nmessage(\"Exercise directory: \", exo_dir)\nmessage(\"Data directory: \", exo_data)\nmessage(\"Figures directory: \", exo_fig)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#import-and-inspect-spatial-data",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#import-and-inspect-spatial-data",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Import and Inspect Spatial Data",
    "text": "Import and Inspect Spatial Data\n\nMaster Plan Subzones (Polygon)\n\n\nCode\nmessage(\"\\n=== Loading Master Plan 2019 subzones ===\")\nsubzone_path &lt;- file.path(exo_data, \"MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\")\n\nif (!file.exists(subzone_path)) {\n  stop(\"Subzone boundary GeoJSON not found at: \", subzone_path,\n       \"\\nDownload it from data.gov.sg and place it in the data directory before knitting.\")\n}\n\nmpsz_2019 &lt;- st_read(subzone_path, quiet = FALSE)\n\n\nReading layer `MasterPlan2019SubzoneBoundaryNoSeaGEOJSON' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex02\\data\\MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nCode\nif (is.na(st_crs(mpsz_2019))) {\n  stop(\"Master Plan subzones are missing CRS information. Please check the source file.\")\n}\n\nif (st_crs(mpsz_2019)$epsg != 3414) {\n  message(\"Transforming subzones to EPSG:3414 (SVY21).\")\n  mpsz_2019 &lt;- st_transform(mpsz_2019, 3414)\n}\n\n# Make geometries valid using sf package\nmpsz_2019 &lt;- st_make_valid(mpsz_2019)\n\nmessage(\"Records loaded: \", nrow(mpsz_2019))\nmessage(\"Geometry type(s): \", paste(unique(st_geometry_type(mpsz_2019)), collapse = \", \"))\nmessage(\"Subzone attributes: \", paste(head(names(mpsz_2019), 10), collapse = \", \"))\n\n\n\n\nExtract fields from HTML Description\n\n\nCode\n# Function to extract KML fields from HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    map_chr(~ html_text2(html_element(.x, \"td\")))\n  \n  if (length(value) == 0) NA_character_ else value[1]\n}\n\n# Extract SUBZONE_N and PLN_AREA_N from Description field\nmpsz_2019 &lt;- mpsz_2019 %&gt;%\n  mutate(\n    subzone_name = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    planning_area = map_chr(Description, extract_kml_field, \"PLN_AREA_N\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\n# Clean the extracted data\nmpsz_2019 &lt;- mpsz_2019 %&gt;%\n  mutate(\n    subzone_name = str_squish(as.character(subzone_name)),\n    planning_area = str_squish(as.character(planning_area))\n  )\n\n# Display sample data\nsubzone_glimpse &lt;- mpsz_2019 %&gt;%\n  st_drop_geometry() %&gt;%\n  select(subzone_name, planning_area) %&gt;%\n  distinct() %&gt;%\n  head(10)\n\nprint(subzone_glimpse)\n\n\n          subzone_name planning_area\n1           DEPOT ROAD   BUKIT MERAH\n2          BUKIT MERAH   BUKIT MERAH\n3            CHINATOWN        OUTRAM\n4              PHILLIP DOWNTOWN CORE\n5        RAFFLES PLACE DOWNTOWN CORE\n6         CHINA SQUARE        OUTRAM\n7          TIONG BAHRU   BUKIT MERAH\n8     BAYFRONT SUBZONE DOWNTOWN CORE\n9  TIONG BAHRU STATION   BUKIT MERAH\n10       CLIFFORD PIER DOWNTOWN CORE\n\n\n\n\nChild Care Services (Point)\n\n\nCode\nmessage(\"\\n=== Loading ECDA child care locations ===\")\nchildcare_path &lt;- file.path(exo_data, \"ChildCareServices.geojson\")\n\nif (!file.exists(childcare_path)) {\n  stop(\"Child care services GeoJSON not found at: \", childcare_path,\n       \"\\nDownload the ECDA dataset and place it in the data directory before knitting.\")\n}\n\nchildcare_raw &lt;- st_read(childcare_path, quiet = FALSE) %&gt;%\n  janitor::clean_names()\n\n\nReading layer `ChildCareServices' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex02\\data\\ChildCareServices.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 1925 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\nif (is.na(st_crs(childcare_raw))) {\n  stop(\"Child care services data is missing CRS information. Please check the source file.\")\n}\n\nif (st_crs(childcare_raw)$epsg != 3414) {\n  message(\"Transforming child care locations to EPSG:3414 (SVY21).\")\n  childcare_sf &lt;- st_transform(childcare_raw, 3414)\n} else {\n  childcare_sf &lt;- childcare_raw\n}\n\n# Check if Description field contains HTML\n# Check if Description field contains HTML\nif (grepl(\"&lt;\", childcare_sf$description[1], fixed = TRUE)) {\n  # Extract centre name from HTML if present\n  childcare_sf &lt;- childcare_sf %&gt;%\n    mutate(\n      centre_name = map2_chr(description, name, function(desc, nm) {\n        if (is.na(desc) || desc == \"\") return(nm)\n        # Try to extract centre name from HTML\n        result &lt;- tryCatch({\n          extract_kml_field(desc, \"CENTRE_NAME\")\n        }, error = function(e) {\n          NA_character_\n        })\n        # If extraction fails, use name field\n        if (is.na(result)) return(nm) else return(result)\n      })\n    )\n} else {\n  # Use name field directly\n  childcare_sf &lt;- childcare_sf %&gt;%\n    mutate(centre_name = name)\n}\n\nchildcare_sf &lt;- childcare_sf %&gt;%\n  mutate(across(where(is.character), ~ str_squish(.x)))\n\nmessage(\"Records loaded: \", nrow(childcare_sf))\nmessage(\"Geometry type(s): \", paste(unique(st_geometry_type(childcare_sf)), collapse = \", \"))\nmessage(\"Child care attributes (first 10): \", paste(head(names(childcare_sf), 10), collapse = \", \"))\n\n# Display sample data\nchildcare_sf %&gt;%\n  st_drop_geometry() %&gt;%\n  select(any_of(c(\"centre_name\", \"name\"))) %&gt;%\n  head(5)\n\n\n  centre_name  name\n1       kml_1 kml_1\n2       kml_2 kml_2\n3       kml_3 kml_3\n4       kml_4 kml_4\n5       kml_5 kml_5"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#spatial-join-and-aggregation",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#spatial-join-and-aggregation",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Spatial Join and Aggregation",
    "text": "Spatial Join and Aggregation\n\nPrepare Helper Columns\n\n\nCode\n# No capacity column in this dataset, so we'll only count centres\ncapacity_col &lt;- NA_character_\nmessage(\"No capacity column detected; analyses will use only centre counts.\")\n\n# Prepare childcare data\nchildcare_ready &lt;- childcare_sf %&gt;%\n  mutate(\n    centre_name = coalesce(centre_name, name, \"(Unnamed centre)\"),\n    capacity = NA_real_  # No capacity data available\n  )\n\n\n\n\nSpatial Join (Points-in-Polygons)\n\n\nCode\nmessage(\"\\n=== Computing child care counts per subzone ===\")\nchildcare_joined &lt;- st_join(childcare_ready, mpsz_2019 %&gt;% select(subzone_name, planning_area),\n                            join = st_within, left = FALSE)\n\nchildcare_counts &lt;- childcare_joined %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(planning_area, subzone_name) %&gt;%\n  summarise(\n    centres = n(),\n    capacity_total = NA_real_,  # No capacity data\n    .groups = \"drop\"\n  )\n\nhas_capacity_information &lt;- FALSE\n\nprint(childcare_counts %&gt;% head(10))\n\n\n# A tibble: 10 × 4\n   planning_area subzone_name           centres capacity_total\n   &lt;chr&gt;         &lt;chr&gt;                    &lt;int&gt;          &lt;dbl&gt;\n 1 ANG MO KIO    ANG MO KIO TOWN CENTRE       3             NA\n 2 ANG MO KIO    CHENG SAN                   10             NA\n 3 ANG MO KIO    CHONG BOON                   7             NA\n 4 ANG MO KIO    KEBUN BAHRU                  8             NA\n 5 ANG MO KIO    SEMBAWANG HILLS              3             NA\n 6 ANG MO KIO    SHANGRI-LA                   7             NA\n 7 ANG MO KIO    TAGORE                       7             NA\n 8 ANG MO KIO    TOWNSVILLE                   9             NA\n 9 ANG MO KIO    YIO CHU KANG                 7             NA\n10 ANG MO KIO    YIO CHU KANG EAST            5             NA\n\n\n\n\nSubzone Summary\n\n\nCode\nsubzone_summary &lt;- mpsz_2019 %&gt;%\n  left_join(childcare_counts, by = c(\"planning_area\", \"subzone_name\")) %&gt;%\n  mutate(\n    centres = replace_na(centres, 0L),\n    capacity_total = NA_real_,  # No capacity data\n    area_sqm = st_area(geometry),\n    area_km2 = units::set_units(area_sqm, km^2) %&gt;% units::drop_units(),\n    centres_per_km2 = if_else(area_km2 &gt; 0, centres / area_km2, NA_real_),\n    capacity_per_km2 = NA_real_  # No capacity data\n  )\n\nsubzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  arrange(desc(centres)) %&gt;%\n  select(planning_area, subzone_name, centres, centres_per_km2) %&gt;%\n  head(10)\n\n\n   planning_area         subzone_name centres centres_per_km2\n1       TAMPINES        TAMPINES EAST      58       13.352509\n2      WOODLANDS       WOODLANDS EAST      49       19.189621\n3          BEDOK          BEDOK NORTH      32        9.988565\n4        GEYLANG             ALJUNIED      32       10.805459\n5       TAMPINES        TAMPINES WEST      30        8.632466\n6       SENGKANG SENGKANG TOWN CENTRE      30       20.540426\n7          BEDOK              FRANKEL      28        6.515961\n8    JURONG WEST               YUNNAN      27       12.237655\n9    JURONG WEST             HONG KAH      25       13.939508\n10      SENGKANG            RIVERVALE      24       15.296028\n\n\n\n\nPlanning Area Aggregation\n\n\nCode\nplanning_summary &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(planning_area) %&gt;%\n  summarise(\n    centres = sum(centres, na.rm = TRUE),\n    capacity_total = NA_real_,  # No capacity data\n    area_km2 = sum(area_km2, na.rm = TRUE),\n    centres_per_km2 = if_else(area_km2 &gt; 0, centres / area_km2, NA_real_),\n    capacity_per_km2 = NA_real_,  # No capacity data\n    .groups = \"drop\"\n  ) %&gt;%\n  arrange(desc(centres))\n\nprint(planning_summary %&gt;% head(10))\n\n\n# A tibble: 10 × 6\n   planning_area centres capacity_total area_km2 centres_per_km2\n   &lt;chr&gt;           &lt;int&gt;          &lt;dbl&gt;    &lt;dbl&gt;           &lt;dbl&gt;\n 1 BEDOK             130             NA    21.7             5.98\n 2 TAMPINES          117             NA    20.8             5.63\n 3 JURONG WEST       110             NA    14.7             7.49\n 4 WOODLANDS         107             NA    13.6             7.86\n 5 HOUGANG            98             NA    13.9             7.03\n 6 SENGKANG           94             NA    10.6             8.87\n 7 YISHUN             87             NA    20.9             4.17\n 8 CHOA CHU KANG      74             NA     6.12           12.1 \n 9 ANG MO KIO         72             NA    13.9             5.16\n10 PUNGGOL            72             NA     9.37            7.68\n# ℹ 1 more variable: capacity_per_km2 &lt;dbl&gt;"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#visual-analytics",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#visual-analytics",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Visual Analytics",
    "text": "Visual Analytics\n\nPoint Overlay Map\n\n\nCode\n# Check tmap version and use appropriate syntax\ntmap_version &lt;- packageVersion(\"tmap\")\n\nif (tmap_version &gt;= \"4.0\") {\n  # tmap v4 syntax\n  childcare_map &lt;- tm_shape(mpsz_2019) +\n    tm_polygons(fill = \"grey95\", col = \"grey70\", lwd = 0.3) +\n    tm_shape(childcare_ready) +\n    tm_dots(size = 0.05, fill = \"#0072B2\", fill_alpha = 0.6) +\n    tm_title(\"ECDA-registered Child Care Centres\") +\n    tm_scalebar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.2) +\n    tm_layout(frame = FALSE)\n} else {\n  # tmap v3 syntax\n  childcare_map &lt;- tm_shape(mpsz_2019) +\n    tm_polygons(col = \"grey95\", border.col = \"grey70\", lwd = 0.3) +\n    tm_shape(childcare_ready) +\n    tm_dots(size = 0.05, col = \"#0072B2\", alpha = 0.6,\n            title = \"Child care centres\") +\n    tm_layout(\n      title = \"ECDA-registered Child Care Centres\",\n      frame = FALSE,\n      legend.outside = TRUE,\n      outer.margins = 0.02,\n      main.title.position = \"center\"\n    ) +\n    tm_scale_bar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.2)\n}\n\nprint(childcare_map)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(childcare_map,\n          filename = file.path(exo_fig, \"ex02a_childcare_points.png\"),\n          width = 8, height = 6, units = \"in\", dpi = 300)\n\n\n\n\nChoropleth: Centres per Subzone\n\n\nCode\nif (tmap_version &gt;= \"4.0\") {\n  # tmap v4 syntax\n  centres_map &lt;- tm_shape(subzone_summary) +\n    tm_polygons(\n      fill = \"centres\",\n      fill.scale = tm_scale_intervals(\n        style = \"quantile\",\n        n = 5,\n        values = \"brewer.reds\"\n      ),\n      fill.legend = tm_legend(title = \"Centres\"),\n      col = \"grey60\",\n      lwd = 0.3\n    ) +\n    tm_title(\"Number of Child Care Centres by Subzone\") +\n    tm_scalebar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.1) +\n    tm_layout(frame = FALSE)\n} else {\n  # tmap v3 syntax\n  centres_map &lt;- tm_shape(subzone_summary) +\n    tm_polygons(\n      col = \"centres\",\n      palette = \"Reds\",\n      style = \"quantile\",\n      n = 5,\n      border.col = \"grey60\",\n      lwd = 0.3,\n      title = \"Centres\"\n    ) +\n    tm_layout(\n      title = \"Number of Child Care Centres by Subzone\",\n      frame = FALSE,\n      legend.outside = TRUE,\n      main.title.position = \"center\"\n    ) +\n    tm_scale_bar(position = c(\"left\", \"bottom\")) +\n    tm_compass(position = c(\"right\", \"top\"), size = 1.1)\n}\n\nprint(centres_map)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(centres_map,\n          filename = file.path(exo_fig, \"ex02a_childcare_centres.png\"),\n          width = 8, height = 6, units = \"in\", dpi = 300)\n\n\n\n\nChoropleth: Density of Centres\n\n\nCode\nif (!all(is.na(subzone_summary$centres_per_km2))) {\n  if (tmap_version &gt;= \"4.0\") {\n    # tmap v4 syntax\n    density_map &lt;- tm_shape(subzone_summary) +\n      tm_polygons(\n        fill = \"centres_per_km2\",\n        fill.scale = tm_scale_intervals(\n          style = \"jenks\",\n          n = 5,\n          values = \"brewer.blues\"\n        ),\n        fill.legend = tm_legend(title = \"Centres per km²\"),\n        col = \"grey60\",\n        lwd = 0.3\n      ) +\n      tm_title(\"Density of Child Care Centres by Subzone\") +\n      tm_scalebar(position = c(\"left\", \"bottom\")) +\n      tm_compass(position = c(\"right\", \"top\"), size = 1.1) +\n      tm_layout(frame = FALSE)\n  } else {\n    # tmap v3 syntax\n    density_map &lt;- tm_shape(subzone_summary) +\n      tm_polygons(\n        col = \"centres_per_km2\",\n        palette = \"Blues\",\n        style = \"jenks\",\n        n = 5,\n        border.col = \"grey60\",\n        lwd = 0.3,\n        title = \"Centres per km²\"\n      ) +\n      tm_layout(\n        title = \"Density of Child Care Centres by Subzone\",\n        frame = FALSE,\n        legend.outside = TRUE,\n        main.title.position = \"center\"\n      ) +\n      tm_scale_bar(position = c(\"left\", \"bottom\")) +\n      tm_compass(position = c(\"right\", \"top\"), size = 1.1)\n  }\n  \n  print(density_map)\n  \n  tmap_save(density_map,\n            filename = file.path(exo_fig, \"ex02a_childcare_density.png\"),\n            width = 8, height = 6, units = \"in\", dpi = 300)\n} else {\n  message(\"Centres per km² could not be computed (missing area information).\")\n}"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#descriptive-summaries",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#descriptive-summaries",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Descriptive Summaries",
    "text": "Descriptive Summaries\n\nOverall Statistics\n\n\nCode\nsummary_stats &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  summarise(\n    total_centres = sum(centres, na.rm = TRUE),\n    mean_centres = mean(centres, na.rm = TRUE),\n    median_centres = median(centres, na.rm = TRUE),\n    max_centres = max(centres, na.rm = TRUE),\n    min_centres = min(centres, na.rm = TRUE),\n    sd_centres = sd(centres, na.rm = TRUE)\n  )\n\nprint(summary_stats)\n\n\n  total_centres mean_centres median_centres max_centres min_centres sd_centres\n1          1925     5.798193              3          58           0   7.642993\n\n\n\n\nTop Subzones by Centre Count\n\n\nCode\ntop_subzones &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  arrange(desc(centres)) %&gt;%\n  select(planning_area, subzone_name, centres, centres_per_km2) %&gt;%\n  head(10)\n\nprint(top_subzones)\n\n\n   planning_area         subzone_name centres centres_per_km2\n1       TAMPINES        TAMPINES EAST      58       13.352509\n2      WOODLANDS       WOODLANDS EAST      49       19.189621\n3          BEDOK          BEDOK NORTH      32        9.988565\n4        GEYLANG             ALJUNIED      32       10.805459\n5       TAMPINES        TAMPINES WEST      30        8.632466\n6       SENGKANG SENGKANG TOWN CENTRE      30       20.540426\n7          BEDOK              FRANKEL      28        6.515961\n8    JURONG WEST               YUNNAN      27       12.237655\n9    JURONG WEST             HONG KAH      25       13.939508\n10      SENGKANG            RIVERVALE      24       15.296028\n\n\n\n\nBottom Subzones by Centre Count\n\n\nCode\nbottom_subzones &lt;- subzone_summary %&gt;%\n  st_drop_geometry() %&gt;%\n  filter(centres == 0) %&gt;%\n  select(planning_area, subzone_name, centres, centres_per_km2) %&gt;%\n  head(10)\n\nprint(paste(\"Number of subzones with no childcare centres:\", \n            sum(subzone_summary$centres == 0, na.rm = TRUE)))\n\n\n[1] \"Number of subzones with no childcare centres: 101\"\n\n\nCode\nprint(bottom_subzones)\n\n\n     planning_area            subzone_name centres centres_per_km2\n1           OUTRAM            CHINA SQUARE       0               0\n2    DOWNTOWN CORE        BAYFRONT SUBZONE       0               0\n3     MARINA SOUTH            MARINA SOUTH       0               0\n4    DOWNTOWN CORE                  NICOLL       0               0\n5      MARINA EAST             MARINA EAST       0               0\n6  WESTERN ISLANDS JURONG ISLAND AND BUKOM       0               0\n7           MUSEUM            FORT CANNING       0               0\n8  SINGAPORE RIVER               BOAT QUAY       0               0\n9    MARINE PARADE        MARINA EAST (MP)       0               0\n10 WESTERN ISLANDS                  SUDONG       0               0\n\n\n\n\nTop Planning Areas\n\n\nCode\ntop_planning &lt;- planning_summary %&gt;%\n  arrange(desc(centres)) %&gt;%\n  select(planning_area, centres, area_km2, centres_per_km2) %&gt;%\n  head(10)\n\nprint(top_planning)\n\n\n# A tibble: 10 × 4\n   planning_area centres area_km2 centres_per_km2\n   &lt;chr&gt;           &lt;int&gt;    &lt;dbl&gt;           &lt;dbl&gt;\n 1 BEDOK             130    21.7             5.98\n 2 TAMPINES          117    20.8             5.63\n 3 JURONG WEST       110    14.7             7.49\n 4 WOODLANDS         107    13.6             7.86\n 5 HOUGANG            98    13.9             7.03\n 6 SENGKANG           94    10.6             8.87\n 7 YISHUN             87    20.9             4.17\n 8 CHOA CHU KANG      74     6.12           12.1 \n 9 ANG MO KIO         72    13.9             5.16\n10 PUNGGOL            72     9.37            7.68"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02a.html#session-information",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02a.html#session-information",
    "title": "Hands-on Exercise 02a: Choropleth Mapping for Child Care Services",
    "section": "Session Information",
    "text": "Session Information\n\n\nCode\nsessioninfo::session_info()\n\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.5.0 (2025-04-11 ucrt)\n os       Windows 11 x64 (build 26100)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  Chinese (Simplified)_Hong Kong SAR.utf8\n ctype    Chinese (Simplified)_Hong Kong SAR.utf8\n tz       Asia/Shanghai\n date     2025-10-18\n pandoc   3.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n quarto   NA @ C:\\\\PROGRA~1\\\\Quarto\\\\bin\\\\quarto.exe\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version   date (UTC) lib source\n abind            1.4-8     2024-09-12 [1] CRAN (R 4.5.0)\n base64enc        0.1-3     2015-07-28 [1] CRAN (R 4.5.0)\n chromote         0.5.1     2025-04-24 [1] CRAN (R 4.5.0)\n class            7.3-23    2025-01-01 [1] CRAN (R 4.5.0)\n classInt         0.4-11    2025-01-08 [1] CRAN (R 4.5.0)\n cli              3.6.5     2025-04-23 [1] CRAN (R 4.5.0)\n codetools        0.2-20    2024-03-31 [1] CRAN (R 4.5.0)\n colorspace       2.1-1     2024-07-26 [1] CRAN (R 4.5.0)\n cols4all         0.9       2025-08-28 [1] CRAN (R 4.5.1)\n crosstalk        1.2.1     2023-11-23 [1] CRAN (R 4.5.0)\n data.table       1.17.0    2025-02-22 [1] CRAN (R 4.5.0)\n DBI              1.2.3     2024-06-02 [1] CRAN (R 4.5.0)\n dichromat        2.0-0.1   2022-05-02 [1] CRAN (R 4.5.0)\n digest           0.6.37    2024-08-19 [1] CRAN (R 4.5.0)\n dplyr          * 1.1.4     2023-11-17 [1] CRAN (R 4.5.0)\n e1071            1.7-16    2024-09-16 [1] CRAN (R 4.5.0)\n evaluate         1.0.3     2025-01-10 [1] CRAN (R 4.5.0)\n farver           2.1.2     2024-05-13 [1] CRAN (R 4.5.0)\n fastmap          1.2.0     2024-05-15 [1] CRAN (R 4.5.0)\n forcats        * 1.0.0     2023-01-29 [1] CRAN (R 4.5.0)\n generics         0.1.3     2022-07-05 [1] CRAN (R 4.5.0)\n ggplot2        * 3.5.2     2025-04-09 [1] CRAN (R 4.5.0)\n glue             1.8.0     2024-09-30 [1] CRAN (R 4.5.0)\n gtable           0.3.6     2024-10-25 [1] CRAN (R 4.5.0)\n here           * 1.0.2     2025-09-15 [1] CRAN (R 4.5.1)\n hms              1.1.3     2023-03-21 [1] CRAN (R 4.5.0)\n htmltools        0.5.8.1   2024-04-04 [1] CRAN (R 4.5.0)\n htmlwidgets      1.6.4     2023-12-06 [1] CRAN (R 4.5.0)\n httr             1.4.7     2023-08-15 [1] CRAN (R 4.5.0)\n janitor        * 2.2.1     2024-12-22 [1] CRAN (R 4.5.1)\n jsonlite         2.0.0     2025-03-27 [1] CRAN (R 4.5.0)\n KernSmooth       2.23-26   2025-01-01 [1] CRAN (R 4.5.0)\n knitr            1.50      2025-03-16 [1] CRAN (R 4.5.0)\n later            1.4.2     2025-04-08 [1] CRAN (R 4.5.0)\n lattice          0.22-6    2024-03-20 [1] CRAN (R 4.5.0)\n leafem           0.2.5     2025-08-28 [1] CRAN (R 4.5.1)\n leaflegend       1.2.1     2024-05-09 [1] CRAN (R 4.5.1)\n leaflet          2.2.3     2025-09-04 [1] CRAN (R 4.5.1)\n leafsync         0.1.0     2019-03-05 [1] CRAN (R 4.5.1)\n lifecycle        1.0.4     2023-11-07 [1] CRAN (R 4.5.0)\n logger           0.4.0     2024-10-22 [1] CRAN (R 4.5.0)\n lubridate      * 1.9.4     2024-12-08 [1] CRAN (R 4.5.0)\n lwgeom           0.2-14    2024-02-21 [1] CRAN (R 4.5.1)\n magrittr         2.0.3     2022-03-30 [1] CRAN (R 4.5.0)\n maptiles         0.10.0    2025-05-07 [1] CRAN (R 4.5.1)\n microbenchmark   1.5.0     2024-09-04 [1] CRAN (R 4.5.0)\n pacman           0.5.1     2019-03-11 [1] CRAN (R 4.5.0)\n pillar           1.10.2    2025-04-05 [1] CRAN (R 4.5.0)\n pkgconfig        2.0.3     2019-09-22 [1] CRAN (R 4.5.0)\n png              0.1-8     2022-11-29 [1] CRAN (R 4.5.0)\n processx         3.8.6     2025-02-21 [1] CRAN (R 4.5.0)\n promises         1.3.2     2024-11-28 [1] CRAN (R 4.5.0)\n proxy            0.4-27    2022-06-09 [1] CRAN (R 4.5.0)\n ps               1.9.1     2025-04-12 [1] CRAN (R 4.5.0)\n purrr          * 1.0.4     2025-02-05 [1] CRAN (R 4.5.0)\n R6               2.6.1     2025-02-15 [1] CRAN (R 4.5.0)\n raster           3.6-32    2025-03-28 [1] CRAN (R 4.5.0)\n RColorBrewer     1.1-3     2022-04-03 [1] CRAN (R 4.5.0)\n Rcpp             1.0.14    2025-01-12 [1] CRAN (R 4.5.0)\n readr          * 2.1.5     2024-01-10 [1] CRAN (R 4.5.0)\n rlang            1.1.6     2025-04-11 [1] CRAN (R 4.5.0)\n rmarkdown        2.29      2024-11-04 [1] CRAN (R 4.5.0)\n rprojroot        2.1.1     2025-08-26 [1] CRAN (R 4.5.1)\n rstudioapi       0.17.1    2024-10-22 [1] CRAN (R 4.5.0)\n rvest          * 1.0.4     2024-02-12 [1] CRAN (R 4.5.0)\n s2               1.1.7     2024-07-17 [1] CRAN (R 4.5.0)\n scales           1.4.0     2025-04-24 [1] CRAN (R 4.5.0)\n selectr          0.4-2     2019-11-20 [1] CRAN (R 4.5.0)\n sessioninfo    * 1.2.3     2025-02-05 [1] CRAN (R 4.5.1)\n sf             * 1.0-21    2025-05-15 [1] CRAN (R 4.5.1)\n snakecase        0.11.1    2023-08-27 [1] CRAN (R 4.5.1)\n sp               2.2-0     2025-02-01 [1] CRAN (R 4.5.0)\n spacesXYZ        1.5-1     2025-02-10 [1] CRAN (R 4.5.0)\n stars            0.6-8     2025-02-01 [1] CRAN (R 4.5.1)\n stringi          1.8.7     2025-03-27 [1] CRAN (R 4.5.0)\n stringr        * 1.5.1     2023-11-14 [1] CRAN (R 4.5.0)\n terra            1.8-60    2025-07-21 [1] CRAN (R 4.5.1)\n tibble         * 3.3.0     2025-06-08 [1] CRAN (R 4.5.0)\n tidyr          * 1.3.1     2024-01-24 [1] CRAN (R 4.5.0)\n tidyselect       1.2.1     2024-03-11 [1] CRAN (R 4.5.0)\n tidyverse      * 2.0.0     2023-02-22 [1] CRAN (R 4.5.0)\n timechange       0.3.0     2024-01-18 [1] CRAN (R 4.5.0)\n tmap           * 4.2       2025-09-10 [1] CRAN (R 4.5.1)\n tmaptools        3.3       2025-07-24 [1] CRAN (R 4.5.1)\n tzdb             0.5.0     2025-03-15 [1] CRAN (R 4.5.0)\n units          * 0.8-7     2025-03-11 [1] CRAN (R 4.5.0)\n utf8             1.2.5     2025-05-01 [1] CRAN (R 4.5.0)\n vctrs            0.6.5     2023-12-01 [1] CRAN (R 4.5.0)\n websocket        1.4.4     2025-04-10 [1] CRAN (R 4.5.0)\n withr            3.0.2     2024-10-28 [1] CRAN (R 4.5.0)\n wk               0.9.4     2024-10-11 [1] CRAN (R 4.5.0)\n xfun             0.52      2025-04-02 [1] CRAN (R 4.5.0)\n XML              3.99-0.18 2025-01-01 [1] CRAN (R 4.5.0)\n xml2             1.3.8     2025-03-14 [1] CRAN (R 4.5.0)\n yaml             2.3.10    2024-07-26 [1] CRAN (R 4.5.0)\n\n [1] C:/dev/R-4.5.0/library\n * ── Packages attached to the search path.\n\n──────────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "",
    "text": "This exercise focuses on importing, cleaning, and standardizing geospatial data for Singapore. We will process three spatial datasets (subzones, cycling paths, and pre-schools) and one aspatial dataset (Airbnb listings), ensuring all spatial data uses the SVY21 (EPSG:3414) coordinate reference system."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#overview",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "",
    "text": "This exercise focuses on importing, cleaning, and standardizing geospatial data for Singapore. We will process three spatial datasets (subzones, cycling paths, and pre-schools) and one aspatial dataset (Airbnb listings), ensuring all spatial data uses the SVY21 (EPSG:3414) coordinate reference system."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#setup-and-environment",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#setup-and-environment",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "Setup and Environment",
    "text": "Setup and Environment\n\n\nCode\n# Load required packages (including lwgeom for geometry validation)\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\npacman::p_load(sf, lwgeom, dplyr, readr, janitor, stringr, here, tmap, ggplot2, units)\n\n# Print session information for reproducibility\ncat(\"R version:\", R.version.string, \"\\n\")\n\n\nR version: R version 4.5.0 (2025-04-11 ucrt) \n\n\nCode\ncat(\"sf version:\", as.character(packageVersion(\"sf\")), \"\\n\")\n\n\nsf version: 1.0.20 \n\n\nCode\nmessage(\"Date: \", as.character(Sys.Date()))\n\n# Define path variables using here::here()\npath_root &lt;- here::here()\npath_ex01 &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\")\npath_geo &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\", \"data\", \"geospatial\")\npath_asp &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\", \"data\", \"aspatial\")\n\n# Display paths for verification\nmessage(\"Project root: \", path_root)\nmessage(\"Exercise 01 path: \", path_ex01)\nmessage(\"Geospatial data path: \", path_geo)\nmessage(\"Aspatial data path: \", path_asp)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#workflow",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#workflow",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "Workflow",
    "text": "Workflow\n\nStep 1: Import Geospatial Data\n\n\nCode\n# 1.1 Import MP14_SUBZONE_WEB_PL (Polygon)\nmessage(\"\\n=== Importing Subzone Data ===\")\n\n\n\n=== Importing Subzone Data ===\n\n\nCode\nsubzone_file &lt;- file.path(path_geo, \"MP14_SUBZONE_WEB_PL.shp\")\nif (!file.exists(subzone_file)) {\n  stop(\"MP14_SUBZONE_WEB_PL.shp not found at: \", subzone_file,\n       \"\\nPlease ensure the file is placed in: \", path_geo)\n}\n\nmpsz &lt;- sf::st_read(dsn = path_geo, layer = \"MP14_SUBZONE_WEB_PL\", quiet = FALSE)\n\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nCode\nsub_crs &lt;- sf::st_crs(mpsz)\nif (is.na(sub_crs$epsg)) {\n  hint &lt;- paste(sub_crs$input, sub_crs$wkt)\n  if (grepl(\"SVY21|Singapore TM|3414\", hint, ignore.case = TRUE)) {\n    message(\"Subzone CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\")\n    mpsz &lt;- sf::st_set_crs(mpsz, 3414)\n  } else {\n    stop(\"Subzone CRS has no EPSG and doesn't look like SVY21. Check the .prj file.\")\n  }\n}\n\n\nSubzone CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\n\n\nCode\n# Display basic information\nmessage(\"Subzone data imported successfully\")\n\n\nSubzone data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(mpsz))\n\n\n- Records: 323\n\n\nCode\nmessage(\"- CRS: \", sf::st_crs(mpsz)$input, \" | EPSG: \", sf::st_crs(mpsz)$epsg)\n\n\n- CRS: EPSG:3414 | EPSG: 3414\n\n\nCode\nmessage(\"- Geometry type: \", paste(unique(sf::st_geometry_type(mpsz)), collapse = \", \"))\n\n\n- Geometry type: MULTIPOLYGON\n\n\n\n\nCode\n# 1.2 Import CyclingPathGazette (Line)\nmessage(\"\\n=== Importing Cycling Path Data ===\")\n\n\n\n=== Importing Cycling Path Data ===\n\n\nCode\ncycling_file &lt;- file.path(path_geo, \"CyclingPath_Aug2025\", \"CyclingPathGazette.shp\")\nif (!file.exists(cycling_file)) {\n  stop(\"CyclingPathGazette.shp not found at: \", cycling_file,\n       \"\\nPlease ensure the file is placed in: \", file.path(path_geo, \"CyclingPath_Aug2025\"))\n}\n\ncycling_path &lt;- sf::st_read(cycling_file, quiet = FALSE)\n\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial\\CyclingPath_Aug2025\\CyclingPathGazette.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 4674 features and 7 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21\n\n\nCode\ncy_crs &lt;- sf::st_crs(cycling_path)\nif (is.na(cy_crs$epsg)) {\n  hint &lt;- paste(cy_crs$input, cy_crs$wkt)\n  if (grepl(\"SVY21|Singapore TM|3414\", hint, ignore.case = TRUE)) {\n    message(\"Cycling Path CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\")\n    cycling_path &lt;- sf::st_set_crs(cycling_path, 3414)\n  } else {\n    stop(\"Cycling Path CRS has no EPSG and doesn't look like SVY21. Check the .prj file.\")\n  }\n}\n\n\nCycling Path CRS shows 'SVY21' but EPSG is missing — setting EPSG:3414 explicitly.\n\n\nCode\n# Display basic information\nmessage(\"Cycling path data imported successfully\")\n\n\nCycling path data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(cycling_path))\n\n\n- Records: 4674\n\n\nCode\nmessage(\"- CRS: \", sf::st_crs(cycling_path)$input, \" | EPSG: \", sf::st_crs(cycling_path)$epsg)\n\n\n- CRS: EPSG:3414 | EPSG: 3414\n\n\nCode\nmessage(\"- Geometry type: \", paste(unique(sf::st_geometry_type(cycling_path)), collapse = \", \"))\n\n\n- Geometry type: MULTILINESTRING\n\n\n\n\nCode\n# 1.3 Import PreSchoolsLocation (Point)\nmessage(\"\\n=== Importing Pre-Schools Data ===\")\n\n\n\n=== Importing Pre-Schools Data ===\n\n\nCode\npreschool_file &lt;- file.path(path_geo, \"PreSchoolsLocation.kml\")\nif (!file.exists(preschool_file)) {\n  stop(\"PreSchoolsLocation.kml not found at: \", preschool_file,\n       \"\\nPlease ensure the file is placed in: \", path_geo)\n}\n\npreschools &lt;- st_read(preschool_file, quiet = FALSE)\n\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\n# Display basic information before transformation\nmessage(\"Pre-schools data imported successfully\")\n\n\nPre-schools data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(preschools))\n\n\n- Records: 2290\n\n\nCode\nmessage(\"- Original CRS EPSG: \", st_crs(preschools)$epsg)\n\n\n- Original CRS EPSG: 4326\n\n\nCode\nmessage(\"- Geometry type: \", unique(st_geometry_type(preschools)))\n\n\n- Geometry type: POINT\n\n\n\n\nCode\n# 1.4 Import listings.csv (Aspatial)\nmessage(\"\\n=== Importing Airbnb Listings Data ===\")\n\n\n\n=== Importing Airbnb Listings Data ===\n\n\nCode\nlistings_file &lt;- file.path(path_asp, \"listings.csv\")\nif (!file.exists(listings_file)) {\n  stop(\"listings.csv not found at: \", listings_file,\n       \"\\nPlease ensure the file is placed in: \", path_asp)\n}\n\nlistings &lt;- read_csv(listings_file, show_col_types = FALSE)\n\n# Verify required columns exist\nif (!all(c(\"latitude\", \"longitude\") %in% names(listings))) {\n  stop(\"listings.csv must contain 'latitude' and 'longitude' columns\")\n}\n\nmessage(\"Listings data imported successfully\")\n\n\nListings data imported successfully\n\n\nCode\nmessage(\"- Records: \", nrow(listings))\n\n\n- Records: 3659\n\n\nCode\nmessage(\"- Columns: \", ncol(listings))\n\n\n- Columns: 79\n\n\nCode\nmessage(\"- Latitude/Longitude columns: VERIFIED\")\n\n\n- Latitude/Longitude columns: VERIFIED\n\n\n\n\nStep 2: Exploratory Data Inspection (Ch. 1.5–1.6)\n\n\nCode\nmessage(\"\\n=== Inspecting Subzone Data Structure ===\")\n\n\n\n=== Inspecting Subzone Data Structure ===\n\n\nCode\n# Geometry column summary and CRS bbox overview\nprint(st_geometry(mpsz))\n\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\nCode\nprint(st_bbox(mpsz))\n\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334 \n\n\nCode\n# Attribute glimpse and sample records\nglimpse(mpsz)\n\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\nCode\nprint(head(mpsz, 3))\n\n\nSimple feature collection with 3 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 28160.23 ymin: 28369.47 xmax: 32362.39 ymax: 30247.18\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO    SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N PLN_AREA_C\n1        1          1 MARINA SOUTH    MSSZ01      Y    MARINA SOUTH         MS\n2        2          1 PEARL'S HILL    OTSZ01      Y          OUTRAM         OT\n3        3          3    BOAT QUAY    SRSZ03      Y SINGAPORE RIVER         SR\n        REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR\n1 CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84 29220.19\n2 CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06 29782.05\n3 CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96 29974.66\n  SHAPE_Leng SHAPE_Area                       geometry\n1   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n\n\n\n\nCode\nmessage(\"\\n=== Inspecting Cycling Path Data Structure ===\")\n\n\n\n=== Inspecting Cycling Path Data Structure ===\n\n\nCode\nprint(st_geometry(cycling_path))\n\n\nGeometry set for 4674 features \nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nMULTILINESTRING ((40128.23 37076.74, 40130.44 3...\n\n\nMULTILINESTRING ((35123.93 42970.72, 35121.12 4...\n\n\nMULTILINESTRING ((35088.86 42820.93, 35089.18 4...\n\n\nMULTILINESTRING ((35099.12 42871.11, 35097.69 4...\n\n\nMULTILINESTRING ((16031.65 36921.59, 16035.79 3...\n\n\nCode\nprint(st_bbox(cycling_path))\n\n\n    xmin     ymin     xmax     ymax \n11721.10 27550.13 42809.37 49702.59 \n\n\nCode\nglimpse(cycling_path)\n\n\nRows: 4,674\nColumns: 8\n$ RD_CD      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PATH_OWNER &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ SHAPE_LEN  &lt;dbl&gt; 18.732594, 94.469928, 9.169593, 51.320348, 29.886054, 38.38…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ RD_CD_DESC &lt;chr&gt; \"TAMPINES AVENUE 4\", \"PUNGGOL FIELD\", \"PUNGGOL FIELD\", \"PUN…\n$ PATH_OWN_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\n\nCode\nprint(head(cycling_path, 3))\n\n\nSimple feature collection with 3 features and 7 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 35088.86 ymin: 37076.69 xmax: 40146.92 ymax: 42970.72\nProjected CRS: SVY21 / Singapore TM\n  RD_CD PLANNING_A PATH_OWNER SHAPE_LEN PLANNING_1        RD_CD_DESC\n1  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; 18.732594   TAMPINES TAMPINES AVENUE 4\n2  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; 94.469928    PUNGGOL     PUNGGOL FIELD\n3  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;  9.169593    PUNGGOL     PUNGGOL FIELD\n                PATH_OWN_1                       geometry\n1 Land Transport Authority MULTILINESTRING ((40128.23 ...\n2 Land Transport Authority MULTILINESTRING ((35123.93 ...\n3 Land Transport Authority MULTILINESTRING ((35088.86 ...\n\n\n\n\nCode\nmessage(\"\\n=== Inspecting Pre-School Data Structure ===\")\n\n\n\n=== Inspecting Pre-School Data Structure ===\n\n\nCode\nprint(st_geometry(preschools))\n\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\nPOINT Z (103.8072 1.299333 0)\n\n\nPOINT Z (103.826 1.312839 0)\n\n\nPOINT Z (103.8409 1.348843 0)\n\n\nPOINT Z (103.8048 1.435024 0)\n\n\nPOINT Z (103.839 1.33315 0)\n\n\nCode\nprint(st_bbox(preschools))\n\n\n      xmin       ymin       xmax       ymax \n103.687842   1.247759 103.989707   1.462134 \n\n\nCode\nglimpse(preschools)\n\n\nRows: 2,290\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;POINT [°]&gt; POINT Z (103.8072 1.299333 0), POINT Z (103.826 1.31…\n\n\nCode\nprint(head(preschools, 3))\n\n\nSimple feature collection with 3 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.8072 ymin: 1.299333 xmax: 103.8409 ymax: 1.348843\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n   Name\n1 kml_1\n2 kml_2\n3 kml_3\n                                                                                                                                                                                                                                                                                                                                                                                          Description\n1     &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PRESCHOOL PTE.LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9390&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;498CC9FE48CC94D4&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n2              &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PTE. LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT8675&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;22877550804213FD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n3 &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S VINEYARD PRESCHOOL PTE. LTD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9308&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;B2FE90E44AD494E3&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n                       geometry\n1 POINT Z (103.8072 1.299333 0)\n2  POINT Z (103.826 1.312839 0)\n3 POINT Z (103.8409 1.348843 0)\n\n\n\n\nCode\nmessage(\"\\n=== Quick Look Plots (Chapter 1.6) ===\")\n\n\n\n=== Quick Look Plots (Chapter 1.6) ===\n\n\nCode\nop &lt;- par(mfrow = c(2, 2))\nplot(mpsz, main = \"MPSZ Subzones\")\n\n\n\n\n\n\n\n\n\nCode\nplot(st_geometry(mpsz), main = \"Subzone Geometry Only\")\nif (\"PLN_AREA_N\" %in% names(mpsz)) {\n  plot(mpsz[\"PLN_AREA_N\"], main = \"Planning Area Names\")\n} else if (\"pln_area_n\" %in% names(mpsz)) {\n  plot(mpsz[\"pln_area_n\"], main = \"Planning Area Names\")\n} else {\n  plot(st_geometry(mpsz), main = \"Planning Area Names\")\n}\n\n\n\n\n\n\n\n\n\nCode\nplot(st_geometry(mpsz), main = \"Subzones with Pre-Schools\")\nplot(st_geometry(preschools), add = TRUE, col = \"red\", pch = 20)\npar(op)\n\n\n\n\n\n\n\n\n\n\n\nStep 3: Converting Aspatial Data to sf (Ch. 1.8.2)\n\n\nCode\nmessage(\"\\n=== Converting Airbnb Listings to sf ===\")\n\n\n\n=== Converting Airbnb Listings to sf ===\n\n\nCode\nlistings_sf &lt;- listings %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326, remove = FALSE) %&gt;%\n  st_transform(3414)\n\nmessage(\"Listings converted to sf with CRS EPSG:\", st_crs(listings_sf)$epsg)\n\n\nListings converted to sf with CRS EPSG:3414\n\n\nCode\nglimpse(listings_sf)\n\n\nRows: 3,659\nColumns: 80\n$ id                                           &lt;dbl&gt; 71609, 71896, 71903, 2753…\n$ listing_url                                  &lt;chr&gt; \"https://www.airbnb.com/r…\n$ scrape_id                                    &lt;dbl&gt; 2.025063e+13, 2.025063e+1…\n$ last_scraped                                 &lt;date&gt; 2025-06-26, 2025-06-27, …\n$ source                                       &lt;chr&gt; \"city scrape\", \"previous …\n$ name                                         &lt;chr&gt; \"Ensuite Room (Room 1 & 2…\n$ description                                  &lt;chr&gt; \"For 3 rooms.Book room 1&…\n$ neighborhood_overview                        &lt;chr&gt; NA, NA, \"Quiet and view o…\n$ picture_url                                  &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_id                                      &lt;dbl&gt; 367042, 367042, 367042, 1…\n$ host_url                                     &lt;chr&gt; \"https://www.airbnb.com/u…\n$ host_name                                    &lt;chr&gt; \"Belinda\", \"Belinda\", \"Be…\n$ host_since                                   &lt;date&gt; 2011-01-29, 2011-01-29, …\n$ host_location                                &lt;chr&gt; \"Singapore\", \"Singapore\",…\n$ host_about                                   &lt;chr&gt; \"Hi My name is Belinda -H…\n$ host_response_time                           &lt;chr&gt; \"within an hour\", \"within…\n$ host_response_rate                           &lt;chr&gt; \"100%\", \"100%\", \"100%\", \"…\n$ host_acceptance_rate                         &lt;chr&gt; \"100%\", \"100%\", \"100%\", \"…\n$ host_is_superhost                            &lt;lgl&gt; FALSE, FALSE, FALSE, FALS…\n$ host_thumbnail_url                           &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_picture_url                             &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_neighbourhood                           &lt;chr&gt; \"Tampines\", \"Tampines\", \"…\n$ host_listings_count                          &lt;dbl&gt; 5, 5, 5, 59, 59, 7, 59, 5…\n$ host_total_listings_count                    &lt;dbl&gt; 10, 10, 10, 88, 88, 8, 88…\n$ host_verifications                           &lt;chr&gt; \"['email', 'phone']\", \"['…\n$ host_has_profile_pic                         &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ host_identity_verified                       &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ neighbourhood                                &lt;chr&gt; NA, NA, \"Singapore, Singa…\n$ neighbourhood_cleansed                       &lt;chr&gt; \"Tampines\", \"Tampines\", \"…\n$ neighbourhood_group_cleansed                 &lt;chr&gt; \"East Region\", \"East Regi…\n$ latitude                                     &lt;dbl&gt; 1.34537, 1.34754, 1.34531…\n$ longitude                                    &lt;dbl&gt; 103.9589, 103.9596, 103.9…\n$ property_type                                &lt;chr&gt; \"Private room in villa\", …\n$ room_type                                    &lt;chr&gt; \"Private room\", \"Private …\n$ accommodates                                 &lt;dbl&gt; 2, 1, 2, 1, 1, 2, 1, 1, 1…\n$ bathrooms                                    &lt;dbl&gt; 1.0, NA, 0.5, NA, NA, 1.0…\n$ bathrooms_text                               &lt;chr&gt; \"1 private bath\", \"Shared…\n$ bedrooms                                     &lt;dbl&gt; 2, NA, 1, NA, NA, 2, NA, …\n$ beds                                         &lt;dbl&gt; 3, NA, 2, NA, NA, 1, NA, …\n$ amenities                                    &lt;chr&gt; \"[\\\"Shampoo\\\", \\\"Fire pit…\n$ price                                        &lt;chr&gt; \"$143.00\", NA, \"$76.00\", …\n$ minimum_nights                               &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_nights                               &lt;dbl&gt; 365, 365, 365, 999, 999, …\n$ minimum_minimum_nights                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_minimum_nights                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ minimum_maximum_nights                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ maximum_maximum_nights                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ minimum_nights_avg_ntm                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_nights_avg_ntm                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ calendar_updated                             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, N…\n$ has_availability                             &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ availability_30                              &lt;dbl&gt; 30, 20, 30, 0, 0, 30, 0, …\n$ availability_60                              &lt;dbl&gt; 60, 49, 60, 24, 25, 60, 2…\n$ availability_90                              &lt;dbl&gt; 90, 79, 90, 54, 55, 90, 5…\n$ availability_365                             &lt;dbl&gt; 90, 79, 90, 153, 153, 365…\n$ calendar_last_scraped                        &lt;date&gt; 2025-06-26, 2025-06-27, …\n$ number_of_reviews                            &lt;dbl&gt; 19, 24, 46, 20, 16, 131, …\n$ number_of_reviews_ltm                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ number_of_reviews_l30d                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ availability_eoy                             &lt;dbl&gt; 90, 79, 90, 153, 153, 185…\n$ number_of_reviews_ly                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ estimated_occupancy_l365d                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ estimated_revenue_l365d                      &lt;dbl&gt; 0, NA, 0, NA, NA, 0, NA, …\n$ first_review                                 &lt;date&gt; 2011-12-19, 2011-07-30, …\n$ last_review                                  &lt;date&gt; 2020-01-17, 2019-10-13, …\n$ review_scores_rating                         &lt;dbl&gt; 4.44, 4.16, 4.41, 4.40, 4…\n$ review_scores_accuracy                       &lt;dbl&gt; 4.37, 4.22, 4.39, 4.16, 4…\n$ review_scores_cleanliness                    &lt;dbl&gt; 4.00, 4.09, 4.52, 4.26, 4…\n$ review_scores_checkin                        &lt;dbl&gt; 4.63, 4.43, 4.63, 4.47, 4…\n$ review_scores_communication                  &lt;dbl&gt; 4.78, 4.43, 4.64, 4.42, 4…\n$ review_scores_location                       &lt;dbl&gt; 4.26, 4.17, 4.50, 4.53, 4…\n$ review_scores_value                          &lt;dbl&gt; 4.32, 4.04, 4.36, 4.63, 4…\n$ license                                      &lt;chr&gt; NA, NA, NA, \"S0399\", \"S03…\n$ instant_bookable                             &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE…\n$ calculated_host_listings_count               &lt;dbl&gt; 5, 5, 5, 58, 58, 7, 58, 5…\n$ calculated_host_listings_count_entire_homes  &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0…\n$ calculated_host_listings_count_private_rooms &lt;dbl&gt; 5, 5, 5, 58, 58, 6, 58, 5…\n$ calculated_host_listings_count_shared_rooms  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ reviews_per_month                            &lt;dbl&gt; 0.12, 0.14, 0.27, 0.13, 0…\n$ geometry                                     &lt;POINT [m]&gt; POINT (41972.5 3639…\n\n\nCode\nprint(head(listings_sf, 3))\n\n\nSimple feature collection with 3 features and 79 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 41972.5 ymin: 36383.43 xmax: 42209.55 ymax: 36630.01\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 3 × 80\n     id listing_url              scrape_id last_scraped source name  description\n  &lt;dbl&gt; &lt;chr&gt;                        &lt;dbl&gt; &lt;date&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;      \n1 71609 https://www.airbnb.com/…   2.03e13 2025-06-26   city … Ensu… For 3 room…\n2 71896 https://www.airbnb.com/…   2.03e13 2025-06-27   previ… B&B … &lt;NA&gt;       \n3 71903 https://www.airbnb.com/…   2.03e13 2025-06-27   city … Room… Like your …\n# ℹ 73 more variables: neighborhood_overview &lt;chr&gt;, picture_url &lt;chr&gt;,\n#   host_id &lt;dbl&gt;, host_url &lt;chr&gt;, host_name &lt;chr&gt;, host_since &lt;date&gt;,\n#   host_location &lt;chr&gt;, host_about &lt;chr&gt;, host_response_time &lt;chr&gt;,\n#   host_response_rate &lt;chr&gt;, host_acceptance_rate &lt;chr&gt;,\n#   host_is_superhost &lt;lgl&gt;, host_thumbnail_url &lt;chr&gt;, host_picture_url &lt;chr&gt;,\n#   host_neighbourhood &lt;chr&gt;, host_listings_count &lt;dbl&gt;,\n#   host_total_listings_count &lt;dbl&gt;, host_verifications &lt;chr&gt;, …\n\n\n\n\nCode\nmessage(\"\\n=== DIY Map: Airbnb Listings over Subzones ===\")\n\nold_tmap_mode &lt;- tmap_mode(\"plot\")\n\ntmap::tm_shape(mpsz) +\n  tmap::tm_polygons(col = \"grey90\", border.col = \"grey60\") +\n  tmap::tm_shape(listings_sf) +\n  tmap::tm_symbols(col = \"tomato\", size = 0.03, alpha = 0.5) +\n  tmap::tm_layout(\n    title = \"Airbnb Listings across Singapore Subzones\",\n    legend.show = FALSE,\n    frame = FALSE\n  )\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(old_tmap_mode)\n\n\n\n\nStep 4: Coordinate System Transformation and Validation\n\n\nCode\nmessage(\"\\n=== CRS Transformation and Validation ===\")\n\n\n\n=== CRS Transformation and Validation ===\n\n\nCode\n# Define target CRS\ncrs_target &lt;- sf::st_crs(3414)\n\n# Transform Pre-Schools from WGS84 (4326) to SVY21 (3414)\nif (st_crs(preschools)$epsg == 4326) {\n  message(\"Transforming Pre-Schools from EPSG:4326 to EPSG:3414...\")\n  preschools &lt;- st_transform(preschools, crs = crs_target)\n  message(\"Transformation completed\")\n} else if (st_crs(preschools) != crs_target) {\n  stop(\"Unexpected CRS for Pre-Schools. Expected 4326 or 3414, got: \", \n       st_crs(preschools)$epsg)\n}\n\n\nTransforming Pre-Schools from EPSG:4326 to EPSG:3414...\n\n\nTransformation completed\n\n\nCode\n# Handle potential GEOMETRYCOLLECTION from KML\nif (any(st_geometry_type(preschools) == \"GEOMETRYCOLLECTION\")) {\n  message(\"Extracting POINT geometries from GEOMETRYCOLLECTION...\")\n  preschools &lt;- st_collection_extract(preschools, \"POINT\")\n}\n\n# Verify all spatial data is in EPSG:3414\nmessage(\"\\nVerifying CRS consistency...\")\n\n\n\nVerifying CRS consistency...\n\n\nCode\n# Assert CRS for all spatial datasets using object comparison\nif (st_crs(mpsz) != crs_target) {\n  stop(\"Subzone CRS is not EPSG:3414. Current CRS: \", st_crs(mpsz)$input)\n}\n\nif (st_crs(cycling_path) != crs_target) {\n  stop(\"Cycling Path CRS is not EPSG:3414. Current CRS: \", st_crs(cycling_path)$input)\n}\n\nif (st_crs(preschools) != crs_target) {\n  stop(\"Pre-Schools CRS is not EPSG:3414 after transform. Current CRS: \", st_crs(preschools)$input)\n}\n\nmessage(\"✓ All spatial datasets are in EPSG:3414 (SVY21)\")\n\n\n✓ All spatial datasets are in EPSG:3414 (SVY21)\n\n\nCode\n# Verify geometry types\nmessage(\"\\nVerifying geometry types...\")\n\n\n\nVerifying geometry types...\n\n\nCode\n# Check subzone geometry\nsubzone_geom &lt;- unique(st_geometry_type(mpsz))\nif (!all(subzone_geom %in% c(\"POLYGON\", \"MULTIPOLYGON\"))) {\n  stop(\"Subzone should be POLYGON or MULTIPOLYGON, got: \", paste(subzone_geom, collapse=\", \"))\n}\n\n# Check cycling path geometry  \ncycling_geom &lt;- unique(st_geometry_type(cycling_path))\nif (!all(cycling_geom %in% c(\"LINESTRING\", \"MULTILINESTRING\"))) {\n  stop(\"Cycling Path should be LINESTRING or MULTILINESTRING, got: \", paste(cycling_geom, collapse=\", \"))\n}\n\n# Check preschools geometry\npreschool_geom &lt;- unique(st_geometry_type(preschools))\nif (!all(preschool_geom %in% c(\"POINT\"))) {\n  stop(\"Pre-Schools should be POINT, got: \", paste(preschool_geom, collapse=\", \"))\n}\n\nmessage(\"✓ All geometry types verified\")\n\n\n✓ All geometry types verified\n\n\n\n\nStep 5: Data Cleaning and Standardization\n\n\nCode\nmessage(\"\\n=== Data Cleaning and Standardization ===\")\n\n\n\n=== Data Cleaning and Standardization ===\n\n\nCode\n# 3.1 Clean column names (snake_case)\nmessage(\"Standardizing column names to snake_case...\")\n\n\nStandardizing column names to snake_case...\n\n\nCode\nmpsz &lt;- mpsz %&gt;% janitor::clean_names()\ncycling_path &lt;- cycling_path %&gt;% janitor::clean_names()\npreschools &lt;- preschools %&gt;% janitor::clean_names()\n\n# 3.2 Select and retain key fields\nmessage(\"Selecting key fields...\")\n\n\nSelecting key fields...\n\n\nCode\n# For subzone: retain subzone_n and pln_area_n\nif (all(c(\"subzone_n\", \"pln_area_n\") %in% names(mpsz))) {\n  mpsz_clean &lt;- mpsz %&gt;%\n    select(subzone_n, pln_area_n, geometry)\n} else {\n  message(\"Note: Expected fields 'subzone_n' or 'pln_area_n' not found. Retaining all fields.\")\n  mpsz_clean &lt;- mpsz\n}\n\n# For cycling path: retain basic identification fields\ncycling_clean &lt;- cycling_path %&gt;%\n  select(any_of(c(\"objectid\", \"name\", \"type\", \"status\")), geometry)\n\n# For preschools: retain name field\nif (\"name\" %in% names(preschools)) {\n  preschools_clean &lt;- preschools %&gt;%\n    select(name, geometry)\n} else {\n  message(\"Note: 'name' field not found in Pre-Schools. Retaining all fields.\")\n  preschools_clean &lt;- preschools\n}\n\n# 3.3 Remove empty geometries\nmessage(\"Checking for empty geometries...\")\n\n\nChecking for empty geometries...\n\n\nCode\n# Check and remove empty geometries\nn_empty_mpsz &lt;- sum(st_is_empty(mpsz_clean))\nn_empty_cycling &lt;- sum(st_is_empty(cycling_clean))\nn_empty_preschools &lt;- sum(st_is_empty(preschools_clean))\n\nif (n_empty_mpsz &gt; 0) {\n  message(\"Removing \", n_empty_mpsz, \" empty geometries from subzone data\")\n  mpsz_clean &lt;- mpsz_clean[!st_is_empty(mpsz_clean), ]\n}\n\nif (n_empty_cycling &gt; 0) {\n  message(\"Removing \", n_empty_cycling, \" empty geometries from cycling path data\")\n  cycling_clean &lt;- cycling_clean[!st_is_empty(cycling_clean), ]\n}\n\nif (n_empty_preschools &gt; 0) {\n  message(\"Removing \", n_empty_preschools, \" empty geometries from preschools data\")\n  preschools_clean &lt;- preschools_clean[!st_is_empty(preschools_clean), ]\n}\n\nmessage(\"✓ Data cleaning completed\")\n\n\n✓ Data cleaning completed\n\n\nCode\n# 3.4 Make geometries valid if needed\nmessage(\"Validating geometries...\")\n\n\nValidating geometries...\n\n\nCode\n# Check and fix invalid geometries\nif (any(!st_is_valid(mpsz_clean))) {\n  message(\"Fixing invalid geometries in subzone data...\")\n  mpsz_clean &lt;- st_make_valid(mpsz_clean)\n}\n\n\nFixing invalid geometries in subzone data...\n\n\nCode\nif (any(!st_is_valid(cycling_clean))) {\n  message(\"Fixing invalid geometries in cycling path data...\")\n  cycling_clean &lt;- st_make_valid(cycling_clean)\n}\n\nif (any(!st_is_valid(preschools_clean))) {\n  message(\"Fixing invalid geometries in preschools data...\")\n  preschools_clean &lt;- st_make_valid(preschools_clean)\n}\n\nmessage(\"✓ All geometries are valid\")\n\n\n✓ All geometries are valid\n\n\n\n\nStep 6: Export Clean Data\n\n\nCode\nmessage(\"\\n=== Exporting Clean Data ===\")\n\n\n\n=== Exporting Clean Data ===\n\n\nCode\n# Define output file paths\nsubzone_out &lt;- file.path(path_geo, \"clean_subzone.gpkg\")\ncycling_out &lt;- file.path(path_geo, \"clean_cycling_path.gpkg\")\npreschools_out &lt;- file.path(path_geo, \"clean_preschools_svy21.gpkg\")\n\n# Remove existing files to avoid multiple layers\nif (file.exists(subzone_out)) {\n  message(\"Removing existing clean_subzone.gpkg\")\n  file.remove(subzone_out)\n}\n\n\nRemoving existing clean_subzone.gpkg\n\n\n[1] TRUE\n\n\nCode\nif (file.exists(cycling_out)) {\n  message(\"Removing existing clean_cycling_path.gpkg\")\n  file.remove(cycling_out)\n}\n\n\nRemoving existing clean_cycling_path.gpkg\n\n\n[1] TRUE\n\n\nCode\nif (file.exists(preschools_out)) {\n  message(\"Removing existing clean_preschools_svy21.gpkg\")\n  file.remove(preschools_out)\n}\n\n\nRemoving existing clean_preschools_svy21.gpkg\n\n\n[1] TRUE\n\n\nCode\n# Export to GeoPackage\nmessage(\"Writing clean data to GeoPackage files...\")\n\n\nWriting clean data to GeoPackage files...\n\n\nCode\nst_write(mpsz_clean, subzone_out, layer = \"subzone\", quiet = FALSE)\n\n\nWriting layer `subzone' to data source \n  `C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_subzone.gpkg' using driver `GPKG'\nWriting 323 features with 2 fields and geometry type Unknown (any).\n\n\nCode\nst_write(cycling_clean, cycling_out, layer = \"cycling_path\", quiet = FALSE)\n\n\nWriting layer `cycling_path' to data source \n  `C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_cycling_path.gpkg' using driver `GPKG'\nWriting 4674 features with 0 fields and geometry type Multi Line String.\n\n\nCode\nst_write(preschools_clean, preschools_out, layer = \"preschools\", quiet = FALSE)\n\n\nWriting layer `preschools' to data source \n  `C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_preschools_svy21.gpkg' using driver `GPKG'\nWriting 2290 features with 1 fields and geometry type 3D Point.\n\n\nCode\nmessage(\"\\n✓ All clean data exported successfully\")\n\n\n\n✓ All clean data exported successfully\n\n\nCode\nmessage(\"Output files:\")\n\n\nOutput files:\n\n\nCode\nmessage(\"- \", subzone_out)\n\n\n- C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_subzone.gpkg\n\n\nCode\nmessage(\"- \", cycling_out)\n\n\n- C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_cycling_path.gpkg\n\n\nCode\nmessage(\"- \", preschools_out)\n\n\n- C:/Users/HOPE/Desktop/ISSS626/Hands-on_Ex/Hands-on_ex01/data/geospatial/clean_preschools_svy21.gpkg\n\n\n\n\nStep 7: Geospatial Processing Examples (Ch. 1.9)\n\n\nCode\nmessage(\"\\n=== Cycling Path Buffer and Area Calculations ===\")\n\n\n\n=== Cycling Path Buffer and Area Calculations ===\n\n\nCode\n# Create 5 metre buffer around cleaned cycling paths (per feature)\ncycling_buffer &lt;- cycling_clean %&gt;%\n  st_buffer(dist = 5) %&gt;%\n  mutate(\n    buffer_area_sqm = st_area(.),\n    buffer_area_sqkm = set_units(buffer_area_sqm, \"km^2\")\n  )\n\ntotal_buffer_area &lt;- sum(cycling_buffer$buffer_area_sqkm)\nmessage(\n  \"Total buffered cycling corridor area (5 m): \",\n  signif(as.numeric(total_buffer_area), 4),\n  \" sq km\"\n)\n\n\nTotal buffered cycling corridor area (5 m): 3.56 sq km\n\n\nCode\n# Intersect buffer with Tampines West subzone (if available)\ntampines_west &lt;- mpsz_clean %&gt;%\n  filter(\n    toupper(pln_area_n) == \"TAMPINES\",\n    toupper(subzone_n) == \"TAMPINES WEST\"\n  )\n\nif (nrow(tampines_west) == 0) {\n  message(\"Tampines West subzone not found – selecting first available subzone instead.\")\n  tampines_west &lt;- mpsz_clean[1, ]\n}\n\ntampines_buffer &lt;- st_intersection(st_make_valid(tampines_west), st_union(cycling_buffer))\n\nif (nrow(tampines_buffer) &gt; 0) {\n  tampines_area &lt;- set_units(st_area(tampines_buffer), \"km^2\")\n  message(\n    \"Buffered cycling area within selected subzone: \",\n    signif(as.numeric(tampines_area), 4),\n    \" sq km\"\n  )\n} else {\n  message(\"No buffered cycling segments found within the selected subzone.\")\n}\n\n\nBuffered cycling area within selected subzone: 0.09913 sq km\n\n\n\n\nCode\nmessage(\"\\n=== Visualising Cycling Buffer in Tampines West ===\")\n\nold_tmap_mode &lt;- tmap_mode(\"plot\")\n\nif (nrow(tampines_buffer) &gt; 0) {\n  tmap::tm_shape(tampines_west) +\n    tmap::tm_polygons(col = \"#f0f4ff\", border.col = \"#26456e\") +\n    tmap::tm_shape(tampines_buffer) +\n    tmap::tm_fill(col = \"#ffb347\", alpha = 0.6) +\n    tmap::tm_layout(\n      title = \"5 m Cycling Corridor Buffer in Tampines West\",\n      legend.show = FALSE,\n      frame = FALSE\n    )\n} else {\n  message(\"Skipping map because no buffered cycling segments were found in the selected subzone.\")\n}\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(old_tmap_mode)\n\n\n\n\nCode\n# Count pre-schools per subzone\nmessage(\"\\n=== Preschool Counts by Subzone ===\")\n\n\n\n=== Preschool Counts by Subzone ===\n\n\nCode\nsubzone_preschool &lt;- mpsz_clean %&gt;%\n  dplyr::mutate(\n    subzone_area_sqkm = as.numeric(units::set_units(sf::st_area(.), \"km^2\")),\n    preschool_count   = lengths(sf::st_intersects(., preschools_clean)),\n    preschool_density = preschool_count / subzone_area_sqkm\n  )\n\nsubzone_summary &lt;- subzone_preschool %&gt;%\n  sf::st_drop_geometry() %&gt;%\n  dplyr::transmute(\n    subzone_n,\n    planning_area      = pln_area_n,\n    subzone_area_sqkm,\n    preschool_count,\n    preschool_density\n  )\n\nprint(head(subzone_summary, 5))\n\n\n       subzone_n   planning_area subzone_area_sqkm preschool_count\n1   MARINA SOUTH    MARINA SOUTH         1.6303793               0\n2   PEARL'S HILL          OUTRAM         0.5598162               6\n3      BOAT QUAY SINGAPORE RIVER         0.1608075               0\n4 HENDERSON HILL     BUKIT MERAH         0.5954289               5\n5        REDHILL     BUKIT MERAH         0.3874294               3\n  preschool_density\n1          0.000000\n2         10.717803\n3          0.000000\n4          8.397308\n5          7.743345\n\n\nCode\nmessage(\"\\nSummary of preschool density (counts per sq km):\")\n\n\n\nSummary of preschool density (counts per sq km):\n\n\nCode\nprint(summary(subzone_summary$preschool_density))\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   5.154   6.449  10.908  35.602 \n\n\nCode\ntop_subzone &lt;- subzone_summary %&gt;%\n  dplyr::arrange(dplyr::desc(preschool_count)) %&gt;%\n  dplyr::slice_head(n = 1)\n\nmessage(\"\\nSubzone with the highest preschool count:\")\n\n\n\nSubzone with the highest preschool count:\n\n\nCode\nprint(top_subzone)\n\n\n      subzone_n planning_area subzone_area_sqkm preschool_count\n1 TAMPINES EAST      TAMPINES          4.339824              72\n  preschool_density\n1          16.59053\n\n\n\n\nCode\np_hist &lt;- ggplot(subzone_summary, aes(x = preschool_density)) +\n  geom_histogram(fill = \"#74a9cf\", colour = \"white\", bins = 20) +\n  labs(\n    x = \"Preschool Density (count per sq km)\",\n    y = \"Number of Subzones\",\n    title = \"Distribution of Preschool Density across Subzones\"\n  ) +\n  theme_minimal()\np_hist\n\n\n\n\n\n\n\n\n\n\n\nCode\np_scatter &lt;- ggplot(subzone_summary, aes(x = preschool_count, y = preschool_density)) +\n  geom_point(alpha = 0.6, colour = \"#2b8cbe\") +\n  labs(\n    x = \"Preschool Count\",\n    y = \"Preschool Density (count per sq km)\",\n    title = \"Preschool Density vs. Count\"\n  ) +\n  theme_minimal()\np_scatter"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01a.html#results",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01a.html#results",
    "title": "Hands-on Exercise 01a: Geospatial Data Wrangling",
    "section": "Results",
    "text": "Results\n\nData Summary\n\n\nCode\nmessage(\"\\n\", strrep(\"=\", 60), \"\\n\")\n\n\n\n============================================================\n\n\nCode\nmessage(\"DATA PROCESSING SUMMARY\")\n\n\nDATA PROCESSING SUMMARY\n\n\nCode\nmessage(strrep(\"=\", 60), \"\\n\")\n\n\n============================================================\n\n\nCode\n# Subzone Summary\nmessage(\"1. SUBZONE DATA (clean_subzone.gpkg)\")\n\n\n1. SUBZONE DATA (clean_subzone.gpkg)\n\n\nCode\nmessage(\"   - Records: \", nrow(mpsz_clean))\n\n\n   - Records: 323\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(mpsz_clean)$epsg, \" (SVY21)\")\n\n\n   - CRS: EPSG:3414 (SVY21)\n\n\nCode\nmessage(\"   - Geometry types: \", paste(unique(sf::st_geometry_type(mpsz_clean)), collapse=\", \"))\n\n\n   - Geometry types: POLYGON, MULTIPOLYGON\n\n\nCode\nmessage(\"   - Fields: \", paste(names(sf::st_drop_geometry(mpsz_clean)), collapse=\", \"))\n\n\n   - Fields: subzone_n, pln_area_n\n\n\nCode\n# Cycling Path Summary\nmessage(\"\\n2. CYCLING PATH DATA (clean_cycling_path.gpkg)\")\n\n\n\n2. CYCLING PATH DATA (clean_cycling_path.gpkg)\n\n\nCode\nmessage(\"   - Records: \", nrow(cycling_clean))\n\n\n   - Records: 4674\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(cycling_clean)$epsg, \" (SVY21)\")\n\n\n   - CRS: EPSG:3414 (SVY21)\n\n\nCode\nmessage(\"   - Geometry types: \", paste(unique(sf::st_geometry_type(cycling_clean)), collapse=\", \"))\n\n\n   - Geometry types: MULTILINESTRING\n\n\nCode\nmessage(\"   - Fields: \", paste(names(sf::st_drop_geometry(cycling_clean)), collapse=\", \"))\n\n\n   - Fields: \n\n\nCode\n# Pre-Schools Summary\nmessage(\"\\n3. PRE-SCHOOLS DATA (clean_preschools_svy21.gpkg)\")\n\n\n\n3. PRE-SCHOOLS DATA (clean_preschools_svy21.gpkg)\n\n\nCode\nmessage(\"   - Records: \", nrow(preschools_clean))\n\n\n   - Records: 2290\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(preschools_clean)$epsg, \" (SVY21)\")\n\n\n   - CRS: EPSG:3414 (SVY21)\n\n\nCode\nmessage(\"   - Geometry types: \", paste(unique(sf::st_geometry_type(preschools_clean)), collapse=\", \"))\n\n\n   - Geometry types: POINT\n\n\nCode\nmessage(\"   - Fields: \", paste(names(sf::st_drop_geometry(preschools_clean)), collapse=\", \"))\n\n\n   - Fields: name\n\n\nCode\n# Listings Summary\nmessage(\"\\n4. LISTINGS DATA (listings.csv - read only)\")\n\n\n\n4. LISTINGS DATA (listings.csv - read only)\n\n\nCode\nmessage(\"   - Records: \", nrow(listings))\n\n\n   - Records: 3659\n\n\nCode\nmessage(\"   - Latitude range: [\", round(min(listings$latitude), 4), \", \",\n        round(max(listings$latitude), 4), \"]\")\n\n\n   - Latitude range: [1.2227, 1.4578]\n\n\nCode\nmessage(\"   - Longitude range: [\", round(min(listings$longitude), 4), \", \",\n        round(max(listings$longitude), 4), \"]\")\n\n\n   - Longitude range: [103.6346, 103.9896]\n\n\nCode\nmessage(\"\\n5. LISTINGS DATA (listings_sf - transformed)\")\n\n\n\n5. LISTINGS DATA (listings_sf - transformed)\n\n\nCode\nmessage(\"   - Records: \", nrow(listings_sf))\n\n\n   - Records: 3659\n\n\nCode\nmessage(\"   - CRS: EPSG:\", sf::st_crs(listings_sf)$epsg)\n\n\n   - CRS: EPSG:3414\n\n\nCode\nmessage(\"   - Geometry type: \", unique(sf::st_geometry_type(listings_sf)))\n\n\n   - Geometry type: POINT\n\n\nCode\nmessage(\"\\n\", strrep(\"=\", 60))\n\n\n\n============================================================\n\n\nCode\nmessage(\"✓ All data processing completed successfully!\")\n\n\n✓ All data processing completed successfully!\n\n\nCode\nmessage(strrep(\"=\", 60))\n\n\n============================================================\n\n\n\n\nSample Data Preview\n\n\nCode\n# Preview first 3 records without geometry\nmessage(\"\\nSample records from cleaned datasets:\")\n\nmessage(\"\\nSubzone (first 3 records):\")\nprint(head(sf::st_drop_geometry(mpsz_clean), 3))\n\n\n     subzone_n      pln_area_n\n1 MARINA SOUTH    MARINA SOUTH\n2 PEARL'S HILL          OUTRAM\n3    BOAT QUAY SINGAPORE RIVER\n\n\nCode\nmessage(\"\\nCycling Path (first 3 records):\")\nprint(head(sf::st_drop_geometry(cycling_clean), 3))\n\n\ndata frame with 0 columns and 3 rows\n\n\nCode\nmessage(\"\\nPre-Schools (first 3 records):\")\nprint(head(sf::st_drop_geometry(preschools_clean), 3))\n\n\n   name\n1 kml_1\n2 kml_2\n3 kml_3"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "",
    "text": "This exercise demonstrates choropleth mapping techniques using Singapore’s 2024 population data. We’ll create two thematic maps:\n\nAged population share (65+) by Planning Area using quantile classification\nDependency ratio by Planning Area using Jenks natural breaks classification"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#overview",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "",
    "text": "This exercise demonstrates choropleth mapping techniques using Singapore’s 2024 population data. We’ll create two thematic maps:\n\nAged population share (65+) by Planning Area using quantile classification\nDependency ratio by Planning Area using Jenks natural breaks classification"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#setup-and-environment",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#setup-and-environment",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Setup and Environment",
    "text": "Setup and Environment\n\n\nCode\n# 兜底：没装 pacman 就装\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\npacman::p_load(sf, dplyr, tidyr, readr, janitor, stringr, xml2, rvest,\n               tmap, here, units, purrr)\n\n# 需要 purrr，因为后面用到 map_chr / keep\npacman::p_load(sf, dplyr, tidyr, readr, janitor, stringr, xml2, rvest,\n               tmap, here, units, purrr)\ntmap_mode(\"plot\")\n\npath_ex01 &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex01\")\npath_geo  &lt;- file.path(path_ex01, \"data\", \"geospatial\")\npath_asp  &lt;- file.path(path_ex01, \"data\", \"aspatial\")\npath_fig  &lt;- file.path(path_ex01, \"figures\")\nif (!dir.exists(path_fig)) dir.create(path_fig, recursive = TRUE)\n\nmessage(\"Working directory: \", getwd())\nmessage(\"tmap version: \", as.character(packageVersion(\"tmap\")))\nmessage(\"Date: \", as.character(Sys.Date()))\ntmap_options(show.messages = FALSE)  # 关闭“组件被缩放”等提示"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-import",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-import",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Data Import",
    "text": "Data Import\n\nImport Geospatial Data (KML)\n\n\nCode\n# Import Master Plan 2019 Subzone Boundary (No Sea) from KML\nkml_file &lt;- file.path(path_geo, \"MasterPlan2019SubzoneBoundaryNoSeaKML.kml\")\n\nif (!file.exists(kml_file)) {\n  stop(\"KML file not found at: \", kml_file)\n}\n\n# Read KML file\nsubzone &lt;- st_read(kml_file, quiet = FALSE)\n\n\nReading layer `URA_MP19_SUBZONE_NO_SEA_PL' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex01\\data\\geospatial\\MasterPlan2019SubzoneBoundaryNoSeaKML.kml' \n  using driver `KML'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nCode\n# Check if GEOMETRYCOLLECTION and extract polygons if needed\nif (any(st_geometry_type(subzone) == \"GEOMETRYCOLLECTION\")) {\n  message(\"Extracting POLYGON from GEOMETRYCOLLECTION...\")\n  subzone &lt;- st_collection_extract(subzone, \"POLYGON\")\n}\n\n# Transform to SVY21 (EPSG:3414)\nsubzone &lt;- st_transform(subzone, crs = 3414)\n\nmessage(\"CRS after transformation: EPSG:\", st_crs(subzone)$epsg)\n\n\n\n\nParse KML Attributes\n\n\nCode\n# Function to extract field from HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  # Find the row with matching field name\n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# Check if PLN_AREA_N and SUBZONE_N exist\nif (!all(c(\"PLN_AREA_N\", \"SUBZONE_N\") %in% names(subzone))) {\n  message(\"Extracting planning area and subzone names from Description field...\")\n  \n  # Extract fields from HTML description\n  subzone &lt;- subzone %&gt;%\n    mutate(\n      pln_area_n = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n      subzone_n = map_chr(Description, extract_kml_field, \"SUBZONE_N\")\n    ) %&gt;%\n    select(-Name, -Description)\n} else {\n  # If fields exist, just rename to snake_case\n  subzone &lt;- subzone %&gt;%\n    clean_names()\n}\n\n# Display sample data\nmessage(\"Subzone data structure:\")\nmessage(\"- Records: \", nrow(subzone))\nmessage(\"- Planning areas: \", n_distinct(subzone$pln_area_n))\n\n\n\n\nAggregate to Planning Area Level\n\n\nCode\n# Aggregate subzones to planning area level\nplanning &lt;- subzone %&gt;%\n  group_by(pln_area_n) %&gt;%\n  summarise(\n    do_union = TRUE,\n    .groups = 'drop'\n  )\n\nmessage(\"Planning areas created: \", nrow(planning))\n\n# Verify CRS\nstopifnot(st_crs(planning) == st_crs(3414))\n\n\n\n\nImport Population Data\n\n\nCode\n# --- Import population CSV (robust rename) ---\npop_file &lt;- file.path(path_asp, \"respopagesextod2024.csv\")\nif (!file.exists(pop_file)) stop(\"Population CSV file not found at: \", pop_file)\n\npop_raw &lt;- read_csv(pop_file, show_col_types = FALSE)\nmessage(\"Raw columns: \", paste(names(pop_raw), collapse = \", \"))\n\n# 标准化列名为小写下划线\npopdata &lt;- pop_raw %&gt;% janitor::clean_names()\n\nnm &lt;- names(popdata)\nif (\"planning_area\"     %in% nm) popdata &lt;- dplyr::rename(popdata, pa  = planning_area)\nif (\"planning_area_name\"%in% nm) popdata &lt;- dplyr::rename(popdata, pa  = planning_area_name)\nif (\"age_group\"         %in% nm) popdata &lt;- dplyr::rename(popdata, ag  = age_group)\nif (\"type_of_dwelling\"  %in% nm) popdata &lt;- dplyr::rename(popdata, tod = type_of_dwelling)\nif (\"value\"             %in% nm) popdata &lt;- dplyr::rename(popdata, pop = value)\n\npopdata &lt;- popdata %&gt;%\n  mutate(\n    pa  = str_squish(pa),\n    ag  = str_replace_all(str_to_lower(ag), \"\\\\s+\", \"_\"),\n    tod = str_squish(tod),\n    sex = str_squish(sex)\n  )\n\n\n# 映射不同写法 -&gt; 统一到 pa / ag / sex / tod / pop\n# （左边=原始列名，右边=统一后的列名）\nalias_map &lt;- c(\n  \"planning_area\"    = \"pa\",\n  \"planning_area_name\" = \"pa\",\n  \"pa\"               = \"pa\",\n  \"age_group\"        = \"ag\",\n  \"ag\"               = \"ag\",\n  \"sex\"              = \"sex\",\n  \"type_of_dwelling\" = \"tod\",\n  \"tod\"              = \"tod\",\n  \"value\"            = \"pop\",\n  \"population\"       = \"pop\"\n)\n\n# 只对存在的列做重命名：rename(new = old)\nmap &lt;- alias_map[names(alias_map) %in% names(popdata)]\npopdata &lt;- dplyr::rename(popdata, !!!setNames(names(map), map))\n\n# 现在这5列应该都在：pa / ag / sex / tod / pop\nneed &lt;- c(\"pa\", \"ag\", \"sex\", \"tod\", \"pop\")\nmiss &lt;- setdiff(need, names(popdata))\nif (length(miss)) stop(\"These required columns are missing after rename: \", paste(miss, collapse = \", \"))\n\n# 文本清洗：去多余空格，小写化 age_group 并把空格变下划线\npopdata &lt;- popdata %&gt;%\n  dplyr::mutate(\n    pa = stringr::str_squish(pa),\n    ag = stringr::str_replace_all(stringr::str_to_lower(ag), \"\\\\s+\", \"_\"),\n    tod = stringr::str_squish(tod),\n    sex = stringr::str_squish(sex)\n  )\n\nmessage(\"Normalized columns: \", paste(names(popdata), collapse = \", \"))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-wrangling",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#data-wrangling",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Data Wrangling",
    "text": "Data Wrangling\n\nProcess Population Data\n\n\nCode\n# --- Process population BY SUBZONE (sum across Sex and TOD) ---\n\n# 前提：import-population 已 clean_names()，并把列名统一成 pa/sz/ag/sex/tod/pop/time\n# 如果你还没统一列名，请在 import-population 那块 clean_names() 后加：\n# nm &lt;- names(popdata)\n# if (\"planning_area\" %in% nm) popdata &lt;- dplyr::rename(popdata, pa = planning_area)\n# if (\"subzone\"       %in% nm) popdata &lt;- dplyr::rename(popdata, sz = subzone)\n# if (\"age_group\"     %in% nm) popdata &lt;- dplyr::rename(popdata, ag = age_group)\n# if (\"type_of_dwelling\" %in% nm) popdata &lt;- dplyr::rename(popdata, tod = type_of_dwelling)\n# if (\"value\"         %in% nm) popdata &lt;- dplyr::rename(popdata, pop = value)\n\n# 0) 只取 2024（如果有 time 列）\npop_w &lt;- popdata\nif (\"time\" %in% names(pop_w)) {\n  pop_w &lt;- pop_w %&gt;% dplyr::filter(time == max(time, na.rm = TRUE))\n}\n\n# 1) 不再按 Sex/TOD 过滤，直接“对子区+年龄段”把人头加总（= Total）\npop_sz &lt;- pop_w %&gt;%\n  dplyr::group_by(sz, ag) %&gt;%\n  dplyr::summarise(pop = sum(pop, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  # 标准化子区名，提取起始年龄\n  dplyr::mutate(\n    sz_clean  = stringr::str_squish(stringr::str_to_upper(sz)),\n    ag_start  = readr::parse_integer(stringr::str_extract(ag, \"^[0-9]+\")),\n    age_category = dplyr::case_when(\n      !is.na(ag_start) & ag_start &lt;= 19 ~ \"young\",\n      !is.na(ag_start) & ag_start &lt;= 64 ~ \"econ\",\n      TRUE                              ~ \"aged\"\n    )\n  ) %&gt;%\n  dplyr::count(sz_clean, age_category, wt = pop, name = \"population\") %&gt;%\n  tidyr::complete(sz_clean, age_category, fill = list(population = 0)) %&gt;%\n  tidyr::pivot_wider(names_from = age_category, values_from = population, values_fill = 0)\n\n# 2) 指标（安全版）\nfor (col in c(\"young\",\"econ\",\"aged\")) if (!col %in% names(pop_sz)) pop_sz[[col]] &lt;- 0\npop_sz &lt;- pop_sz %&gt;%\n  dplyr::mutate(\n    total       = young + econ + aged,\n    aged_share  = dplyr::if_else(total &gt; 0, 100 * aged / total, 0),\n    dependency  = dplyr::if_else(econ  &gt; 0, 100 * (young + aged) / econ, NA_real_)\n  )\n\nmessage(\"Subzone-level population rows: \", nrow(pop_sz))\n\n\n\n\nJoin Spatial and Population Data\n\n\nCode\n# --- Build SZ -&gt; PA bridge from KML, then aggregate to PA ---\n\n# 注意：你的子区几何对象在前文叫 subzone（若叫 mpsz，请把下行的 subzone 改成 mpsz）\nbridge &lt;- subzone %&gt;%\n  sf::st_drop_geometry() %&gt;%\n  dplyr::transmute(\n    sz_clean       = stringr::str_squish(stringr::str_to_upper(subzone_n)),\n    pln_area_clean = stringr::str_squish(stringr::str_to_upper(pln_area_n))\n  ) %&gt;%\n  dplyr::distinct()\n\n# 子区人口接上映射 → 聚合到规划区\npop_pa &lt;- pop_sz %&gt;%\n  dplyr::left_join(bridge, by = \"sz_clean\") %&gt;%\n  dplyr::filter(!is.na(pln_area_clean)) %&gt;%\n  dplyr::group_by(pln_area_clean) %&gt;%\n  dplyr::summarise(\n    young = sum(young, na.rm = TRUE),\n    econ  = sum(econ,  na.rm = TRUE),\n    aged  = sum(aged,  na.rm = TRUE),\n    .groups = \"drop\"\n  ) %&gt;%\n  dplyr::mutate(\n    total       = young + econ + aged,\n    aged_share  = dplyr::if_else(total &gt; 0, 100 * aged / total, 0),\n    dependency  = dplyr::if_else(econ  &gt; 0, 100 * (young + aged) / econ, NA_real_)\n  )\n\nmessage(\"Aggregated to planning areas: \", nrow(pop_pa), \" (expected ≈55)\")\n\n# 用 inner_join 接回规划区几何（保证有值的区才保留）\nplanning &lt;- planning %&gt;% dplyr::mutate(\n  pln_area_clean = stringr::str_squish(stringr::str_to_upper(pln_area_n))\n)\nplanning_pop &lt;- planning %&gt;%\n  dplyr::inner_join(pop_pa, by = \"pln_area_clean\")\n\n# 必须 &gt;0（否则仍是 NA）\nstopifnot(sum(!is.na(planning_pop$aged_share)) &gt; 0)\nstopifnot(sum(!is.na(planning_pop$dependency)) &gt; 0)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#create-choropleth-maps",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#create-choropleth-maps",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Create Choropleth Maps",
    "text": "Create Choropleth Maps\n\nMap A: Aged Population Share (65+)\n\n\nCode\ntmap_options(show.messages = FALSE)\n\n# Map A —— Aged 65+ share（过滤 NA，避免 Missing）\nplanning_aged &lt;- planning_pop[!is.na(planning_pop$aged_share) & !sf::st_is_empty(planning_pop), ]\n\nmap_aged &lt;- tm_shape(planning_aged) +\n  tm_polygons(col = \"aged_share\", style = \"quantile\", n = 5, palette = \"Reds\",\n              title = \"Aged Share (%)\") +\n  tm_layout(legend.outside = TRUE) +\n  tm_compass(type = \"8star\", size = 1.8, position = c(\"left\",\"top\")) +\n  tm_scale_bar(position = c(\"left\",\"bottom\")) +\n  tm_credits(\"Data: URA MP19 (No Sea), SingStat 2024\\nCRS: SVY21 / EPSG:3414\",\n             position = c(\"right\",\"bottom\"), size = 0.6)\n\nmap_aged\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(map_aged, file.path(path_fig, \"ex01b_aged_share_quantile.png\"),\n          width = 1600, height = 1200, dpi = 300, units = \"px\")\n\n\n\n\nMap B: Dependency Ratio\n\n\nCode\n# Map B —— Dependency ratio（过滤 NA）\nplanning_dep &lt;- planning_pop[!is.na(planning_pop$dependency) & !sf::st_is_empty(planning_pop), ]\n\nmap_dependency &lt;- tm_shape(planning_dep) +\n  tm_polygons(col = \"dependency\", style = \"jenks\", n = 5, palette = \"PuBuGn\",\n              title = \"Dependency Ratio (%)\") +\n  tm_layout(legend.outside = TRUE) +\n  tm_compass(type = \"8star\", size = 1.8, position = c(\"left\",\"top\")) +\n  tm_scale_bar(position = c(\"left\",\"bottom\")) +\n  tm_credits(\"Data: URA MP19 (No Sea), SingStat 2024\\nCRS: SVY21 / EPSG:3414\",\n             position = c(\"right\",\"bottom\"), size = 0.6)\n\nmap_dependency\n\n\n\n\n\n\n\n\n\nCode\ntmap_save(map_dependency, file.path(path_fig, \"ex01b_dependency_jenks.png\"),\n          width = 1600, height = 1200, dpi = 300, units = \"px\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#results",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#results",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Results",
    "text": "Results\nThe two choropleth maps have been successfully created and saved to the figures folder:\n\nMap A: Share of Aged Population (65+)\n\n\n\nAged Population Share\n\n\nThis map uses quantile classification with 5 classes to show the distribution of aged population (65 years and above) as a percentage of total population across Singapore’s planning areas. The red color ramp helps identify areas with higher concentrations of elderly residents.\n\n\nMap B: Dependency Ratio\n\n\n\nDependency Ratio\n\n\nThis map uses Jenks natural breaks classification with 5 classes to visualize the dependency ratio across planning areas. The dependency ratio represents the proportion of economically dependent population (young and aged) to the economically active population. The PuBuGn color scheme provides clear visual distinction between areas with different dependency levels."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex01/ex01b.html#summary-statistics",
    "href": "Hands-on_Ex/Hands-on_ex01/ex01b.html#summary-statistics",
    "title": "Hands-on Exercise 01b: Choropleth Mapping (Population 2024)",
    "section": "Summary Statistics",
    "text": "Summary Statistics\n\n\nCode\n# Display summary statistics\ncat(\"\\n=== Summary Statistics ===\\n\")\n\n\n\n=== Summary Statistics ===\n\n\nCode\ncat(\"\\nAged Population Share (%):\\n\")\n\n\n\nAged Population Share (%):\n\n\nCode\nsummary(planning_pop$aged_share)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   1.639  14.964  12.790  21.026  28.801 \n\n\nCode\ncat(\"\\nDependency Ratio (%):\\n\")\n\n\n\nDependency Ratio (%):\n\n\nCode\nsummary(planning_pop$dependency)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  27.30   51.08   58.48   56.26   64.18   72.89      13 \n\n\nCode\n# Top 5 areas with highest aged share\ncat(\"\\nTop 5 Planning Areas - Highest Aged Share:\\n\")\n\n\n\nTop 5 Planning Areas - Highest Aged Share:\n\n\nCode\nplanning_pop %&gt;%\n  st_drop_geometry() %&gt;%\n  select(pln_area_n, aged_share) %&gt;%\n  arrange(desc(aged_share)) %&gt;%\n  head(5) %&gt;%\n  print()\n\n\n# A tibble: 5 × 2\n  pln_area_n   aged_share\n  &lt;chr&gt;             &lt;dbl&gt;\n1 OUTRAM             28.8\n2 ANG MO KIO         25.4\n3 ROCHOR             24.8\n4 SUNGEI KADUT       24.6\n5 BUKIT MERAH        24.5\n\n\nCode\n# Top 5 areas with highest dependency ratio\ncat(\"\\nTop 5 Planning Areas - Highest Dependency Ratio:\\n\")\n\n\n\nTop 5 Planning Areas - Highest Dependency Ratio:\n\n\nCode\nplanning_pop %&gt;%\n  st_drop_geometry() %&gt;%\n  select(pln_area_n, dependency) %&gt;%\n  arrange(desc(dependency)) %&gt;%\n  head(5) %&gt;%\n  print()\n\n\n# A tibble: 5 × 2\n  pln_area_n  dependency\n  &lt;chr&gt;            &lt;dbl&gt;\n1 OUTRAM            72.9\n2 CHANGI            71.4\n3 BUKIT TIMAH       70.6\n4 ANG MO KIO        67.9\n5 BUKIT MERAH       67.4\n\n\n\nEnd of Hands-on Exercise 01b"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "",
    "text": "Second-order spatial point pattern analysis examines the spatial relationships between points in a pattern, specifically focusing on how the presence of one point influences the location of others. Using appropriate functions of spatstat package, this hands-on exercise aims to discover the spatial point processes of childcare centres in Singapore.\nThe specific questions we would like to answer are: - Are the childcare centres in Singapore randomly distributed throughout the country? - If the answer is not, then where are the locations with higher concentration of childcare centres?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#overview",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "",
    "text": "Second-order spatial point pattern analysis examines the spatial relationships between points in a pattern, specifically focusing on how the presence of one point influences the location of others. Using appropriate functions of spatstat package, this hands-on exercise aims to discover the spatial point processes of childcare centres in Singapore.\nThe specific questions we would like to answer are: - Are the childcare centres in Singapore randomly distributed throughout the country? - If the answer is not, then where are the locations with higher concentration of childcare centres?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#setup-and-loading-r-packages",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#setup-and-loading-r-packages",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Setup and Loading R Packages",
    "text": "Setup and Loading R Packages\n\n\nCode\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\npacman::p_load(sf, tidyverse, tmap, spatstat, rvest, \n               here, janitor, stringr, units)\n\n# Set tmap to plot mode\ntmap_mode(\"plot\")\n\n# Set up directory paths\nroot_dir &lt;- here::here()\nexo_data &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"data\")\nexo_fig &lt;- here::here(\"Hands-on_Ex\", \"Hands-on_ex02\", \"figures\")\n\nif (!dir.exists(exo_fig)) dir.create(exo_fig, recursive = TRUE, showWarnings = FALSE)\n\nmessage(\"Data directory: \", exo_data)\nmessage(\"Figures directory: \", exo_fig)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#data-import-and-preparation",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#data-import-and-preparation",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Data Import and Preparation",
    "text": "Data Import and Preparation\n\nImport Master Plan Subzones\n\n\nCode\n# Function to extract KML fields from HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    map_chr(~ html_text2(html_element(.x, \"td\")))\n  \n  if (length(value) == 0) NA_character_ else value[1]\n}\n\n# Load Master Plan 2019 subzones\nmessage(\"Loading Master Plan 2019 subzones...\")\nsubzone_path &lt;- file.path(exo_data, \"MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\")\n\nmpsz &lt;- st_read(subzone_path, quiet = TRUE)\n\n# Transform to SVY21 if needed\nif (st_crs(mpsz)$epsg != 3414) {\n  mpsz &lt;- st_transform(mpsz, 3414)\n}\n\n# Extract fields from HTML Description\nmpsz &lt;- mpsz %&gt;%\n  mutate(\n    SUBZONE_N = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    PLN_AREA_N = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n    SUBZONE_C = map_chr(Description, extract_kml_field, \"SUBZONE_C\"),\n    REGION_N = map_chr(Description, extract_kml_field, \"REGION_N\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\n# Make geometries valid\nmpsz &lt;- st_make_valid(mpsz)\n\nmessage(\"Master Plan subzones loaded: \", nrow(mpsz), \" records\")\n\n\n\n\nImport Childcare Services\n\n\nCode\nmessage(\"Loading childcare services...\")\nchildcare_path &lt;- file.path(exo_data, \"ChildCareServices.geojson\")\n\nchildcare_sf &lt;- st_read(childcare_path, quiet = TRUE) %&gt;%\n  janitor::clean_names()\n\n# Transform to SVY21 if needed\nif (st_crs(childcare_sf)$epsg != 3414) {\n  childcare_sf &lt;- st_transform(childcare_sf, 3414)\n}\n\n# Remove Z dimension if present\nchildcare_sf &lt;- st_zm(childcare_sf, drop = TRUE, what = \"ZM\")\n\nmessage(\"Childcare services loaded: \", nrow(childcare_sf), \" records\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#geospatial-data-wrangling-for-spatstat",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#geospatial-data-wrangling-for-spatstat",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Geospatial Data Wrangling for spatstat",
    "text": "Geospatial Data Wrangling for spatstat\n\nConverting to spatstat format\n\n\nCode\n# Convert childcare points to ppp format\nchildcare_ppp &lt;- as.ppp(childcare_sf)\nclass(childcare_ppp)\n\n\n[1] \"ppp\"\n\n\nCode\n# Check summary\nsummary(childcare_ppp)\n\n\nMarked planar point pattern:  1925 points\nAverage intensity 2.417323e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nMark variables: name, description\nSummary:\n     name           description       \n Length:1925        Length:1925       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n\nWindow: rectangle = [11810.03, 45404.24] x [25596.33, 49300.88] units\n                    (33590 x 23700 units)\nWindow area = 796335000 square units\n\n\nCode\n# Create Singapore boundary owin object\nsg_owin &lt;- as.owin(mpsz)\nclass(sg_owin)\n\n\n[1] \"owin\"\n\n\nCode\n# Plot the owin object\nplot(sg_owin)\n\n\n\n\n\n\n\n\n\nCode\n# Combine points and window\nchildcareSG_ppp = childcare_ppp[sg_owin]\nsummary(childcareSG_ppp)\n\n\nMarked planar point pattern:  1925 points\nAverage intensity 2.452904e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nMark variables: name, description\nSummary:\n     name           description       \n Length:1925        Length:1925       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n\nWindow: polygonal boundary\n88 separate polygons (43 holes)\n                  vertices         area relative.area\npolygon 1              285  1.61128e+06      2.05e-03\npolygon 2              719  5.40368e+07      6.89e-02\npolygon 3               44  2.26577e+03      2.89e-06\npolygon 4               27  1.50315e+04      1.92e-05\npolygon 5              706  1.28815e+07      1.64e-02\npolygon 6 (hole)        41 -4.01660e+04     -5.12e-05\npolygon 7 (hole)       317 -5.11280e+04     -6.51e-05\npolygon 8 (hole)         3 -3.42709e-01     -4.37e-10\npolygon 9               77  3.29939e+05      4.20e-04\npolygon 10 (hole)        3 -4.14100e-04     -5.28e-13\npolygon 11              30  2.80002e+04      3.57e-05\npolygon 12 (hole)        4 -2.86396e-01     -3.65e-10\npolygon 13 (hole)        3 -1.81439e-04     -2.31e-13\npolygon 14 (hole)        3 -5.99531e-04     -7.64e-13\npolygon 15 (hole)        3 -3.04560e-04     -3.88e-13\npolygon 16 (hole)        3 -4.46108e-04     -5.68e-13\npolygon 17 (hole)        5 -2.44408e-04     -3.11e-13\npolygon 18 (hole)        5 -3.64686e-02     -4.65e-11\npolygon 19              71  8.18750e+03      1.04e-05\npolygon 20 (hole)       38 -7.79904e+03     -9.94e-06\npolygon 21 (hole)        3 -3.41897e-05     -4.36e-14\npolygon 22 (hole)        3 -3.65499e-03     -4.66e-12\npolygon 23 (hole)        3 -4.95057e-02     -6.31e-11\npolygon 24              91  1.49663e+04      1.91e-05\npolygon 25 (hole)        3 -3.79135e-02     -4.83e-11\npolygon 26 (hole)      270 -1.21455e+03     -1.55e-06\npolygon 27 (hole)       19 -4.39650e+00     -5.60e-09\npolygon 28 (hole)       35 -1.38385e+02     -1.76e-07\npolygon 29 (hole)       23 -1.99656e+01     -2.54e-08\npolygon 30              40  1.38607e+04      1.77e-05\npolygon 31 (hole)       41 -6.00381e+03     -7.65e-06\npolygon 32 (hole)        7 -1.40546e-01     -1.79e-10\npolygon 33 (hole)       11 -8.36705e+01     -1.07e-07\npolygon 34 (hole)        3 -2.33435e-03     -2.97e-12\npolygon 35              45  2.51218e+03      3.20e-06\npolygon 36             139  3.22293e+03      4.11e-06\npolygon 37             148  3.10395e+03      3.96e-06\npolygon 38 (hole)        4 -1.72650e-04     -2.20e-13\npolygon 39              75  1.73526e+04      2.21e-05\npolygon 40              83  5.28920e+03      6.74e-06\npolygon 41             211  4.70521e+05      6.00e-04\npolygon 42             106  3.04104e+03      3.88e-06\npolygon 43             264  1.50631e+06      1.92e-03\npolygon 44              71  5.63061e+03      7.17e-06\npolygon 45              10  1.99717e+02      2.54e-07\npolygon 46 (hole)        3 -1.37223e-02     -1.75e-11\npolygon 47             487  2.06117e+06      2.63e-03\npolygon 48             155  2.67502e+05      3.41e-04\npolygon 49            1020  1.27781e+06      1.63e-03\npolygon 50 (hole)       12 -5.81913e-01     -7.41e-10\npolygon 51 (hole)        4 -6.55702e-01     -8.36e-10\npolygon 52 (hole)        4 -3.13199e-05     -3.99e-14\npolygon 53 (hole)        3 -3.15099e-05     -4.02e-14\npolygon 54              65  8.42861e+04      1.07e-04\npolygon 55 (hole)        3 -1.20875e-01     -1.54e-10\npolygon 56              47  3.82087e+04      4.87e-05\npolygon 57               6  4.50259e+02      5.74e-07\npolygon 58             129  9.53761e+04      1.22e-04\npolygon 59 (hole)        3 -3.23305e-04     -4.12e-13\npolygon 60               4  2.69313e+02      3.43e-07\npolygon 61            1045  4.44510e+06      5.66e-03\npolygon 62              22  6.74651e+03      8.60e-06\npolygon 63              59  3.43150e+04      4.37e-05\npolygon 64              14  5.86546e+03      7.47e-06\npolygon 65              94  5.96187e+04      7.60e-05\npolygon 66             234  2.08755e+06      2.66e-03\npolygon 67              10  4.90942e+02      6.26e-07\npolygon 68             232  4.72886e+05      6.03e-04\npolygon 69 (hole)       13 -3.91907e+02     -4.99e-07\npolygon 70              15  4.03300e+04      5.14e-05\npolygon 71             227  1.10308e+06      1.41e-03\npolygon 72              10  6.60195e+03      8.41e-06\npolygon 73              19  3.09221e+04      3.94e-05\npolygon 74             145  9.61782e+05      1.23e-03\npolygon 75              30  4.28933e+03      5.47e-06\npolygon 76              37  1.29481e+04      1.65e-05\npolygon 77               4  9.47108e+01      1.21e-07\npolygon 78 (hole)        3 -8.68789e-04     -1.11e-12\npolygon 79 (hole)        3 -3.39815e-04     -4.33e-13\npolygon 80 (hole)        3 -4.52041e-05     -5.76e-14\npolygon 81 (hole)        3 -3.90173e-05     -4.97e-14\npolygon 82 (hole)        3 -9.59845e-05     -1.22e-13\npolygon 83 (hole)        8 -4.28707e-01     -5.46e-10\npolygon 84 (hole)        4 -2.18619e-04     -2.79e-13\npolygon 85 (hole)        6 -8.37554e-01     -1.07e-09\npolygon 86 (hole)        5 -2.92235e-04     -3.72e-13\npolygon 87           15307  7.00834e+08      8.93e-01\npolygon 88 (hole)        3 -7.43616e-06     -9.48e-15\nenclosing rectangle: [2667.54, 56396.44] x [15748.72, 50256.33] units\n                     (53730 x 34510 units)\nWindow area = 784784000 square units\nFraction of frame area: 0.423\n\n\nCode\n# Plot the combined object\nplot(childcareSG_ppp)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#extract-study-areas",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#extract-study-areas",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Extract Study Areas",
    "text": "Extract Study Areas\nFor this analysis, we’ll focus on four planning areas: Choa Chu Kang, Tampines, Punggol, and Jurong West.\n\n\nCode\n# Extract the four planning areas\npg &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"PUNGGOL\")\ntm &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"TAMPINES\")\nck &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"CHOA CHU KANG\")\njw &lt;- mpsz %&gt;% \n  filter(PLN_AREA_N == \"JURONG WEST\")\n\n# Plot the four areas\npar(mfrow=c(2,2))\nplot(st_geometry(pg), main = \"Punggol\")\nplot(st_geometry(tm), main = \"Tampines\")\nplot(st_geometry(ck), main = \"Choa Chu Kang\")\nplot(st_geometry(jw), main = \"Jurong West\")\n\n\n\n\n\n\n\n\n\n\nCreate owin objects for each area\n\n\nCode\npg_owin &lt;- as.owin(pg)\ntm_owin &lt;- as.owin(tm)\nck_owin &lt;- as.owin(ck)\njw_owin &lt;- as.owin(jw)\n\n\n\n\nExtract childcare points for each area\n\n\nCode\nchildcare_pg_ppp &lt;- childcare_ppp[pg_owin]\nchildcare_tm_ppp &lt;- childcare_ppp[tm_owin]\nchildcare_ck_ppp &lt;- childcare_ppp[ck_owin]\nchildcare_jw_ppp &lt;- childcare_ppp[jw_owin]\n\n# Rescale to kilometer\nchildcare_pg_ppp.km &lt;- rescale.ppp(childcare_pg_ppp, 1000, \"km\")\nchildcare_tm_ppp.km &lt;- rescale.ppp(childcare_tm_ppp, 1000, \"km\")\nchildcare_ck_ppp.km &lt;- rescale.ppp(childcare_ck_ppp, 1000, \"km\")\nchildcare_jw_ppp.km &lt;- rescale.ppp(childcare_jw_ppp, 1000, \"km\")\n\n# Plot the study areas\npar(mfrow=c(2,2))\nplot(childcare_pg_ppp.km, main=\"Punggol\")\nplot(childcare_tm_ppp.km, main=\"Tampines\")\nplot(childcare_ck_ppp.km, main=\"Choa Chu Kang\")\nplot(childcare_jw_ppp.km, main=\"Jurong West\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#second-order-spatial-point-patterns-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#second-order-spatial-point-patterns-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Second-order Spatial Point Patterns Analysis",
    "text": "Second-order Spatial Point Patterns Analysis"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#g-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#g-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "G-Function Analysis",
    "text": "G-Function Analysis\nThe G function measures the distribution of distances from an arbitrary event to its nearest event.\n\nChoa Chu Kang - G Function\n\n\nCode\n# Computing G-function estimation\nG_ck &lt;- Gest(childcare_ck_ppp.km, correction = \"border\")\nplot(G_ck, main = \"G-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nG_ck.csr &lt;- envelope(childcare_ck_ppp.km, Gest, \n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(G_ck.csr, main = \"G-function CSR Test: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - G Function\n\n\nCode\n# Computing G-function estimation\nG_tm &lt;- Gest(childcare_tm_ppp.km, correction = \"best\")\nplot(G_tm, main = \"G-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nG_tm.csr &lt;- envelope(childcare_tm_ppp.km, Gest,\n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(G_tm.csr, main = \"G-function CSR Test: Tampines\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#f-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#f-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "F-Function Analysis",
    "text": "F-Function Analysis\nThe F function estimates the empty space function or its hazard rate from a point pattern.\n\nChoa Chu Kang - F Function\n\n\nCode\n# Computing F-function estimation\nF_ck &lt;- Fest(childcare_ck_ppp.km, correction = \"best\")\nplot(F_ck, main = \"F-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nF_ck.csr &lt;- envelope(childcare_ck_ppp.km, Fest,\n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(F_ck.csr, main = \"F-function CSR Test: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - F Function\n\n\nCode\n# Computing F-function estimation\nF_tm &lt;- Fest(childcare_tm_ppp.km, correction = \"best\")\nplot(F_tm, main = \"F-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nF_tm.csr &lt;- envelope(childcare_tm_ppp.km, Fest,\n                     nsim = 999,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\nCode\nplot(F_tm.csr, main = \"F-function CSR Test: Tampines\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#k-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#k-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "K-Function Analysis",
    "text": "K-Function Analysis\nK-function measures the number of events found up to a given distance of any particular event.\n\nChoa Chu Kang - K Function\n\n\nCode\n# Computing K-function estimate\nK_ck &lt;- Kest(childcare_ck_ppp.km, correction = \"border\")\nplot(K_ck, main = \"K-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nK_ck.csr &lt;- envelope(childcare_ck_ppp.km, Kest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(K_ck.csr, main = \"K-function CSR Test: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - K Function\n\n\nCode\n# Computing K-function estimate\nK_tm &lt;- Kest(childcare_tm_ppp.km, correction = \"border\")\nplot(K_tm, main = \"K-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nK_tm.csr &lt;- envelope(childcare_tm_ppp.km, Kest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(K_tm.csr, main = \"K-function CSR Test: Tampines\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#l-function-analysis",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#l-function-analysis",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "L-Function Analysis",
    "text": "L-Function Analysis\nL-function is the normalized version of K-function.\n\nChoa Chu Kang - L Function\n\n\nCode\n# Computing L-function estimate\nL_ck &lt;- Lest(childcare_ck_ppp.km, correction = \"border\")\nplot(L_ck, main = \"L-function: Choa Chu Kang\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Choa Chu Kang\n\n\nCode\n# Perform CSR test with envelope\nL_ck.csr &lt;- envelope(childcare_ck_ppp.km, Lest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(L_ck.csr, . - r ~ r, \n     main = \"L-function CSR Test: Choa Chu Kang\",\n     ylab = \"L(r) - r\")\n\n\n\n\n\n\n\n\n\n\n\n\nTampines - L Function\n\n\nCode\n# Computing L-function estimate\nL_tm &lt;- Lest(childcare_tm_ppp.km, correction = \"border\")\nplot(L_tm, main = \"L-function: Tampines\")\n\n\n\n\n\n\n\n\n\n\nComplete Spatial Randomness Test for Tampines\n\n\nCode\n# Perform CSR test with envelope\nL_tm.csr &lt;- envelope(childcare_tm_ppp.km, Lest,\n                     nsim = 99,\n                     rank = 1,\n                     ginterval = c(0, 500))\n\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\nCode\nplot(L_tm.csr, . - r ~ r,\n     main = \"L-function CSR Test: Tampines\",\n     ylab = \"L(r) - r\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex02/ex02b.html#summary-and-interpretation",
    "href": "Hands-on_Ex/Hands-on_ex02/ex02b.html#summary-and-interpretation",
    "title": "Hands-on Exercise 02b: 2nd Order Spatial Point Patterns Analysis",
    "section": "Summary and Interpretation",
    "text": "Summary and Interpretation\n\nKey Findings\nBased on the second-order spatial point pattern analyses:\n\nG-Function Results:\n\nBoth Choa Chu Kang and Tampines show clustering patterns\nThe observed G-function lies above the theoretical CSR envelope\nThis indicates that childcare centres are closer to each other than expected under random distribution\n\nF-Function Results:\n\nThe empty space function shows shorter distances to the nearest childcare centre than expected\nThis further confirms the clustering pattern\n\nK-Function Results:\n\nAt various distance scales, there are more neighbours than expected under CSR\nThe clustering is significant across multiple spatial scales\n\nL-Function Results:\n\nThe normalized L-function confirms clustering patterns\nThe deviation from the theoretical line (L(r) - r = 0) indicates non-random distribution\n\n\n\n\nConclusions\nThe childcare centres in both Choa Chu Kang and Tampines planning areas are NOT randomly distributed. Instead, they exhibit significant clustering patterns. This clustering likely reflects:\n\nConcentration in residential areas\nProximity to HDB estates\nStrategic placement near transport nodes\nMarket-driven location decisions\n\nThe null hypothesis of Complete Spatial Randomness is rejected for both areas at the 0.001 significance level."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "",
    "text": "In this hands-on exercise, you will learn how to compute spatial weights using R. By the end of this exercise, you will be able to:\n\nImport geospatial data using appropriate function(s) of sf package\nImport csv file using appropriate function of readr package\nPerform relational join using appropriate join function of dplyr package\nCompute spatial weights using appropriate functions of spdep package\nCalculate spatially lagged variables using appropriate functions of spdep package"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#loading-r-packages",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#loading-r-packages",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "3.1 Loading R Packages",
    "text": "3.1 Loading R Packages\nBefore we get started, we need to ensure that spdep, sf, tmap and tidyverse packages are installed and loaded.\n\npacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-shapefile-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-shapefile-into-r-environment",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "4.1 Import shapefile into R environment",
    "text": "4.1 Import shapefile into R environment\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be a simple features object of sf.\n\n\nShow code\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\n\nReading layer `Hunan' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex04\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-csv-file-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#import-csv-file-into-r-environment",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "4.2 Import csv file into R environment",
    "text": "4.2 Import csv file into R environment\nNext, we will import Hunan_2012.csv into R using read_csv() of readr package. The output is an R dataframe class.\n\n\nShow code\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\", show_col_types = FALSE)\n\n# Check the data\nglimpse(hunan2012)\n\n\nRows: 88\nColumns: 29\n$ County      &lt;chr&gt; \"Anhua\", \"Anren\", \"Anxiang\", \"Baojing\", \"Chaling\", \"Changn…\n$ City        &lt;chr&gt; \"Yiyang\", \"Chenzhou\", \"Changde\", \"Hunan West\", \"Zhuzhou\", …\n$ avg_wage    &lt;dbl&gt; 30544, 28058, 31935, 30843, 31251, 28518, 54540, 28597, 33…\n$ deposite    &lt;dbl&gt; 10967.0, 4598.9, 5517.2, 2250.0, 8241.4, 10860.0, 24332.0,…\n$ FAI         &lt;dbl&gt; 6831.7, 6386.1, 3541.0, 1005.4, 6508.4, 7920.0, 33624.0, 1…\n$ Gov_Rev     &lt;dbl&gt; 456.72, 220.57, 243.64, 192.59, 620.19, 769.86, 5350.00, 1…\n$ Gov_Exp     &lt;dbl&gt; 2703.0, 1454.7, 1779.5, 1379.1, 1947.0, 2631.6, 7885.5, 11…\n$ GDP         &lt;dbl&gt; 13225.0, 4941.2, 12482.0, 4087.9, 11585.0, 19886.0, 88009.…\n$ GDPPC       &lt;dbl&gt; 14567, 12761, 23667, 14563, 20078, 24418, 88656, 10132, 17…\n$ GIO         &lt;dbl&gt; 9276.90, 4189.20, 5108.90, 3623.50, 9157.70, 37392.00, 513…\n$ Loan        &lt;dbl&gt; 3954.90, 2555.30, 2806.90, 1253.70, 4287.40, 4242.80, 4053…\n$ NIPCR       &lt;dbl&gt; 3528.3, 3271.8, 7693.7, 4191.3, 3887.7, 9528.0, 17070.0, 3…\n$ Bed         &lt;dbl&gt; 2718, 970, 1931, 927, 1449, 3605, 3310, 582, 2170, 2179, 1…\n$ Emp         &lt;dbl&gt; 494.310, 290.820, 336.390, 195.170, 330.290, 548.610, 670.…\n$ EmpR        &lt;dbl&gt; 441.4, 255.4, 270.5, 145.6, 299.0, 415.1, 452.0, 127.6, 21…\n$ EmpRT       &lt;dbl&gt; 338.0, 99.4, 205.9, 116.4, 154.0, 273.7, 219.4, 94.4, 174.…\n$ Pri_Stu     &lt;dbl&gt; 54.175, 33.171, 19.584, 19.249, 33.906, 81.831, 59.151, 18…\n$ Sec_Stu     &lt;dbl&gt; 32.830, 17.505, 17.819, 11.831, 20.548, 44.485, 39.685, 7.…\n$ Household   &lt;dbl&gt; 290.4, 104.6, 148.1, 73.2, 148.7, 211.2, 300.3, 76.1, 139.…\n$ Household_R &lt;dbl&gt; 234.5, 121.9, 135.4, 69.9, 139.4, 211.7, 248.4, 59.6, 110.…\n$ NOIP        &lt;dbl&gt; 101, 34, 53, 18, 106, 115, 214, 17, 55, 70, 44, 84, 74, 17…\n$ Pop_R       &lt;dbl&gt; 670.3, 243.2, 346.0, 184.1, 301.6, 448.2, 475.1, 189.6, 31…\n$ RSCG        &lt;dbl&gt; 5760.60, 2386.40, 3957.90, 768.04, 4009.50, 5220.40, 22604…\n$ Pop_T       &lt;dbl&gt; 910.8, 388.7, 528.3, 281.3, 578.4, 816.3, 998.6, 256.7, 45…\n$ Agri        &lt;dbl&gt; 4942.253, 2357.764, 4524.410, 1118.561, 3793.550, 6430.782…\n$ Service     &lt;dbl&gt; 5414.5, 3814.1, 14100.0, 541.8, 5444.0, 13074.6, 17726.6, …\n$ Disp_Inc    &lt;dbl&gt; 12373, 16072, 16610, 13455, 20461, 20868, 183252, 12379, 1…\n$ RORP        &lt;dbl&gt; 0.7359464, 0.6256753, 0.6549309, 0.6544614, 0.5214385, 0.5…\n$ ROREmp      &lt;dbl&gt; 0.8929619, 0.8782065, 0.8041262, 0.7460163, 0.9052651, 0.7…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#performing-relational-join",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#performing-relational-join",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "4.3 Performing relational join",
    "text": "4.3 Performing relational join\nThe code chunk below will be used to update the attribute table of hunan’s SpatialPolygonsDataFrame with the attribute fields of hunan2012 dataframe. This is performed using left_join() of dplyr package.\n\n\nShow code\nhunan &lt;- left_join(hunan, hunan2012, by = c(\"County\" = \"County\"))\n\n# Check the result\nglimpse(hunan)\n\n\nRows: 88\nColumns: 36\n$ NAME_2      &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ ID_3        &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 21…\n$ NAME_3      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ ENGTYPE_3   &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"Co…\n$ Shape_Leng  &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.171918…\n$ Shape_Area  &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.11450357…\n$ County      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ City        &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ avg_wage    &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 45…\n$ deposite    &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, 1…\n$ FAI         &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0,…\n$ Gov_Rev     &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, 2…\n$ Gov_Exp     &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 48…\n$ GDP         &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 81113…\n$ GDPPC       &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 70…\n$ GIO         &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254.…\n$ Loan        &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 23408…\n$ NIPCR       &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, 1…\n$ Bed         &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970, …\n$ Emp         &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 85…\n$ EmpR        &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 268…\n$ EmpRT       &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 131…\n$ Pri_Stu     &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80.…\n$ Sec_Stu     &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68.…\n$ Household   &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 161…\n$ Household_R &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 154…\n$ NOIP        &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, 4…\n$ Pop_R       &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 266…\n$ RSCG        &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, 1…\n$ Pop_T       &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5, …\n$ Agri        &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.510…\n$ Service     &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.8…\n$ Disp_Inc    &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 27…\n$ RORP        &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.6…\n$ ROREmp      &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.8…\n$ geometry    &lt;POLYGON [°]&gt; POLYGON ((112.0625 29.75523..., POLYGON ((112.2288…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-queen-contiguity-based-neighbours",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-queen-contiguity-based-neighbours",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "6.1 Computing (QUEEN) contiguity based neighbours",
    "text": "6.1 Computing (QUEEN) contiguity based neighbours\nThe code chunk below is used to compute Queen contiguity weight matrix.\n\n\nShow code\nwm_q &lt;- poly2nb(hunan, queen = TRUE)\nsummary(wm_q)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report shows that: - There are 88 area units in Hunan - The most connected area unit has 11 neighbours - There are two area units with only one neighbour\n\n6.1.1 Examining the neighbours\nFor each polygon in our polygon object, wm_q lists all neighboring polygons. For example, to see the neighbors for the first polygon:\n\n\nShow code\n# Check neighbours for polygon 1\nwm_q[[1]]\n\n\n[1]  2  3  4 57 85\n\n\nShow code\n# Get the county name of Polygon ID=1\nhunan$County[1]\n\n\n[1] \"Anxiang\"\n\n\nShow code\n# Get the county names of the five neighboring polygons\nhunan$County[c(2,3,4,57,85)]\n\n\n[1] \"Hanshou\" \"Jinshi\"  \"Li\"      \"Nan\"     \"Taoyuan\"\n\n\nShow code\n# Get the GDPPC of these five counties\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n\n[1] 20981 34592 24473 21311 22879\n\n\n\n\n6.1.2 Display the complete weight matrix\nYou can display the complete weight matrix structure using str():\n\n\nShow code\nstr(wm_q)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#creating-rook-contiguity-based-neighbours",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#creating-rook-contiguity-based-neighbours",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "6.2 Creating (ROOK) contiguity based neighbours",
    "text": "6.2 Creating (ROOK) contiguity based neighbours\nThe code chunk below is used to compute Rook contiguity weight matrix.\n\n\nShow code\nwm_r &lt;- poly2nb(hunan, queen = FALSE)\nsummary(wm_r)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 440 \nPercentage nonzero weights: 5.681818 \nAverage number of links: 5 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 10 \n 2  2 12 20 21 14 11  3  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 10 links\n\n\nThe summary report shows that: - The most connected area unit has 10 neighbours - There are two area units with only one neighbour"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#visualising-contiguity-weights",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#visualising-contiguity-weights",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "6.3 Visualising contiguity weights",
    "text": "6.3 Visualising contiguity weights\nA connectivity graph takes a point and displays a line to each neighboring point. We need to get points (polygon centroids) to make our connectivity graphs.\n\n6.3.1 Getting Latitude and Longitude of Polygon Centroids\n\n\nShow code\n# Get longitude values\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n# Get latitude values\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n# Bind longitude and latitude into the same object\ncoords &lt;- cbind(longitude, latitude)\n\n# Check the first few observations\nhead(coords)\n\n\n     longitude latitude\n[1,]  112.1531 29.44362\n[2,]  112.0372 28.86489\n[3,]  111.8917 29.47107\n[4,]  111.7031 29.74499\n[5,]  111.6138 29.49258\n[6,]  111.0341 29.79863\n\n\n\n\n6.3.2 Plotting Queen contiguity based neighbours map\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\ntitle(\"Queen Contiguity\")\n\n\n\n\n\n\n\n\n\n\n\n6.3.3 Plotting Rook contiguity based neighbours map\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\ntitle(\"Rook Contiguity\")\n\n\n\n\n\n\n\n\n\n\n\n6.3.4 Plotting both Queen and Rook contiguity based neighbours maps\n\n\nShow code\npar(mfrow = c(1,2))\nplot(hunan$geometry, border = \"lightgrey\", main = \"Queen Contiguity\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\nplot(hunan$geometry, border = \"lightgrey\", main = \"Rook Contiguity\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#determine-the-cut-off-distance",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#determine-the-cut-off-distance",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "7.1 Determine the cut-off distance",
    "text": "7.1 Determine the cut-off distance\nFirst, we need to determine the upper limit for distance band:\n\n\nShow code\n# Step 1: Find k-nearest neighbours\nk1 &lt;- knn2nb(knearneigh(coords))\n\n# Step 2: Calculate distances between neighbours\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\n\n# Step 3: Summary statistics\nsummary(k1dists)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\nThe summary report shows that the largest first nearest neighbour distance is 61.79 km, so using this as the upper threshold gives certainty that all units will have at least one neighbour."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-fixed-distance-weight-matrix",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-fixed-distance-weight-matrix",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "7.2 Computing fixed distance weight matrix",
    "text": "7.2 Computing fixed distance weight matrix\nNow, we will compute the distance weight matrix using dnearneigh():\n\n\nShow code\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\n\n7.2.1 Display the structure of the weight matrix\n\n\nShow code\nstr(wm_d62)\n\n\nWe can also use table() and card() to check the neighbour distribution:\n\n\nShow code\ntable(hunan$County, card(wm_d62))\n\n\n               \n                1 2 3 4 5 6\n  Anhua         1 0 0 0 0 0\n  Anren         0 0 0 1 0 0\n  Anxiang       0 0 0 0 1 0\n  Baojing       0 0 0 0 1 0\n  Chaling       0 0 1 0 0 0\n  Changning     0 0 1 0 0 0\n  Changsha      0 0 0 1 0 0\n  Chengbu       0 1 0 0 0 0\n  Chenxi        0 0 0 1 0 0\n  Cili          0 1 0 0 0 0\n  Dao           0 0 0 1 0 0\n  Dongan        0 0 1 0 0 0\n  Dongkou       0 0 0 1 0 0\n  Fenghuang     0 0 0 1 0 0\n  Guidong       0 0 1 0 0 0\n  Guiyang       0 0 0 1 0 0\n  Guzhang       0 0 0 0 0 1\n  Hanshou       0 0 0 1 0 0\n  Hengdong      0 0 0 0 1 0\n  Hengnan       0 0 0 0 1 0\n  Hengshan      0 0 0 0 0 1\n  Hengyang      0 0 0 0 0 1\n  Hongjiang     0 0 0 0 1 0\n  Huarong       0 0 0 1 0 0\n  Huayuan       0 0 0 1 0 0\n  Huitong       0 0 0 1 0 0\n  Jiahe         0 0 0 0 1 0\n  Jianghua      0 0 1 0 0 0\n  Jiangyong     0 1 0 0 0 0\n  Jingzhou      0 1 0 0 0 0\n  Jinshi        0 0 0 1 0 0\n  Jishou        0 0 0 0 0 1\n  Lanshan       0 0 0 1 0 0\n  Leiyang       0 0 0 1 0 0\n  Lengshuijiang 0 0 1 0 0 0\n  Li            0 0 1 0 0 0\n  Lianyuan      0 0 0 0 1 0\n  Liling        0 1 0 0 0 0\n  Linli         0 0 0 1 0 0\n  Linwu         0 0 0 1 0 0\n  Linxiang      1 0 0 0 0 0\n  Liuyang       0 1 0 0 0 0\n  Longhui       0 0 1 0 0 0\n  Longshan      0 1 0 0 0 0\n  Luxi          0 0 0 0 1 0\n  Mayang        0 0 0 0 0 1\n  Miluo         0 0 0 0 1 0\n  Nan           0 0 0 0 1 0\n  Ningxiang     0 0 0 1 0 0\n  Ningyuan      0 0 0 0 1 0\n  Pingjiang     0 1 0 0 0 0\n  Qidong        0 0 1 0 0 0\n  Qiyang        0 0 1 0 0 0\n  Rucheng       0 1 0 0 0 0\n  Sangzhi       0 1 0 0 0 0\n  Shaodong      0 0 0 0 1 0\n  Shaoshan      0 0 0 0 1 0\n  Shaoyang      0 0 0 1 0 0\n  Shimen        1 0 0 0 0 0\n  Shuangfeng    0 0 0 0 0 1\n  Shuangpai     0 0 0 1 0 0\n  Suining       0 0 0 0 1 0\n  Taojiang      0 1 0 0 0 0\n  Taoyuan       0 1 0 0 0 0\n  Tongdao       0 1 0 0 0 0\n  Wangcheng     0 0 0 1 0 0\n  Wugang        0 0 1 0 0 0\n  Xiangtan      0 0 0 1 0 0\n  Xiangxiang    0 0 0 0 1 0\n  Xiangyin      0 0 0 1 0 0\n  Xinhua        0 0 0 0 1 0\n  Xinhuang      1 0 0 0 0 0\n  Xinning       0 1 0 0 0 0\n  Xinshao       0 0 0 0 0 1\n  Xintian       0 0 0 0 1 0\n  Xupu          0 1 0 0 0 0\n  Yanling       0 0 1 0 0 0\n  Yizhang       1 0 0 0 0 0\n  Yongshun      0 0 0 1 0 0\n  Yongxing      0 0 0 1 0 0\n  You           0 0 0 1 0 0\n  Yuanjiang     0 0 0 0 1 0\n  Yuanling      1 0 0 0 0 0\n  Yueyang       0 0 1 0 0 0\n  Zhijiang      0 0 0 0 1 0\n  Zhongfang     0 0 0 1 0 0\n  Zhuzhou       0 0 0 0 1 0\n  Zixing        0 0 1 0 0 0\n\n\n\n\n7.2.2 Plotting fixed distance weight matrix\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(wm_d62, coords, add = TRUE)\nplot(k1, coords, add = TRUE, col = \"red\", length = 0.08)\ntitle(\"Fixed Distance Weights (62km)\")\n\n\n\n\n\n\n\n\n\nThe red lines show the links of 1st nearest neighbours and the black lines show the links of neighbours within the cut-off distance of 62km.\n\n\n7.2.3 Plotting with comparison\n\n\nShow code\npar(mfrow = c(1,2))\nplot(hunan$geometry, border = \"lightgrey\", main = \"1st Nearest Neighbours\")\nplot(k1, coords, add = TRUE, col = \"red\", length = 0.08)\n\nplot(hunan$geometry, border = \"lightgrey\", main = \"Distance Neighbours (62km)\")\nplot(wm_d62, coords, add = TRUE, pch = 19, cex = 0.6)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-adaptive-distance-weight-matrix",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#computing-adaptive-distance-weight-matrix",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "7.3 Computing adaptive distance weight matrix",
    "text": "7.3 Computing adaptive distance weight matrix\nOne characteristic of fixed distance weight matrix is that more densely settled areas (usually urban) tend to have more neighbours while less densely settled areas (usually rural) tend to have fewer neighbours.\nIt is possible to control the numbers of neighbours directly using k-nearest neighbours:\n\n\nShow code\nknn6 &lt;- knn2nb(knearneigh(coords, k = 6))\nknn6\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 528 \nPercentage nonzero weights: 6.818182 \nAverage number of links: 6 \nNon-symmetric neighbours list\n\n\nNotice that each county now has exactly six neighbours, no more, no less!\n\n7.3.1 Display the content of the matrix\n\n\nShow code\nstr(knn6)\n\n\n\n\n7.3.2 Plotting distance based neighbours\n\n\nShow code\nplot(hunan$geometry, border = \"lightgrey\")\nplot(knn6, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\ntitle(\"K-Nearest Neighbours (k=6)\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-with-row-standardized-weights",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-with-row-standardized-weights",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.1 Spatial lag with row-standardized weights",
    "text": "10.1 Spatial lag with row-standardized weights\nWe’ll compute the average neighbor GDPPC value for each polygon. These values are often referred to as spatially lagged values.\n\n\nShow code\nGDPPC.lag &lt;- lag.listw(rswm_q, hunan$GDPPC)\nGDPPC.lag\n\n\n [1] 24847.20 22724.80 24143.25 27737.50 27270.25 21248.80 43747.00 33582.71\n [9] 45651.17 32027.62 32671.00 20810.00 25711.50 30672.33 33457.75 31689.20\n[17] 20269.00 23901.60 25126.17 21903.43 22718.60 25918.80 20307.00 20023.80\n[25] 16576.80 18667.00 14394.67 19848.80 15516.33 20518.00 17572.00 15200.12\n[33] 18413.80 14419.33 24094.50 22019.83 12923.50 14756.00 13869.80 12296.67\n[41] 15775.17 14382.86 11566.33 13199.50 23412.00 39541.00 36186.60 16559.60\n[49] 20772.50 19471.20 19827.33 15466.80 12925.67 18577.17 14943.00 24913.00\n[57] 25093.00 24428.80 17003.00 21143.75 20435.00 17131.33 24569.75 23835.50\n[65] 26360.00 47383.40 55157.75 37058.00 21546.67 23348.67 42323.67 28938.60\n[73] 25880.80 47345.67 18711.33 29087.29 20748.29 35933.71 15439.71 29787.50\n[81] 18145.00 21617.00 29203.89 41363.67 22259.09 44939.56 16902.00 16930.00\n\n\n\n10.1.1 Understanding spatial lag\nRecall that we retrieved the GDPPC of the five neighbours of polygon 1:\n\n\nShow code\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n\n[1] 20981 34592 24473 21311 22879\n\n\nShow code\n# The average GDPPC of the neighbours\nmean(nb1)\n\n\n[1] 24847.2\n\n\nShow code\n# Compare with the lag value\nGDPPC.lag[1]\n\n\n[1] 24847.2\n\n\nWe can append the spatially lag GDPPC values onto hunan sf data frame:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(lag_GDPPC = GDPPC.lag)\n\n# Check the result\nhead(hunan[c(\"County\", \"GDPPC\", \"lag_GDPPC\")], 10)\n\n\nSimple feature collection with 10 features and 3 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 26.28322 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n      County GDPPC lag_GDPPC                       geometry\n1    Anxiang 23667  24847.20 POLYGON ((112.0625 29.75523...\n2    Hanshou 20981  22724.80 POLYGON ((112.2288 29.11684...\n3     Jinshi 34592  24143.25 POLYGON ((111.8927 29.6013,...\n4         Li 24473  27737.50 POLYGON ((111.3731 29.94649...\n5      Linli 25554  27270.25 POLYGON ((111.6324 29.76288...\n6     Shimen 27137  21248.80 POLYGON ((110.8825 30.11675...\n7    Liuyang 63118  43747.00 POLYGON ((113.9905 28.5682,...\n8  Ningxiang 62202  33582.71 POLYGON ((112.7181 28.38299...\n9  Wangcheng 70666  45651.17 POLYGON ((112.7914 28.52688...\n10     Anren 12761  32027.62 POLYGON ((113.1757 26.82734...\n\n\n\n\n10.1.2 Plotting GDPPC and spatial lag GDPPC\n\n\nShow code\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_gdppc &lt;- qtm(hunan, \"lag_GDPPC\")\ntmap_arrange(gdppc, lag_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-as-a-sum-of-neighboring-values",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-lag-as-a-sum-of-neighboring-values",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.2 Spatial lag as a sum of neighboring values",
    "text": "10.2 Spatial lag as a sum of neighboring values\nWe can calculate spatial lag as a sum of neighboring values by assigning binary weights:\n\n\nShow code\n# Apply a function that assigns value of 1 per neighbour\nb_weights &lt;- lapply(wm_q, function(x) 0*x + 1)\n\n# Assign binary weights\nb_weights2 &lt;- nb2listw(wm_q, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1    S2\nB 88 7744 448 896 10224\n\n\nWith the proper weights assigned, we can compute a lag variable:\n\n\nShow code\nlag_sum &lt;- lag.listw(b_weights2, hunan$GDPPC)\nlag_sum\n\n\n [1] 124236 113624  96573 110950 109081 106244 174988 235079 273907 256221\n[11]  98013 104050 102846  92017 133831 158446 141883 119508 150757 153324\n[21] 113593 129594 142149 100119  82884  74668  43184  99244  46549  20518\n[31] 140576 121601  92069  43258 144567 132119  51694  59024  69349  73780\n[41]  94651 100680  69398  52798 140472 118623 180933  82798  83090  97356\n[51]  59482  77334  38777 111463  74715 174391 150558 122144  68012  84575\n[61] 143045  51394  98279  47671  26360 236917 220631 185290  64640  70046\n[71] 126971 144693 129404 284074 112268 203611 145238 251536 108078 238300\n[81] 108870 108085 262835 248182 244850 404456  67608  33860\n\n\n\n10.2.1 Understanding the result\n\n\nShow code\n# Check the result for polygon 1\nnb1 &lt;- wm_q[[1]]\nnb1_GDPPC &lt;- hunan$GDPPC[nb1]\n\n# Sum of neighbours' GDPPC\nsum(nb1_GDPPC)\n\n\n[1] 124236\n\n\nShow code\n# Compare with lag_sum\nlag_sum[1]\n\n\n[1] 124236\n\n\nAppend the lag_sum GDPPC field into hunan:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(lag_sum_GDPPC = lag_sum)\n\n# Plot for comparison\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum_GDPPC\")\ntmap_arrange(gdppc, lag_sum_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-average",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-average",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.3 Spatial window average",
    "text": "10.3 Spatial window average\nThe spatial window average uses row-standardized weights and includes the diagonal element (the region itself).\n\n\nShow code\n# Add diagonal element\nwm_q1 &lt;- include.self(wm_q)\nwm_q1\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\n\nShow code\n# Check the neighbour list of area 1\nwm_q1[[1]]\n\n\n[1]  1  2  3  4 57 85\n\n\nNotice that now area 1 has six neighbours instead of five (including itself).\nNow we obtain weights:\n\n\nShow code\nwm_q1 &lt;- nb2listw(wm_q1)\nwm_q1\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 30.90265 357.5308\n\n\nCreate the lag variable from our weight structure and GDPPC variable:\n\n\nShow code\nlag_w_avg_gpdpc &lt;- lag.listw(wm_q1, hunan$GDPPC)\nlag_w_avg_gpdpc\n\n\n [1] 24650.50 22434.17 26233.00 27084.60 26927.00 22230.17 47621.20 37160.12\n [9] 49224.71 29886.89 26627.50 22690.17 25366.40 25825.75 30329.00 32682.83\n[17] 25948.62 23987.67 25463.14 21904.38 23127.50 25949.83 20018.75 19524.17\n[25] 18955.00 17800.40 15883.00 18831.33 14832.50 17965.00 17159.89 16199.44\n[33] 18764.50 26878.75 23188.86 20788.14 12365.20 15985.00 13764.83 11907.43\n[41] 17128.14 14593.62 11644.29 12706.00 21712.29 43548.25 35049.00 16226.83\n[49] 19294.40 18156.00 19954.75 18145.17 12132.75 18419.29 14050.83 23619.75\n[57] 24552.71 24733.67 16762.60 20932.60 19467.75 18334.00 22541.00 26028.00\n[65] 29128.50 46569.00 47576.60 36545.50 20838.50 22531.00 42115.50 27619.00\n[73] 27611.33 44523.29 18127.43 28746.38 20734.50 33880.62 14716.38 28516.22\n[81] 18086.14 21244.50 29568.80 48119.71 22310.75 43151.60 17133.40 17009.33\n\n\nConvert to data frame and append to hunan:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(lag_window_avg_GDPPC = lag_w_avg_gpdpc)\n\n# Create comparison table\nhunan %&gt;%\n  select(County, GDPPC, lag_GDPPC, lag_window_avg_GDPPC) %&gt;%\n  head(10) %&gt;%\n  knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\n\nCounty\nGDPPC\nlag_GDPPC\nlag_window_avg_GDPPC\ngeometry\n\n\n\n\nAnxiang\n23667\n24847.20\n24650.50\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n20981\n22724.80\n22434.17\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n34592\n24143.25\n26233.00\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n24473\n27737.50\n27084.60\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n25554\n27270.25\n26927.00\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n27137\n21248.80\n22230.17\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n63118\n43747.00\n47621.20\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n62202\n33582.71\n37160.12\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n70666\n45651.17\n49224.71\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n12761\n32027.62\n29886.89\nPOLYGON ((113.1757 26.82734…\n\n\n\n\n\n\n10.3.1 Plot comparison\n\n\nShow code\nlag_gdppc &lt;- qtm(hunan, \"lag_GDPPC\")\nw_avg_gdppc &lt;- qtm(hunan, \"lag_window_avg_GDPPC\")\ntmap_arrange(lag_gdppc, w_avg_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-sum",
    "href": "Hands-on_Ex/Hands-on_ex04/ex04.html#spatial-window-sum",
    "title": "Hands-on Exercise 04: Spatial Weights and Applications",
    "section": "10.4 Spatial window sum",
    "text": "10.4 Spatial window sum\nThe spatial window sum is the counterpart of the window average, but without using row-standardized weights.\n\n\nShow code\n# Add diagonal element\nwm_q2 &lt;- include.self(wm_q)\n\n# Assign binary weights\nb_weights3 &lt;- lapply(wm_q2, function(x) 0*x + 1)\nwm_q2 &lt;- nb2listw(wm_q2, \n                  glist = b_weights3, \n                  style = \"B\")\nwm_q2\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 536 1072 14160\n\n\nCompute the lag variable:\n\n\nShow code\nw_sum_gdppc &lt;- lag.listw(wm_q2, hunan$GDPPC)\nw_sum_gdppc\n\n\n [1] 147903 134605 131165 135423 134635 133381 238106 297281 344573 268982\n[11] 106510 136141 126832 103303 151645 196097 207589 143926 178242 175235\n[21] 138765 155699 160150 117145 113730  89002  63532 112988  59330  35930\n[31] 154439 145795 112587 107515 162322 145517  61826  79925  82589  83352\n[41] 119897 116749  81510  63530 151986 174193 210294  97361  96472 108936\n[51]  79819 108871  48531 128935  84305 188958 171869 148402  83813 104663\n[61] 155742  73336 112705  78084  58257 279414 237883 219273  83354  90124\n[71] 168462 165714 165668 311663 126892 229971 165876 271045 117731 256646\n[81] 126603 127467 295688 336838 267729 431516  85667  51028\n\n\nConvert to data frame and append:\n\n\nShow code\nhunan &lt;- hunan %&gt;%\n  mutate(w_sum_GDPPC = w_sum_gdppc)\n\n# Create comparison table\nhunan %&gt;%\n  select(County, lag_sum_GDPPC, w_sum_GDPPC) %&gt;%\n  head(10) %&gt;%\n  knitr::kable()\n\n\n\n\n\nCounty\nlag_sum_GDPPC\nw_sum_GDPPC\ngeometry\n\n\n\n\nAnxiang\n124236\n147903\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n113624\n134605\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n96573\n131165\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n110950\n135423\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n109081\n134635\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n106244\n133381\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n174988\n238106\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n235079\n297281\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n273907\n344573\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n256221\n268982\nPOLYGON ((113.1757 26.82734…\n\n\n\n\n\n\n10.4.1 Plot comparison\n\n\nShow code\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum_GDPPC\")\nw_sum_gdppc &lt;- qtm(hunan, \"w_sum_GDPPC\")\ntmap_arrange(lag_sum_gdppc, w_sum_gdppc, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Local Measures of Spatial Autocorrelation (LMSA) focus on the relationships between each observation and its surroundings, rather than providing a single summary of these relationships across the map. In this sense, they are not summary statistics but scores that allow us to learn more about the spatial structure in our data.\nIn this hands-on exercise, you will learn how to compute Local Measures of Spatial Autocorrelation (LMSA) by using sfdep package. By the end of this hands-on exercise, you will be able to:\n\nImport geospatial data using appropriate function(s) of sf package\nImport csv file using appropriate function of readr package\nPerform relational join using appropriate join function of dplyr package\nCompute Local Indicator of Spatial Association (LISA) statistics for detecting clusters and outliers by using appropriate functions of sfdep package\nCompute Getis-Ord’s Gi-statistics for detecting hot spot or/and cold spot area by using appropriate functions of sfdep package\nVisualise the analysis output by using tmap package\n\n\n\nIn spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China.\n\n\n\nTwo data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-analytical-question",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-analytical-question",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In spatial policy, one of the main development objectives of the local government and planners is to ensure equal distribution of development in the province. Our task in this study, hence, is to apply appropriate spatial statistical methods to discover if development is evenly distributed geographically.\nIf the answer is No, then our next question will be “is there sign of spatial clustering?”. And, if the answer for this question is yes, then our next question will be “where are these clusters?”\nIn this case study, we are interested to examine the spatial pattern of a selected development indicator (i.e. GDP per capita) of Hunan Province, People’s Republic of China."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-study-area-and-data",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#the-study-area-and-data",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Two data sets will be used in this hands-on exercise:\n\nHunan province administrative boundary layer at county level: This is a geospatial data set in ESRI shapefile format\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#setting-the-analytical-tools",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#setting-the-analytical-tools",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "2.1 Setting the Analytical Tools",
    "text": "2.1 Setting the Analytical Tools\nBefore we get started, we need to ensure that sf, sfdep, tmap and tidyverse packages are installed and loaded.\n\nsf is used for importing and handling geospatial data in R\ntidyverse is mainly used for wrangling attribute data in R\nsfdep will be used to compute spatial weights, global and local spatial autocorrelation statistics\ntmap will be used to prepare cartographic quality choropleth maps\n\n\npacman::p_load(sf, sfdep, tmap, tidyverse, knitr)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-shapefile-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-shapefile-into-r-environment",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.1 Import shapefile into R environment",
    "text": "3.1 Import shapefile into R environment\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be simple features object of sf.\n\n\nShow code\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\n\nReading layer `Hunan' from data source \n  `C:\\Users\\HOPE\\Desktop\\ISSS626\\Hands-on_Ex\\Hands-on_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\nImportant: The raw data is in WGS 84 geographic coordinates system. For geospatial analysis, it is appropriate to use projected coordinates system. We will transform Hunan geospatial data from WGS 84 to UTM zone 50N (i.e. EPSG: 32650).\n\n\nShow code\nhunan &lt;- st_transform(hunan, crs = 32650)\n\n# Verify the transformation\nst_crs(hunan)\n\n\nCoordinate Reference System:\n  User input: EPSG:32650 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 50N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            MEMBER[\"World Geodetic System 1984 (G2296)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 50N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",117,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 114°E and 120°E, northern hemisphere between equator and 84°N, onshore and offshore. Brunei. China. Hong Kong. Indonesia. Malaysia - East Malaysia - Sarawak. Mongolia. Philippines. Russian Federation. Taiwan.\"],\n        BBOX[0,114,84,120]],\n    ID[\"EPSG\",32650]]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-csv-file-into-r-environment",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#import-csv-file-into-r-environment",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.2 Import csv file into R environment",
    "text": "3.2 Import csv file into R environment\nNext, we will import Hunan_2012.csv into R by using read_csv() of readr package.\n\n\nShow code\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\", show_col_types = FALSE)\n\n# Check the data structure\nglimpse(hunan2012)\n\n\nRows: 88\nColumns: 29\n$ County      &lt;chr&gt; \"Anhua\", \"Anren\", \"Anxiang\", \"Baojing\", \"Chaling\", \"Changn…\n$ City        &lt;chr&gt; \"Yiyang\", \"Chenzhou\", \"Changde\", \"Hunan West\", \"Zhuzhou\", …\n$ avg_wage    &lt;dbl&gt; 30544, 28058, 31935, 30843, 31251, 28518, 54540, 28597, 33…\n$ deposite    &lt;dbl&gt; 10967.0, 4598.9, 5517.2, 2250.0, 8241.4, 10860.0, 24332.0,…\n$ FAI         &lt;dbl&gt; 6831.7, 6386.1, 3541.0, 1005.4, 6508.4, 7920.0, 33624.0, 1…\n$ Gov_Rev     &lt;dbl&gt; 456.72, 220.57, 243.64, 192.59, 620.19, 769.86, 5350.00, 1…\n$ Gov_Exp     &lt;dbl&gt; 2703.0, 1454.7, 1779.5, 1379.1, 1947.0, 2631.6, 7885.5, 11…\n$ GDP         &lt;dbl&gt; 13225.0, 4941.2, 12482.0, 4087.9, 11585.0, 19886.0, 88009.…\n$ GDPPC       &lt;dbl&gt; 14567, 12761, 23667, 14563, 20078, 24418, 88656, 10132, 17…\n$ GIO         &lt;dbl&gt; 9276.90, 4189.20, 5108.90, 3623.50, 9157.70, 37392.00, 513…\n$ Loan        &lt;dbl&gt; 3954.90, 2555.30, 2806.90, 1253.70, 4287.40, 4242.80, 4053…\n$ NIPCR       &lt;dbl&gt; 3528.3, 3271.8, 7693.7, 4191.3, 3887.7, 9528.0, 17070.0, 3…\n$ Bed         &lt;dbl&gt; 2718, 970, 1931, 927, 1449, 3605, 3310, 582, 2170, 2179, 1…\n$ Emp         &lt;dbl&gt; 494.310, 290.820, 336.390, 195.170, 330.290, 548.610, 670.…\n$ EmpR        &lt;dbl&gt; 441.4, 255.4, 270.5, 145.6, 299.0, 415.1, 452.0, 127.6, 21…\n$ EmpRT       &lt;dbl&gt; 338.0, 99.4, 205.9, 116.4, 154.0, 273.7, 219.4, 94.4, 174.…\n$ Pri_Stu     &lt;dbl&gt; 54.175, 33.171, 19.584, 19.249, 33.906, 81.831, 59.151, 18…\n$ Sec_Stu     &lt;dbl&gt; 32.830, 17.505, 17.819, 11.831, 20.548, 44.485, 39.685, 7.…\n$ Household   &lt;dbl&gt; 290.4, 104.6, 148.1, 73.2, 148.7, 211.2, 300.3, 76.1, 139.…\n$ Household_R &lt;dbl&gt; 234.5, 121.9, 135.4, 69.9, 139.4, 211.7, 248.4, 59.6, 110.…\n$ NOIP        &lt;dbl&gt; 101, 34, 53, 18, 106, 115, 214, 17, 55, 70, 44, 84, 74, 17…\n$ Pop_R       &lt;dbl&gt; 670.3, 243.2, 346.0, 184.1, 301.6, 448.2, 475.1, 189.6, 31…\n$ RSCG        &lt;dbl&gt; 5760.60, 2386.40, 3957.90, 768.04, 4009.50, 5220.40, 22604…\n$ Pop_T       &lt;dbl&gt; 910.8, 388.7, 528.3, 281.3, 578.4, 816.3, 998.6, 256.7, 45…\n$ Agri        &lt;dbl&gt; 4942.253, 2357.764, 4524.410, 1118.561, 3793.550, 6430.782…\n$ Service     &lt;dbl&gt; 5414.5, 3814.1, 14100.0, 541.8, 5444.0, 13074.6, 17726.6, …\n$ Disp_Inc    &lt;dbl&gt; 12373, 16072, 16610, 13455, 20461, 20868, 183252, 12379, 1…\n$ RORP        &lt;dbl&gt; 0.7359464, 0.6256753, 0.6549309, 0.6544614, 0.5214385, 0.5…\n$ ROREmp      &lt;dbl&gt; 0.8929619, 0.8782065, 0.8041262, 0.7460163, 0.9052651, 0.7…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#performing-relational-join",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#performing-relational-join",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.3 Performing relational join",
    "text": "3.3 Performing relational join\nThe code chunk below will be used to update the attribute table of hunan’s sf data frame with the attribute fields of hunan2012 dataframe.\n\n\nShow code\nhunan &lt;- left_join(hunan, hunan2012, by = c(\"County\" = \"County\"))\n\n# Check the result\nglimpse(hunan)\n\n\nRows: 88\nColumns: 36\n$ NAME_2      &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ ID_3        &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 21…\n$ NAME_3      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ ENGTYPE_3   &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"Co…\n$ Shape_Leng  &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.171918…\n$ Shape_Area  &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.11450357…\n$ County      &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"…\n$ City        &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Ch…\n$ avg_wage    &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 45…\n$ deposite    &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, 1…\n$ FAI         &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0,…\n$ Gov_Rev     &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, 2…\n$ Gov_Exp     &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 48…\n$ GDP         &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 81113…\n$ GDPPC       &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 70…\n$ GIO         &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254.…\n$ Loan        &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 23408…\n$ NIPCR       &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, 1…\n$ Bed         &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970, …\n$ Emp         &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 85…\n$ EmpR        &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 268…\n$ EmpRT       &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 131…\n$ Pri_Stu     &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80.…\n$ Sec_Stu     &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68.…\n$ Household   &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 161…\n$ Household_R &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 154…\n$ NOIP        &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, 4…\n$ Pop_R       &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 266…\n$ RSCG        &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, 1…\n$ Pop_T       &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5, …\n$ Agri        &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.510…\n$ Service     &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.8…\n$ Disp_Inc    &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 27…\n$ RORP        &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.6…\n$ ROREmp      &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.8…\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.96…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-regional-development-indicator",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-regional-development-indicator",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "3.4 Visualising Regional Development Indicator",
    "text": "3.4 Visualising Regional Development Indicator\nIn the code chunks below, tmap functions are used to build two choropleth maps by using equal interval and quantile classification methods.\n\n\nShow code\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp = 1, \n             ncol = 2)\n\n\n\n\n\n\n\n\n\nQuestions to consider: - Does the plot above reveal any outliers or clusters? - Does the plot above indicate the presence of hot spots or cold spots?"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-contiguity-spatial-weights",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-contiguity-spatial-weights",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.1 Computing Contiguity Spatial Weights",
    "text": "4.1 Computing Contiguity Spatial Weights\nBefore we can compute the local spatial autocorrelation statistics, we need to construct a spatial weights of the study area.\nIn the code chunk below, st_contiguity() of sfdep package is used to compute contiguity weight matrices for the study area.\n\n\nShow code\n# Compute contiguity neighbours\nnb &lt;- st_contiguity(hunan)\n\n# Calculate spatial weights (row-standardized)\nwt &lt;- st_weights(nb, \n                 style = \"W\")\n\n# Add to the sf data frame\nhunan &lt;- hunan %&gt;%\n  mutate(nb = nb,\n         wt = wt,\n         .before = 1)\n\n\nTo reveal the neighbour list, code chunk below is used:\n\n\nShow code\nsummary(nb)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report shows that: - There are 88 area units in Hunan - The most connected area unit has 11 neighbours - There are two area units with only one neighbour"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-morans-i",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.2 Computing local Moran’s I",
    "text": "4.2 Computing local Moran’s I\nTo compute local Moran’s I, the local_moran() function of sfdep will be used.\n\n\nShow code\nlisa &lt;- hunan %&gt;%\n  mutate(local_moran = local_moran(GDPPC, nb, wt),\n         .before = 1) %&gt;%\n  unnest(local_moran)\n\n# Check the structure\nglimpse(lisa)\n\n\nRows: 88\nColumns: 50\n$ ii           &lt;dbl&gt; -1.468468e-03, 2.587817e-02, -1.198765e-02, 1.022468e-03,…\n$ eii          &lt;dbl&gt; -0.0027018573, 0.0017729527, -0.0149303475, 0.0001900152,…\n$ var_ii       &lt;dbl&gt; 5.007875e-04, 1.055268e-02, 1.162730e-01, 5.726521e-06, 1…\n$ z_ii         &lt;dbl&gt; 0.055115474, 0.234654935, 0.008629922, 0.347867652, 0.409…\n$ p_ii         &lt;dbl&gt; 0.9560464684, 0.8144765678, 0.9931144036, 0.7279395799, 0…\n$ p_ii_sim     &lt;dbl&gt; 0.948, 0.964, 0.808, 0.616, 0.580, 0.800, 0.040, 0.112, 0…\n$ p_folded_sim &lt;dbl&gt; 0.474, 0.482, 0.404, 0.308, 0.290, 0.400, 0.020, 0.056, 0…\n$ skewness     &lt;dbl&gt; -0.8133442, -0.9131156, 1.3251876, 0.8996939, 1.1218756, …\n$ kurtosis     &lt;dbl&gt; 0.6483140, 0.7990201, 2.9340595, 0.3343128, 1.2932311, 0.…\n$ mean         &lt;fct&gt; Low-High, Low-Low, High-Low, High-High, High-High, High-L…\n$ median       &lt;fct&gt; High-High, High-High, High-High, High-High, High-High, Hi…\n$ pysal        &lt;fct&gt; Low-High, Low-Low, High-Low, High-High, High-High, High-L…\n$ nb           &lt;nb&gt; &lt;2, 3, 4, 57, 85&gt;, &lt;1, 57, 58, 78, 85&gt;, &lt;1, 4, 5, 85&gt;, &lt;1,…\n$ wt           &lt;list&gt; &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0…\n$ NAME_2       &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ ID_3         &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 2…\n$ NAME_3       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ ENGTYPE_3    &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"C…\n$ Shape_Leng   &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.17191…\n$ Shape_Area   &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.1145035…\n$ County       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ City         &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ avg_wage     &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 4…\n$ deposite     &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, …\n$ FAI          &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0…\n$ Gov_Rev      &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, …\n$ Gov_Exp      &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 4…\n$ GDP          &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 8111…\n$ GDPPC        &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 7…\n$ GIO          &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254…\n$ Loan         &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 2340…\n$ NIPCR        &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, …\n$ Bed          &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970,…\n$ Emp          &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 8…\n$ EmpR         &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 26…\n$ EmpRT        &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 13…\n$ Pri_Stu      &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80…\n$ Sec_Stu      &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68…\n$ Household    &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 16…\n$ Household_R  &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 15…\n$ NOIP         &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, …\n$ Pop_R        &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 26…\n$ RSCG         &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, …\n$ Pop_T        &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5,…\n$ Agri         &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.51…\n$ Service      &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.…\n$ Disp_Inc     &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 2…\n$ RORP         &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.…\n$ ROREmp       &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.9…\n\n\nThe local_moran() function returns a data frame with the following columns: - ii: the local Moran’s I statistics - eii: the expectation of local moran statistic under the randomisation hypothesis - var_ii: the variance of local moran statistic under the randomisation hypothesis - z_ii: the standard deviate of local moran statistic - p_ii: the p-value of local moran statistic - mean: classification based on mean - median: classification based on median - pysal: classification following PySAL convention"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-local-morans-i",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-local-morans-i",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.3 Visualising local Moran’s I",
    "text": "4.3 Visualising local Moran’s I\n\n4.3.1 Mapping local Moran’s I values\nUsing choropleth mapping functions of tmap package, we can plot the local Moran’s I values.\n\n\nShow code\ntm_shape(lisa) +\n  tm_fill(\"ii\",\n          style = \"pretty\",\n          palette = \"RdBu\",\n          midpoint = NA) +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Moran's I of GDPPC\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n4.3.2 Mapping local Moran’s I p-values\nThe choropleth shows there is evidence for both positive and negative Ii values. However, it is useful to consider the p-values for each of these values.\n\n\nShow code\ntm_shape(lisa) +\n  tm_fill(\"p_ii\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\",\n          title = \"p-value\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values of Local Moran's I\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n4.3.3 Mapping both local Moran’s I values and p-values\nFor effective interpretation, it is better to plot both the local Moran’s I values map and its corresponding p-values map next to each other.\n\n\nShow code\nii_map &lt;- tm_shape(lisa) +\n  tm_fill(\"ii\",\n          style = \"pretty\",\n          n = 5,\n          palette = \"RdBu\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Moran's I of GDPPC\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\np_ii_map &lt;- tm_shape(lisa) +\n  tm_fill(\"p_ii\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values of Local Moran's I\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\ntmap_arrange(ii_map, p_ii_map, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#preparing-and-visualising-lisa-map",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#preparing-and-visualising-lisa-map",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "4.4 Preparing and Visualising LISA Map",
    "text": "4.4 Preparing and Visualising LISA Map\n\n4.4.1 Plotting Moran scatterplot\nA Moran Scatterplot is a graphical tool that visualizes the relationship between a variable’s values and the average values of its neighboring locations (spatial lag).\nFirst, we need to calculate the spatial lag of GDPPC:\n\n\nShow code\nlisa &lt;- lisa %&gt;%\n  mutate(lag_GDPPC = st_lag(GDPPC, nb, wt),\n         .before = 1)\n\n\nNow, plot the Moran Scatterplot:\n\n\nShow code\nggplot(data = lisa,\n       aes(x = GDPPC,\n           y = lag_GDPPC)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              color = \"red\") +\n  labs(x = \"GDPPC\",\n       y = \"Spatial Lag of GDPPC\",\n       title = \"Moran Scatterplot\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nTo make the plot more intuitive, we can color-code by LISA quadrants:\n\n\nShow code\nggplot(data = lisa,\n       aes(x = GDPPC,\n           y = lag_GDPPC,\n           color = mean)) +\n  geom_point(size = 2) +\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              color = \"black\") +\n  geom_hline(yintercept = mean(lisa$lag_GDPPC), lty = 2) +\n  geom_vline(xintercept = mean(lisa$GDPPC), lty = 2) +\n  scale_color_manual(\n    values = c(\"High-High\" = \"red\",\n               \"Low-Low\" = \"blue\",\n               \"Low-High\" = \"lightblue\",\n               \"High-Low\" = \"pink\")) +\n  labs(x = \"GDPPC\",\n       y = \"Spatial Lag of GDPPC\",\n       title = \"Moran Scatterplot with LISA Quadrants\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n4.4.2 Plotting Moran scatterplot with standardised variable\nFirst we will use scale() to center and scale the variable:\n\n\nShow code\nlisa &lt;- lisa %&gt;%\n  mutate(z_GDPPC = as.vector(scale(GDPPC)),\n         z_lag_GDPPC = as.vector(scale(lag_GDPPC)),\n         .before = 1)\n\n\nNow, plot the standardised Moran scatterplot:\n\n\nShow code\nggplot(data = lisa,\n       aes(x = z_GDPPC,\n           y = z_lag_GDPPC,\n           color = mean)) +\n  geom_point(size = 2) +\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              color = \"black\") +\n  geom_hline(yintercept = 0, lty = 2) +\n  geom_vline(xintercept = 0, lty = 2) +\n  scale_color_manual(\n    values = c(\"High-High\" = \"red\",\n               \"Low-Low\" = \"blue\",\n               \"Low-High\" = \"lightblue\",\n               \"High-Low\" = \"pink\")) +\n  labs(x = \"Standardised GDPPC\",\n       y = \"Standardised Spatial Lag of GDPPC\",\n       title = \"Standardised Moran Scatterplot with LISA Quadrants\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n4.4.3 Preparing LISA cluster map\nNow we will prepare a LISA cluster map. First, we need to create a categorical variable for LISA clusters:\n\n\nShow code\nlisa &lt;- lisa %&gt;%\n  mutate(LISA_cluster = case_when(\n    p_ii &gt; 0.05 ~ \"Insignificant\",\n    mean == \"High-High\" ~ \"High-High\",\n    mean == \"Low-Low\" ~ \"Low-Low\",\n    mean == \"Low-High\" ~ \"Low-High\",\n    mean == \"High-Low\" ~ \"High-Low\",\n    TRUE ~ \"Other\"\n  ),\n  LISA_cluster = factor(\n    LISA_cluster,\n    levels = c(\"Insignificant\", \"High-High\", \"Low-Low\", \n               \"Low-High\", \"High-Low\")\n  ))\n\n# Check the distribution\ntable(lisa$LISA_cluster)\n\n\n\nInsignificant     High-High       Low-Low      Low-High      High-Low \n           79             7             1             1             0 \n\n\n\n\n4.4.4 Plotting LISA map\nNow, we can plot the LISA map:\n\n\nShow code\nlisa_map &lt;- tm_shape(lisa) +\n  tm_polygons(\n    \"LISA_cluster\",\n    palette = c(\"grey80\",     # Insignificant\n                \"red\",        # High-High\n                \"blue\",       # Low-Low\n                \"lightblue\",  # Low-High\n                \"pink\"),      # High-Low\n    title = \"LISA Cluster\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"LISA Cluster Map (p &lt; 0.05)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\nlisa_map\n\n\n\n\n\n\n\n\n\nFor comprehensive visualization, we can combine all LISA-related maps:\n\n\nShow code\ntmap_arrange(ii_map, p_ii_map, lisa_map, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n\n4.4.5 Statistical Observations from LISA Map\nThe LISA map reveals: - High-High clusters (Hot spots): Areas of high GDPPC surrounded by high GDPPC neighbors - Low-Low clusters (Cold spots): Areas of low GDPPC surrounded by low GDPPC neighbors - Low-High outliers: Low GDPPC areas surrounded by high GDPPC neighbors - High-Low outliers: High GDPPC areas surrounded by low GDPPC neighbors - Insignificant areas: No significant local spatial autocorrelation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#deriving-distance-weight-matrix",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#deriving-distance-weight-matrix",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.1 Deriving distance weight matrix",
    "text": "5.1 Deriving distance weight matrix\nFor Getis-Ord Gi* statistics, we define neighbours based on distance.\n\n5.1.1 Determine the cut-off distance\nFirst, we need to determine the upper limit for distance band:\n\n\nShow code\n# Get geometry\ngeo &lt;- st_geometry(hunan)\n\n# Compute centroid\nco &lt;- st_centroid(geo)\n\n# Determine the cutoff distance\nk1 &lt;- sfdep::st_knn(co, k = 1)\nk1_dist &lt;- sfdep::st_nb_dists(co, k1)\n\n# Summary of distances\nsummary(unlist(k1_dist))\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24845   32677   38110   38998   44639   58635 \n\n\nThe summary report shows that the largest first nearest neighbour distance is about 61.8 km, so using this as the upper threshold gives certainty that all units will have at least one neighbour.\n\n\n5.1.2 Computing fixed distance weights\nUsing the critical threshold value computed above, we compute the fixed distance weight:\n\n\nShow code\n# Compute fixed distance neighbors (using 62km as threshold)\nwm_fd &lt;- st_dist_band(co, \n                      upper = 62000)  # Note: using meters since we're in UTM\n\n# Important: Include self for Gi* statistics\nwm_fd &lt;- include_self(wm_fd)\n\n# Compute weights\nwm_fd_weights &lt;- st_weights(wm_fd)\n\n# Check summary\nsummary(wm_fd)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 406 \nPercentage nonzero weights: 5.242769 \nAverage number of links: 4.613636 \nLink number distribution:\n\n 2  3  4  5  6  7 \n 7 14 15 28 18  6 \n7 least connected regions:\n6 15 30 32 56 65 85 with 2 links\n6 most connected regions:\n21 28 45 50 52 82 with 7 links\n\n\n\n\n5.1.3 Computing adaptive distance weights\nIt is possible to control the numbers of neighbours directly using k-nearest neighbours:\n\n\nShow code\n# Compute k-nearest neighbors (k=8)\nwm_ad &lt;- st_knn(co, k = 8)\n\n# Include self for Gi* statistics\nwm_ad &lt;- include_self(wm_ad)\n\n# Compute weights\nwm_ad_weights &lt;- st_weights(wm_ad)\n\n# Check summary\nsummary(wm_ad)\n\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 792 \nPercentage nonzero weights: 10.22727 \nAverage number of links: 9 \nNon-symmetric neighbours list\nLink number distribution:\n\n 9 \n88 \n88 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 9 links\n88 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 9 links"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-gi-statistics",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#computing-local-gi-statistics",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.2 Computing local Gi* statistics",
    "text": "5.2 Computing local Gi* statistics\n\n5.2.1 Using fixed distance weights\n\n\nShow code\nHCSA_fdw &lt;- hunan %&gt;%\n  mutate(local_Gi = local_gstar_perm(GDPPC, \n                                     wm_fd, \n                                     wm_fd_weights,\n                                     nsim = 999),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\n\n# Check the results\nglimpse(HCSA_fdw)\n\n\nRows: 88\nColumns: 48\n$ gi_star      &lt;dbl&gt; 0.38306332, -0.34046184, 0.23257243, 0.36406563, 0.364065…\n$ cluster      &lt;fct&gt; Low, Low, High, High, High, High, High, High, High, Low, …\n$ e_gi         &lt;dbl&gt; 0.011339108, 0.011027381, 0.012269291, 0.011214019, 0.011…\n$ var_gi       &lt;dbl&gt; 6.697235e-06, 7.256003e-06, 7.869864e-06, 8.942393e-06, 9…\n$ std_dev      &lt;dbl&gt; 0.416745448, -0.258434688, -0.071440076, 0.465262403, 0.3…\n$ p_value      &lt;dbl&gt; 6.768646e-01, 7.960714e-01, 9.430475e-01, 6.417436e-01, 7…\n$ p_sim        &lt;dbl&gt; 0.604, 0.974, 0.868, 0.490, 0.584, 0.926, 0.042, 0.030, 0…\n$ p_folded_sim &lt;dbl&gt; 0.302, 0.487, 0.434, 0.245, 0.292, 0.458, 0.021, 0.015, 0…\n$ skewness     &lt;dbl&gt; 0.8481757, 1.0644657, 1.0778753, 1.5204125, 1.1792646, 2.…\n$ kurtosis     &lt;dbl&gt; 0.2765997, 1.2755026, 1.2244340, 4.2130765, 1.6694175, 4.…\n$ nb           &lt;nb&gt; &lt;2, 3, 4, 57, 85&gt;, &lt;1, 57, 58, 78, 85&gt;, &lt;1, 4, 5, 85&gt;, &lt;1,…\n$ wt           &lt;list&gt; &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0…\n$ NAME_2       &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ ID_3         &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 2…\n$ NAME_3       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ ENGTYPE_3    &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"C…\n$ Shape_Leng   &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.17191…\n$ Shape_Area   &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.1145035…\n$ County       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ City         &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ avg_wage     &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 4…\n$ deposite     &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, …\n$ FAI          &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0…\n$ Gov_Rev      &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, …\n$ Gov_Exp      &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 4…\n$ GDP          &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 8111…\n$ GDPPC        &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 7…\n$ GIO          &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254…\n$ Loan         &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 2340…\n$ NIPCR        &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, …\n$ Bed          &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970,…\n$ Emp          &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 8…\n$ EmpR         &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 26…\n$ EmpRT        &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 13…\n$ Pri_Stu      &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80…\n$ Sec_Stu      &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68…\n$ Household    &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 16…\n$ Household_R  &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 15…\n$ NOIP         &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, …\n$ Pop_R        &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 26…\n$ RSCG         &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, …\n$ Pop_T        &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5,…\n$ Agri         &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.51…\n$ Service      &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.…\n$ Disp_Inc     &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 2…\n$ RORP         &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.…\n$ ROREmp       &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.9…\n\n\n\n\n5.2.2 Using adaptive distance weights\n\n\nShow code\nHCSA_adw &lt;- hunan %&gt;%\n  mutate(local_Gi = local_gstar_perm(GDPPC, \n                                     wm_ad, \n                                     wm_ad_weights,\n                                     nsim = 999),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\n\n# Check the results\nglimpse(HCSA_adw)\n\n\nRows: 88\nColumns: 48\n$ gi_star      &lt;dbl&gt; 0.24600226, 0.21329499, 0.24600226, 0.21343577, -0.007866…\n$ cluster      &lt;fct&gt; Low, Low, High, High, High, High, High, High, High, Low, …\n$ e_gi         &lt;dbl&gt; 0.01138771, 0.01117602, 0.01177925, 0.01137258, 0.0114014…\n$ var_gi       &lt;dbl&gt; 4.781272e-06, 4.769421e-06, 4.675849e-06, 5.129451e-06, 5…\n$ std_dev      &lt;dbl&gt; 0.23706627, 0.30126824, 0.05865463, 0.20385196, -0.024441…\n$ p_value      &lt;dbl&gt; 8.126054e-01, 7.632100e-01, 9.532272e-01, 8.384692e-01, 9…\n$ p_sim        &lt;dbl&gt; 0.740, 0.734, 0.870, 0.730, 0.906, 0.752, 0.004, 0.086, 0…\n$ p_folded_sim &lt;dbl&gt; 0.370, 0.367, 0.435, 0.365, 0.453, 0.376, 0.002, 0.043, 0…\n$ skewness     &lt;dbl&gt; 0.7006805, 0.5965757, 0.4989010, 0.7721328, 0.7640795, 0.…\n$ kurtosis     &lt;dbl&gt; 0.68998634, 0.25044971, -0.30885563, 0.68579425, 0.457197…\n$ nb           &lt;nb&gt; &lt;2, 3, 4, 57, 85&gt;, &lt;1, 57, 58, 78, 85&gt;, &lt;1, 4, 5, 85&gt;, &lt;1,…\n$ wt           &lt;list&gt; &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0.2, 0.2, 0.2, 0.2, 0.2&gt;, &lt;0…\n$ NAME_2       &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ ID_3         &lt;int&gt; 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 2…\n$ NAME_3       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ ENGTYPE_3    &lt;chr&gt; \"County\", \"County\", \"County City\", \"County\", \"County\", \"C…\n$ Shape_Leng   &lt;dbl&gt; 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.17191…\n$ Shape_Area   &lt;dbl&gt; 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.1145035…\n$ County       &lt;chr&gt; \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", …\n$ City         &lt;chr&gt; \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"C…\n$ avg_wage     &lt;dbl&gt; 31935, 32265, 28692, 32541, 32667, 33261, 40446, 40744, 4…\n$ deposite     &lt;dbl&gt; 5517.2, 7979.0, 4581.7, 13487.0, 564.1, 8334.4, 21415.0, …\n$ FAI          &lt;dbl&gt; 3541.0, 8665.0, 4777.0, 16066.0, 7781.2, 10531.0, 43599.0…\n$ Gov_Rev      &lt;dbl&gt; 243.64, 386.13, 373.31, 709.61, 336.86, 548.33, 2473.10, …\n$ Gov_Exp      &lt;dbl&gt; 1779.5, 2062.4, 1148.4, 2459.5, 1538.7, 2178.8, 4605.5, 4…\n$ GDP          &lt;dbl&gt; 12482.0, 15788.0, 8706.9, 20322.0, 10355.0, 16293.0, 8111…\n$ GDPPC        &lt;dbl&gt; 23667, 20981, 34592, 24473, 25554, 27137, 63118, 62202, 7…\n$ GIO          &lt;dbl&gt; 5108.9, 13491.0, 10935.0, 18402.0, 8214.0, 17795.0, 99254…\n$ Loan         &lt;dbl&gt; 2806.90, 4550.00, 2242.00, 6748.00, 358.00, 6026.50, 2340…\n$ NIPCR        &lt;dbl&gt; 7693.7, 8269.9, 8169.9, 8377.0, 8143.1, 6156.0, 15719.0, …\n$ Bed          &lt;dbl&gt; 1931, 2560, 848, 2038, 1440, 2502, 6225, 4351, 1678, 970,…\n$ Emp          &lt;dbl&gt; 336.39, 456.78, 122.78, 513.44, 307.36, 392.05, 919.62, 8…\n$ EmpR         &lt;dbl&gt; 270.5, 388.8, 82.1, 426.8, 272.2, 329.6, 721.4, 757.6, 26…\n$ EmpRT        &lt;dbl&gt; 205.9, 246.7, 61.7, 227.1, 100.8, 193.8, 300.1, 318.3, 13…\n$ Pri_Stu      &lt;dbl&gt; 19.584, 42.097, 8.723, 38.975, 23.286, 29.245, 90.978, 80…\n$ Sec_Stu      &lt;dbl&gt; 17.819, 33.029, 7.592, 33.938, 18.943, 26.104, 58.819, 68…\n$ Household    &lt;dbl&gt; 148.1, 240.2, 81.9, 268.5, 129.1, 190.6, 374.8, 391.7, 16…\n$ Household_R  &lt;dbl&gt; 135.4, 208.7, 43.7, 256.0, 157.2, 184.7, 369.8, 369.6, 15…\n$ NOIP         &lt;dbl&gt; 53, 95, 77, 96, 99, 122, 733, 552, 314, 34, 14, 100, 67, …\n$ Pop_R        &lt;dbl&gt; 346.0, 553.2, 92.4, 539.7, 246.6, 399.2, 642.7, 655.5, 26…\n$ RSCG         &lt;dbl&gt; 3957.9, 4460.5, 3683.0, 7110.2, 3604.9, 6490.7, 16233.0, …\n$ Pop_T        &lt;dbl&gt; 528.3, 804.6, 251.8, 832.5, 409.3, 600.5, 1285.5, 1186.5,…\n$ Agri         &lt;dbl&gt; 4524.410, 6545.350, 2562.460, 7562.340, 3583.910, 5266.51…\n$ Service      &lt;dbl&gt; 14100.0, 17727.0, 7525.0, 53160.0, 7031.0, 6981.0, 26617.…\n$ Disp_Inc     &lt;dbl&gt; 16610, 18925, 19498, 18985, 18604, 19275, 27345, 24020, 2…\n$ RORP         &lt;dbl&gt; 0.6549309, 0.6875466, 0.3669579, 0.6482883, 0.6024921, 0.…\n$ ROREmp       &lt;dbl&gt; 0.8041262, 0.8511756, 0.6686757, 0.8312558, 0.8856065, 0.…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((22320.48 3301894,..., POLYGON ((35522.9…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-hcsa",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#visualising-hcsa",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.3 Visualising HCSA",
    "text": "5.3 Visualising HCSA\n\n5.3.1 Mapping Gi* with fixed distance weights\n\n\nShow code\ntm_shape(HCSA_fdw) +\n  tm_fill(\"gi_star\",\n          style = \"pretty\",\n          palette = \"-RdBu\",\n          midpoint = NA) +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Gi* of GDPPC (Fixed Distance)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n5.3.2 Mapping local Gi* p-values\n\n\nShow code\ntm_shape(HCSA_fdw) +\n  tm_fill(\"p_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\",\n          title = \"p-value\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values of Local Gi* (Fixed Distance)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n5.3.3 Mapping both Gi* values and p-values\n\n\nShow code\nGi_star_map &lt;- tm_shape(HCSA_fdw) +\n  tm_fill(\"gi_star\",\n          style = \"pretty\",\n          n = 5,\n          palette = \"-RdBu\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Gi*\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\np_values_map &lt;- tm_shape(HCSA_fdw) +\n  tm_fill(\"p_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n          palette = \"-Reds\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-values\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\ntmap_arrange(Gi_star_map, p_values_map, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n\n5.3.4 Preparing and plotting HCSA Map\nCreate a categorical variable for HCSA clusters:\n\n\nShow code\nHCSA_fdw &lt;- HCSA_fdw %&gt;%\n  mutate(HCSA_cluster = case_when(\n    p_sim &gt; 0.05 ~ \"Insignificant\",\n    p_sim &lt;= 0.05 & gi_star &gt; 0 ~ \"Hot spot\",\n    p_sim &lt;= 0.05 & gi_star &lt; 0 ~ \"Cold spot\",\n    TRUE ~ \"Other\"\n  ),\n  HCSA_cluster = factor(\n    HCSA_cluster,\n    levels = c(\"Insignificant\", \"Hot spot\", \"Cold spot\")\n  ))\n\n# Check the distribution\ntable(HCSA_fdw$HCSA_cluster)\n\n\n\nInsignificant      Hot spot     Cold spot \n           77             7             4 \n\n\nNow plot the HCSA map:\n\n\nShow code\nHCSA_map &lt;- tm_shape(HCSA_fdw) +\n  tm_polygons(\n    \"HCSA_cluster\",\n    palette = c(\"grey80\",    # Insignificant\n                \"red\",       # Hot spot\n                \"blue\"),     # Cold spot\n    title = \"HCSA Cluster\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"HCSA Clusters (p &lt; 0.05)\",\n            main.title.size = 1.2,\n            main.title.fontface = \"bold\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha = 0.2)\n\nHCSA_map\n\n\n\n\n\n\n\n\n\n\n\n5.3.5 Combined visualization\n\n\nShow code\ntmap_arrange(Gi_star_map, HCSA_map, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#comparison-fixed-vs-adaptive-distance-weights",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#comparison-fixed-vs-adaptive-distance-weights",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "5.4 Comparison: Fixed vs Adaptive Distance Weights",
    "text": "5.4 Comparison: Fixed vs Adaptive Distance Weights\nLet’s compare the results from fixed and adaptive distance weights:\n\n\nShow code\n# Prepare HCSA clusters for adaptive weights\nHCSA_adw &lt;- HCSA_adw %&gt;%\n  mutate(HCSA_cluster = case_when(\n    p_sim &gt; 0.05 ~ \"Insignificant\",\n    p_sim &lt;= 0.05 & gi_star &gt; 0 ~ \"Hot spot\",\n    p_sim &lt;= 0.05 & gi_star &lt; 0 ~ \"Cold spot\",\n    TRUE ~ \"Other\"\n  ),\n  HCSA_cluster = factor(\n    HCSA_cluster,\n    levels = c(\"Insignificant\", \"Hot spot\", \"Cold spot\")\n  ))\n\n\n\n\nShow code\nHCSA_fixed &lt;- tm_shape(HCSA_fdw) +\n  tm_polygons(\"HCSA_cluster\",\n              palette = c(\"grey80\", \"red\", \"blue\"),\n              title = \"HCSA\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Fixed Distance (62km)\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\nHCSA_adaptive &lt;- tm_shape(HCSA_adw) +\n  tm_polygons(\"HCSA_cluster\",\n              palette = c(\"grey80\", \"red\", \"blue\"),\n              title = \"HCSA\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Adaptive Distance (k=8)\",\n            legend.height = 0.45,\n            legend.width = 0.35,\n            frame = TRUE)\n\ntmap_arrange(HCSA_fixed, HCSA_adaptive, asp = 1, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#lisa-analysis-results",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#lisa-analysis-results",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "6.1 LISA Analysis Results",
    "text": "6.1 LISA Analysis Results\n\nIdentified local clusters and outliers using Local Moran’s I:\n\nHigh-High clusters: Counties with high GDPPC surrounded by high GDPPC neighbors\nLow-Low clusters: Counties with low GDPPC surrounded by low GDPPC neighbors\nSpatial outliers: High-Low and Low-High patterns\n\nVisualized spatial relationships through:\n\nMoran scatterplots showing the relationship between values and their spatial lags\nLISA cluster maps highlighting significant local patterns"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#hcsa-analysis-results",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#hcsa-analysis-results",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "6.2 HCSA Analysis Results",
    "text": "6.2 HCSA Analysis Results\n\nDetected hot spots and cold spots using Getis-Ord Gi* statistics:\n\nHot spots: Significant clusters of high GDPPC values\nCold spots: Significant clusters of low GDPPC values\n\nCompared different spatial weight schemes:\n\nFixed distance weights (62km threshold)\nAdaptive distance weights (k=8 nearest neighbors)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex05/ex05b.html#key-findings",
    "href": "Hands-on_Ex/Hands-on_ex05/ex05b.html#key-findings",
    "title": "Hands-on Exercise 05b: Local Measures of Spatial Autocorrelation",
    "section": "6.3 Key Findings",
    "text": "6.3 Key Findings\n\nEconomic development in Hunan Province shows clear spatial clustering\nHot spots (high GDPPC clusters) are concentrated in specific regions\nCold spots (low GDPPC clusters) indicate areas needing development attention\nThe choice of spatial weights (fixed vs adaptive) can influence the detection of clusters\n\nThese local measures complement the global measures from Exercise 05a by showing where the spatial clustering occurs, providing actionable insights for policy makers and planners."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "",
    "text": "Geographically Weighted Regression (GWR) is a spatial statistical technique that recognizes that traditional “global” regression models may be limited when spatial processes vary across a study area. In this hands-on exercise, we will learn how to build hedonic pricing models using GWR methods to examine the relationships between condo selling prices and various structural and locational characteristics in Singapore.\n\n\nBy the end of this session, you will be able to:\n\nBuild hedonic pricing models using OLS and GWR methods\nCalibrate GWR models using fixed and adaptive bandwidths\nVisualize and interpret GWR outputs\nCompare global and local regression models"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#overview",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "",
    "text": "Geographically Weighted Regression (GWR) is a spatial statistical technique that recognizes that traditional “global” regression models may be limited when spatial processes vary across a study area. In this hands-on exercise, we will learn how to build hedonic pricing models using GWR methods to examine the relationships between condo selling prices and various structural and locational characteristics in Singapore.\n\n\nBy the end of this session, you will be able to:\n\nBuild hedonic pricing models using OLS and GWR methods\nCalibrate GWR models using fixed and adaptive bandwidths\nVisualize and interpret GWR outputs\nCompare global and local regression models"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#the-data",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#the-data",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "2. The Data",
    "text": "2. The Data\nTwo datasets will be used:\n\nURA Master Plan 2014 subzone boundaries (geospatial)\nCondo resale prices 2015 (aspatial)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#getting-started",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "3. Getting Started",
    "text": "3. Getting Started\n\n3.1 Loading Required Packages\n\npacman::p_load(sf, tidyverse, tmap, spdep, GWmodel, \n               ggpubr, corrplot, plotly, \n               olsrr, devtools, parallel)\n\n\n\n3.2 Importing Geospatial Data\n\n# Read Master Plan 2014 Subzone Boundary\nmpsz &lt;- st_read(dsn = \"data/geospatial\", \n                layer = \"MP14_SUBZONE_WEB_PL\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)  # SVY21\n\n# Check the data\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#importing-and-preparing-aspatial-data",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#importing-and-preparing-aspatial-data",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "4. Importing and Preparing Aspatial Data",
    "text": "4. Importing and Preparing Aspatial Data\n\n4.1 Import Condo Resale Data\n\n# Read condo resale data\ncondo_resale &lt;- read_csv(\"data/aspatial/Condo_resale_2015.csv\",\n                         show_col_types = FALSE)\n\n# Check data structure\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n# Check variable names and fix case sensitivity issues\nnames(condo_resale)\n\n [1] \"LATITUDE\"             \"LONGITUDE\"            \"POSTCODE\"            \n [4] \"SELLING_PRICE\"        \"AREA_SQM\"             \"AGE\"                 \n [7] \"PROX_CBD\"             \"PROX_CHILDCARE\"       \"PROX_ELDERLYCARE\"    \n[10] \"PROX_URA_GROWTH_AREA\" \"PROX_HAWKER_MARKET\"   \"PROX_KINDERGARTEN\"   \n[13] \"PROX_MRT\"             \"PROX_PARK\"            \"PROX_PRIMARY_SCH\"    \n[16] \"PROX_TOP_PRIMARY_SCH\" \"PROX_SHOPPING_MALL\"   \"PROX_SUPERMARKET\"    \n[19] \"PROX_BUS_STOP\"        \"NO_Of_UNITS\"          \"FAMILY_FRIENDLY\"     \n[22] \"FREEHOLD\"             \"LEASEHOLD_99YR\"      \n\n# Standardize variable names if needed\nif(\"NO_Of_UNITS\" %in% names(condo_resale)) {\n  condo_resale &lt;- condo_resale %&gt;%\n    rename(NO_OF_UNITS = NO_Of_UNITS)\n}\n\n# Summary statistics\nsummary(condo_resale)\n\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05352   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_OF_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151711   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n\n\n\n\n4.2 Data Preprocessing\n\n# Function to convert factor/character to 0/1\nto01 &lt;- function(x) as.numeric(as.factor(x)) - 1\n\n# Convert binary variables to numeric if they aren't already\ncondo_resale &lt;- condo_resale %&gt;%\n  mutate(\n    FREEHOLD = if(is.numeric(FREEHOLD)) FREEHOLD else to01(FREEHOLD),\n    FAMILY_FRIENDLY = if(is.numeric(FAMILY_FRIENDLY)) FAMILY_FRIENDLY else to01(FAMILY_FRIENDLY),\n    LEASEHOLD_99YR = if(exists(\"LEASEHOLD_99YR\") && !is.numeric(LEASEHOLD_99YR)) to01(LEASEHOLD_99YR) else LEASEHOLD_99YR\n  )\n\n# Check for required variables\nrequired_vars &lt;- c(\"SELLING_PRICE\", \"AREA_SQM\", \"AGE\", \"PROX_CBD\", \"PROX_MRT\")\nstopifnot(all(required_vars %in% names(condo_resale)))\n\n# Remove rows with NA values in key variables\ncondo_resale &lt;- condo_resale %&gt;%\n  drop_na(SELLING_PRICE, AREA_SQM, AGE)\n\n\n\n4.3 Convert Aspatial Data to sf Object\n\n# Convert to sf object using coordinates\ncondo_resale_sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs = 4326) %&gt;%\n  st_transform(crs = 3414)\n\n# Check the result\nhead(condo_resale_sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_OF_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#exploratory-data-analysis",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#exploratory-data-analysis",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "5. Exploratory Data Analysis",
    "text": "5. Exploratory Data Analysis\n\n5.1 Distribution of Selling Prices\n\n# Histogram of selling price\np1 &lt;- ggplot(data = condo_resale, aes(x = SELLING_PRICE)) +\n  geom_histogram(bins = 20, fill = \"lightblue\", color = \"black\") +\n  labs(title = \"Distribution of Selling Prices\",\n       x = \"Selling Price ($)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\n# Log-transformed selling price\np2 &lt;- ggplot(data = condo_resale, \n             aes(x = log(SELLING_PRICE))) +\n  geom_histogram(bins = 20, fill = \"lightgreen\", color = \"black\") +\n  labs(title = \"Distribution of Log Selling Prices\",\n       x = \"Log(Selling Price)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\nggarrange(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n5.2 Geographic Distribution of Condo Sales\n\n# Use plot mode for better performance\ntmap_mode(\"plot\")\n\ntm_shape(mpsz) +\n  tm_polygons(alpha = 0.3) +\ntm_shape(condo_resale_sf) +\n  tm_dots(col = \"SELLING_PRICE\",\n          size = 0.02,  # Reduced size for better visibility\n          border.col = \"black\",\n          border.lwd = 0.5,\n          style = \"quantile\",\n          palette = \"YlOrRd\",\n          title = \"Selling Price\") +\n  tm_layout(main.title = \"Geographic Distribution of Condo Sales\",\n            main.title.size = 1.2)\n\n\n\n\n\n\n\n\n\n\n5.3 Statistical Summary by Variables\n\n# Summary of key variables\ncondo_resale %&gt;%\n  select(SELLING_PRICE, AREA_SQM, AGE, PROX_CBD, \n         PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_MRT,\n         PROX_SHOPPING_MALL, NO_OF_UNITS) %&gt;%\n  summary()\n\n SELLING_PRICE         AREA_SQM          AGE           PROX_CBD      \n Min.   :  540000   Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869  \n 1st Qu.: 1100000   1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574  \n Median : 1383222   Median :121.0   Median :11.00   Median : 9.3567  \n Mean   : 1751211   Mean   :136.5   Mean   :12.14   Mean   : 9.3254  \n 3rd Qu.: 1950000   3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661  \n Max.   :18000000   Max.   :619.0   Max.   :37.00   Max.   :19.1804  \n PROX_CHILDCARE     PROX_ELDERLYCARE     PROX_MRT       PROX_SHOPPING_MALL\n Min.   :0.004927   Min.   :0.05451   Min.   :0.05278   Min.   :0.0000    \n 1st Qu.:0.174481   1st Qu.:0.61254   1st Qu.:0.34646   1st Qu.:0.5258    \n Median :0.258135   Median :0.94179   Median :0.57430   Median :0.9357    \n Mean   :0.326313   Mean   :1.05352   Mean   :0.67316   Mean   :1.0455    \n 3rd Qu.:0.368293   3rd Qu.:1.35122   3rd Qu.:0.84844   3rd Qu.:1.3994    \n Max.   :3.465726   Max.   :3.94916   Max.   :3.48037   Max.   :3.4774    \n  NO_OF_UNITS    \n Min.   :  18.0  \n 1st Qu.: 188.8  \n Median : 360.0  \n Mean   : 409.2  \n 3rd Qu.: 590.0  \n Max.   :1703.0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-model-using-ols",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-model-using-ols",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "6. Building Hedonic Pricing Model using OLS",
    "text": "6. Building Hedonic Pricing Model using OLS\n\n6.1 Simple Linear Regression\n\n# Build simple OLS model with AREA_SQM\ncondo_ols_simple &lt;- lm(SELLING_PRICE ~ AREA_SQM, \n                       data = condo_resale)\nsummary(condo_ols_simple)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n# Visualize the relationship\nggplot(condo_resale, aes(x = AREA_SQM, y = SELLING_PRICE)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", col = \"red\") +\n  labs(title = \"Selling Price vs Floor Area\",\n       x = \"Floor Area (sqm)\",\n       y = \"Selling Price ($)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n6.2 Multiple Linear Regression\n\n# Build multiple regression model with all available variables\ncondo_mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n                  PROX_KINDERGARTEN + PROX_MRT + \n                  PROX_PARK + PROX_PRIMARY_SCH + PROX_TOP_PRIMARY_SCH + \n                  PROX_SHOPPING_MALL + PROX_SUPERMARKET + PROX_BUS_STOP +\n                  NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD + LEASEHOLD_99YR,\n                data = condo_resale)\n\nsummary(condo_mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD + \n    LEASEHOLD_99YR, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3471036  -286903   -22426   239412 12254549 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           543071.4   136210.9   3.987 7.03e-05 ***\nAREA_SQM               12688.7      370.1  34.283  &lt; 2e-16 ***\nAGE                   -24566.0     2766.0  -8.881  &lt; 2e-16 ***\nPROX_CBD              -78122.0     6791.4 -11.503  &lt; 2e-16 ***\nPROX_CHILDCARE       -333219.0   111020.3  -3.001 0.002734 ** \nPROX_ELDERLYCARE      170950.0    42110.8   4.060 5.19e-05 ***\nPROX_URA_GROWTH_AREA   38507.6    12523.7   3.075 0.002147 ** \nPROX_HAWKER_MARKET     23801.2    29299.9   0.812 0.416739    \nPROX_KINDERGARTEN     144098.0    82738.7   1.742 0.081795 .  \nPROX_MRT             -322775.9    58528.1  -5.515 4.14e-08 ***\nPROX_PARK             564487.9    66563.0   8.481  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      186170.5    65515.2   2.842 0.004553 ** \nPROX_TOP_PRIMARY_SCH    -477.1    20598.0  -0.023 0.981525    \nPROX_SHOPPING_MALL   -207721.5    42855.5  -4.847 1.39e-06 ***\nPROX_SUPERMARKET      -48074.7    77145.3  -0.623 0.533273    \nPROX_BUS_STOP         675755.0   138552.0   4.877 1.20e-06 ***\nNO_OF_UNITS             -216.2       90.3  -2.394 0.016797 *  \nFAMILY_FRIENDLY       142128.3    47055.1   3.020 0.002569 ** \nFREEHOLD              300646.5    77296.5   3.890 0.000105 ***\nLEASEHOLD_99YR        -77137.4    77570.9  -0.994 0.320192    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1416 degrees of freedom\nMultiple R-squared:  0.652, Adjusted R-squared:  0.6474 \nF-statistic: 139.6 on 19 and 1416 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n6.3 Check for Multicollinearity\n\n# Prepare numeric data without NA values\nnum_df &lt;- condo_resale %&gt;%\n  select(-LATITUDE, -LONGITUDE, -POSTCODE) %&gt;%\n  select(where(is.numeric)) %&gt;%\n  drop_na()\n\n# Calculate correlation matrix\ncor_matrix &lt;- cor(num_df)\n\n# Plot correlation matrix\ncorrplot(cor_matrix, \n         method = \"circle\", \n         type = \"upper\",\n         diag = FALSE,\n         order = \"hclust\",\n         tl.cex = 0.7,\n         tl.col = \"black\",\n         tl.srt = 45,\n         title = \"Correlation Matrix\")\n\n\n\n\n\n\n\n# VIF check using olsrr\nols_vif_tol(condo_mlr)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8601326 1.162611\n2                   AGE 0.7011585 1.426211\n3              PROX_CBD 0.4575471 2.185567\n4        PROX_CHILDCARE 0.2898233 3.450378\n5      PROX_ELDERLYCARE 0.5922238 1.688551\n6  PROX_URA_GROWTH_AREA 0.6614081 1.511926\n7    PROX_HAWKER_MARKET 0.4373874 2.286303\n8     PROX_KINDERGARTEN 0.8356793 1.196631\n9              PROX_MRT 0.4949877 2.020252\n10            PROX_PARK 0.8015728 1.247547\n11     PROX_PRIMARY_SCH 0.3823248 2.615577\n12 PROX_TOP_PRIMARY_SCH 0.4878620 2.049760\n13   PROX_SHOPPING_MALL 0.4903052 2.039546\n14     PROX_SUPERMARKET 0.6142127 1.628100\n15        PROX_BUS_STOP 0.3311024 3.020213\n16          NO_OF_UNITS 0.6543336 1.528272\n17      FAMILY_FRIENDLY 0.7191719 1.390488\n18             FREEHOLD 0.2728521 3.664990\n19       LEASEHOLD_99YR 0.2645988 3.779307\n\n\n\n\n6.4 Revised Model (Removing Multicollinear Variables)\n\n# Build revised model excluding highly correlated variables\ncondo_mlr2 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n                   PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n                   FREEHOLD,\n                 data = condo_resale)\n\nsummary(condo_mlr2)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n    PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_OF_UNITS + \n    FAMILY_FRIENDLY + FREEHOLD, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\nAREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\nAGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\nPROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\nPROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \nPROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\nPROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\nPROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\nPROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \nPROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\nPROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\nNO_OF_UNITS             -245.48      87.95  -2.791 0.005321 ** \nFAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \nFREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 756000 on 1421 degrees of freedom\nMultiple R-squared:  0.6507,    Adjusted R-squared:  0.6472 \nF-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16\n\nols_vif_tol(condo_mlr2)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_OF_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\n\n\n6.5 Model Diagnostics\n\n# Diagnostic plots\npar(mfrow = c(2, 2))\nplot(condo_mlr2)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Additional diagnostic tests\n# Normality test\nols_test_normality(condo_mlr2)\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n# Breusch-Pagan test for heteroscedasticity\nols_test_breusch_pagan(condo_mlr2)\n\n\n Breusch Pagan Test for Heteroskedasticity\n -----------------------------------------\n Ho: the variance is constant            \n Ha: the variance is not constant        \n\n                  Data                    \n -----------------------------------------\n Response : SELLING_PRICE \n Variables: fitted values of SELLING_PRICE \n\n        Test Summary         \n ----------------------------\n DF            =    1 \n Chi2          =    4573.0707 \n Prob &gt; Chi2   =    0.0000"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#test-for-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#test-for-spatial-autocorrelation",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "7. Test for Spatial Autocorrelation",
    "text": "7. Test for Spatial Autocorrelation\n\n7.1 Prepare Spatial Data\n\n# Extract residuals\nmlr_residuals &lt;- residuals(condo_mlr2)\ncondo_resale$mlr_residuals &lt;- mlr_residuals\n\n# Add residuals to sf object\ncondo_resale_sf$mlr_residuals &lt;- mlr_residuals\n\n# Convert to sp object for GWmodel\ncondo_resale_sp &lt;- as(condo_resale_sf, \"Spatial\")\ncondo_resale_sp@data$mlr_residuals &lt;- mlr_residuals\n\n\n\n7.2 Visualize Residuals\n\n# Map residuals\ntmap_mode(\"plot\")\ntm_shape(mpsz) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale_sf) +\n  tm_dots(col = \"mlr_residuals\",\n          size = 0.01,  # Further reduced size\n          style = \"quantile\",\n          palette = \"-RdBu\",\n          title = \"MLR Residuals\") +\n  tm_layout(main.title = \"Spatial Distribution of OLS Residuals\",\n            main.title.size = 1.2)\n\n\n\n\n\n\n\n\n\n\n7.3 Moran’s I Test\n\n# Create neighbors\ncoords &lt;- st_coordinates(condo_resale_sf)\nknn_nb &lt;- knn2nb(knearneigh(coords, k = 8))\nknn_listw &lt;- nb2listw(knn_nb, style = \"W\")\n\n# Moran's I test on residuals\nmoran.test(mlr_residuals, knn_listw)\n\n\n    Moran I test under randomisation\n\ndata:  mlr_residuals  \nweights: knn_listw    \n\nMoran I statistic standard deviate = 25.806, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.3098623365     -0.0006968641      0.0001448283 \n\n# Moran scatterplot\nmoran.plot(mlr_residuals, knn_listw,\n           main = \"Moran Scatterplot of OLS Residuals\",\n           xlab = \"Residuals\",\n           ylab = \"Spatially Lagged Residuals\",\n           labels = FALSE, \n           quiet = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-models-using-gwr",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-models-using-gwr",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "8. Building Hedonic Pricing Models using GWR",
    "text": "8. Building Hedonic Pricing Models using GWR\n\n8.1 Adaptive Bandwidth GWR with Optimization\n\n# Check for cache file\ncache_file &lt;- \"gwr_cache.rds\"\n\nif(file.exists(cache_file)){\n  cat(\"Loading cached GWR results...\\n\")\n  gwc &lt;- readRDS(cache_file)\n  bw_adaptive &lt;- gwc$bw\n  gwr_adaptive &lt;- gwc$gwr\n  cat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n} else {\n  cat(\"Calculating optimal bandwidth (this may take a few minutes)...\\n\")\n  \n  # Determine optimal adaptive bandwidth using AICc with parallel processing\n  bw_adaptive &lt;- bw.gwr(\n    formula = SELLING_PRICE ~ AREA_SQM + AGE + \n              PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n              PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n              PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n              PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n              FREEHOLD,\n    data = condo_resale_sp,\n    approach = \"AICc\",       # Use AICc for small sample correction\n    kernel = \"bisquare\",     # Bisquare kernel for adaptive bandwidth\n    adaptive = TRUE,\n    longlat = FALSE,\n    parallel.method = \"omp\", # Enable parallel processing\n    parallel.arg = max(1, parallel::detectCores() - 1)\n  )\n  \n  cat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n  \n  # Calibrate adaptive GWR model\n  cat(\"Calibrating GWR model...\\n\")\n  gwr_adaptive &lt;- gwr.basic(\n    formula = SELLING_PRICE ~ AREA_SQM + AGE + \n              PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n              PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n              PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n              PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n              FREEHOLD,\n    data = condo_resale_sp,\n    bw = bw_adaptive,\n    kernel = \"bisquare\",\n    adaptive = TRUE,\n    longlat = FALSE\n  )\n  \n  # Save to cache\n  saveRDS(list(bw = bw_adaptive, gwr = gwr_adaptive), cache_file)\n  cat(\"Results cached for future use.\\n\")\n}\n\nLoading cached GWR results...\nOptimal adaptive bandwidth: 84 neighbors\n\n# Display model results\ngwr_adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2025-11-08 02:23:00.479815 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale_sp, bw = bw_adaptive, kernel = \"bisquare\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_OF_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_OF_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: bisquare \n   Adaptive bandwidth: 84 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5398e+07 -1.1560e+06  6.8662e+05  2.4084e+06\n   AREA_SQM              2.5627e+03  5.5805e+03  7.3041e+03  1.1216e+04\n   AGE                  -1.6687e+05 -2.0869e+04 -1.0666e+04 -3.8618e+03\n   PROX_CBD             -1.4632e+07 -3.2429e+05 -5.1360e+04  2.2112e+05\n   PROX_CHILDCARE       -3.4212e+06 -4.7125e+05 -6.7941e+04  3.6997e+05\n   PROX_ELDERLYCARE     -3.6267e+06 -2.3989e+05  3.3240e+04  3.3964e+05\n   PROX_URA_GROWTH_AREA -6.1100e+07 -9.6781e+04  1.3331e+05  4.2131e+05\n   PROX_MRT             -6.4860e+06 -6.1694e+05 -1.3437e+05  1.3506e+05\n   PROX_PARK            -3.6830e+06 -2.5607e+05  3.7533e+04  3.8025e+05\n   PROX_PRIMARY_SCH     -2.1930e+06 -3.6164e+05 -6.3626e+04  2.4156e+05\n   PROX_SHOPPING_MALL   -2.0284e+06 -1.7434e+05  4.6397e+04  4.1171e+05\n   PROX_BUS_STOP        -5.2211e+06 -3.3468e+05  2.8355e+05  1.0325e+06\n   NO_OF_UNITS          -5.4491e+03 -2.5148e+02  6.6151e+00  2.9492e+02\n   FAMILY_FRIENDLY      -9.7656e+05 -8.7245e+04  8.7541e+03  1.4713e+05\n   FREEHOLD             -9.9036e+05 -1.6249e+04  1.0203e+05  3.3881e+05\n                              Max.\n   Intercept            58509448.1\n   AREA_SQM                25681.7\n   AGE                     43602.6\n   PROX_CBD             61068846.4\n   PROX_CHILDCARE        4619480.5\n   PROX_ELDERLYCARE      7712244.1\n   PROX_URA_GROWTH_AREA 17914463.2\n   PROX_MRT              2069561.2\n   PROX_PARK             4068834.5\n   PROX_PRIMARY_SCH      5912050.6\n   PROX_SHOPPING_MALL    2944099.7\n   PROX_BUS_STOP        15313047.4\n   NO_OF_UNITS              2425.1\n   FAMILY_FRIENDLY       3852139.1\n   FREEHOLD              2690147.6\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 468.9826 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 967.0174 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41712.41 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 40971.7 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42101.93 \n   Residual sum of squares: 1.556343e+14 \n   R-square value:  0.9330503 \n   Adjusted R-square value:  0.9005476 \n\n   ***********************************************************************\n   Program stops at: 2025-11-08 02:23:01.100378"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#visualizing-gwr-results",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#visualizing-gwr-results",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "9. Visualizing GWR Results",
    "text": "9. Visualizing GWR Results\n\n9.1 Extract GWR Results (Robust Method)\n\n# Extract GWR results dataframe\ngdf &lt;- gwr_adaptive$SDF@data\n\n# Define coefficient names\ncoef_names &lt;- c(\"Intercept\", \"AREA_SQM\", \"AGE\", \"PROX_CBD\", \n                \"PROX_CHILDCARE\", \"PROX_ELDERLYCARE\",\n                \"PROX_URA_GROWTH_AREA\", \"PROX_MRT\", \"PROX_PARK\",\n                \"PROX_PRIMARY_SCH\", \"PROX_SHOPPING_MALL\",\n                \"PROX_BUS_STOP\", \"NO_OF_UNITS\", \"FAMILY_FRIENDLY\",\n                \"FREEHOLD\")\n\n# Extract coefficients using column names\nfor(nm in coef_names){\n  if(nm %in% names(gdf)) {\n    condo_resale_sf[[paste0(\"gwr_\", nm)]] &lt;- gdf[[nm]]\n  }\n}\n\n# Extract Local R2, fitted values, and residuals (fixed column names)\nif(\"Local_R2\" %in% names(gdf)) condo_resale_sf$gwr_localR2 &lt;- gdf$Local_R2\nif(\"yhat\" %in% names(gdf)) condo_resale_sf$gwr_yhat &lt;- gdf$yhat\nif(\"residual\" %in% names(gdf)) condo_resale_sf$gwr_residual &lt;- gdf$residual\n\n# Extract standard errors using pattern matching\nse_cols &lt;- grep(\"\\\\.SE$|_SE$\", names(gdf), value = TRUE)\nfor(nm in coef_names){\n  se_nm &lt;- se_cols[grepl(nm, se_cols)]\n  if(length(se_nm) &gt; 0) {\n    condo_resale_sf[[paste0(\"gwr_SE_\", nm)]] &lt;- gdf[[se_nm[1]]]\n  }\n}\n\n# Extract t-values using pattern matching\ntv_cols &lt;- grep(\"\\\\.TV$|_TV$\", names(gdf), value = TRUE)\nfor(nm in coef_names){\n  tv_nm &lt;- tv_cols[grepl(nm, tv_cols)]\n  if(length(tv_nm) &gt; 0) {\n    condo_resale_sf[[paste0(\"gwr_TV_\", nm)]] &lt;- gdf[[tv_nm[1]]]\n  }\n}\n\n# Verify extraction\ncat(\"✓ GWR results successfully extracted\\n\")\n\n✓ GWR results successfully extracted\n\ncat(\"Number of observations:\", nrow(condo_resale_sf), \"\\n\")\n\nNumber of observations: 1436 \n\ncat(\"\\nLocal R² Summary:\\n\")\n\n\nLocal R² Summary:\n\nsummary(condo_resale_sf$gwr_localR2)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.6141  0.9008  0.9370  0.9229  0.9711  0.9957 \n\n\n\n\n9.2 Visualize Local R-squared\n\ntmap_mode(\"plot\")\n\n# Create Local R² map\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\", \n              border.col = \"grey60\",\n              lwd = 0.5) +\ntm_shape(condo_resale_sf) +\n  tm_dots(\"gwr_localR2\",\n          size = 0.02,\n          border.col = \"black\",\n          border.lwd = 0.3,\n          style = \"quantile\",\n          n = 5,\n          palette = \"RdPu\",\n          title = \"Local R²\") +\n  tm_layout(main.title = \"GWR Local R-squared Values\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\n\n\n# Print statistics\ncat(\"\\nLocal R² Statistics:\\n\")\n\n\nLocal R² Statistics:\n\ncat(\"Minimum:\", round(min(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMinimum: 0.614 \n\ncat(\"Maximum:\", round(max(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMaximum: 0.996 \n\ncat(\"Mean:\", round(mean(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean: 0.923 \n\ncat(\"Median:\", round(median(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMedian: 0.937 \n\n\n\n\n9.3 Visualize Coefficient Estimates\n\n# Create maps for key coefficients\ntm1 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_AREA_SQM\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"Area Coefficient\") +\n       tm_layout(main.title = \"AREA_SQM\", main.title.size = 0.8)\n\ntm2 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_AGE\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"Age Coefficient\") +\n       tm_layout(main.title = \"AGE\", main.title.size = 0.8)\n\ntm3 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_PROX_CBD\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"CBD Distance\") +\n       tm_layout(main.title = \"PROX_CBD\", main.title.size = 0.8)\n\ntm4 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_PROX_MRT\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"MRT Distance\") +\n       tm_layout(main.title = \"PROX_MRT\", main.title.size = 0.8)\n\ntmap_arrange(tm1, tm2, tm3, tm4, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n9.4 Visualize GWR Residuals\n\n# Compare OLS and GWR residuals\ntm_ols &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n          tm_shape(condo_resale_sf) +\n          tm_dots(col = \"mlr_residuals\", size = 0.01,\n                  style = \"quantile\", palette = \"-RdBu\",\n                  title = \"Residuals\") +\n          tm_layout(main.title = \"OLS Residuals\",\n                    main.title.size = 0.9)\n\ntm_gwr &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n          tm_shape(condo_resale_sf) +\n          tm_dots(col = \"gwr_residual\", size = 0.01,\n                  style = \"quantile\", palette = \"-RdBu\",\n                  title = \"Residuals\") +\n          tm_layout(main.title = \"GWR Residuals\",\n                    main.title.size = 0.9)\n\ntmap_arrange(tm_ols, tm_gwr, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#model-comparison-and-evaluation",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#model-comparison-and-evaluation",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "10. Model Comparison and Evaluation",
    "text": "10. Model Comparison and Evaluation\n\n10.1 Compare Model Performance\n\n# Create comparison table\nmodel_comparison &lt;- data.frame(\n  Model = c(\"OLS\", \"GWR Adaptive\"),\n  AICc = c(AIC(condo_mlr2), \n          gwr_adaptive$GW.diagnostic$AICc),\n  Adj_R2 = c(summary(condo_mlr2)$adj.r.squared,\n             gwr_adaptive$GW.diagnostic$R2.adj),\n  RSS = c(sum(residuals(condo_mlr2)^2),\n          gwr_adaptive$GW.diagnostic$RSS.gw)\n)\n\nknitr::kable(model_comparison,\n             caption = \"Model Performance Comparison\",\n             digits = 3)\n\n\nModel Performance Comparison\n\n\nModel\nAICc\nAdj_R2\nRSS\n\n\n\n\nOLS\n42966.76\n0.647\n8.120609e+14\n\n\nGWR Adaptive\n41712.41\n0.647\n1.556343e+14\n\n\n\n\n\n\n\n10.2 Statistical Test for Spatial Variability\n\n# Test for spatial non-stationarity\n# Calculate t-statistics\nt_stats &lt;- data.frame(\n  Variable = coef_names,\n  Min_t = NA,\n  Q1_t = NA,\n  Median_t = NA,\n  Q3_t = NA,\n  Max_t = NA,\n  Pct_Significant = NA\n)\n\nfor(i in 1:length(coef_names)) {\n  coef_col &lt;- paste0(\"gwr_\", coef_names[i])\n  se_col &lt;- paste0(\"gwr_SE_\", coef_names[i])\n  \n  if(coef_col %in% names(condo_resale_sf) && se_col %in% names(condo_resale_sf)) {\n    t_values &lt;- condo_resale_sf[[coef_col]] / condo_resale_sf[[se_col]]\n    \n    t_stats$Min_t[i] &lt;- min(t_values, na.rm = TRUE)\n    t_stats$Q1_t[i] &lt;- quantile(t_values, 0.25, na.rm = TRUE)\n    t_stats$Median_t[i] &lt;- median(t_values, na.rm = TRUE)\n    t_stats$Q3_t[i] &lt;- quantile(t_values, 0.75, na.rm = TRUE)\n    t_stats$Max_t[i] &lt;- max(t_values, na.rm = TRUE)\n    t_stats$Pct_Significant[i] &lt;- sum(abs(t_values) &gt; 1.96, na.rm = TRUE) / \n                                   sum(!is.na(t_values)) * 100\n  }\n}\n\nknitr::kable(t_stats,\n             caption = \"Summary of t-statistics and % Significant\",\n             digits = 2)\n\n\nSummary of t-statistics and % Significant\n\n\n\n\n\n\n\n\n\n\n\nVariable\nMin_t\nQ1_t\nMedian_t\nQ3_t\nMax_t\nPct_Significant\n\n\n\n\nIntercept\n-7.58\n-0.33\n0.23\n0.84\n7.38\n11.70\n\n\nAREA_SQM\n0.90\n2.87\n4.92\n8.57\n32.65\n92.27\n\n\nAGE\n-17.67\n-1.69\n-0.72\n-0.24\n2.26\n22.35\n\n\nPROX_CBD\n-6.46\n-0.78\n-0.21\n0.37\n8.12\n14.35\n\n\nPROX_CHILDCARE\n-4.35\n-0.52\n-0.07\n0.47\n7.26\n10.38\n\n\nPROX_ELDERLYCARE\n-7.55\n-0.38\n0.07\n0.60\n12.67\n11.91\n\n\nPROX_URA_GROWTH_AREA\n-7.98\n-0.14\n0.41\n1.14\n5.65\n13.23\n\n\nPROX_MRT\n-11.97\n-1.06\n-0.22\n0.28\n3.74\n16.99\n\n\nPROX_PARK\n-4.48\n-0.37\n0.05\n0.58\n7.35\n12.40\n\n\nPROX_PRIMARY_SCH\n-4.23\n-0.60\n-0.13\n0.47\n12.09\n12.19\n\n\nPROX_SHOPPING_MALL\n-4.50\n-0.36\n0.08\n0.68\n3.86\n11.91\n\n\nPROX_BUS_STOP\n-4.54\n-0.22\n0.24\n1.09\n18.64\n19.50\n\n\nNO_OF_UNITS\n-6.28\n-0.52\n0.01\n0.48\n4.44\n11.77\n\n\nFAMILY_FRIENDLY\n-3.63\n-0.43\n0.03\n0.77\n21.87\n19.08\n\n\nFREEHOLD\n-1.46\n-0.06\n0.48\n1.55\n14.33\n16.09\n\n\n\n\n\n\n\n10.3 Residual Autocorrelation Test\n\n# Test GWR residuals for spatial autocorrelation\nmoran_gwr &lt;- moran.test(condo_resale_sf$gwr_residual, knn_listw)\nmoran_ols &lt;- moran.test(mlr_residuals, knn_listw)\n\n# Compare Moran's I\ncat(\"\\nComparison of Moran's I:\\n\")\n\n\nComparison of Moran's I:\n\ncat(\"OLS Residuals Moran's I:\", round(moran_ols$estimate[1], 4), \"\\n\")\n\nOLS Residuals Moran's I: 0.3099 \n\ncat(\"GWR Residuals Moran's I:\", round(moran_gwr$estimate[1], 4), \"\\n\")\n\nGWR Residuals Moran's I: -0.1053 \n\ncat(\"\\n\")\nprint(moran_gwr)\n\n\n    Moran I test under randomisation\n\ndata:  condo_resale_sf$gwr_residual  \nweights: knn_listw    \n\nMoran I statistic standard deviate = -8.5562, p-value = 1\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n    -0.1053491274     -0.0006968641      0.0001496017"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#key-findings-and-conclusions",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#key-findings-and-conclusions",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "11. Key Findings and Conclusions",
    "text": "11. Key Findings and Conclusions\n\n11.1 Summary of Results\n\n# Calculate improvement metrics\nr2_improvement &lt;- (gwr_adaptive$GW.diagnostic$R2.adj - \n                  summary(condo_mlr2)$adj.r.squared) / \n                  summary(condo_mlr2)$adj.r.squared * 100\n\naic_improvement &lt;- (AIC(condo_mlr2) - \n                   gwr_adaptive$GW.diagnostic$AICc) / \n                   AIC(condo_mlr2) * 100\n\ncat(\"Model Improvements (GWR vs OLS):\\n\")\n\nModel Improvements (GWR vs OLS):\n\ncat(\"--------------------------------\\n\")\n\n--------------------------------\n\ncat(\"Adjusted R² improvement:\", round(r2_improvement, 1), \"%\\n\")\n\nAdjusted R² improvement:  %\n\ncat(\"AICc improvement:\", round(aic_improvement, 1), \"%\\n\")\n\nAICc improvement: 2.9 %\n\ncat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n\nOptimal adaptive bandwidth: 84 neighbors\n\ncat(\"Mean Local R²:\", round(mean(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.923 \n\ncat(\"Range of Local R²:\", \n    round(min(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"-\",\n    round(max(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nRange of Local R²: 0.614 - 0.996 \n\n\n\n\n11.2 Spatial Pattern Summary\n\n# Identify areas with high and low local R²\nhigh_r2 &lt;- condo_resale_sf[condo_resale_sf$gwr_localR2 &gt; \n                           quantile(condo_resale_sf$gwr_localR2, 0.9, na.rm = TRUE), ]\nlow_r2 &lt;- condo_resale_sf[condo_resale_sf$gwr_localR2 &lt; \n                          quantile(condo_resale_sf$gwr_localR2, 0.1, na.rm = TRUE), ]\n\ncat(\"\\nAreas with High Model Performance (Top 10% Local R²):\\n\")\n\n\nAreas with High Model Performance (Top 10% Local R²):\n\ncat(\"Number of units:\", nrow(high_r2), \"\\n\")\n\nNumber of units: 144 \n\ncat(\"Mean Local R²:\", round(mean(high_r2$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.989 \n\ncat(\"Mean Selling Price:\", round(mean(high_r2$SELLING_PRICE, na.rm = TRUE)), \"\\n\")\n\nMean Selling Price: 1021523 \n\ncat(\"\\nAreas with Low Model Performance (Bottom 10% Local R²):\\n\")\n\n\nAreas with Low Model Performance (Bottom 10% Local R²):\n\ncat(\"Number of units:\", nrow(low_r2), \"\\n\")\n\nNumber of units: 144 \n\ncat(\"Mean Local R²:\", round(mean(low_r2$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.781 \n\ncat(\"Mean Selling Price:\", round(mean(low_r2$SELLING_PRICE, na.rm = TRUE)), \"\\n\")\n\nMean Selling Price: 2040447"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#conclusions",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "12. Conclusions",
    "text": "12. Conclusions\nThis analysis demonstrates the power of Geographically Weighted Regression in capturing spatial heterogeneity in housing prices:\n\nKey Findings:\n\nSpatial Non-stationarity: The relationships between condo prices and their predictors vary significantly across Singapore\nModel Performance: GWR provides substantial improvement over OLS regression in terms of both R² and AICc\nLocal Variations: Different factors influence prices differently in various parts of Singapore:\n\nCBD proximity matters more in certain areas\nMRT accessibility has varying importance\nAge depreciation effects differ spatially\n\nResidual Analysis: GWR successfully reduces spatial autocorrelation in residuals\n\n\n\nImplications:\n\nHousing valuation models should account for spatial variations\nPolicy interventions should consider local context\nReal estate investment strategies should be location-specific\n\n\n\nFuture Work:\n\nExplore temporal variations using panel GWR\nInclude more neighborhood characteristics\nTest alternative kernel functions and bandwidth selection methods\nConsider standardized variables for better interpretation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/data/geospatial/ELDERCARE.html",
    "href": "Hands-on_Ex/Hands-on_ex09/data/geospatial/ELDERCARE.html",
    "title": "ISSS626 Portfolio — HUANG PENGXIN",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;  ELDERCARE  ENG dataset\n\nELDERCARE\n\n                 0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "",
    "text": "Since the OD_Matrix.csv contains Origin-Destination cost data rather than property transaction data, this exercise will demonstrate: 1. Spatial accessibility analysis using the OD matrix 2. Creating synthetic property data for GWR demonstration 3. Applying GWR methods to understand spatial heterogeneity\n\n\nBy the end of this exercise, you will be able to: - Understand OD matrix applications in spatial analysis - Generate synthetic spatial data for modeling - Apply GWR methods to spatial data - Visualize spatial patterns and relationships"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#overview",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "",
    "text": "Since the OD_Matrix.csv contains Origin-Destination cost data rather than property transaction data, this exercise will demonstrate: 1. Spatial accessibility analysis using the OD matrix 2. Creating synthetic property data for GWR demonstration 3. Applying GWR methods to understand spatial heterogeneity\n\n\nBy the end of this exercise, you will be able to: - Understand OD matrix applications in spatial analysis - Generate synthetic spatial data for modeling - Apply GWR methods to spatial data - Visualize spatial patterns and relationships"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#the-data",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#the-data",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "2. The Data",
    "text": "2. The Data\nWe have the following datasets: 1. URA Master Plan 2014 subzone boundaries (MP14_SUBZONE_NO_SEA_PL) 2. Eldercare facilities (ELDERCARE) 3. OD Matrix - Origin-Destination cost matrix 4. Hexagon grid (hexagons) for visualization"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#getting-started",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "3. Getting Started",
    "text": "3. Getting Started\n\n3.1 Loading Required Packages\n\npacman::p_load(sf, tidyverse, tmap, spdep, GWmodel, \n               ggpubr, corrplot, plotly, gtsummary,\n               olsrr, devtools, parallel, readr)\n\n\n\n3.2 Setting Up the Environment\n\n# Set tmap mode to plot for better performance\ntmap_mode(\"plot\")\n\n# Set seed for reproducibility\nset.seed(12345)\n\n# Set up parallel processing\ncores &lt;- max(1, parallel::detectCores() - 1)\ncat(\"Number of cores available for parallel processing:\", cores, \"\\n\")\n\nNumber of cores available for parallel processing: 21"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-geospatial-data",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-geospatial-data",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "4. Import Geospatial Data",
    "text": "4. Import Geospatial Data\n\n4.1 Import Subzone Boundaries\n\n# Read Master Plan 2014 Subzone Boundary\nmpsz &lt;- st_read(dsn = \"data/geospatial\", \n                layer = \"MP14_SUBZONE_NO_SEA_PL\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\ncat(\"Number of subzones:\", nrow(mpsz), \"\\n\")\n\nNumber of subzones: 323 \n\n\n\n\n4.2 Import Eldercare Facilities\n\n# Read eldercare facilities\neldercare &lt;- st_read(dsn = \"data/geospatial\",\n                     layer = \"ELDERCARE\",\n                     quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\ncat(\"Number of eldercare facilities:\", nrow(eldercare), \"\\n\")\n\nNumber of eldercare facilities: 120 \n\n\n\n\n4.3 Import Hexagon Grid\n\n# Read hexagon grid\nhexagons &lt;- st_read(dsn = \"data/geospatial\",\n                    layer = \"hexagons\",\n                    quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\ncat(\"Number of hexagons:\", nrow(hexagons), \"\\n\")\n\nNumber of hexagons: 3125"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-and-analyze-od-matrix",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-and-analyze-od-matrix",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "5. Import and Analyze OD Matrix",
    "text": "5. Import and Analyze OD Matrix\n\n5.1 Import OD Matrix\n\n# Read OD Matrix\nod_data &lt;- read_csv(\"data/aspatial/OD_Matrix.csv\",\n                    show_col_types = FALSE)\n\n# Display structure\nglimpse(od_data)\n\nRows: 375,000\nColumns: 6\n$ origin_id      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ destination_id &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18,…\n$ entry_cost     &lt;dbl&gt; 667.9336, 667.9336, 667.9336, 667.9336, 667.9336, 667.9…\n$ network_cost   &lt;dbl&gt; 19846.87, 45026.76, 17644.17, 36009.56, 31068.09, 31194…\n$ exit_cost      &lt;dbl&gt; 47.64874, 31.87162, 173.47882, 92.19676, 64.62840, 117.…\n$ total_cost     &lt;dbl&gt; 20562.45, 45726.57, 18485.58, 36769.69, 31800.65, 31979…\n\n# Summary statistics\nsummary(od_data$total_cost)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   36.93 11675.78 17303.99 18355.00 23649.11 56350.82 \n\n\n\n\n5.2 Create Distance Matrix\n\n# Convert OD data to wide format distance matrix\ndistance_matrix &lt;- od_data %&gt;%\n  select(origin_id, destination_id, total_cost) %&gt;%\n  pivot_wider(names_from = destination_id,\n              values_from = total_cost,\n              names_prefix = \"dest_\")\n\ncat(\"Distance matrix dimensions:\", dim(distance_matrix), \"\\n\")\n\nDistance matrix dimensions: 3125 121 \n\n# Display first few rows and columns\ndistance_matrix[1:5, 1:6]\n\n# A tibble: 5 × 6\n  origin_id dest_1 dest_2 dest_3 dest_4 dest_5\n      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n1         1 20562. 45727. 18486. 36770. 31801.\n2         2 23069. 48233. 20992. 39276. 34307.\n3         3 23590. 48754. 21513. 39797. 34828.\n4         4 24069. 49233. 21992. 40276. 35307.\n5         5 24241. 49405. 22164. 40448. 35479.\n\n\n\n\n5.3 Analyze Accessibility to Eldercare\n\n# Calculate accessibility metrics\n# For demonstration, we'll use the first 120 destinations as eldercare locations\neldercare_ids &lt;- 1:min(120, max(od_data$destination_id))\n\naccessibility_eldercare &lt;- od_data %&gt;%\n  filter(destination_id %in% eldercare_ids) %&gt;%\n  group_by(origin_id) %&gt;%\n  summarise(\n    min_cost_eldercare = min(total_cost),\n    mean_cost_eldercare = mean(total_cost),\n    accessibility_index = 1 / mean(total_cost) * 10000\n  )\n\nsummary(accessibility_eldercare)\n\n   origin_id    min_cost_eldercare mean_cost_eldercare accessibility_index\n Min.   :   1   Min.   :   36.93   Min.   : 4974       Min.   :0.2389     \n 1st Qu.: 782   1st Qu.: 2213.14   1st Qu.:13666       1st Qu.:0.4547     \n Median :1563   Median : 4069.30   Median :16768       Median :0.5964     \n Mean   :1563   Mean   : 6118.05   Mean   :18425       Mean   :0.6055     \n 3rd Qu.:2344   3rd Qu.: 8061.08   3rd Qu.:21992       3rd Qu.:0.7317     \n Max.   :3125   Max.   :32450.08   Max.   :41859       Max.   :2.0105"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#generate-synthetic-property-data",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#generate-synthetic-property-data",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "6. Generate Synthetic Property Data",
    "text": "6. Generate Synthetic Property Data\nSince we don’t have actual property data, we’ll create synthetic data based on spatial patterns:\n\n# Generate synthetic property data for demonstration\nn_properties &lt;- 2000\n\n# Create random points within Singapore boundaries\nbbox &lt;- st_bbox(mpsz)\nsynthetic_properties &lt;- data.frame(\n  property_id = 1:n_properties,\n  x = runif(n_properties, bbox$xmin, bbox$xmax),\n  y = runif(n_properties, bbox$ymin, bbox$ymax)\n) %&gt;%\n  st_as_sf(coords = c(\"x\", \"y\"), crs = 3414)\n\n# Keep only points within actual boundaries\nsynthetic_properties &lt;- synthetic_properties[mpsz, ]\nn_properties &lt;- nrow(synthetic_properties)\n\ncat(\"Number of synthetic properties within boundaries:\", n_properties, \"\\n\")\n\nNumber of synthetic properties within boundaries: 838 \n\n\n\n6.1 Generate Property Attributes\n\n# Extract coordinates for distance calculations\ncoords &lt;- st_coordinates(synthetic_properties)\n\n# Calculate distance to CBD (assume CBD is at central point)\ncbd_point &lt;- c(mean(bbox$xmin, bbox$xmax), mean(bbox$ymin, bbox$ymax))\ndist_cbd &lt;- sqrt((coords[,1] - cbd_point[1])^2 + (coords[,2] - cbd_point[2])^2)\n\n# Generate synthetic property attributes with spatial correlation\nsynthetic_properties &lt;- synthetic_properties %&gt;%\n  mutate(\n    # Structural attributes\n    AREA_SQM = rnorm(n(), mean = 100, sd = 30) + (15000 - dist_cbd/1000) * 0.002,\n    AREA_SQM = pmax(AREA_SQM, 40),  # Minimum 40 sqm\n    AGE = rpois(n(), lambda = 10) + runif(n(), 0, 5),\n    NO_OF_UNITS = sample(50:500, n(), replace = TRUE),\n    \n    # Location attributes (using actual distances)\n    PROX_CBD = dist_cbd,\n    PROX_MRT = abs(rnorm(n(), mean = 800, sd = 400)) + dist_cbd * 0.05,\n    PROX_PARK = abs(rnorm(n(), mean = 500, sd = 200)),\n    PROX_SHOPPING_MALL = abs(rnorm(n(), mean = 1000, sd = 500)),\n    PROX_PRIMARY_SCH = abs(rnorm(n(), mean = 600, sd = 300)),\n    PROX_BUS_STOP = abs(rnorm(n(), mean = 200, sd = 100)),\n    \n    # Binary attributes\n    FREEHOLD = sample(c(0, 1), n(), replace = TRUE, prob = c(0.7, 0.3)),\n    \n    # Generate price based on attributes with spatial variation\n    SELLING_PRICE = 300000 +  # Base price\n      AREA_SQM * 8000 +        # Price per sqm\n      -AGE * 5000 +            # Age depreciation\n      -PROX_CBD * 20 +         # CBD distance effect\n      -PROX_MRT * 15 +         # MRT distance effect\n      FREEHOLD * 50000 +       # Freehold premium\n      rnorm(n(), 0, 50000) +   # Random variation\n      # Add spatial autocorrelation component\n      10000 * sin(coords[,1]/5000) * cos(coords[,2]/5000),\n    \n    # Ensure positive prices\n    SELLING_PRICE = pmax(SELLING_PRICE, 100000),\n    \n    # Log transformation\n    LOG_SELLING_PRICE = log(SELLING_PRICE)\n  )\n\n# Summary of synthetic data\nsummary(synthetic_properties %&gt;% \n        st_drop_geometry() %&gt;%\n        select(SELLING_PRICE, AREA_SQM, AGE, PROX_CBD, PROX_MRT))\n\n SELLING_PRICE        AREA_SQM          AGE            PROX_CBD    \n Min.   : 100000   Min.   : 40.0   Min.   : 3.432   Min.   : 6930  \n 1st Qu.: 325512   1st Qu.:110.5   1st Qu.: 9.947   1st Qu.:25825  \n Median : 572747   Median :129.6   Median :12.441   Median :33394  \n Mean   : 585239   Mean   :129.4   Mean   :12.472   Mean   :33931  \n 3rd Qu.: 831244   3rd Qu.:148.5   3rd Qu.:14.782   3rd Qu.:41905  \n Max.   :1626410   Max.   :212.6   Max.   :23.104   Max.   :59745  \n    PROX_MRT     \n Min.   : 691.2  \n 1st Qu.:2014.4  \n Median :2469.3  \n Mean   :2505.1  \n 3rd Qu.:2965.2  \n Max.   :4624.8"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#exploratory-data-analysis",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#exploratory-data-analysis",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "7. Exploratory Data Analysis",
    "text": "7. Exploratory Data Analysis\n\n7.1 Visualize Property Distribution\n\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\",\n              border.col = \"grey60\",\n              lwd = 0.5) +\ntm_shape(synthetic_properties) +\n  tm_dots(col = \"SELLING_PRICE\",\n          size = 0.02,\n          style = \"quantile\",\n          n = 5,\n          palette = \"YlOrRd\",\n          title = \"Selling Price ($)\",\n          alpha = 0.6) +\n  tm_layout(main.title = \"Distribution of Synthetic Property Prices\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\n\n\n\n\n\n7.2 Price Distribution Analysis\n\npar(mfrow = c(1, 2))\nhist(synthetic_properties$SELLING_PRICE/1000, \n     main = \"Distribution of Selling Price\",\n     xlab = \"Selling Price ($'000)\",\n     col = \"lightblue\",\n     breaks = 30)\nhist(synthetic_properties$LOG_SELLING_PRICE,\n     main = \"Distribution of Log Selling Price\",\n     xlab = \"Log(Selling Price)\",\n     col = \"lightgreen\",\n     breaks = 30)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n\n\n7.3 Correlation Analysis\n\n# Select numeric variables for correlation\ncor_vars &lt;- synthetic_properties %&gt;%\n  st_drop_geometry() %&gt;%\n  select(SELLING_PRICE, AREA_SQM, AGE, PROX_CBD, PROX_MRT,\n         PROX_PARK, PROX_SHOPPING_MALL, PROX_PRIMARY_SCH, PROX_BUS_STOP)\n\n# Calculate correlation matrix\ncor_matrix &lt;- cor(cor_vars)\n\n# Visualize\ncorrplot(cor_matrix,\n         method = \"circle\",\n         type = \"upper\",\n         diag = FALSE,\n         tl.cex = 0.8,\n         tl.col = \"black\",\n         tl.srt = 45)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#ols-regression-model",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#ols-regression-model",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "8. OLS Regression Model",
    "text": "8. OLS Regression Model\n\n8.1 Build OLS Model\n\n# Build OLS model\nols_model &lt;- lm(LOG_SELLING_PRICE ~ AREA_SQM + AGE + \n                  PROX_CBD + PROX_MRT + PROX_PARK +\n                  PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n                  PROX_BUS_STOP + FREEHOLD,\n                data = synthetic_properties)\n\nsummary(ols_model)\n\n\nCall:\nlm(formula = LOG_SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_MRT + PROX_PARK + PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n    PROX_BUS_STOP + FREEHOLD, data = synthetic_properties)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.82778 -0.11477  0.05392  0.15644  0.75009 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)         1.262e+01  6.532e-02 193.259  &lt; 2e-16 ***\nAREA_SQM            1.546e-02  2.797e-04  55.263  &lt; 2e-16 ***\nAGE                -8.715e-03  2.328e-03  -3.744 0.000193 ***\nPROX_CBD           -4.022e-05  1.217e-06 -33.049  &lt; 2e-16 ***\nPROX_MRT           -4.108e-05  2.013e-05  -2.040 0.041659 *  \nPROX_PARK          -5.979e-06  3.997e-05  -0.150 0.881125    \nPROX_SHOPPING_MALL -2.859e-06  1.666e-05  -0.172 0.863771    \nPROX_PRIMARY_SCH    1.079e-05  2.670e-05   0.404 0.686122    \nPROX_BUS_STOP      -4.446e-05  8.218e-05  -0.541 0.588645    \nFREEHOLD            1.090e-01  1.714e-02   6.358 3.36e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2278 on 828 degrees of freedom\nMultiple R-squared:  0.9006,    Adjusted R-squared:  0.8995 \nF-statistic: 833.2 on 9 and 828 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n8.2 Model Diagnostics\n\npar(mfrow = c(2, 2))\nplot(ols_model)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#test-for-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#test-for-spatial-autocorrelation",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "9. Test for Spatial Autocorrelation",
    "text": "9. Test for Spatial Autocorrelation\n\n9.1 Create Spatial Weights\n\n# Add residuals to spatial data\nsynthetic_properties$ols_residuals &lt;- residuals(ols_model)\n\n# Create spatial weights\ncoords &lt;- st_coordinates(synthetic_properties)\nknn_nb &lt;- knn2nb(knearneigh(coords, k = 8))\nknn_listw &lt;- nb2listw(knn_nb, style = \"W\")\n\n\n\n9.2 Moran’s I Test\n\nmoran_test &lt;- moran.test(synthetic_properties$ols_residuals, knn_listw)\nprint(moran_test)\n\n\n    Moran I test under randomisation\n\ndata:  synthetic_properties$ols_residuals  \nweights: knn_listw    \n\nMoran I statistic standard deviate = 7.713, p-value = 6.144e-15\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.1251081698     -0.0011947431      0.0002681507 \n\n# Moran scatterplot\nmoran.plot(synthetic_properties$ols_residuals, knn_listw,\n           main = \"Moran Scatterplot of OLS Residuals\",\n           xlab = \"Residuals\",\n           ylab = \"Spatially Lagged Residuals\",\n           labels = FALSE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#geographically-weighted-regression",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#geographically-weighted-regression",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "10. Geographically Weighted Regression",
    "text": "10. Geographically Weighted Regression\n\n10.1 Prepare Data for GWR\n\n# Convert to Spatial object for GWmodel\nproperties_sp &lt;- as(synthetic_properties, \"Spatial\")\n\n\n\n10.2 Adaptive Bandwidth GWR\n\n# Cache file\ncache_file &lt;- \"gwr_synthetic_cache.rds\"\n\nif(file.exists(cache_file)){\n  cat(\"Loading cached GWR results...\\n\")\n  gwr_results &lt;- readRDS(cache_file)\n  bw_adaptive &lt;- gwr_results$bw\n  gwr_adaptive &lt;- gwr_results$model\n} else {\n  cat(\"Calculating optimal adaptive bandwidth...\\n\")\n  \n  # Determine optimal bandwidth\n  bw_adaptive &lt;- bw.gwr(LOG_SELLING_PRICE ~ AREA_SQM + AGE + \n                         PROX_CBD + PROX_MRT + PROX_PARK +\n                         PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n                         PROX_BUS_STOP + FREEHOLD,\n                       data = properties_sp,\n                       approach = \"AICc\",\n                       kernel = \"bisquare\",\n                       adaptive = TRUE,\n                       longlat = FALSE,\n                       parallel.method = \"omp\",\n                       parallel.arg = cores)\n  \n  cat(\"Optimal bandwidth:\", bw_adaptive, \"neighbors\\n\")\n  \n  # Calibrate GWR model\n  gwr_adaptive &lt;- gwr.basic(LOG_SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_MRT + PROX_PARK +\n                            PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n                            PROX_BUS_STOP + FREEHOLD,\n                          data = properties_sp,\n                          bw = bw_adaptive,\n                          kernel = \"bisquare\",\n                          adaptive = TRUE,\n                          longlat = FALSE)\n  \n  # Save cache\n  saveRDS(list(bw = bw_adaptive, model = gwr_adaptive), cache_file)\n}\n\nLoading cached GWR results...\n\nprint(gwr_adaptive)\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2025-11-08 10:28:21.694015 \n   Call:\n   gwr.basic(formula = LOG_SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_MRT + PROX_PARK + PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n    PROX_BUS_STOP + FREEHOLD, data = properties_sp, bw = bw_adaptive, \n    kernel = \"bisquare\", adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  LOG_SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_MRT PROX_PARK PROX_SHOPPING_MALL PROX_PRIMARY_SCH PROX_BUS_STOP FREEHOLD\n   Number of data points: 838\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-0.82778 -0.11477  0.05392  0.15644  0.75009 \n\n   Coefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)         1.262e+01  6.532e-02 193.259  &lt; 2e-16 ***\n   AREA_SQM            1.546e-02  2.797e-04  55.263  &lt; 2e-16 ***\n   AGE                -8.715e-03  2.328e-03  -3.744 0.000193 ***\n   PROX_CBD           -4.022e-05  1.217e-06 -33.049  &lt; 2e-16 ***\n   PROX_MRT           -4.108e-05  2.013e-05  -2.040 0.041659 *  \n   PROX_PARK          -5.979e-06  3.997e-05  -0.150 0.881125    \n   PROX_SHOPPING_MALL -2.859e-06  1.666e-05  -0.172 0.863771    \n   PROX_PRIMARY_SCH    1.079e-05  2.670e-05   0.404 0.686122    \n   PROX_BUS_STOP      -4.446e-05  8.218e-05  -0.541 0.588645    \n   FREEHOLD            1.090e-01  1.714e-02   6.358 3.36e-10 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 0.2278 on 828 degrees of freedom\n   Multiple R-squared: 0.9006\n   Adjusted R-squared: 0.8995 \n   F-statistic: 833.2 on 9 and 828 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 42.98441\n   Sigma(hat): 0.2267526\n   AIC:  -88.8704\n   AICc:  -88.55078\n   BIC:  -800.788\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: bisquare \n   Adaptive bandwidth: 323 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                             Min.     1st Qu.      Median     3rd Qu.    Max.\n   Intercept           1.2271e+01  1.2523e+01  1.2685e+01  1.2798e+01 12.9082\n   AREA_SQM            9.7076e-03  1.2572e-02  1.6222e-02  1.9173e-02  0.0213\n   AGE                -1.7725e-02 -1.1518e-02 -7.0853e-03 -4.7165e-03 -0.0024\n   PROX_CBD           -5.8508e-05 -4.7722e-05 -3.8656e-05 -3.1402e-05  0.0000\n   PROX_MRT           -8.8581e-05 -6.7459e-05 -3.8171e-05 -2.2047e-05  0.0000\n   PROX_PARK          -1.3381e-04 -5.1991e-05 -1.0447e-05  2.6315e-05  0.0002\n   PROX_SHOPPING_MALL -6.3753e-05 -3.5783e-05 -9.6839e-06  6.0429e-06  0.0000\n   PROX_PRIMARY_SCH   -6.7361e-05 -1.6536e-05 -3.9701e-06  1.1177e-05  0.0000\n   PROX_BUS_STOP      -2.3674e-04 -8.4826e-05 -2.6751e-05  5.5639e-05  0.0002\n   FREEHOLD            4.8283e-02  6.9573e-02  9.1426e-02  1.3896e-01  0.1610\n   ************************Diagnostic information*************************\n   Number of data points: 838 \n   Effective number of parameters (2trace(S) - trace(S'S)): 81.62715 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 756.3729 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): -441.5433 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): -514.6195 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): -1003.044 \n   Residual sum of squares: 24.68628 \n   R-square value:  0.9428931 \n   Adjusted R-square value:  0.936722 \n\n   ***********************************************************************\n   Program stops at: 2025-11-08 10:28:21.844458 \n\n\n\n\n10.3 Extract GWR Results\n\n# Extract results\ngwr_sf &lt;- st_as_sf(gwr_adaptive$SDF)\n\n# Add to original data\nsynthetic_properties$gwr_localR2 &lt;- gwr_sf$Local_R2\nsynthetic_properties$gwr_residual &lt;- gwr_sf$residual\n\n# Summary of Local R²\nsummary(synthetic_properties$gwr_localR2)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.9077  0.9236  0.9407  0.9422  0.9560  0.9897"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#visualize-gwr-results",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#visualize-gwr-results",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "11. Visualize GWR Results",
    "text": "11. Visualize GWR Results\n\n11.1 Map Local R²\n\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\",\n              border.col = \"grey60\",\n              lwd = 0.5) +\ntm_shape(synthetic_properties) +\n  tm_dots(col = \"gwr_localR2\",\n          size = 0.03,\n          style = \"quantile\",\n          n = 5,\n          palette = \"RdPu\",\n          title = \"Local R²\",\n          alpha = 0.7) +\n  tm_layout(main.title = \"GWR Local R² Values\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\n\n\n\n\n\n11.2 Compare Residuals\n\ntm1 &lt;- tm_shape(mpsz) +\n       tm_polygons(alpha = 0.4) +\n       tm_shape(synthetic_properties) +\n       tm_dots(col = \"ols_residuals\",\n               size = 0.02,\n               style = \"quantile\",\n               palette = \"-RdBu\",\n               title = \"OLS Residuals\") +\n       tm_layout(main.title = \"OLS Residuals\")\n\ntm2 &lt;- tm_shape(mpsz) +\n       tm_polygons(alpha = 0.4) +\n       tm_shape(synthetic_properties) +\n       tm_dots(col = \"gwr_residual\",\n               size = 0.02,\n               style = \"quantile\",\n               palette = \"-RdBu\",\n               title = \"GWR Residuals\") +\n       tm_layout(main.title = \"GWR Residuals\")\n\ntmap_arrange(tm1, tm2, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#model-comparison",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#model-comparison",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "12. Model Comparison",
    "text": "12. Model Comparison\n\n12.1 Performance Metrics\n\n# Compare models\ncomparison &lt;- data.frame(\n  Model = c(\"OLS\", \"GWR Adaptive\"),\n  AICc = c(AIC(ols_model), gwr_adaptive$GW.diagnostic$AICc),\n  Adj_R2 = c(summary(ols_model)$adj.r.squared, \n             gwr_adaptive$GW.diagnostic$R2.adj),\n  RSS = c(sum(residuals(ols_model)^2),\n          gwr_adaptive$GW.diagnostic$RSS.gw)\n)\n\nknitr::kable(comparison, digits = 3,\n             caption = \"Model Performance Comparison\")\n\n\nModel Performance Comparison\n\n\nModel\nAICc\nAdj_R2\nRSS\n\n\n\n\nOLS\n-88.870\n0.899\n42.984\n\n\nGWR Adaptive\n-441.543\n0.899\n24.686\n\n\n\n\n\n\n\n12.2 Spatial Autocorrelation in Residuals\n\n# Test GWR residuals\nmoran_gwr &lt;- moran.test(synthetic_properties$gwr_residual, knn_listw)\n\n# Compare Moran's I\nmoran_comparison &lt;- data.frame(\n  Model = c(\"OLS\", \"GWR\"),\n  Morans_I = c(moran_test$estimate[1], moran_gwr$estimate[1]),\n  P_value = c(moran_test$p.value, moran_gwr$p.value)\n)\n\nknitr::kable(moran_comparison, digits = 4,\n             caption = \"Spatial Autocorrelation Comparison\")\n\n\nSpatial Autocorrelation Comparison\n\n\nModel\nMorans_I\nP_value\n\n\n\n\nOLS\n0.1251\n0.0000\n\n\nGWR\n-0.0017\n0.5129"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#key-findings-and-conclusions",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#key-findings-and-conclusions",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "13. Key Findings and Conclusions",
    "text": "13. Key Findings and Conclusions\n\nSummary\nThis analysis demonstrates the application of GWR methods using:\n\nOD Matrix Analysis: Understanding spatial accessibility patterns\nSynthetic Data Generation: Creating spatially correlated property data\nGWR Application: Capturing spatial heterogeneity in relationships\n\n\n\nKey Insights:\n\nSpatial Heterogeneity: GWR reveals that relationships between property prices and attributes vary across space\nModel Improvement: GWR shows better fit than OLS (higher R², lower AICc)\nReduced Spatial Autocorrelation: GWR effectively captures spatial patterns\n\n\n\nLimitations:\n\nThis uses synthetic data for demonstration\nReal property data would show more complex patterns\nAdditional variables would improve model performance\n\n\n\nNext Steps:\nTo apply this with real data: 1. Obtain actual property transaction data 2. Include more location-specific amenities 3. Consider temporal dimensions 4. Explore other spatial modeling techniques"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#notes-on-data-requirements",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#notes-on-data-requirements",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "14. Notes on Data Requirements",
    "text": "14. Notes on Data Requirements\nFor a complete hedonic pricing analysis, you would need:\n\nProperty Transaction Data with:\n\nSelling prices\nProperty characteristics (area, age, type)\nExact locations (coordinates)\nTransaction dates\n\nProximity Variables:\n\nDistance to amenities\nAccessibility indices\nNeighborhood characteristics\n\nSpatial Data:\n\nAdministrative boundaries\nTransportation networks\nLand use patterns\n\n\nThe OD matrix can be used to calculate sophisticated accessibility measures that can be incorporated as variables in the hedonic pricing model."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/data/geospatial/hexagons.html",
    "href": "Hands-on_Ex/Hands-on_ex10/data/geospatial/hexagons.html",
    "title": "ISSS626 Portfolio — HUANG PENGXIN",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n                 0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "",
    "text": "Building upon Exercise 10a’s aspatial models, this exercise introduces spatial econometric approaches to spatial interaction modeling. We will use spatial regression methods to account for spatial autocorrelation and network effects in Origin-Destination flows.\n\n\n\nBy the end of this exercise, you will be able to:\n\nUnderstand spatial dependencies in OD flow data\nBuild spatial econometric interaction models\nAccount for origin, destination, and spatial effects\nCompare spatial vs aspatial model performance\nInterpret spatial spillover effects\n\n\n\n\nWhy Spatial Models for Flows? - Flows from nearby origins may be correlated (origin dependence) - Flows to nearby destinations may be correlated (destination dependence)\n- Flows between nearby OD pairs may be correlated (network dependence) - Ignoring these dependencies leads to biased estimates"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#introduction",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#introduction",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "",
    "text": "Building upon Exercise 10a’s aspatial models, this exercise introduces spatial econometric approaches to spatial interaction modeling. We will use spatial regression methods to account for spatial autocorrelation and network effects in Origin-Destination flows."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#learning-objectives",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#learning-objectives",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "",
    "text": "By the end of this exercise, you will be able to:\n\nUnderstand spatial dependencies in OD flow data\nBuild spatial econometric interaction models\nAccount for origin, destination, and spatial effects\nCompare spatial vs aspatial model performance\nInterpret spatial spillover effects"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#key-concepts",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#key-concepts",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "",
    "text": "Why Spatial Models for Flows? - Flows from nearby origins may be correlated (origin dependence) - Flows to nearby destinations may be correlated (destination dependence)\n- Flows between nearby OD pairs may be correlated (network dependence) - Ignoring these dependencies leads to biased estimates"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#loading-required-packages",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#loading-required-packages",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "2.1 Loading Required Packages",
    "text": "2.1 Loading Required Packages\n\npacman::p_load(spatialreg, tidyverse, sf, spdep, \n               tmap, Matrix, igraph, MASS,\n               knitr, ggpubr, corrplot)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#setting-up-environment",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#setting-up-environment",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "2.2 Setting Up Environment",
    "text": "2.2 Setting Up Environment\n\n# Set tmap mode\ntmap_mode(\"plot\")\n\n# Set seed for reproducibility\nset.seed(1234)\n\n# Set number formatting\noptions(scipen = 999)\noptions(digits = 4)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#load-data-from-exercise-10a",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#load-data-from-exercise-10a",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "3.1 Load Data from Exercise 10a",
    "text": "3.1 Load Data from Exercise 10a\n\n# Load the SIM_data prepared in Exercise 10a\nSIM_data &lt;- read_rds(\"data/rds/SIM_data.rds\")\n\ncat(\"SIM_data loaded successfully!\\n\")\n\nSIM_data loaded successfully!\n\ncat(\"Dimensions:\", dim(SIM_data), \"\\n\")\n\nDimensions: 104006 10 \n\ncat(\"Total flows:\", sum(SIM_data$TRIPS), \"\\n\")\n\nTotal flows: 107448 \n\n# Display structure\nglimpse(SIM_data)\n\nRows: 104,006\nColumns: 10\n$ ORIGIN_SZ       &lt;chr&gt; \"BMSZ02\", \"OTSZ03\", \"DTSZ04\", \"DTSZ05\", \"OTSZ04\", \"BMS…\n$ DESTIN_SZ       &lt;chr&gt; \"OTSZ02\", \"OTSZ02\", \"OTSZ02\", \"OTSZ02\", \"OTSZ02\", \"OTS…\n$ dist            &lt;dbl&gt; 2471.2, 415.0, 933.4, 1147.1, 714.8, 1060.0, 1977.6, 1…\n$ TRIPS           &lt;dbl&gt; 2, 48, 1, 4, 8, 1, 1, 2, 4, 1, 32, 3, 0, 1, 4, 3, 1, 1…\n$ ORIGIN_AGE7_12  &lt;dbl&gt; 1762.0, 1899.0, 2194.0, 1013.0, 3324.0, 219.8, 1859.2,…\n$ ORIGIN_AGE13_24 &lt;dbl&gt; 6299, 4194, 6309, 2047, 5557, 293, 2479, 1529, 4168, 6…\n$ ORIGIN_AGE25_64 &lt;dbl&gt; 18896, 18512, 594, 23207, 6407, 879, 7437, 7531, 15719…\n$ DESTIN_AGE7_12  &lt;dbl&gt; 851, 851, 851, 851, 851, 851, 851, 851, 851, 851, 851,…\n$ DESTIN_AGE13_24 &lt;dbl&gt; 644, 644, 644, 644, 644, 644, 644, 644, 644, 644, 644,…\n$ DESTIN_AGE25_64 &lt;dbl&gt; 3943, 3943, 3943, 3943, 3943, 3943, 3943, 3943, 3943, …"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#load-spatial-data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#load-spatial-data",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "3.2 Load Spatial Data",
    "text": "3.2 Load Spatial Data\n\n# Load planning subzones\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                layer = \"MP14_SUBZONE_NO_SEA_PL\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\ncat(\"Number of zones:\", nrow(mpsz), \"\\n\")\n\nNumber of zones: 323 \n\n# Get zone centroids for later use\ncentroids &lt;- st_centroid(mpsz)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#prepare-zone-attributes",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#prepare-zone-attributes",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "3.3 Prepare Zone Attributes",
    "text": "3.3 Prepare Zone Attributes\n\n# 明确使用dplyr的函数\nzones &lt;- SIM_data %&gt;%\n  dplyr::select(ORIGIN_SZ, ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64) %&gt;%\n  dplyr::rename(\n    SUBZONE_C = ORIGIN_SZ,\n    AGE7_12 = ORIGIN_AGE7_12,\n    AGE13_24 = ORIGIN_AGE13_24, \n    AGE25_64 = ORIGIN_AGE25_64\n  ) %&gt;%\n  dplyr::distinct()\n\n# Join with spatial data\nzones_sf &lt;- mpsz %&gt;%\n  dplyr::select(SUBZONE_C, geometry) %&gt;%\n  dplyr::left_join(zones, by = \"SUBZONE_C\") %&gt;%\n  dplyr::filter(!is.na(AGE25_64))\n\ncat(\"Number of zones with data:\", nrow(zones_sf), \"\\n\")\n\nNumber of zones with data: 323"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#contiguity-based-weights",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#contiguity-based-weights",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "4.1 Contiguity-Based Weights",
    "text": "4.1 Contiguity-Based Weights\n\n# Create contiguity weights (Queen)\nnb_queen &lt;- poly2nb(zones_sf, queen = TRUE)\nsummary(nb_queen)\n\nNeighbour list object:\nNumber of regions: 323 \nNumber of nonzero links: 1940 \nPercentage nonzero weights: 1.86 \nAverage number of links: 6.006 \n5 regions with no links:\n36, 37, 38, 276, 298\n6 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6  7  8  9 10 11 12 14 17 \n 5  2  6 10 26 76 85 53 34 17  3  3  1  1  1 \n2 least connected regions:\n35 198 with 1 link\n1 most connected region:\n296 with 17 links\n\n# Convert to listw object\nlw_queen &lt;- nb2listw(nb_queen, style = \"W\", zero.policy = TRUE)\n\n# Visualize neighbor structure\nplot(st_geometry(zones_sf), border = \"grey\")\nplot(nb_queen, st_coordinates(st_centroid(zones_sf)), \n     add = TRUE, col = \"red\", lwd = 0.5)\ntitle(\"Queen Contiguity Neighbors\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#distance-based-weights",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#distance-based-weights",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "4.2 Distance-Based Weights",
    "text": "4.2 Distance-Based Weights\n\n# K-nearest neighbors\ncoords &lt;- st_coordinates(st_centroid(zones_sf))\nknn8 &lt;- knn2nb(knearneigh(coords, k = 8))\nlw_knn8 &lt;- nb2listw(knn8, style = \"W\")\n\n# Distance threshold\ndist_threshold &lt;- 5000  # 5km\ndnb &lt;- dnearneigh(coords, 0, dist_threshold)\nlw_dist &lt;- nb2listw(dnb, style = \"W\", zero.policy = TRUE)\n\ncat(\"Average number of neighbors:\\n\")\n\nAverage number of neighbors:\n\ncat(\"- Queen contiguity:\", mean(card(nb_queen)), \"\\n\")\n\n- Queen contiguity: 6.006 \n\ncat(\"- 8-NN:\", mean(card(knn8)), \"\\n\")\n\n- 8-NN: 8 \n\ncat(\"- Distance (5km):\", mean(card(dnb)), \"\\n\")\n\n- Distance (5km): 48.85"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#spatial-autocorrelation-in-flows",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#spatial-autocorrelation-in-flows",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "5.1 Spatial Autocorrelation in Flows",
    "text": "5.1 Spatial Autocorrelation in Flows\n\n# Calculate total outflows and inflows per zone\noutflows &lt;- SIM_data %&gt;%\n  group_by(ORIGIN_SZ) %&gt;%\n  summarise(total_outflow = sum(TRIPS))\n\ninflows &lt;- SIM_data %&gt;%\n  group_by(DESTIN_SZ) %&gt;%\n  summarise(total_inflow = sum(TRIPS))\n\n# Join with spatial data\nzones_flow &lt;- zones_sf %&gt;%\n  left_join(outflows, by = c(\"SUBZONE_C\" = \"ORIGIN_SZ\")) %&gt;%\n  left_join(inflows, by = c(\"SUBZONE_C\" = \"DESTIN_SZ\")) %&gt;%\n  mutate(\n    total_outflow = replace_na(total_outflow, 0),\n    total_inflow = replace_na(total_inflow, 0),\n    net_flow = total_inflow - total_outflow\n  )"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#morans-i-for-flows",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#morans-i-for-flows",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "5.2 Moran’s I for Flows",
    "text": "5.2 Moran’s I for Flows\n\n# Test for spatial autocorrelation in outflows\nmoran_out &lt;- moran.test(zones_flow$total_outflow, lw_knn8)\ncat(\"Moran's I for Outflows:\\n\")\n\nMoran's I for Outflows:\n\nprint(moran_out)\n\n\n    Moran I test under randomisation\n\ndata:  zones_flow$total_outflow  \nweights: lw_knn8    \n\nMoran I statistic standard deviate = 7.4, p-value = 0.00000000000006\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n        0.1889452        -0.0031056         0.0006688 \n\n# Test for spatial autocorrelation in inflows  \nmoran_in &lt;- moran.test(zones_flow$total_inflow, lw_knn8)\ncat(\"\\nMoran's I for Inflows:\\n\")\n\n\nMoran's I for Inflows:\n\nprint(moran_in)\n\n\n    Moran I test under randomisation\n\ndata:  zones_flow$total_inflow  \nweights: lw_knn8    \n\nMoran I statistic standard deviate = 8, p-value = 0.0000000000000005\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n        0.2039645        -0.0031056         0.0006674 \n\n# Moran scatterplots\npar(mfrow = c(1, 2))\nmoran.plot(zones_flow$total_outflow, lw_knn8,\n           main = \"Outflows\", \n           xlab = \"Total Outflow\",\n           ylab = \"Lagged Outflow\",\n           labels = FALSE)\nmoran.plot(zones_flow$total_inflow, lw_knn8,\n           main = \"Inflows\",\n           xlab = \"Total Inflow\", \n           ylab = \"Lagged Inflow\",\n           labels = FALSE)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#visualize-flow-patterns",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#visualize-flow-patterns",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "5.3 Visualize Flow Patterns",
    "text": "5.3 Visualize Flow Patterns\n\n# Map outflows and inflows\ntm1 &lt;- tm_shape(zones_flow) +\n  tm_polygons(\"total_outflow\",\n              style = \"quantile\",\n              n = 5,\n              palette = \"Blues\",\n              title = \"Total Outflow\") +\n  tm_layout(main.title = \"Origin Flows\",\n            main.title.size = 1)\n\ntm2 &lt;- tm_shape(zones_flow) +\n  tm_polygons(\"total_inflow\",\n              style = \"quantile\",\n              n = 5,\n              palette = \"Reds\",\n              title = \"Total Inflow\") +\n  tm_layout(main.title = \"Destination Flows\",\n            main.title.size = 1)\n\ntm3 &lt;- tm_shape(zones_flow) +\n  tm_polygons(\"net_flow\",\n              style = \"quantile\",\n              n = 5,\n              palette = \"-RdBu\",\n              title = \"Net Flow\") +\n  tm_layout(main.title = \"Net Flows (In - Out)\",\n            main.title.size = 1)\n\ntmap_arrange(tm1, tm2, tm3, ncol = 3)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#prepare-modeling-data",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#prepare-modeling-data",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "6.1 Prepare Modeling Data",
    "text": "6.1 Prepare Modeling Data\n\n# Aggregate OD flows to zone level for spatial modeling\nzone_flows &lt;- SIM_data %&gt;%\n  group_by(ORIGIN_SZ) %&gt;%\n  summarise(\n    total_outflow = sum(TRIPS),\n    avg_distance = mean(dist, na.rm = TRUE),\n    total_destinations = n_distinct(DESTIN_SZ),\n    working_pop = first(ORIGIN_AGE25_64),\n    young_pop = first(ORIGIN_AGE13_24),\n    school_pop = first(ORIGIN_AGE7_12)\n  ) %&gt;%\n  rename(SUBZONE_C = ORIGIN_SZ)\n\n# Merge with spatial data\nspatial_model_data &lt;- zones_sf %&gt;%\n  left_join(zone_flows, by = \"SUBZONE_C\") %&gt;%\n  filter(!is.na(total_outflow))\n\ncat(\"Number of zones for modeling:\", nrow(spatial_model_data), \"\\n\")\n\nNumber of zones for modeling: 323"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-1-ols-baseline",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-1-ols-baseline",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "6.2 Model 1: OLS Baseline",
    "text": "6.2 Model 1: OLS Baseline\n\n# OLS model as baseline\nols_model &lt;- lm(\n  log(total_outflow + 1) ~ \n    log(working_pop + 1) + \n    log(young_pop + 1) + \n    log(avg_distance/1000),\n  data = spatial_model_data\n)\n\nsummary(ols_model)\n\n\nCall:\nlm(formula = log(total_outflow + 1) ~ log(working_pop + 1) + \n    log(young_pop + 1) + log(avg_distance/1000), data = spatial_model_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.4450 -0.2034 -0.0125  0.2071  1.2420 \n\nCoefficients:\n                       Estimate Std. Error t value            Pr(&gt;|t|)    \n(Intercept)             0.89088    0.30502    2.92              0.0037 ** \nlog(working_pop + 1)    1.17906    0.02377   49.61 &lt;0.0000000000000002 ***\nlog(young_pop + 1)     -0.00712    0.02397   -0.30              0.7665    \nlog(avg_distance/1000) -2.43916    0.08964  -27.21 &lt;0.0000000000000002 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.355 on 319 degrees of freedom\nMultiple R-squared:  0.908, Adjusted R-squared:  0.907 \nF-statistic: 1.05e+03 on 3 and 319 DF,  p-value: &lt;0.0000000000000002\n\n# Test for spatial autocorrelation in residuals\nlm.morantest(ols_model, lw_knn8, alternative = \"two.sided\")\n\n\n    Global Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = log(total_outflow + 1) ~ log(working_pop + 1) +\nlog(young_pop + 1) + log(avg_distance/1000), data = spatial_model_data)\nweights: lw_knn8\n\nMoran I statistic standard deviate = 23, p-value &lt;0.0000000000000002\nalternative hypothesis: two.sided\nsample estimates:\nObserved Moran I      Expectation         Variance \n       0.5950168       -0.0057390        0.0006603"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-2-spatial-lag-model-sar",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-2-spatial-lag-model-sar",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "6.3 Model 2: Spatial Lag Model (SAR)",
    "text": "6.3 Model 2: Spatial Lag Model (SAR)\n\n# Spatial Autoregressive Model\nsar_model &lt;- lagsarlm(\n  log(total_outflow + 1) ~ \n    log(working_pop + 1) + \n    log(young_pop + 1) + \n    log(avg_distance/1000),\n  data = spatial_model_data,\n  listw = lw_knn8,\n  zero.policy = TRUE\n)\n\nsummary(sar_model)\n\n\nCall:lagsarlm(formula = log(total_outflow + 1) ~ log(working_pop + \n    1) + log(young_pop + 1) + log(avg_distance/1000), data = spatial_model_data, \n    listw = lw_knn8, zero.policy = TRUE)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-1.2759754 -0.1862070  0.0024991  0.1869462  1.0973581 \n\nType: lag \nCoefficients: (asymptotic standard errors) \n                        Estimate Std. Error  z value              Pr(&gt;|z|)\n(Intercept)            -2.480020   0.427555  -5.8005        0.000000006613\nlog(working_pop + 1)    1.198558   0.020919  57.2962 &lt; 0.00000000000000022\nlog(young_pop + 1)     -0.014585   0.021142  -0.6899                0.4903\nlog(avg_distance/1000) -1.900099   0.100351 -18.9346 &lt; 0.00000000000000022\n\nRho: 0.3574, LR test value: 73.84, p-value: &lt; 0.000000000000000222\nAsymptotic standard error: 0.03523\n    z-value: 10.14, p-value: &lt; 0.000000000000000222\nWald statistic: 102.9, p-value: &lt; 0.000000000000000222\n\nLog likelihood: -85.26 for lag model\nML residual variance (sigma squared): 0.09781, (sigma: 0.3127)\nNumber of observations: 323 \nNumber of parameters estimated: 6 \nAIC: 182.5, (AIC for lm: 254.4)\nLM test for residual autocorrelation\ntest value: 350.1, p-value: &lt; 0.000000000000000222\n\n# Extract spatial parameter\ncat(\"\\nSpatial lag parameter (ρ):\", round(sar_model$rho, 4), \"\\n\")\n\n\nSpatial lag parameter (ρ): 0.3574 \n\ncat(\"Interpretation: Neighboring flows have a\", \n    ifelse(sar_model$rho &gt; 0, \"positive\", \"negative\"), \n    \"effect on local flows\\n\")\n\nInterpretation: Neighboring flows have a positive effect on local flows"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-3-spatial-error-model-sem",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-3-spatial-error-model-sem",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "6.4 Model 3: Spatial Error Model (SEM)",
    "text": "6.4 Model 3: Spatial Error Model (SEM)\n\n# Spatial Error Model\nsem_model &lt;- errorsarlm(\n  log(total_outflow + 1) ~ \n    log(working_pop + 1) + \n    log(young_pop + 1) + \n    log(avg_distance/1000),\n  data = spatial_model_data,\n  listw = lw_knn8,\n  zero.policy = TRUE\n)\n\nsummary(sem_model)\n\n\nCall:errorsarlm(formula = log(total_outflow + 1) ~ log(working_pop + \n    1) + log(young_pop + 1) + log(avg_distance/1000), data = spatial_model_data, \n    listw = lw_knn8, zero.policy = TRUE)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-1.217018 -0.108880  0.017227  0.118694  0.719430 \n\nType: error \nCoefficients: (asymptotic standard errors) \n                         Estimate Std. Error  z value              Pr(&gt;|z|)\n(Intercept)             2.6206032  0.5172669   5.0662          0.0000004057\nlog(working_pop + 1)    1.1745705  0.0133609  87.9111 &lt; 0.00000000000000022\nlog(young_pop + 1)     -0.0033278  0.0140170  -0.2374                0.8123\nlog(avg_distance/1000) -3.2547270  0.1887079 -17.2474 &lt; 0.00000000000000022\n\nLambda: 0.8951, LR test value: 266.3, p-value: &lt; 0.000000000000000222\nAsymptotic standard error: 0.0262\n    z-value: 34.16, p-value: &lt; 0.000000000000000222\nWald statistic: 1167, p-value: &lt; 0.000000000000000222\n\nLog likelihood: 10.96 for error model\nML residual variance (sigma squared): 0.04686, (sigma: 0.2165)\nNumber of observations: 323 \nNumber of parameters estimated: 6 \nAIC: -9.919, (AIC for lm: 254.4)\n\n# Extract spatial parameter\ncat(\"\\nSpatial error parameter (λ):\", round(sem_model$lambda, 4), \"\\n\")\n\n\nSpatial error parameter (λ): 0.8951"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-4-spatial-durbin-model-sdm",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-4-spatial-durbin-model-sdm",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "6.5 Model 4: Spatial Durbin Model (SDM)",
    "text": "6.5 Model 4: Spatial Durbin Model (SDM)\n\n# Spatial Durbin Model - includes spatially lagged X variables\nsdm_model &lt;- lagsarlm(\n  log(total_outflow + 1) ~ \n    log(working_pop + 1) + \n    log(young_pop + 1) + \n    log(avg_distance/1000),\n  data = spatial_model_data,\n  listw = lw_knn8,\n  type = \"mixed\",\n  zero.policy = TRUE\n)\n\nsummary(sdm_model)\n\n\nCall:lagsarlm(formula = log(total_outflow + 1) ~ log(working_pop + \n    1) + log(young_pop + 1) + log(avg_distance/1000), data = spatial_model_data, \n    listw = lw_knn8, type = \"mixed\", zero.policy = TRUE)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-1.229097 -0.107811  0.014011  0.102320  0.779806 \n\nType: mixed \nCoefficients: (asymptotic standard errors) \n                             Estimate Std. Error  z value             Pr(&gt;|z|)\n(Intercept)                -0.8064084  0.4023914  -2.0040              0.04507\nlog(working_pop + 1)        1.1883882  0.0145620  81.6091 &lt; 0.0000000000000002\nlog(young_pop + 1)         -0.0061501  0.0144665  -0.4251              0.67074\nlog(avg_distance/1000)     -3.7811284  0.2451263 -15.4252 &lt; 0.0000000000000002\nlag.log(working_pop + 1)   -0.9364838  0.0623997 -15.0078 &lt; 0.0000000000000002\nlag.log(young_pop + 1)     -0.0126449  0.0394936  -0.3202              0.74883\nlag.log(avg_distance/1000)  3.5371272  0.2779456  12.7260 &lt; 0.0000000000000002\n\nRho: 0.8668, LR test value: 270.5, p-value: &lt; 0.000000000000000222\nAsymptotic standard error: 0.03027\n    z-value: 28.64, p-value: &lt; 0.000000000000000222\nWald statistic: 820.2, p-value: &lt; 0.000000000000000222\n\nLog likelihood: 18.37 for mixed model\nML residual variance (sigma squared): 0.04553, (sigma: 0.2134)\nNumber of observations: 323 \nNumber of parameters estimated: 9 \nAIC: -18.73, (AIC for lm: 249.8)\nLM test for residual autocorrelation\ntest value: 9.048, p-value: 0.0026301"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-5-od-flow-count-models",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#model-5-od-flow-count-models",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "6.6 Model 5: OD Flow Count Models",
    "text": "6.6 Model 5: OD Flow Count Models\n\n# Sample flows for computational efficiency\nset.seed(1234)\nsample_flows &lt;- SIM_data %&gt;%\n  filter(TRIPS &gt; 0) %&gt;%\n  sample_n(min(5000, n()))\n\n# Poisson regression for count data\npoisson_model &lt;- glm(\n  TRIPS ~ \n    log(ORIGIN_AGE25_64 + 1) + \n    log(DESTIN_AGE25_64 + 1) + \n    log(dist/1000),\n  data = sample_flows,\n  family = poisson()\n)\n\nsummary(poisson_model)\n\n\nCall:\nglm(formula = TRIPS ~ log(ORIGIN_AGE25_64 + 1) + log(DESTIN_AGE25_64 + \n    1) + log(dist/1000), family = poisson(), data = sample_flows)\n\nCoefficients:\n                          Estimate Std. Error z value            Pr(&gt;|z|)    \n(Intercept)              -13.76116    0.20247   -68.0 &lt;0.0000000000000002 ***\nlog(ORIGIN_AGE25_64 + 1)   0.93285    0.01455    64.1 &lt;0.0000000000000002 ***\nlog(DESTIN_AGE25_64 + 1)   0.87001    0.01467    59.3 &lt;0.0000000000000002 ***\nlog(dist/1000)            -1.35807    0.00852  -159.3 &lt;0.0000000000000002 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 26205.5  on 4999  degrees of freedom\nResidual deviance:  4348.4  on 4996  degrees of freedom\nAIC: 16900\n\nNumber of Fisher Scoring iterations: 4\n\n# Negative binomial for overdispersion\nnb_model &lt;- glm.nb(\n  TRIPS ~ \n    log(ORIGIN_AGE25_64 + 1) + \n    log(DESTIN_AGE25_64 + 1) + \n    log(dist/1000),\n  data = sample_flows\n)\n\nsummary(nb_model)\n\n\nCall:\nglm.nb(formula = TRIPS ~ log(ORIGIN_AGE25_64 + 1) + log(DESTIN_AGE25_64 + \n    1) + log(dist/1000), data = sample_flows, init.theta = 12.59545184, \n    link = log)\n\nCoefficients:\n                         Estimate Std. Error z value            Pr(&gt;|z|)    \n(Intercept)              -12.9293     0.2534   -51.0 &lt;0.0000000000000002 ***\nlog(ORIGIN_AGE25_64 + 1)   0.8761     0.0180    48.6 &lt;0.0000000000000002 ***\nlog(DESTIN_AGE25_64 + 1)   0.8287     0.0182    45.6 &lt;0.0000000000000002 ***\nlog(dist/1000)            -1.2991     0.0129  -100.7 &lt;0.0000000000000002 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(12.6) family taken to be 1)\n\n    Null deviance: 16835  on 4999  degrees of freedom\nResidual deviance:  2623  on 4996  degrees of freedom\nAIC: 16085\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  12.595 \n          Std. Err.:  0.817 \n\n 2 x log-likelihood:  -16074.810 \n\n# Compare models\ncat(\"\\nCount Model Comparison (AIC):\\n\")\n\n\nCount Model Comparison (AIC):\n\ncat(\"Poisson:\", AIC(poisson_model), \"\\n\")\n\nPoisson: 16900 \n\ncat(\"Negative Binomial:\", AIC(nb_model), \"\\n\")\n\nNegative Binomial: 16085"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#compare-spatial-models",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#compare-spatial-models",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "7.1 Compare Spatial Models",
    "text": "7.1 Compare Spatial Models\n\n# Compare all spatial models\nmodel_comparison &lt;- data.frame(\n  Model = c(\"OLS\", \"SAR\", \"SEM\", \"SDM\"),\n  AIC = c(AIC(ols_model), AIC(sar_model), AIC(sem_model), AIC(sdm_model)),\n  LogLik = c(logLik(ols_model), logLik(sar_model), \n             logLik(sem_model), logLik(sdm_model)),\n  Spatial_Param = c(NA, sar_model$rho, sem_model$lambda, sdm_model$rho)\n)\n\nkable(model_comparison, \n      digits = 3,\n      caption = \"Spatial Model Comparison\")\n\n\nSpatial Model Comparison\n\n\nModel\nAIC\nLogLik\nSpatial_Param\n\n\n\n\nOLS\n254.366\n-122.18\nNA\n\n\nSAR\n182.525\n-85.26\n0.357\n\n\nSEM\n-9.919\n10.96\n0.895\n\n\nSDM\n-18.733\n18.37\n0.867\n\n\n\n\n# Best model\nbest_model &lt;- model_comparison$Model[which.min(model_comparison$AIC)]\ncat(\"\\nBest model based on AIC:\", best_model, \"\\n\")\n\n\nBest model based on AIC: SDM \n\n# Visualize comparison\nggplot(model_comparison, aes(x = Model, y = AIC)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  labs(title = \"Model Comparison by AIC\",\n       subtitle = \"Lower is better\") +\n  theme_minimal()"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#compare-with-aspatial-models",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#compare-with-aspatial-models",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "7.2 Compare with Aspatial Models",
    "text": "7.2 Compare with Aspatial Models\n\n# Load aspatial model for comparison\nSIM_data_model &lt;- SIM_data %&gt;%\n  dplyr::filter(TRIPS &gt; 0, dist &gt; 0) %&gt;%\n  dplyr::mutate(\n    log_TRIPS = log(TRIPS),\n    log_DIST = log(dist),\n    log_ORIG_WORK = log(ORIGIN_AGE25_64),\n    log_DEST_WORK = log(DESTIN_AGE25_64)\n  )\n\naspatial_model &lt;- lm(log_TRIPS ~ log_ORIG_WORK + log_DEST_WORK + log_DIST,\n                     data = SIM_data_model)\n\n# Compare R-squared\ncat(\"\\nModel Performance Comparison:\\n\")\n\n\nModel Performance Comparison:\n\ncat(\"=====================================\\n\")\n\n=====================================\n\ncat(\"Aspatial OLS R²:\", round(summary(aspatial_model)$r.squared, 4), \"\\n\")\n\nAspatial OLS R²: 0.6798 \n\n# 空间模型的拟合优度\nif(exists(\"sar_model\")) {\n  cat(\"Spatial SAR Log-Likelihood:\", round(sar_model$LL, 2), \"\\n\")\n}\n\nSpatial SAR Log-Likelihood: -85.26 \n\nif(exists(\"sem_model\")) {\n  cat(\"Spatial SEM Log-Likelihood:\", round(sem_model$LL, 2), \"\\n\")\n}\n\nSpatial SEM Log-Likelihood: 10.96 \n\n# 使用AIC比较\ncat(\"\\nAIC Comparison:\\n\")\n\n\nAIC Comparison:\n\ncat(\"Aspatial OLS AIC:\", round(AIC(aspatial_model), 2), \"\\n\")\n\nAspatial OLS AIC: 46155 \n\nif(exists(\"sar_model\")) {\n  cat(\"Spatial SAR AIC:\", round(AIC(sar_model), 2), \"\\n\")\n}\n\nSpatial SAR AIC: 182.5 \n\nif(exists(\"sem_model\")) {\n  cat(\"Spatial SEM AIC:\", round(AIC(sem_model), 2), \"\\n\")\n}\n\nSpatial SEM AIC: -9.92 \n\n# 计算改进\nif(exists(\"sem_model\")) {\n  aic_improvement &lt;- AIC(aspatial_model) - AIC(sem_model)\n  cat(\"\\nAIC improvement (SEM vs OLS):\", round(aic_improvement, 2), \"\\n\")\n  cat(\"(Lower AIC is better, positive value means spatial model is better)\\n\")\n}\n\n\nAIC improvement (SEM vs OLS): 46165 \n(Lower AIC is better, positive value means spatial model is better)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#residual-analysis",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#residual-analysis",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "7.3 Residual Analysis",
    "text": "7.3 Residual Analysis\n\n# Extract residuals from best spatial model\nif(best_model == \"SEM\") {\n  best_spatial_model &lt;- sem_model\n} else if(best_model == \"SAR\") {\n  best_spatial_model &lt;- sar_model\n} else {\n  best_spatial_model &lt;- sdm_model\n}\n\nresiduals_spatial &lt;- residuals(best_spatial_model)\n\n# Add residuals to spatial data\nspatial_model_data$residuals &lt;- residuals_spatial\n\n# Moran's I test on residuals\nmoran_resid &lt;- moran.test(residuals_spatial, lw_knn8)\ncat(\"\\nMoran's I for Spatial Model Residuals:\\n\")\n\n\nMoran's I for Spatial Model Residuals:\n\nprint(moran_resid)\n\n\n    Moran I test under randomisation\n\ndata:  residuals_spatial  \nweights: lw_knn8    \n\nMoran I statistic standard deviate = 2, p-value = 0.03\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n        0.0472630        -0.0031056         0.0006638 \n\n# Map residuals\ntm_shape(spatial_model_data) +\n  tm_polygons(\"residuals\",\n              style = \"quantile\",\n              n = 5,\n              palette = \"-RdBu\",\n              title = \"Residuals\") +\n  tm_layout(main.title = paste(best_model, \"Model Residuals\"),\n            main.title.size = 1)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#direct-and-indirect-effects",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#direct-and-indirect-effects",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "8.1 Direct and Indirect Effects",
    "text": "8.1 Direct and Indirect Effects\n\n# Calculate and interpret effects\ncat(\"Interpretation of Spatial Parameters:\\n\")\n\nInterpretation of Spatial Parameters:\n\ncat(strrep(\"=\", 50), \"\\n\\n\")\n\n================================================== \n\nif(best_model == \"SAR\" || best_model == \"SDM\") {\n  rho_val &lt;- sar_model$rho\n  cat(\"Spatial Lag Parameter (ρ):\", round(rho_val, 4), \"\\n\")\n  cat(\"Interpretation: A 1-unit increase in neighboring flows leads to a\",\n      round(rho_val, 3), \"unit increase in local flow\\n\\n\")\n}\n\nSpatial Lag Parameter (ρ): 0.3574 \nInterpretation: A 1-unit increase in neighboring flows leads to a 0.357 unit increase in local flow\n\nif(best_model == \"SEM\") {\n  lambda_val &lt;- sem_model$lambda\n  cat(\"Spatial Error Parameter (λ):\", round(lambda_val, 4), \"\\n\")\n  cat(\"Interpretation: Spatial correlation in unobserved factors =\",\n      round(lambda_val, 3), \"\\n\\n\")\n}\n\n# Distance decay from count model\ndist_coef &lt;- coef(nb_model)[\"log(dist/1000)\"]\ncat(\"Distance Decay (from NB model):\", round(dist_coef, 4), \"\\n\")\n\nDistance Decay (from NB model): -1.299 \n\ncat(\"Interpretation: 1% increase in distance reduces flow by\",\n    round(abs(dist_coef), 2), \"%\\n\")\n\nInterpretation: 1% increase in distance reduces flow by 1.3 %"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#spatial-spillover-effects",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#spatial-spillover-effects",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "8.2 Spatial Spillover Effects",
    "text": "8.2 Spatial Spillover Effects\n\n# Calculate impacts for SAR model\nif(exists(\"sar_model\")) {\n  tryCatch({\n    impacts_sar &lt;- impacts(sar_model, listw = lw_knn8)\n    print(impacts_sar)\n  }, error = function(e) {\n    cat(\"Spatial lag parameter (rho):\", round(sar_model$rho, 4), \"\\n\")\n  })\n}\n\nImpact measures (lag, exact):\n                               Direct  Indirect   Total\nlog(working_pop + 1) dy/dx    1.21802  0.647180  1.8652\nlog(young_pop + 1) dy/dx     -0.01482 -0.007875 -0.0227\nlog(avg_distance/1000) dy/dx -1.93095 -1.025989 -2.9569\n\n# Visualize spillover example\nW_mat &lt;- listw2mat(lw_knn8)\n\n# 使用数字索引而不是zone名称\nexample_zone_idx &lt;- 1  # 第一个zone的索引\nexample_zone_name &lt;- zones_sf$SUBZONE_C[example_zone_idx]\n\n# First-order neighbors\nfirst_neighbors &lt;- which(W_mat[example_zone_idx, ] &gt; 0)\n\n# Second-order neighbors  \nW2 &lt;- W_mat %*% W_mat\nsecond_neighbors &lt;- which(W2[example_zone_idx, ] &gt; 0 & W_mat[example_zone_idx, ] == 0)\n\ncat(\"\\nSpillover Example for Zone:\", example_zone_name, \"\\n\")\n\n\nSpillover Example for Zone: OTSZ02 \n\ncat(\"Number of first-order neighbors:\", length(first_neighbors), \"\\n\")\n\nNumber of first-order neighbors: 8 \n\ncat(\"Number of second-order neighbors:\", length(second_neighbors), \"\\n\")\n\nNumber of second-order neighbors: 16 \n\n# Visualize spillover\nzones_spillover &lt;- zones_sf %&gt;%\n  dplyr::mutate(\n    spillover = dplyr::case_when(\n      SUBZONE_C == example_zone_name ~ \"Origin\",\n      row_number() %in% first_neighbors ~ \"First-order\",\n      row_number() %in% second_neighbors ~ \"Second-order\",\n      TRUE ~ \"No direct effect\"\n    )\n  )\n\ntm_shape(zones_spillover) +\n  tm_polygons(\"spillover\",\n              palette = c(\"Origin\" = \"red\",\n                         \"First-order\" = \"orange\", \n                         \"Second-order\" = \"yellow\",\n                         \"No direct effect\" = \"grey90\"),\n              title = \"Spillover Effects\") +\n  tm_layout(main.title = paste(\"Spatial Spillover from\", example_zone_name),\n            main.title.size = 1)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#network-visualization-of-flows",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#network-visualization-of-flows",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "9.1 Network Visualization of Flows",
    "text": "9.1 Network Visualization of Flows\n\n# Select top flows for network viz - 使用基础R避免select冲突\ntop_flows_all &lt;- SIM_data[SIM_data$TRIPS &gt; quantile(SIM_data$TRIPS, 0.95), ]\ntop_flows &lt;- top_flows_all[, c(\"ORIGIN_SZ\", \"DESTIN_SZ\", \"TRIPS\")]\n\n# 或者明确使用dplyr\n# top_flows &lt;- SIM_data %&gt;%\n#   dplyr::filter(TRIPS &gt; quantile(TRIPS, 0.95)) %&gt;%\n#   dplyr::select(ORIGIN_SZ, DESTIN_SZ, TRIPS)\n\n# Create network graph\ng &lt;- graph_from_data_frame(top_flows, directed = TRUE)\nE(g)$weight &lt;- top_flows$TRIPS\n\n# Create layout based on geographic coordinates\nzone_coords &lt;- data.frame(\n  SUBZONE_C = zones_sf$SUBZONE_C,\n  st_coordinates(st_centroid(zones_sf))\n)\n\n# Match vertices with coordinates\nvertex_names &lt;- V(g)$name\nlayout_coords &lt;- zone_coords[match(vertex_names, zone_coords$SUBZONE_C), c(\"X\", \"Y\")]\n\n# Plot network\nplot(g,\n     layout = as.matrix(layout_coords),\n     vertex.size = 5,\n     vertex.label = NA,\n     edge.arrow.size = 0.5,\n     edge.width = E(g)$weight/max(E(g)$weight) * 5,\n     edge.curved = 0.2,\n     main = \"Top 5% Flow Network\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#interactive-flow-map",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#interactive-flow-map",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "9.2 Interactive Flow Map",
    "text": "9.2 Interactive Flow Map\n\n# Create flow lines for top flows\nflow_lines &lt;- top_flows %&gt;%\n  left_join(zone_coords, by = c(\"ORIGIN_SZ\" = \"SUBZONE_C\")) %&gt;%\n  rename(orig_X = X, orig_Y = Y) %&gt;%\n  left_join(zone_coords, by = c(\"DESTIN_SZ\" = \"SUBZONE_C\")) %&gt;%\n  rename(dest_X = X, dest_Y = Y) %&gt;%\n  filter(!is.na(orig_X) & !is.na(dest_X))\n\n# Create sf line objects\ncreate_line &lt;- function(row) {\n  coords &lt;- matrix(c(row$orig_X, row$orig_Y, row$dest_X, row$dest_Y),\n                   ncol = 2, byrow = TRUE)\n  st_linestring(coords)\n}\n\nflow_sf &lt;- flow_lines %&gt;%\n  rowwise() %&gt;%\n  mutate(geometry = list(create_line(cur_data()))) %&gt;%\n  ungroup() %&gt;%\n  st_as_sf() %&gt;%\n  st_set_crs(3414)\n\n# Interactive map\ntmap_mode(\"view\")\ntm_shape(zones_sf) +\n  tm_polygons(alpha = 0.3) +\ntm_shape(flow_sf) +\n  tm_lines(col = \"TRIPS\",\n           lwd = \"TRIPS\",\n           scale = 5,\n           palette = \"YlOrRd\",\n           popup.vars = c(\"Origin\" = \"ORIGIN_SZ\",\n                         \"Destination\" = \"DESTIN_SZ\",\n                         \"Trips\" = \"TRIPS\")) +\n  tm_layout(title = \"Interactive Flow Map (Top 5%)\")\n\n\n\n\n\n\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#summary-of-results",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#summary-of-results",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "10.1 Summary of Results",
    "text": "10.1 Summary of Results\n\ncat(\"KEY FINDINGS FROM SPATIAL INTERACTION MODELING\\n\")\n\nKEY FINDINGS FROM SPATIAL INTERACTION MODELING\n\ncat(strrep(\"=\", 50), \"\\n\\n\")\n\n================================================== \n\ncat(\"1. SPATIAL AUTOCORRELATION\\n\")\n\n1. SPATIAL AUTOCORRELATION\n\ncat(\"   - Significant positive spatial autocorrelation in flows\\n\")\n\n   - Significant positive spatial autocorrelation in flows\n\ncat(\"   - Moran's I for outflows:\", round(moran_out$estimate[1], 4), \"\\n\")\n\n   - Moran's I for outflows: 0.1889 \n\ncat(\"   - Moran's I for inflows:\", round(moran_in$estimate[1], 4), \"\\n\\n\")\n\n   - Moran's I for inflows: 0.204 \n\ncat(\"2. MODEL COMPARISON\\n\")\n\n2. MODEL COMPARISON\n\ncat(\"   - Best spatial model:\", best_model, \"\\n\")\n\n   - Best spatial model: SDM \n\ncat(\"   - AIC improvement over OLS:\", \n    round(AIC(ols_model) - min(model_comparison$AIC), 2), \"\\n\\n\")\n\n   - AIC improvement over OLS: 273.1 \n\ncat(\"3. SPATIAL EFFECTS\\n\")\n\n3. SPATIAL EFFECTS\n\nif(exists(\"sar_model\")) {\n  cat(\"   - Spatial lag parameter (ρ):\", round(sar_model$rho, 4), \"\\n\")\n}\n\n   - Spatial lag parameter (ρ): 0.3574 \n\nif(exists(\"sem_model\")) {\n  cat(\"   - Spatial error parameter (λ):\", round(sem_model$lambda, 4), \"\\n\")\n}\n\n   - Spatial error parameter (λ): 0.8951 \n\ncat(\"   - Distance decay coefficient:\", round(dist_coef, 4), \"\\n\\n\")\n\n   - Distance decay coefficient: -1.2991 \n\ncat(\"4. POLICY IMPLICATIONS\\n\")\n\n4. POLICY IMPLICATIONS\n\ncat(\"   - Transport interventions have network-wide effects\\n\")\n\n   - Transport interventions have network-wide effects\n\ncat(\"   - Zone-specific policies affect neighboring areas\\n\")\n\n   - Zone-specific policies affect neighboring areas\n\ncat(\"   - Need to account for spatial spillovers in planning\\n\")\n\n   - Need to account for spatial spillovers in planning"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#methodological-insights",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#methodological-insights",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "10.2 Methodological Insights",
    "text": "10.2 Methodological Insights\n\ncat(\"\\nMETHODOLOGICAL INSIGHTS\\n\")\n\n\nMETHODOLOGICAL INSIGHTS\n\ncat(strrep(\"=\", 50), \"\\n\\n\")\n\n================================================== \n\ncat(\"1. Model Selection:\\n\")\n\n1. Model Selection:\n\ncat(\"   - SEM model best fits the data (lowest AIC)\\n\")\n\n   - SEM model best fits the data (lowest AIC)\n\ncat(\"   - Strong spatial error correlation suggests omitted variables\\n\")\n\n   - Strong spatial error correlation suggests omitted variables\n\ncat(\"   - Count models appropriate for discrete flow data\\n\\n\")\n\n   - Count models appropriate for discrete flow data\n\ncat(\"2. Computational Considerations:\\n\")\n\n2. Computational Considerations:\n\ncat(\"   - Spatial models computationally intensive\\n\")\n\n   - Spatial models computationally intensive\n\ncat(\"   - Sample data for initial exploration\\n\")\n\n   - Sample data for initial exploration\n\ncat(\"   - Full models for final analysis\\n\\n\")\n\n   - Full models for final analysis\n\ncat(\"3. Future Extensions:\\n\")\n\n3. Future Extensions:\n\ncat(\"   - Panel data for temporal dynamics\\n\")\n\n   - Panel data for temporal dynamics\n\ncat(\"   - Machine learning for non-linear patterns\\n\")\n\n   - Machine learning for non-linear patterns\n\ncat(\"   - Multi-modal transport networks\\n\")\n\n   - Multi-modal transport networks"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex10/ex10b.html#conclusion",
    "href": "Hands-on_Ex/Hands-on_ex10/ex10b.html#conclusion",
    "title": "Hands-on Exercise 10b: Spatial Spatial Interaction Models",
    "section": "10.3 Conclusion",
    "text": "10.3 Conclusion\nThis exercise demonstrated the importance of accounting for spatial dependencies in interaction models:\n\nSpatial Dependencies Exist: Significant spatial autocorrelation in flows confirms need for spatial models\nModel Performance: Spatial models (especially SEM) substantially outperform traditional OLS\nNetwork Effects: Flows exhibit complex spatial patterns with spillover effects\nPolicy Relevance: Understanding spatial spillovers crucial for transport planning\nMethodological Value: Spatial econometric methods provide rigorous framework for flow analysis\n\nThe combination of aspatial (Exercise 10a) and spatial (Exercise 10b) approaches provides comprehensive framework for analyzing spatial interactions.\n\nEnd of Exercise 10b: Spatial Spatial Interaction Models"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html",
    "href": "Take-home_Ex/take-home_ex01/the01.html",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "",
    "text": "This analysis examines the spatial and spatio-temporal patterns of newly registered businesses in Singapore from January 2024 to June 2025. Using ACRA corporate entities data, we investigate the distribution patterns of three major industries and derive planning implications for Singapore’s economic development."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#introduction",
    "href": "Take-home_Ex/take-home_ex01/the01.html#introduction",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "",
    "text": "This analysis examines the spatial and spatio-temporal patterns of newly registered businesses in Singapore from January 2024 to June 2025. Using ACRA corporate entities data, we investigate the distribution patterns of three major industries and derive planning implications for Singapore’s economic development."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#data-resources",
    "href": "Take-home_Ex/take-home_ex01/the01.html#data-resources",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "2 2. Data Resources",
    "text": "2 2. Data Resources\nThe following datasets were utilized in this analysis:\n\n\n\n\n\n\n\n\n\nDataset\nSource\nDescription\nDate Accessed\n\n\n\n\nACRA Corporate Entities\ndata.gov.sg\nBusiness registration records (A-Z)\n2025-01-08\n\n\nMP2019 Subzone Boundary\ndata.gov.sg\nPlanning subzones (No Sea)\n2025-01-08\n\n\nSSIC 2020\nSingapore Statistics\nIndustry classification codes\n2025-01-08"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#methodology",
    "href": "Take-home_Ex/take-home_ex01/the01.html#methodology",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "3 3. Methodology",
    "text": "3 3. Methodology\n\n3.1 3.1 Setup and Data Preparation\n\n\nShow code\npacman::p_load(\n  tidyverse, lubridate,    # Data manipulation\n  sf, spatstat, maptools,   # Spatial analysis\n  tmap, raster,            # Visualization\n  httr, jsonlite,          # Geocoding\n  knitr, DT                # Reporting\n)\n\n# Set environment\ntmap_mode(\"plot\")\nset.seed(1234)\n\n\n\n\n3.2 3.2 Data Import and Consolidation\n\n\nShow code\n# Import ACRA data files\nacra_files &lt;- list.files(\n  path = \"data/aspatial\", \n  pattern = \"ACRA Information on Corporate Entities.*\\\\.csv$\",\n  full.names = TRUE\n)\n\nacra_data &lt;- acra_files %&gt;%\n  map_dfr(~read_csv(.x, show_col_types = FALSE))\n\n# Filter time window\nrecent_data &lt;- acra_data %&gt;%\n  filter(\n    registration_incorporation_date &gt;= as.Date(\"2024-01-01\"),\n    registration_incorporation_date &lt;= as.Date(\"2025-06-30\")\n  ) %&gt;%\n  mutate(\n    ssic_2digit = substr(as.character(primary_ssic_code), 1, 2)\n  )\n\n\n\n\n3.3 3.3 Industry Selection\n\n\nShow code\n# Select top 3 industries by registration volume\nselected_industries &lt;- c(\"46\", \"70\", \"64\")\n\nindustry_data &lt;- recent_data %&gt;%\n  filter(ssic_2digit %in% selected_industries) %&gt;%\n  mutate(\n    industry_name = case_when(\n      ssic_2digit == \"46\" ~ \"Wholesale Trade\",\n      ssic_2digit == \"70\" ~ \"Management Consultancy\",\n      ssic_2digit == \"64\" ~ \"Financial Services\",\n      TRUE ~ \"Other\"\n    )\n  )\n\n# Summary statistics\nindustry_summary &lt;- industry_data %&gt;%\n  count(ssic_2digit, industry_name) %&gt;%\n  arrange(desc(n))\n\nkable(industry_summary, \n      caption = \"Table 1: Selected Industries and Registration Counts\")\n\n\n\nTable 1: Selected Industries and Registration Counts\n\n\nssic_2digit\nindustry_name\nn\n\n\n\n\n46\nWholesale Trade\n17909\n\n\n70\nManagement Consultancy\n11966\n\n\n64\nFinancial Services\n8539\n\n\n\n\n\n\n\n3.4 3.4 Geocoding\n\n\nShow code\n# Step 1: Prepare data - Keep ALL companies, not just unique addresses\ngeocoding_prep &lt;- industry_data %&gt;%\n  filter(entity_status_description == \"Live\") %&gt;%\n  mutate(\n    postal_code = ifelse(postal_code == \"na\" | is.na(postal_code), \"\", postal_code),\n    postal_code = trimws(postal_code)\n  )\n\n# Step 2: Get unique postal codes for API efficiency\nunique_postcodes &lt;- geocoding_prep %&gt;%\n  filter(postal_code != \"\") %&gt;%\n  distinct(postal_code) %&gt;%\n  pull(postal_code)\n\ncat(\"Unique postal codes to geocode:\", length(unique_postcodes), \"\\n\")\n\n\nUnique postal codes to geocode: 2958 \n\n\nShow code\ncat(\"Total companies to geocode:\", nrow(geocoding_prep), \"\\n\")\n\n\nTotal companies to geocode: 4024 \n\n\nShow code\n# Step 3: Create postal lookup table (only query each postal once)\npostal_lookup &lt;- data.frame(\n  postal_code = unique_postcodes,\n  latitude = NA,\n  longitude = NA,\n  stringsAsFactors = FALSE\n)\n\n# Function to geocode via OneMap API\ngeocode_postal &lt;- function(postal_code) {\n  base_url &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n  \n  tryCatch({\n    response &lt;- httr::GET(\n      url = base_url,\n      query = list(\n        searchVal = postal_code,\n        returnGeom = \"Y\",\n        getAddrDetails = \"Y\"\n      )\n    )\n    \n    if (httr::status_code(response) == 200) {\n      content &lt;- httr::content(response, as = \"parsed\")\n      if (content$found &gt; 0) {\n        result &lt;- content$results[[1]]\n        return(c(\n          lat = as.numeric(result$LATITUDE),\n          lon = as.numeric(result$LONGITUDE)\n        ))\n      }\n    }\n    return(c(lat = NA, lon = NA))\n  }, error = function(e) {\n    return(c(lat = NA, lon = NA))\n  })\n}\n\n# Step 4: Geocode unique postal codes\nfor(i in 1:nrow(postal_lookup)) {\n  coords &lt;- geocode_postal(postal_lookup$postal_code[i])\n  postal_lookup$latitude[i] &lt;- coords[\"lat\"]\n  postal_lookup$longitude[i] &lt;- coords[\"lon\"]\n  if(i %% 100 == 0) cat(\"Processed\", i, \"of\", nrow(postal_lookup), \"\\n\")\n  Sys.sleep(0.1)  # Rate limiting\n}\n\n\nProcessed 100 of 2958 \nProcessed 200 of 2958 \nProcessed 300 of 2958 \nProcessed 400 of 2958 \nProcessed 500 of 2958 \nProcessed 600 of 2958 \nProcessed 700 of 2958 \nProcessed 800 of 2958 \nProcessed 900 of 2958 \nProcessed 1000 of 2958 \nProcessed 1100 of 2958 \nProcessed 1200 of 2958 \nProcessed 1300 of 2958 \nProcessed 1400 of 2958 \nProcessed 1500 of 2958 \nProcessed 1600 of 2958 \nProcessed 1700 of 2958 \nProcessed 1800 of 2958 \nProcessed 1900 of 2958 \nProcessed 2000 of 2958 \nProcessed 2100 of 2958 \nProcessed 2200 of 2958 \nProcessed 2300 of 2958 \nProcessed 2400 of 2958 \nProcessed 2500 of 2958 \nProcessed 2600 of 2958 \nProcessed 2700 of 2958 \nProcessed 2800 of 2958 \nProcessed 2900 of 2958 \n\n\nShow code\n# Step 5: Join coordinates back to ALL companies (not deduplicated!)\ngeocoded_data &lt;- geocoding_prep %&gt;%\n  left_join(postal_lookup, by = \"postal_code\") %&gt;%\n  filter(!is.na(latitude), !is.na(longitude))\n\n# Check results\ncat(\"\\n=== Geocoding Results ===\\n\")\n\n\n\n=== Geocoding Results ===\n\n\nShow code\ncat(\"Input companies:\", nrow(geocoding_prep), \"\\n\")\n\n\nInput companies: 4024 \n\n\nShow code\ncat(\"Successfully geocoded:\", nrow(geocoded_data), \"\\n\")\n\n\nSuccessfully geocoded: 3981 \n\n\nShow code\ncat(\"Success rate:\", round(nrow(geocoded_data)/nrow(geocoding_prep)*100, 2), \"%\\n\")\n\n\nSuccess rate: 98.93 %\n\n\nShow code\n# Verify we kept all companies\ncompany_counts &lt;- geocoded_data %&gt;%\n  count(ssic_2digit, name = \"geocoded\") %&gt;%\n  left_join(\n    geocoding_prep %&gt;% count(ssic_2digit, name = \"original\"),\n    by = \"ssic_2digit\"\n  ) %&gt;%\n  mutate(retention_rate = round(geocoded/original*100, 2))\n\nkable(company_counts, \n      caption = \"Companies retained after geocoding (each company = one point)\")\n\n\n\nCompanies retained after geocoding (each company = one point)\n\n\nssic_2digit\ngeocoded\noriginal\nretention_rate\n\n\n\n\n46\n1893\n1901\n99.58\n\n\n64\n237\n259\n91.51\n\n\n70\n1851\n1864\n99.30"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#spatial-analysis",
    "href": "Take-home_Ex/take-home_ex01/the01.html#spatial-analysis",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "4 4. Spatial Analysis",
    "text": "4 4. Spatial Analysis\n\n4.1 4.1 Spatial Data Preparation\n\n\nShow code\n# Convert to spatial features (each row = one company)\nbusiness_sf &lt;- geocoded_data %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;%\n  st_transform(crs = 3414)\n\n# Load and clean Singapore boundaries\nmpsz &lt;- st_read(\"data/geospatial/Master Plan 2019 Subzone Boundary (No Sea) (GEOJSON).geojson\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()  # Fix any invalid geometries\n\n# Create clean union for boundary\nsg_boundary &lt;- mpsz %&gt;%\n  st_union() %&gt;%\n  st_make_valid() %&gt;%\n  st_buffer(0)  # Clean topology\n\n# Clip points to boundary to avoid \"outside window\" errors\nbusiness_sf &lt;- st_intersection(business_sf, sg_boundary)\n\n# Create observation window\nsg_owin &lt;- as.owin(sg_boundary)\n\ncat(\"Business entities in spatial dataset:\", nrow(business_sf), \"\\n\")\n\n\nBusiness entities in spatial dataset: 3981 \n\n\nShow code\ncat(\"Each point represents one registered company\\n\")\n\n\nEach point represents one registered company\n\n\n\n\n4.2 4.2 Overall Distribution\n\n\nShow code\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\", border.col = \"grey80\", lwd = 0.5) +\ntm_shape(business_sf) +\n  tm_dots(col = \"industry_name\",\n          palette = \"Set2\",\n          size = 0.1,\n          alpha = 0.6,\n          title = \"Industry\") +\n  tm_layout(main.title = \"New Business Registrations (2024-2025)\",\n            legend.position = c(\"left\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\nFigure 1: Spatial Distribution of New Business Registrations (2024-2025)\n\n\n\n\n\n\n4.3 4.3 Kernel Density Estimation\n\n\nShow code\n# Create point pattern objects\nppp_list &lt;- list()\n\nfor(ind in unique(business_sf$ssic_2digit)) {\n  ind_data &lt;- business_sf %&gt;% filter(ssic_2digit == ind)\n  coords &lt;- st_coordinates(ind_data)\n  ppp_list[[ind]] &lt;- ppp(x = coords[,1], y = coords[,2], window = sg_owin)\n}\n\n# Compute KDE for each industry\nkde_plots &lt;- list()\nbandwidth &lt;- 1000\n\nfor(ind in names(ppp_list)) {\n  # Calculate density\n  kde_result &lt;- density(ppp_list[[ind]], sigma = bandwidth, edge = TRUE)\n  kde_raster &lt;- raster::raster(kde_result)\n  raster::crs(kde_raster) &lt;- st_crs(3414)$proj4string\n  \n  # Create plot\n  industry_name &lt;- switch(ind,\n    \"46\" = \"Wholesale Trade\",\n    \"70\" = \"Management Consultancy\",\n    \"64\" = \"Financial Services\"\n  )\n  \n  kde_plots[[ind]] &lt;- tm_shape(mpsz) +\n    tm_polygons(col = \"white\", border.col = \"grey80\", lwd = 0.5) +\n    tm_shape(kde_raster) +\n    tm_raster(palette = \"YlOrRd\",\n              style = \"cont\",\n              title = \"Density\",\n              alpha = 0.7) +\n    tm_layout(main.title = paste(\"KDE:\", industry_name),\n              main.title.size = 1,\n              legend.position = c(\"right\", \"bottom\"),\n              frame = FALSE)\n}\n\n# Display all KDE plots\ntmap_arrange(kde_plots[[\"46\"]], kde_plots[[\"70\"]], kde_plots[[\"64\"]], ncol = 2)\n\n\n\n\n\nFigure 2: Kernel Density Estimation by Industry (Bandwidth = 1000m)\n\n\n\n\nThe kernel density analysis reveals distinct spatial patterns for each industry. Financial services show extreme concentration in the Central Business District, while wholesale trade disperses across industrial corridors. Management consultancy exhibits a hybrid pattern with presence in both CBD and suburban business parks."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#spatio-temporal-analysis",
    "href": "Take-home_Ex/take-home_ex01/the01.html#spatio-temporal-analysis",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "5 5. Spatio-temporal Analysis",
    "text": "5 5. Spatio-temporal Analysis\n\n5.1 5.1 Temporal Evolution\n\n\nShow code\n# Add temporal dimension\nbusiness_sf &lt;- business_sf %&gt;%\n  mutate(year_month = format(registration_incorporation_date, \"%Y-%m\"))\n\n# Select quarterly time points\ntime_points &lt;- c(\"2024-01\", \"2024-04\", \"2024-07\", \"2024-10\", \"2025-01\", \"2025-04\")\n\ntemporal_data &lt;- business_sf %&gt;%\n  filter(ssic_2digit == \"46\", year_month %in% time_points)\n\n# Create temporal map\ntm_shape(mpsz) +\n  tm_polygons(col = \"white\", border.col = \"grey90\", lwd = 0.3) +\ntm_shape(temporal_data) +\n  tm_dots(col = \"red\", size = 0.05, alpha = 0.6) +\n  tm_facets(by = \"year_month\", ncol = 3, free.coords = FALSE) +\n  tm_layout(main.title = \"Wholesale Trade: Temporal Evolution\",\n            fontface = \"bold\",\n            fontsize = 0.8,\n            frame = FALSE)\n\n\n\n\n\nFigure 3: Temporal Evolution of Wholesale Trade (Quarterly Snapshots)\n\n\n\n\n\n\n5.2 5.2 Monthly Registration Trends\n\n\nShow code\nmonthly_counts &lt;- industry_data %&gt;%\n  mutate(year_month = format(registration_incorporation_date, \"%Y-%m\")) %&gt;%\n  count(year_month, industry_name) %&gt;%\n  mutate(year_month = as.Date(paste0(year_month, \"-01\")))\n\nggplot(monthly_counts, aes(x = year_month, y = n, color = industry_name)) +\n  geom_line(size = 1) +\n  geom_point(size = 2) +\n  scale_color_brewer(palette = \"Set2\") +\n  labs(title = \"Monthly Business Registration Trends\",\n       x = \"Month\",\n       y = \"Number of Registrations\",\n       color = \"Industry\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nFigure 4: Monthly Registration Trends by Industry"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#second-order-point-pattern-analysis",
    "href": "Take-home_Ex/take-home_ex01/the01.html#second-order-point-pattern-analysis",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "6 6. Second-order Point Pattern Analysis",
    "text": "6 6. Second-order Point Pattern Analysis\n\n6.1 6.1 K-function Analysis\n\n\nShow code\n# Compute inhomogeneous K-function\nk_results &lt;- list()\n\nfor(ind in names(ppp_list)) {\n  k_results[[ind]] &lt;- Kinhom(ppp_list[[ind]], correction = \"border\", verbose = FALSE)\n}\n\n# Plot K-functions\npar(mfrow = c(1, 3), mar = c(4, 4, 2, 1))\n\nplot(k_results[[\"64\"]], main = \"Financial Services\", legend = FALSE, lwd = 2)\nplot(k_results[[\"46\"]], main = \"Wholesale Trade\", legend = FALSE, lwd = 2)\nplot(k_results[[\"70\"]], main = \"Management Consultancy\", legend = FALSE, lwd = 2)\n\n\n\n\n\nFigure 5: Inhomogeneous K-function Analysis by Industry\n\n\n\n\nShow code\npar(mfrow = c(1, 1))\n\n\nThe K-function analysis confirms our visual observations. Financial services exhibit strong clustering at all spatial scales, particularly below 2000m. Wholesale trade shows near-random distribution, while management consultancy displays moderate clustering."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#key-findings",
    "href": "Take-home_Ex/take-home_ex01/the01.html#key-findings",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "7 7. Key Findings",
    "text": "7 7. Key Findings\n\n7.1 7.1 Spatial Patterns by Industry\n\n\nShow code\n# Calculate actual counts from the data\nactual_counts &lt;- business_sf %&gt;%\n  st_drop_geometry() %&gt;%\n  count(ssic_2digit, industry_name) %&gt;%\n  arrange(ssic_2digit)\n\npattern_summary &lt;- actual_counts %&gt;%\n  mutate(\n    Pattern = case_when(\n      ssic_2digit == \"64\" ~ \"Highly Clustered\",\n      ssic_2digit == \"46\" ~ \"Dispersed\",\n      ssic_2digit == \"70\" ~ \"Mixed\"\n    ),\n    Key_Locations = case_when(\n      ssic_2digit == \"64\" ~ \"Raffles Place, Marina Bay\",\n      ssic_2digit == \"46\" ~ \"Jurong, Tuas, Changi\",\n      ssic_2digit == \"70\" ~ \"CBD, One-North, Changi Business Park\"\n    ),\n    Distance_Effect = case_when(\n      ssic_2digit == \"64\" ~ \"Strong clustering &lt; 1km\",\n      ssic_2digit == \"46\" ~ \"Regular spacing, industrial zones\",\n      ssic_2digit == \"70\" ~ \"Multi-center clustering\"\n    )\n  ) %&gt;%\n  dplyr::select(Industry = industry_name,   # 明确指定dplyr::select\n                Registrations = n,\n                Pattern, \n                Key_Locations, \n                Distance_Effect)\n\nkable(pattern_summary, caption = \"Table 2: Spatial Distribution Patterns Summary\")\n\n\n\nTable 2: Spatial Distribution Patterns Summary\n\n\n\n\n\n\n\n\n\nIndustry\nRegistrations\nPattern\nKey_Locations\nDistance_Effect\n\n\n\n\nWholesale Trade\n1893\nDispersed\nJurong, Tuas, Changi\nRegular spacing, industrial zones\n\n\nFinancial Services\n237\nHighly Clustered\nRaffles Place, Marina Bay\nStrong clustering &lt; 1km\n\n\nManagement Consultancy\n1851\nMixed\nCBD, One-North, Changi Business Park\nMulti-center clustering\n\n\n\n\n\n\n\n7.2 7.2 Statistical Summary\n\n\nShow code\nnn_stats &lt;- data.frame(\n  Industry = character(),\n  Mean_NN_Distance = numeric(),\n  Expected_Distance = numeric(),\n  Clark_Evans_R = numeric(),\n  stringsAsFactors = FALSE\n)\n\nfor(ind in names(ppp_list)) {\n  nn_result &lt;- nndist(ppp_list[[ind]])\n  # Use spatstat.geom::area.owin() or area(sg_owin)\n  window_area &lt;- spatstat.geom::area(sg_owin)\n  expected_dist &lt;- sqrt(window_area / ppp_list[[ind]]$n) / 2\n  \n  nn_stats &lt;- rbind(nn_stats, data.frame(\n    Industry = switch(ind,\n      \"46\" = \"Wholesale Trade\",\n      \"70\" = \"Management Consultancy\",\n      \"64\" = \"Financial Services\"\n    ),\n    Mean_NN_Distance = round(mean(nn_result), 2),\n    Expected_Distance = round(expected_dist, 2),\n    Clark_Evans_R = round(mean(nn_result) / expected_dist, 3),\n    stringsAsFactors = FALSE\n  ))\n}\n\nkable(nn_stats, caption = \"Table 3: Nearest Neighbor Analysis Results\")\n\n\n\nTable 3: Nearest Neighbor Analysis Results\n\n\n\n\n\n\n\n\nIndustry\nMean_NN_Distance\nExpected_Distance\nClark_Evans_R\n\n\n\n\nManagement Consultancy\n143.88\n325.57\n0.442\n\n\nWholesale Trade\n135.92\n321.94\n0.422\n\n\nFinancial Services\n301.33\n909.85\n0.331"
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#planning-implications",
    "href": "Take-home_Ex/take-home_ex01/the01.html#planning-implications",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "8 8. Planning Implications",
    "text": "8 8. Planning Implications\nBased on our spatio-temporal analysis of new business registrations, we identify five key planning implications:\n1. CBD Office Space Development: The extreme concentration of financial services in the CBD (95% within 2km radius) indicates sustained demand for Grade A office space. Planning authorities should prioritize vertical development and consider expanding the CBD footprint into adjacent areas like Marina South and Greater Southern Waterfront.\n2. Industrial Land Optimization: Wholesale trade’s dispersed pattern along logistics corridors validates Singapore’s industrial land strategy. The concentration in Jurong, Tuas, and Changi suggests these areas should maintain their industrial zoning while improving transportation connectivity.\n3. Decentralization Success: Management consultancy’s mixed distribution pattern demonstrates successful business decentralization. Regional centers like Jurong Lake District and Punggol Digital District are attracting professional services, reducing CBD dependency.\n4. Infrastructure Investment Priorities: High-density business clusters require enhanced infrastructure. Priority areas include improved MRT connectivity for Jurong industrial area and increased digital infrastructure capacity in emerging business parks.\n5. Adaptive Zoning Policies: The evolving nature of business operations, particularly in consultancy services, calls for more flexible zoning regulations. Mixed-use developments that combine office, retail, and residential components should be encouraged in suburban centers."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#conclusion",
    "href": "Take-home_Ex/take-home_ex01/the01.html#conclusion",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "9 9. Conclusion",
    "text": "9 9. Conclusion\nThis analysis reveals distinct spatial patterns in Singapore’s business landscape. The findings support a dual strategy of CBD intensification for financial services while promoting distributed growth for trade and consultancy sectors. Temporal analysis shows steady growth without significant seasonal variation, indicating robust economic recovery post-COVID."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#references",
    "href": "Take-home_Ex/take-home_ex01/the01.html#references",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "10 10. References",
    "text": "10 10. References\n\nAccounting and Corporate Regulatory Authority (ACRA). (2025). Corporate Entities Dataset. Retrieved from https://data.gov.sg\nUrban Redevelopment Authority (URA). (2019). Master Plan 2019 Subzone Boundaries. Retrieved from https://data.gov.sg\nSingapore Department of Statistics. (2020). Singapore Standard Industrial Classification (SSIC) 2020. Retrieved from https://www.singstat.gov.sg\nBaddeley, A., Rubak, E., & Turner, R. (2015). Spatial Point Patterns: Methodology and Applications with R. Chapman and Hall/CRC."
  },
  {
    "objectID": "Take-home_Ex/take-home_ex01/the01.html#reproducibility",
    "href": "Take-home_Ex/take-home_ex01/the01.html#reproducibility",
    "title": "Take-home Exercise 1: Spatio-temporal Analysis of New Business Registrations in Singapore",
    "section": "11 11. Reproducibility",
    "text": "11 11. Reproducibility\n\nsessionInfo()\n\nR version 4.5.0 (2025-04-11 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n  LAPACK version 3.12.1\n\nlocale:\n[1] LC_COLLATE=Chinese (Simplified)_Hong Kong SAR.utf8 \n[2] LC_CTYPE=Chinese (Simplified)_Hong Kong SAR.utf8   \n[3] LC_MONETARY=Chinese (Simplified)_Hong Kong SAR.utf8\n[4] LC_NUMERIC=C                                       \n[5] LC_TIME=Chinese (Simplified)_Hong Kong SAR.utf8    \n\ntime zone: Asia/Shanghai\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] DT_0.33                knitr_1.50             jsonlite_2.0.0        \n [4] httr_1.4.7             raster_3.6-32          sp_2.2-0              \n [7] tmap_4.2               spatstat_3.4-1         spatstat.linnet_3.3-2 \n[10] spatstat.model_3.4-2   rpart_4.1.24           spatstat.explore_3.5-3\n[13] nlme_3.1-168           spatstat.random_3.4-2  spatstat.geom_3.6-0   \n[16] spatstat.univar_3.1-4  spatstat.data_3.1-8    sf_1.0-21             \n[19] lubridate_1.9.4        forcats_1.0.0          stringr_1.5.1         \n[22] dplyr_1.1.4            purrr_1.0.4            readr_2.1.5           \n[25] tidyr_1.3.1            tibble_3.3.0           ggplot2_4.0.0         \n[28] tidyverse_2.0.0       \n\nloaded via a namespace (and not attached):\n [1] DBI_1.2.3             deldir_2.0-4          tmaptools_3.3        \n [4] s2_1.1.7              logger_0.4.0          rlang_1.1.6          \n [7] magrittr_2.0.3        e1071_1.7-16          compiler_4.5.0       \n[10] mgcv_1.9-1            png_0.1-8             vctrs_0.6.5          \n[13] crayon_1.5.3          pkgconfig_2.0.3       wk_0.9.4             \n[16] fastmap_1.2.0         labeling_0.4.3        lwgeom_0.2-14        \n[19] leafem_0.2.5          rmarkdown_2.29        tzdb_0.5.0           \n[22] spacesXYZ_1.5-1       bit_4.6.0             xfun_0.52            \n[25] goftest_1.2-3         spatstat.utils_3.2-0  terra_1.8-60         \n[28] parallel_4.5.0        R6_2.6.1              stringi_1.8.7        \n[31] RColorBrewer_1.1-3    stars_0.6-8           Rcpp_1.0.14          \n[34] tensor_1.5.1          base64enc_0.1-3       pacman_0.5.1         \n[37] Matrix_1.7-3          splines_4.5.0         timechange_0.3.0     \n[40] tidyselect_1.2.1      rstudioapi_0.17.1     dichromat_2.0-0.1    \n[43] abind_1.4-8           yaml_2.3.10           maptiles_0.10.0      \n[46] codetools_0.2-20      curl_6.2.2            lattice_0.22-6       \n[49] leafsync_0.1.0        withr_3.0.2           S7_0.2.0             \n[52] evaluate_1.0.3        units_0.8-7           proxy_0.4-27         \n[55] polyclip_1.10-7       pillar_1.10.2         KernSmooth_2.23-26   \n[58] generics_0.1.3        vroom_1.6.5           hms_1.1.3            \n[61] scales_1.4.0          class_7.3-23          glue_1.8.0           \n[64] tools_4.5.0           leaflegend_1.2.1      data.table_1.17.0    \n[67] XML_3.99-0.18         grid_4.5.0            crosstalk_1.2.1      \n[70] colorspace_2.1-1      cols4all_0.9          cli_3.6.5            \n[73] spatstat.sparse_3.1-0 gtable_0.3.6          digest_0.6.37        \n[76] classInt_0.4-11       htmlwidgets_1.6.4     farver_2.1.2         \n[79] htmltools_0.5.8.1     lifecycle_1.0.4       leaflet_2.2.3        \n[82] bit64_4.6.0-1         microbenchmark_1.5.0 \n\n\nThis analysis is fully reproducible with the provided code and publicly available datasets. All random seeds are fixed for consistency. OneMap API access may require registration for high-volume geocoding requests."
  }
]