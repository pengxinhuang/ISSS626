[
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "",
    "text": "Geographically Weighted Regression (GWR) is a spatial statistical technique that recognizes that traditional “global” regression models may be limited when spatial processes vary across a study area. In this hands-on exercise, we will learn how to build hedonic pricing models using GWR methods to examine the relationships between condo selling prices and various structural and locational characteristics in Singapore.\n\n\nBy the end of this session, you will be able to:\n\nBuild hedonic pricing models using OLS and GWR methods\nCalibrate GWR models using fixed and adaptive bandwidths\nVisualize and interpret GWR outputs\nCompare global and local regression models"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#overview",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "",
    "text": "Geographically Weighted Regression (GWR) is a spatial statistical technique that recognizes that traditional “global” regression models may be limited when spatial processes vary across a study area. In this hands-on exercise, we will learn how to build hedonic pricing models using GWR methods to examine the relationships between condo selling prices and various structural and locational characteristics in Singapore.\n\n\nBy the end of this session, you will be able to:\n\nBuild hedonic pricing models using OLS and GWR methods\nCalibrate GWR models using fixed and adaptive bandwidths\nVisualize and interpret GWR outputs\nCompare global and local regression models"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#the-data",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#the-data",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "2. The Data",
    "text": "2. The Data\nTwo datasets will be used:\n\nURA Master Plan 2014 subzone boundaries (geospatial)\nCondo resale prices 2015 (aspatial)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#getting-started",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "3. Getting Started",
    "text": "3. Getting Started\n\n3.1 Loading Required Packages\n\npacman::p_load(sf, tidyverse, tmap, spdep, GWmodel, \n               ggpubr, corrplot, plotly, \n               olsrr, devtools, parallel)\n\n\n\n3.2 Importing Geospatial Data\n\n# Read Master Plan 2014 Subzone Boundary\nmpsz &lt;- st_read(dsn = \"data/geospatial\", \n                layer = \"MP14_SUBZONE_WEB_PL\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)  # SVY21\n\n# Check the data\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#importing-and-preparing-aspatial-data",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#importing-and-preparing-aspatial-data",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "4. Importing and Preparing Aspatial Data",
    "text": "4. Importing and Preparing Aspatial Data\n\n4.1 Import Condo Resale Data\n\n# Read condo resale data\ncondo_resale &lt;- read_csv(\"data/aspatial/Condo_resale_2015.csv\",\n                         show_col_types = FALSE)\n\n# Check data structure\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n# Check variable names and fix case sensitivity issues\nnames(condo_resale)\n\n [1] \"LATITUDE\"             \"LONGITUDE\"            \"POSTCODE\"            \n [4] \"SELLING_PRICE\"        \"AREA_SQM\"             \"AGE\"                 \n [7] \"PROX_CBD\"             \"PROX_CHILDCARE\"       \"PROX_ELDERLYCARE\"    \n[10] \"PROX_URA_GROWTH_AREA\" \"PROX_HAWKER_MARKET\"   \"PROX_KINDERGARTEN\"   \n[13] \"PROX_MRT\"             \"PROX_PARK\"            \"PROX_PRIMARY_SCH\"    \n[16] \"PROX_TOP_PRIMARY_SCH\" \"PROX_SHOPPING_MALL\"   \"PROX_SUPERMARKET\"    \n[19] \"PROX_BUS_STOP\"        \"NO_Of_UNITS\"          \"FAMILY_FRIENDLY\"     \n[22] \"FREEHOLD\"             \"LEASEHOLD_99YR\"      \n\n# Standardize variable names if needed\nif(\"NO_Of_UNITS\" %in% names(condo_resale)) {\n  condo_resale &lt;- condo_resale %&gt;%\n    rename(NO_OF_UNITS = NO_Of_UNITS)\n}\n\n# Summary statistics\nsummary(condo_resale)\n\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05352   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_OF_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151711   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n\n\n\n\n4.2 Data Preprocessing\n\n# Function to convert factor/character to 0/1\nto01 &lt;- function(x) as.numeric(as.factor(x)) - 1\n\n# Convert binary variables to numeric if they aren't already\ncondo_resale &lt;- condo_resale %&gt;%\n  mutate(\n    FREEHOLD = if(is.numeric(FREEHOLD)) FREEHOLD else to01(FREEHOLD),\n    FAMILY_FRIENDLY = if(is.numeric(FAMILY_FRIENDLY)) FAMILY_FRIENDLY else to01(FAMILY_FRIENDLY),\n    LEASEHOLD_99YR = if(exists(\"LEASEHOLD_99YR\") && !is.numeric(LEASEHOLD_99YR)) to01(LEASEHOLD_99YR) else LEASEHOLD_99YR\n  )\n\n# Check for required variables\nrequired_vars &lt;- c(\"SELLING_PRICE\", \"AREA_SQM\", \"AGE\", \"PROX_CBD\", \"PROX_MRT\")\nstopifnot(all(required_vars %in% names(condo_resale)))\n\n# Remove rows with NA values in key variables\ncondo_resale &lt;- condo_resale %&gt;%\n  drop_na(SELLING_PRICE, AREA_SQM, AGE)\n\n\n\n4.3 Convert Aspatial Data to sf Object\n\n# Convert to sf object using coordinates\ncondo_resale_sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs = 4326) %&gt;%\n  st_transform(crs = 3414)\n\n# Check the result\nhead(condo_resale_sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_OF_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#exploratory-data-analysis",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#exploratory-data-analysis",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "5. Exploratory Data Analysis",
    "text": "5. Exploratory Data Analysis\n\n5.1 Distribution of Selling Prices\n\n# Histogram of selling price\np1 &lt;- ggplot(data = condo_resale, aes(x = SELLING_PRICE)) +\n  geom_histogram(bins = 20, fill = \"lightblue\", color = \"black\") +\n  labs(title = \"Distribution of Selling Prices\",\n       x = \"Selling Price ($)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\n# Log-transformed selling price\np2 &lt;- ggplot(data = condo_resale, \n             aes(x = log(SELLING_PRICE))) +\n  geom_histogram(bins = 20, fill = \"lightgreen\", color = \"black\") +\n  labs(title = \"Distribution of Log Selling Prices\",\n       x = \"Log(Selling Price)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\nggarrange(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n5.2 Geographic Distribution of Condo Sales\n\n# Use plot mode for better performance\ntmap_mode(\"plot\")\n\ntm_shape(mpsz) +\n  tm_polygons(alpha = 0.3) +\ntm_shape(condo_resale_sf) +\n  tm_dots(col = \"SELLING_PRICE\",\n          size = 0.02,  # Reduced size for better visibility\n          border.col = \"black\",\n          border.lwd = 0.5,\n          style = \"quantile\",\n          palette = \"YlOrRd\",\n          title = \"Selling Price\") +\n  tm_layout(main.title = \"Geographic Distribution of Condo Sales\",\n            main.title.size = 1.2)\n\n\n\n\n\n\n\n\n\n\n5.3 Statistical Summary by Variables\n\n# Summary of key variables\ncondo_resale %&gt;%\n  select(SELLING_PRICE, AREA_SQM, AGE, PROX_CBD, \n         PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_MRT,\n         PROX_SHOPPING_MALL, NO_OF_UNITS) %&gt;%\n  summary()\n\n SELLING_PRICE         AREA_SQM          AGE           PROX_CBD      \n Min.   :  540000   Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869  \n 1st Qu.: 1100000   1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574  \n Median : 1383222   Median :121.0   Median :11.00   Median : 9.3567  \n Mean   : 1751211   Mean   :136.5   Mean   :12.14   Mean   : 9.3254  \n 3rd Qu.: 1950000   3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661  \n Max.   :18000000   Max.   :619.0   Max.   :37.00   Max.   :19.1804  \n PROX_CHILDCARE     PROX_ELDERLYCARE     PROX_MRT       PROX_SHOPPING_MALL\n Min.   :0.004927   Min.   :0.05451   Min.   :0.05278   Min.   :0.0000    \n 1st Qu.:0.174481   1st Qu.:0.61254   1st Qu.:0.34646   1st Qu.:0.5258    \n Median :0.258135   Median :0.94179   Median :0.57430   Median :0.9357    \n Mean   :0.326313   Mean   :1.05352   Mean   :0.67316   Mean   :1.0455    \n 3rd Qu.:0.368293   3rd Qu.:1.35122   3rd Qu.:0.84844   3rd Qu.:1.3994    \n Max.   :3.465726   Max.   :3.94916   Max.   :3.48037   Max.   :3.4774    \n  NO_OF_UNITS    \n Min.   :  18.0  \n 1st Qu.: 188.8  \n Median : 360.0  \n Mean   : 409.2  \n 3rd Qu.: 590.0  \n Max.   :1703.0"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-model-using-ols",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-model-using-ols",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "6. Building Hedonic Pricing Model using OLS",
    "text": "6. Building Hedonic Pricing Model using OLS\n\n6.1 Simple Linear Regression\n\n# Build simple OLS model with AREA_SQM\ncondo_ols_simple &lt;- lm(SELLING_PRICE ~ AREA_SQM, \n                       data = condo_resale)\nsummary(condo_ols_simple)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n# Visualize the relationship\nggplot(condo_resale, aes(x = AREA_SQM, y = SELLING_PRICE)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", col = \"red\") +\n  labs(title = \"Selling Price vs Floor Area\",\n       x = \"Floor Area (sqm)\",\n       y = \"Selling Price ($)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n6.2 Multiple Linear Regression\n\n# Build multiple regression model with all available variables\ncondo_mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n                  PROX_KINDERGARTEN + PROX_MRT + \n                  PROX_PARK + PROX_PRIMARY_SCH + PROX_TOP_PRIMARY_SCH + \n                  PROX_SHOPPING_MALL + PROX_SUPERMARKET + PROX_BUS_STOP +\n                  NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD + LEASEHOLD_99YR,\n                data = condo_resale)\n\nsummary(condo_mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD + \n    LEASEHOLD_99YR, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3471036  -286903   -22426   239412 12254549 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           543071.4   136210.9   3.987 7.03e-05 ***\nAREA_SQM               12688.7      370.1  34.283  &lt; 2e-16 ***\nAGE                   -24566.0     2766.0  -8.881  &lt; 2e-16 ***\nPROX_CBD              -78122.0     6791.4 -11.503  &lt; 2e-16 ***\nPROX_CHILDCARE       -333219.0   111020.3  -3.001 0.002734 ** \nPROX_ELDERLYCARE      170950.0    42110.8   4.060 5.19e-05 ***\nPROX_URA_GROWTH_AREA   38507.6    12523.7   3.075 0.002147 ** \nPROX_HAWKER_MARKET     23801.2    29299.9   0.812 0.416739    \nPROX_KINDERGARTEN     144098.0    82738.7   1.742 0.081795 .  \nPROX_MRT             -322775.9    58528.1  -5.515 4.14e-08 ***\nPROX_PARK             564487.9    66563.0   8.481  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      186170.5    65515.2   2.842 0.004553 ** \nPROX_TOP_PRIMARY_SCH    -477.1    20598.0  -0.023 0.981525    \nPROX_SHOPPING_MALL   -207721.5    42855.5  -4.847 1.39e-06 ***\nPROX_SUPERMARKET      -48074.7    77145.3  -0.623 0.533273    \nPROX_BUS_STOP         675755.0   138552.0   4.877 1.20e-06 ***\nNO_OF_UNITS             -216.2       90.3  -2.394 0.016797 *  \nFAMILY_FRIENDLY       142128.3    47055.1   3.020 0.002569 ** \nFREEHOLD              300646.5    77296.5   3.890 0.000105 ***\nLEASEHOLD_99YR        -77137.4    77570.9  -0.994 0.320192    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1416 degrees of freedom\nMultiple R-squared:  0.652, Adjusted R-squared:  0.6474 \nF-statistic: 139.6 on 19 and 1416 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n6.3 Check for Multicollinearity\n\n# Prepare numeric data without NA values\nnum_df &lt;- condo_resale %&gt;%\n  select(-LATITUDE, -LONGITUDE, -POSTCODE) %&gt;%\n  select(where(is.numeric)) %&gt;%\n  drop_na()\n\n# Calculate correlation matrix\ncor_matrix &lt;- cor(num_df)\n\n# Plot correlation matrix\ncorrplot(cor_matrix, \n         method = \"circle\", \n         type = \"upper\",\n         diag = FALSE,\n         order = \"hclust\",\n         tl.cex = 0.7,\n         tl.col = \"black\",\n         tl.srt = 45,\n         title = \"Correlation Matrix\")\n\n\n\n\n\n\n\n# VIF check using olsrr\nols_vif_tol(condo_mlr)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8601326 1.162611\n2                   AGE 0.7011585 1.426211\n3              PROX_CBD 0.4575471 2.185567\n4        PROX_CHILDCARE 0.2898233 3.450378\n5      PROX_ELDERLYCARE 0.5922238 1.688551\n6  PROX_URA_GROWTH_AREA 0.6614081 1.511926\n7    PROX_HAWKER_MARKET 0.4373874 2.286303\n8     PROX_KINDERGARTEN 0.8356793 1.196631\n9              PROX_MRT 0.4949877 2.020252\n10            PROX_PARK 0.8015728 1.247547\n11     PROX_PRIMARY_SCH 0.3823248 2.615577\n12 PROX_TOP_PRIMARY_SCH 0.4878620 2.049760\n13   PROX_SHOPPING_MALL 0.4903052 2.039546\n14     PROX_SUPERMARKET 0.6142127 1.628100\n15        PROX_BUS_STOP 0.3311024 3.020213\n16          NO_OF_UNITS 0.6543336 1.528272\n17      FAMILY_FRIENDLY 0.7191719 1.390488\n18             FREEHOLD 0.2728521 3.664990\n19       LEASEHOLD_99YR 0.2645988 3.779307\n\n\n\n\n6.4 Revised Model (Removing Multicollinear Variables)\n\n# Build revised model excluding highly correlated variables\ncondo_mlr2 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n                   PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n                   FREEHOLD,\n                 data = condo_resale)\n\nsummary(condo_mlr2)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n    PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_OF_UNITS + \n    FAMILY_FRIENDLY + FREEHOLD, data = condo_resale)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\nAREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\nAGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\nPROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\nPROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \nPROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\nPROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\nPROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\nPROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \nPROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\nPROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\nNO_OF_UNITS             -245.48      87.95  -2.791 0.005321 ** \nFAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \nFREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 756000 on 1421 degrees of freedom\nMultiple R-squared:  0.6507,    Adjusted R-squared:  0.6472 \nF-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16\n\nols_vif_tol(condo_mlr2)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_OF_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\n\n\n6.5 Model Diagnostics\n\n# Diagnostic plots\npar(mfrow = c(2, 2))\nplot(condo_mlr2)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n# Additional diagnostic tests\n# Normality test\nols_test_normality(condo_mlr2)\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n# Breusch-Pagan test for heteroscedasticity\nols_test_breusch_pagan(condo_mlr2)\n\n\n Breusch Pagan Test for Heteroskedasticity\n -----------------------------------------\n Ho: the variance is constant            \n Ha: the variance is not constant        \n\n                  Data                    \n -----------------------------------------\n Response : SELLING_PRICE \n Variables: fitted values of SELLING_PRICE \n\n        Test Summary         \n ----------------------------\n DF            =    1 \n Chi2          =    4573.0707 \n Prob &gt; Chi2   =    0.0000"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#test-for-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#test-for-spatial-autocorrelation",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "7. Test for Spatial Autocorrelation",
    "text": "7. Test for Spatial Autocorrelation\n\n7.1 Prepare Spatial Data\n\n# Extract residuals\nmlr_residuals &lt;- residuals(condo_mlr2)\ncondo_resale$mlr_residuals &lt;- mlr_residuals\n\n# Add residuals to sf object\ncondo_resale_sf$mlr_residuals &lt;- mlr_residuals\n\n# Convert to sp object for GWmodel\ncondo_resale_sp &lt;- as(condo_resale_sf, \"Spatial\")\ncondo_resale_sp@data$mlr_residuals &lt;- mlr_residuals\n\n\n\n7.2 Visualize Residuals\n\n# Map residuals\ntmap_mode(\"plot\")\ntm_shape(mpsz) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale_sf) +\n  tm_dots(col = \"mlr_residuals\",\n          size = 0.01,  # Further reduced size\n          style = \"quantile\",\n          palette = \"-RdBu\",\n          title = \"MLR Residuals\") +\n  tm_layout(main.title = \"Spatial Distribution of OLS Residuals\",\n            main.title.size = 1.2)\n\n\n\n\n\n\n\n\n\n\n7.3 Moran’s I Test\n\n# Create neighbors\ncoords &lt;- st_coordinates(condo_resale_sf)\nknn_nb &lt;- knn2nb(knearneigh(coords, k = 8))\nknn_listw &lt;- nb2listw(knn_nb, style = \"W\")\n\n# Moran's I test on residuals\nmoran.test(mlr_residuals, knn_listw)\n\n\n    Moran I test under randomisation\n\ndata:  mlr_residuals  \nweights: knn_listw    \n\nMoran I statistic standard deviate = 25.806, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.3098623365     -0.0006968641      0.0001448283 \n\n# Moran scatterplot\nmoran.plot(mlr_residuals, knn_listw,\n           main = \"Moran Scatterplot of OLS Residuals\",\n           xlab = \"Residuals\",\n           ylab = \"Spatially Lagged Residuals\",\n           labels = FALSE, \n           quiet = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-models-using-gwr",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#building-hedonic-pricing-models-using-gwr",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "8. Building Hedonic Pricing Models using GWR",
    "text": "8. Building Hedonic Pricing Models using GWR\n\n8.1 Adaptive Bandwidth GWR with Optimization\n\n# Check for cache file\ncache_file &lt;- \"gwr_cache.rds\"\n\nif(file.exists(cache_file)){\n  cat(\"Loading cached GWR results...\\n\")\n  gwc &lt;- readRDS(cache_file)\n  bw_adaptive &lt;- gwc$bw\n  gwr_adaptive &lt;- gwc$gwr\n  cat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n} else {\n  cat(\"Calculating optimal bandwidth (this may take a few minutes)...\\n\")\n  \n  # Determine optimal adaptive bandwidth using AICc with parallel processing\n  bw_adaptive &lt;- bw.gwr(\n    formula = SELLING_PRICE ~ AREA_SQM + AGE + \n              PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n              PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n              PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n              PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n              FREEHOLD,\n    data = condo_resale_sp,\n    approach = \"AICc\",       # Use AICc for small sample correction\n    kernel = \"bisquare\",     # Bisquare kernel for adaptive bandwidth\n    adaptive = TRUE,\n    longlat = FALSE,\n    parallel.method = \"omp\", # Enable parallel processing\n    parallel.arg = max(1, parallel::detectCores() - 1)\n  )\n  \n  cat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n  \n  # Calibrate adaptive GWR model\n  cat(\"Calibrating GWR model...\\n\")\n  gwr_adaptive &lt;- gwr.basic(\n    formula = SELLING_PRICE ~ AREA_SQM + AGE + \n              PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n              PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n              PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n              PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + \n              FREEHOLD,\n    data = condo_resale_sp,\n    bw = bw_adaptive,\n    kernel = \"bisquare\",\n    adaptive = TRUE,\n    longlat = FALSE\n  )\n  \n  # Save to cache\n  saveRDS(list(bw = bw_adaptive, gwr = gwr_adaptive), cache_file)\n  cat(\"Results cached for future use.\\n\")\n}\n\nLoading cached GWR results...\nOptimal adaptive bandwidth: 84 neighbors\n\n# Display model results\ngwr_adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2025-11-08 02:23:00.479815 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_OF_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale_sp, bw = bw_adaptive, kernel = \"bisquare\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_OF_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_OF_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: bisquare \n   Adaptive bandwidth: 84 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5398e+07 -1.1560e+06  6.8662e+05  2.4084e+06\n   AREA_SQM              2.5627e+03  5.5805e+03  7.3041e+03  1.1216e+04\n   AGE                  -1.6687e+05 -2.0869e+04 -1.0666e+04 -3.8618e+03\n   PROX_CBD             -1.4632e+07 -3.2429e+05 -5.1360e+04  2.2112e+05\n   PROX_CHILDCARE       -3.4212e+06 -4.7125e+05 -6.7941e+04  3.6997e+05\n   PROX_ELDERLYCARE     -3.6267e+06 -2.3989e+05  3.3240e+04  3.3964e+05\n   PROX_URA_GROWTH_AREA -6.1100e+07 -9.6781e+04  1.3331e+05  4.2131e+05\n   PROX_MRT             -6.4860e+06 -6.1694e+05 -1.3437e+05  1.3506e+05\n   PROX_PARK            -3.6830e+06 -2.5607e+05  3.7533e+04  3.8025e+05\n   PROX_PRIMARY_SCH     -2.1930e+06 -3.6164e+05 -6.3626e+04  2.4156e+05\n   PROX_SHOPPING_MALL   -2.0284e+06 -1.7434e+05  4.6397e+04  4.1171e+05\n   PROX_BUS_STOP        -5.2211e+06 -3.3468e+05  2.8355e+05  1.0325e+06\n   NO_OF_UNITS          -5.4491e+03 -2.5148e+02  6.6151e+00  2.9492e+02\n   FAMILY_FRIENDLY      -9.7656e+05 -8.7245e+04  8.7541e+03  1.4713e+05\n   FREEHOLD             -9.9036e+05 -1.6249e+04  1.0203e+05  3.3881e+05\n                              Max.\n   Intercept            58509448.1\n   AREA_SQM                25681.7\n   AGE                     43602.6\n   PROX_CBD             61068846.4\n   PROX_CHILDCARE        4619480.5\n   PROX_ELDERLYCARE      7712244.1\n   PROX_URA_GROWTH_AREA 17914463.2\n   PROX_MRT              2069561.2\n   PROX_PARK             4068834.5\n   PROX_PRIMARY_SCH      5912050.6\n   PROX_SHOPPING_MALL    2944099.7\n   PROX_BUS_STOP        15313047.4\n   NO_OF_UNITS              2425.1\n   FAMILY_FRIENDLY       3852139.1\n   FREEHOLD              2690147.6\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 468.9826 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 967.0174 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41712.41 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 40971.7 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42101.93 \n   Residual sum of squares: 1.556343e+14 \n   R-square value:  0.9330503 \n   Adjusted R-square value:  0.9005476 \n\n   ***********************************************************************\n   Program stops at: 2025-11-08 02:23:01.100378"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#visualizing-gwr-results",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#visualizing-gwr-results",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "9. Visualizing GWR Results",
    "text": "9. Visualizing GWR Results\n\n9.1 Extract GWR Results (Robust Method)\n\n# Extract GWR results dataframe\ngdf &lt;- gwr_adaptive$SDF@data\n\n# Define coefficient names\ncoef_names &lt;- c(\"Intercept\", \"AREA_SQM\", \"AGE\", \"PROX_CBD\", \n                \"PROX_CHILDCARE\", \"PROX_ELDERLYCARE\",\n                \"PROX_URA_GROWTH_AREA\", \"PROX_MRT\", \"PROX_PARK\",\n                \"PROX_PRIMARY_SCH\", \"PROX_SHOPPING_MALL\",\n                \"PROX_BUS_STOP\", \"NO_OF_UNITS\", \"FAMILY_FRIENDLY\",\n                \"FREEHOLD\")\n\n# Extract coefficients using column names\nfor(nm in coef_names){\n  if(nm %in% names(gdf)) {\n    condo_resale_sf[[paste0(\"gwr_\", nm)]] &lt;- gdf[[nm]]\n  }\n}\n\n# Extract Local R2, fitted values, and residuals (fixed column names)\nif(\"Local_R2\" %in% names(gdf)) condo_resale_sf$gwr_localR2 &lt;- gdf$Local_R2\nif(\"yhat\" %in% names(gdf)) condo_resale_sf$gwr_yhat &lt;- gdf$yhat\nif(\"residual\" %in% names(gdf)) condo_resale_sf$gwr_residual &lt;- gdf$residual\n\n# Extract standard errors using pattern matching\nse_cols &lt;- grep(\"\\\\.SE$|_SE$\", names(gdf), value = TRUE)\nfor(nm in coef_names){\n  se_nm &lt;- se_cols[grepl(nm, se_cols)]\n  if(length(se_nm) &gt; 0) {\n    condo_resale_sf[[paste0(\"gwr_SE_\", nm)]] &lt;- gdf[[se_nm[1]]]\n  }\n}\n\n# Extract t-values using pattern matching\ntv_cols &lt;- grep(\"\\\\.TV$|_TV$\", names(gdf), value = TRUE)\nfor(nm in coef_names){\n  tv_nm &lt;- tv_cols[grepl(nm, tv_cols)]\n  if(length(tv_nm) &gt; 0) {\n    condo_resale_sf[[paste0(\"gwr_TV_\", nm)]] &lt;- gdf[[tv_nm[1]]]\n  }\n}\n\n# Verify extraction\ncat(\"✓ GWR results successfully extracted\\n\")\n\n✓ GWR results successfully extracted\n\ncat(\"Number of observations:\", nrow(condo_resale_sf), \"\\n\")\n\nNumber of observations: 1436 \n\ncat(\"\\nLocal R² Summary:\\n\")\n\n\nLocal R² Summary:\n\nsummary(condo_resale_sf$gwr_localR2)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.6141  0.9008  0.9370  0.9229  0.9711  0.9957 \n\n\n\n\n9.2 Visualize Local R-squared\n\ntmap_mode(\"plot\")\n\n# Create Local R² map\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\", \n              border.col = \"grey60\",\n              lwd = 0.5) +\ntm_shape(condo_resale_sf) +\n  tm_dots(\"gwr_localR2\",\n          size = 0.02,\n          border.col = \"black\",\n          border.lwd = 0.3,\n          style = \"quantile\",\n          n = 5,\n          palette = \"RdPu\",\n          title = \"Local R²\") +\n  tm_layout(main.title = \"GWR Local R-squared Values\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\n\n\n# Print statistics\ncat(\"\\nLocal R² Statistics:\\n\")\n\n\nLocal R² Statistics:\n\ncat(\"Minimum:\", round(min(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMinimum: 0.614 \n\ncat(\"Maximum:\", round(max(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMaximum: 0.996 \n\ncat(\"Mean:\", round(mean(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean: 0.923 \n\ncat(\"Median:\", round(median(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMedian: 0.937 \n\n\n\n\n9.3 Visualize Coefficient Estimates\n\n# Create maps for key coefficients\ntm1 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_AREA_SQM\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"Area Coefficient\") +\n       tm_layout(main.title = \"AREA_SQM\", main.title.size = 0.8)\n\ntm2 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_AGE\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"Age Coefficient\") +\n       tm_layout(main.title = \"AGE\", main.title.size = 0.8)\n\ntm3 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_PROX_CBD\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"CBD Distance\") +\n       tm_layout(main.title = \"PROX_CBD\", main.title.size = 0.8)\n\ntm4 &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n       tm_shape(condo_resale_sf) +\n       tm_dots(col = \"gwr_PROX_MRT\", size = 0.01,\n               style = \"quantile\", palette = \"-RdBu\",\n               title = \"MRT Distance\") +\n       tm_layout(main.title = \"PROX_MRT\", main.title.size = 0.8)\n\ntmap_arrange(tm1, tm2, tm3, tm4, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n9.4 Visualize GWR Residuals\n\n# Compare OLS and GWR residuals\ntm_ols &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n          tm_shape(condo_resale_sf) +\n          tm_dots(col = \"mlr_residuals\", size = 0.01,\n                  style = \"quantile\", palette = \"-RdBu\",\n                  title = \"Residuals\") +\n          tm_layout(main.title = \"OLS Residuals\",\n                    main.title.size = 0.9)\n\ntm_gwr &lt;- tm_shape(mpsz) + tm_polygons(alpha = 0.4) +\n          tm_shape(condo_resale_sf) +\n          tm_dots(col = \"gwr_residual\", size = 0.01,\n                  style = \"quantile\", palette = \"-RdBu\",\n                  title = \"Residuals\") +\n          tm_layout(main.title = \"GWR Residuals\",\n                    main.title.size = 0.9)\n\ntmap_arrange(tm_ols, tm_gwr, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#model-comparison-and-evaluation",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#model-comparison-and-evaluation",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "10. Model Comparison and Evaluation",
    "text": "10. Model Comparison and Evaluation\n\n10.1 Compare Model Performance\n\n# Create comparison table\nmodel_comparison &lt;- data.frame(\n  Model = c(\"OLS\", \"GWR Adaptive\"),\n  AICc = c(AIC(condo_mlr2), \n          gwr_adaptive$GW.diagnostic$AICc),\n  Adj_R2 = c(summary(condo_mlr2)$adj.r.squared,\n             gwr_adaptive$GW.diagnostic$R2.adj),\n  RSS = c(sum(residuals(condo_mlr2)^2),\n          gwr_adaptive$GW.diagnostic$RSS.gw)\n)\n\nknitr::kable(model_comparison,\n             caption = \"Model Performance Comparison\",\n             digits = 3)\n\n\nModel Performance Comparison\n\n\nModel\nAICc\nAdj_R2\nRSS\n\n\n\n\nOLS\n42966.76\n0.647\n8.120609e+14\n\n\nGWR Adaptive\n41712.41\n0.647\n1.556343e+14\n\n\n\n\n\n\n\n10.2 Statistical Test for Spatial Variability\n\n# Test for spatial non-stationarity\n# Calculate t-statistics\nt_stats &lt;- data.frame(\n  Variable = coef_names,\n  Min_t = NA,\n  Q1_t = NA,\n  Median_t = NA,\n  Q3_t = NA,\n  Max_t = NA,\n  Pct_Significant = NA\n)\n\nfor(i in 1:length(coef_names)) {\n  coef_col &lt;- paste0(\"gwr_\", coef_names[i])\n  se_col &lt;- paste0(\"gwr_SE_\", coef_names[i])\n  \n  if(coef_col %in% names(condo_resale_sf) && se_col %in% names(condo_resale_sf)) {\n    t_values &lt;- condo_resale_sf[[coef_col]] / condo_resale_sf[[se_col]]\n    \n    t_stats$Min_t[i] &lt;- min(t_values, na.rm = TRUE)\n    t_stats$Q1_t[i] &lt;- quantile(t_values, 0.25, na.rm = TRUE)\n    t_stats$Median_t[i] &lt;- median(t_values, na.rm = TRUE)\n    t_stats$Q3_t[i] &lt;- quantile(t_values, 0.75, na.rm = TRUE)\n    t_stats$Max_t[i] &lt;- max(t_values, na.rm = TRUE)\n    t_stats$Pct_Significant[i] &lt;- sum(abs(t_values) &gt; 1.96, na.rm = TRUE) / \n                                   sum(!is.na(t_values)) * 100\n  }\n}\n\nknitr::kable(t_stats,\n             caption = \"Summary of t-statistics and % Significant\",\n             digits = 2)\n\n\nSummary of t-statistics and % Significant\n\n\n\n\n\n\n\n\n\n\n\nVariable\nMin_t\nQ1_t\nMedian_t\nQ3_t\nMax_t\nPct_Significant\n\n\n\n\nIntercept\n-7.58\n-0.33\n0.23\n0.84\n7.38\n11.70\n\n\nAREA_SQM\n0.90\n2.87\n4.92\n8.57\n32.65\n92.27\n\n\nAGE\n-17.67\n-1.69\n-0.72\n-0.24\n2.26\n22.35\n\n\nPROX_CBD\n-6.46\n-0.78\n-0.21\n0.37\n8.12\n14.35\n\n\nPROX_CHILDCARE\n-4.35\n-0.52\n-0.07\n0.47\n7.26\n10.38\n\n\nPROX_ELDERLYCARE\n-7.55\n-0.38\n0.07\n0.60\n12.67\n11.91\n\n\nPROX_URA_GROWTH_AREA\n-7.98\n-0.14\n0.41\n1.14\n5.65\n13.23\n\n\nPROX_MRT\n-11.97\n-1.06\n-0.22\n0.28\n3.74\n16.99\n\n\nPROX_PARK\n-4.48\n-0.37\n0.05\n0.58\n7.35\n12.40\n\n\nPROX_PRIMARY_SCH\n-4.23\n-0.60\n-0.13\n0.47\n12.09\n12.19\n\n\nPROX_SHOPPING_MALL\n-4.50\n-0.36\n0.08\n0.68\n3.86\n11.91\n\n\nPROX_BUS_STOP\n-4.54\n-0.22\n0.24\n1.09\n18.64\n19.50\n\n\nNO_OF_UNITS\n-6.28\n-0.52\n0.01\n0.48\n4.44\n11.77\n\n\nFAMILY_FRIENDLY\n-3.63\n-0.43\n0.03\n0.77\n21.87\n19.08\n\n\nFREEHOLD\n-1.46\n-0.06\n0.48\n1.55\n14.33\n16.09\n\n\n\n\n\n\n\n10.3 Residual Autocorrelation Test\n\n# Test GWR residuals for spatial autocorrelation\nmoran_gwr &lt;- moran.test(condo_resale_sf$gwr_residual, knn_listw)\nmoran_ols &lt;- moran.test(mlr_residuals, knn_listw)\n\n# Compare Moran's I\ncat(\"\\nComparison of Moran's I:\\n\")\n\n\nComparison of Moran's I:\n\ncat(\"OLS Residuals Moran's I:\", round(moran_ols$estimate[1], 4), \"\\n\")\n\nOLS Residuals Moran's I: 0.3099 \n\ncat(\"GWR Residuals Moran's I:\", round(moran_gwr$estimate[1], 4), \"\\n\")\n\nGWR Residuals Moran's I: -0.1053 \n\ncat(\"\\n\")\nprint(moran_gwr)\n\n\n    Moran I test under randomisation\n\ndata:  condo_resale_sf$gwr_residual  \nweights: knn_listw    \n\nMoran I statistic standard deviate = -8.5562, p-value = 1\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n    -0.1053491274     -0.0006968641      0.0001496017"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#key-findings-and-conclusions",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#key-findings-and-conclusions",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "11. Key Findings and Conclusions",
    "text": "11. Key Findings and Conclusions\n\n11.1 Summary of Results\n\n# Calculate improvement metrics\nr2_improvement &lt;- (gwr_adaptive$GW.diagnostic$R2.adj - \n                  summary(condo_mlr2)$adj.r.squared) / \n                  summary(condo_mlr2)$adj.r.squared * 100\n\naic_improvement &lt;- (AIC(condo_mlr2) - \n                   gwr_adaptive$GW.diagnostic$AICc) / \n                   AIC(condo_mlr2) * 100\n\ncat(\"Model Improvements (GWR vs OLS):\\n\")\n\nModel Improvements (GWR vs OLS):\n\ncat(\"--------------------------------\\n\")\n\n--------------------------------\n\ncat(\"Adjusted R² improvement:\", round(r2_improvement, 1), \"%\\n\")\n\nAdjusted R² improvement:  %\n\ncat(\"AICc improvement:\", round(aic_improvement, 1), \"%\\n\")\n\nAICc improvement: 2.9 %\n\ncat(\"Optimal adaptive bandwidth:\", bw_adaptive, \"neighbors\\n\")\n\nOptimal adaptive bandwidth: 84 neighbors\n\ncat(\"Mean Local R²:\", round(mean(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.923 \n\ncat(\"Range of Local R²:\", \n    round(min(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"-\",\n    round(max(condo_resale_sf$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nRange of Local R²: 0.614 - 0.996 \n\n\n\n\n11.2 Spatial Pattern Summary\n\n# Identify areas with high and low local R²\nhigh_r2 &lt;- condo_resale_sf[condo_resale_sf$gwr_localR2 &gt; \n                           quantile(condo_resale_sf$gwr_localR2, 0.9, na.rm = TRUE), ]\nlow_r2 &lt;- condo_resale_sf[condo_resale_sf$gwr_localR2 &lt; \n                          quantile(condo_resale_sf$gwr_localR2, 0.1, na.rm = TRUE), ]\n\ncat(\"\\nAreas with High Model Performance (Top 10% Local R²):\\n\")\n\n\nAreas with High Model Performance (Top 10% Local R²):\n\ncat(\"Number of units:\", nrow(high_r2), \"\\n\")\n\nNumber of units: 144 \n\ncat(\"Mean Local R²:\", round(mean(high_r2$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.989 \n\ncat(\"Mean Selling Price:\", round(mean(high_r2$SELLING_PRICE, na.rm = TRUE)), \"\\n\")\n\nMean Selling Price: 1021523 \n\ncat(\"\\nAreas with Low Model Performance (Bottom 10% Local R²):\\n\")\n\n\nAreas with Low Model Performance (Bottom 10% Local R²):\n\ncat(\"Number of units:\", nrow(low_r2), \"\\n\")\n\nNumber of units: 144 \n\ncat(\"Mean Local R²:\", round(mean(low_r2$gwr_localR2, na.rm = TRUE), 3), \"\\n\")\n\nMean Local R²: 0.781 \n\ncat(\"Mean Selling Price:\", round(mean(low_r2$SELLING_PRICE, na.rm = TRUE)), \"\\n\")\n\nMean Selling Price: 2040447"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex07/ex07.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex07/ex07.html#conclusions",
    "title": "Hands-on Exercise 07: Geographically Weighted Regression",
    "section": "12. Conclusions",
    "text": "12. Conclusions\nThis analysis demonstrates the power of Geographically Weighted Regression in capturing spatial heterogeneity in housing prices:\n\nKey Findings:\n\nSpatial Non-stationarity: The relationships between condo prices and their predictors vary significantly across Singapore\nModel Performance: GWR provides substantial improvement over OLS regression in terms of both R² and AICc\nLocal Variations: Different factors influence prices differently in various parts of Singapore:\n\nCBD proximity matters more in certain areas\nMRT accessibility has varying importance\nAge depreciation effects differ spatially\n\nResidual Analysis: GWR successfully reduces spatial autocorrelation in residuals\n\n\n\nImplications:\n\nHousing valuation models should account for spatial variations\nPolicy interventions should consider local context\nReal estate investment strategies should be location-specific\n\n\n\nFuture Work:\n\nExplore temporal variations using panel GWR\nInclude more neighborhood characteristics\nTest alternative kernel functions and bandwidth selection methods\nConsider standardized variables for better interpretation"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to compute Global and Local Measures of Spatial Autocorrelation (GLSA) using Singapore HDB resale price data. We will explore spatial patterns in housing prices and identify clusters of high and low value properties.\n\n\nBy the end of this session, you will be able to:\n\nCompute global spatial autocorrelation statistics (Moran’s I and Geary’s C)\nPerform permutation tests for global spatial autocorrelation\nCompute and visualize local indicators of spatial association (LISA)\nDetect hot spots and cold spots using Getis-Ord Gi* statistics\nCreate various spatial autocorrelation visualizations"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#overview",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In this hands-on exercise, we will learn how to compute Global and Local Measures of Spatial Autocorrelation (GLSA) using Singapore HDB resale price data. We will explore spatial patterns in housing prices and identify clusters of high and low value properties.\n\n\nBy the end of this session, you will be able to:\n\nCompute global spatial autocorrelation statistics (Moran’s I and Geary’s C)\nPerform permutation tests for global spatial autocorrelation\nCompute and visualize local indicators of spatial association (LISA)\nDetect hot spots and cold spots using Getis-Ord Gi* statistics\nCreate various spatial autocorrelation visualizations"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#getting-started",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "2. Getting Started",
    "text": "2. Getting Started\n\n2.1 Setting Global Options\n\n# 全局防止打印过多输出\nknitr::opts_chunk$set(message = FALSE, warning = FALSE)\noptions(max.print = 1000, \n        tibble.print_max = 60, \n        tibble.width = Inf,\n        dplyr.print_max = 60)\n\n\n\n2.2 Loading Required Packages\n\npacman::p_load(sf, spdep, tmap, tidyverse, \n               plotly, ggplot2, GGally, viridis, \n               knitr, DT)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#importing-and-exploring-data",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#importing-and-exploring-data",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "3. Importing and Exploring Data",
    "text": "3. Importing and Exploring Data\n\n3.1 Import the Data\n\n# Load the preprocessed data\nmdata &lt;- readRDS(\"data/rawdata/mdata.rds\")\n\n# Display data information\ncat(\"Dataset Information:\\n\")\n\nDataset Information:\n\ncat(\"- Type:\", class(mdata)[1], \"\\n\")\n\n- Type: sf \n\ncat(\"- Observations:\", format(nrow(mdata), big.mark = \",\"), \"\\n\")\n\n- Observations: 15,901 \n\ncat(\"- Variables:\", ncol(mdata), \"\\n\")\n\n- Variables: 18 \n\ncat(\"- Geometry:\", unique(st_geometry_type(mdata)), \"\\n\")\n\n- Geometry: 2 \n\ncat(\"- CRS:\", st_crs(mdata)$input, \"\\n\")\n\n- CRS: EPSG:3414 \n\n\n\n\n3.2 Data Summary\n\n# Summary statistics of key variables\nmdata %&gt;%\n  st_drop_geometry() %&gt;%\n  select(resale_price, floor_area_sqm, remaining_lease_mths, \n         PROX_CBD, PROX_MRT, PROX_MALL) %&gt;%\n  summary()\n\n  resale_price     floor_area_sqm   remaining_lease_mths    PROX_CBD      \n Min.   : 218000   Min.   : 74.00   Min.   : 546.0       Min.   : 0.9994  \n 1st Qu.: 353000   1st Qu.: 91.00   1st Qu.: 798.0       1st Qu.:10.1651  \n Median : 405000   Median : 93.00   Median : 936.0       Median :13.4356  \n Mean   : 433588   Mean   : 95.15   Mean   : 939.8       Mean   :12.5368  \n 3rd Qu.: 470000   3rd Qu.:102.00   3rd Qu.:1111.0       3rd Qu.:15.4162  \n Max.   :1186888   Max.   :138.00   Max.   :1164.0       Max.   :19.6501  \n    PROX_MRT         PROX_MALL     \n Min.   :0.02204   Min.   :0.0000  \n 1st Qu.:0.30141   1st Qu.:0.3690  \n Median :0.53671   Median :0.5701  \n Mean   :0.60983   Mean   :0.6358  \n 3rd Qu.:0.82722   3rd Qu.:0.8319  \n Max.   :2.13061   Max.   :2.2710"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#visualizing-the-study-area",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#visualizing-the-study-area",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "4. Visualizing the Study Area",
    "text": "4. Visualizing the Study Area\n\n4.1 Distribution of Resale Prices\n\n# Histogram\np1 &lt;- ggplot(data = mdata, \n             aes(x = resale_price/1000)) +\n  geom_histogram(bins = 50, \n                 fill = \"lightblue\", \n                 color = \"black\") +\n  labs(title = \"Distribution of HDB Resale Prices\",\n       x = \"Resale Price (S$'000)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\n# Log-transformed prices\np2 &lt;- ggplot(data = mdata,\n             aes(x = log(resale_price))) +\n  geom_histogram(bins = 50,\n                fill = \"lightgreen\",\n                color = \"black\") +\n  labs(title = \"Distribution of Log Resale Prices\",\n       x = \"Log(Resale Price)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\nlibrary(gridExtra)\ngrid.arrange(p1, p2, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n4.2 Spatial Distribution of Resale Prices\n\n# Map resale prices with smaller points\ntmap_mode(\"plot\")\ntm_shape(mdata) +\n  tm_dots(\"resale_price\",\n          size = 0.008,\n          style = \"quantile\",\n          palette = \"YlOrRd\",\n          title = \"Resale Price (S$)\",\n          n = 5,\n          alpha = 0.6) +\n  tm_layout(main.title = \"Distribution of HDB Resale Prices in Singapore\",\n            main.title.size = 1.0,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n4.3 Relationship with Key Variables (Sample)\n\n# Sample data for plotting\nset.seed(1234)\nmdata_sample &lt;- mdata[sample(nrow(mdata), 2000), ]\n\n# Price vs Floor Area\np1 &lt;- ggplot(mdata_sample, aes(x = floor_area_sqm, y = resale_price/1000)) +\n  geom_point(alpha = 0.5, size = 1) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\") +\n  labs(title = \"Price vs Floor Area (n=2000)\",\n       x = \"Floor Area (sqm)\",\n       y = \"Price (S$'000)\") +\n  theme_minimal()\n\n# Price vs Distance to CBD\np2 &lt;- ggplot(mdata_sample, aes(x = PROX_CBD, y = resale_price/1000)) +\n  geom_point(alpha = 0.5, size = 1) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"blue\") +\n  labs(title = \"Price vs Distance to CBD\",\n       x = \"Distance to CBD (km)\",\n       y = \"Price (S$'000)\") +\n  theme_minimal()\n\ngrid.arrange(p1, p2, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#computing-spatial-weights-matrix",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#computing-spatial-weights-matrix",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "5. Computing Spatial Weights Matrix",
    "text": "5. Computing Spatial Weights Matrix\n\n5.1 K-Nearest Neighbors\n\n# Extract coordinates\ncoords &lt;- st_coordinates(mdata)\n\n# Create k-nearest neighbors (k=8)\nknn8 &lt;- knn2nb(knearneigh(coords, k = 8))\n\n# Display summary only\ncat(\"K-Nearest Neighbors (k=8) Summary:\\n\")\n\nK-Nearest Neighbors (k=8) Summary:\n\ncat(\"- Number of regions:\", format(length(knn8), big.mark = \",\"), \"\\n\")\n\n- Number of regions: 15,901 \n\ncat(\"- Number of nonzero links:\", format(sum(card(knn8)), big.mark = \",\"), \"\\n\")\n\n- Number of nonzero links: 127,208 \n\ncat(\"- All regions have exactly\", unique(card(knn8)), \"neighbors\\n\")\n\n- All regions have exactly 8 neighbors\n\n\n\n\n5.2 Creating Spatial Weights\n\n# Row-standardized weights for KNN\nknn8_lw &lt;- nb2listw(knn8, style = \"W\")\n\n# Display info only\ncat(\"Spatial weights created successfully:\\n\")\n\nSpatial weights created successfully:\n\ncat(\"- Style: W (row-standardized)\\n\")\n\n- Style: W (row-standardized)\n\ncat(\"- Zero policy: FALSE\\n\")\n\n- Zero policy: FALSE\n\n\n\n\n5.3 Visualizing Spatial Weights (Small Sample)\n\n# Small sample for visualization\nset.seed(1234)\nsample_idx &lt;- sample(1:nrow(mdata), 200)\nmdata_sample &lt;- mdata[sample_idx, ]\ncoords_sample &lt;- coords[sample_idx, ]\nknn8_sample &lt;- knn2nb(knearneigh(coords_sample, k = 8))\n\n# Plot\nplot(st_geometry(mdata_sample), col = \"lightgrey\", \n     main = \"K-Nearest Neighbors (k=8) - Sample of 200 Points\")\nplot(knn8_sample, coords_sample, add = TRUE, col = \"red\", lwd = 0.5)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#global-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#global-spatial-autocorrelation",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "6. Global Spatial Autocorrelation",
    "text": "6. Global Spatial Autocorrelation\n\n6.1 Moran’s I Test\n\n# Moran's I test\nmoran_result &lt;- moran.test(mdata$resale_price, \n                           listw = knn8_lw, \n                           zero.policy = TRUE, \n                           na.action = na.omit)\nprint(moran_result)\n\n\n    Moran I test under randomisation\n\ndata:  mdata$resale_price  \nweights: knn8_lw    \n\nMoran I statistic standard deviate = 250.21, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     9.271867e-01     -6.289308e-05      1.373381e-05 \n\n\n\n\n6.2 Monte Carlo Moran’s I (Optimized)\n\n# Set seed\nset.seed(1234)\n\n# Monte Carlo simulation with 499 simulations (faster)\nMC_moran &lt;- moran.mc(mdata$resale_price, \n                     listw = knn8_lw, \n                     nsim = 499,  # Reduced from 999\n                     zero.policy = TRUE, \n                     na.action = na.omit)\n\nprint(MC_moran)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  mdata$resale_price \nweights: knn8_lw  \nnumber of simulations + 1: 500 \n\nstatistic = 0.92719, observed rank = 500, p-value = 0.002\nalternative hypothesis: greater\n\n# Visualization\nhist(MC_moran$res, \n     freq = TRUE, \n     breaks = 40,\n     col = \"lightblue\",\n     main = \"Monte Carlo Simulation of Moran's I (499 simulations)\",\n     xlab = \"Simulated Moran's I\")\nabline(v = MC_moran$statistic, \n       col = \"red\", \n       lwd = 2)\n\n\n\n\n\n\n\n\n\n\n6.3 Geary’s C Test (Optimized)\n\n# Geary's C test\ngeary_result &lt;- geary.test(mdata$resale_price, \n                           listw = knn8_lw,\n                           zero.policy = TRUE)\nprint(geary_result)\n\n\n    Geary C test under randomisation\n\ndata:  mdata$resale_price \nweights: knn8_lw   \n\nGeary C statistic standard deviate = 147.8, p-value &lt; 2.2e-16\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n     8.688547e-02      1.000000e+00      3.816706e-05 \n\n# Monte Carlo Geary's C with reduced simulations\nset.seed(1234)\nMC_geary &lt;- geary.mc(mdata$resale_price, \n                     listw = knn8_lw, \n                     nsim = 499,  # Reduced from 999\n                     zero.policy = TRUE)\nprint(MC_geary)\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  mdata$resale_price \nweights: knn8_lw  \nnumber of simulations + 1: 500 \n\nstatistic = 0.086885, observed rank = 1, p-value = 0.002\nalternative hypothesis: greater"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#spatial-correlogram-optimized",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#spatial-correlogram-optimized",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "7. Spatial Correlogram (Optimized)",
    "text": "7. Spatial Correlogram (Optimized)\n\n# Create correlogram for different k values\nk_values &lt;- c(5, 10, 15, 20, 30, 50, 75, 100)\n\ncorrelogram_data &lt;- data.frame(\n  k = integer(),\n  moran_i = numeric(),\n  p_value = numeric()\n)\n\nfor(k in k_values) {\n  # 每个k值都需要重新计算knn\n  knn_temp &lt;- knn2nb(knearneigh(coords, k = k))\n  knn_temp_lw &lt;- nb2listw(knn_temp, style = \"W\")\n  \n  moran_result &lt;- moran.test(mdata$resale_price, \n                             listw = knn_temp_lw,\n                             zero.policy = TRUE)\n  \n  correlogram_data &lt;- rbind(correlogram_data,\n                            data.frame(k = k,\n                                     moran_i = moran_result$estimate[1],\n                                     p_value = moran_result$p.value))\n}\n\n# Plot\nggplot(correlogram_data, aes(x = k, y = moran_i)) +\n  geom_line(color = \"blue\", size = 1) +\n  geom_point(color = \"red\", size = 3) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"grey50\") +\n  labs(title = \"Spatial Correlogram - Moran's I\",\n       subtitle = \"Effect of number of neighbors on spatial autocorrelation\",\n       x = \"Number of Nearest Neighbors (k)\",\n       y = \"Moran's I\") +\n  theme_minimal()"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#local-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#local-spatial-autocorrelation",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "8. Local Spatial Autocorrelation",
    "text": "8. Local Spatial Autocorrelation\n\n8.1 Computing Local Moran’s I\n\n# Compute local Moran's I\nlocalMI &lt;- localmoran(mdata$resale_price, \n                      knn8_lw,\n                      zero.policy = TRUE,\n                      na.action = na.omit)\n\n# Add to data\nmdata$Ii &lt;- localMI[, \"Ii\"]\nmdata$Z_Ii &lt;- localMI[, \"Z.Ii\"]\nmdata$P_value &lt;- localMI[, \"Pr(z != E(Ii))\"]\n\n# Summary only\ncat(\"Local Moran's I computed for\", format(nrow(localMI), big.mark = \",\"), \"observations\\n\")\n\nLocal Moran's I computed for 15,901 observations\n\ncat(\"\\nLocal Moran's I Summary:\\n\")\n\n\nLocal Moran's I Summary:\n\nsummary(mdata$Ii)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-2.27777  0.04857  0.30138  0.92719  0.81068 27.64117 \n\n\n\n\n8.2 Mapping Local Moran’s I Statistics\n\n# Create significance categories\nmdata$P_sig &lt;- cut(mdata$P_value,\n                   breaks = c(0, 0.001, 0.01, 0.05, 1),\n                   labels = c(\"p &lt; 0.001\", \"p &lt; 0.01\", \"p &lt; 0.05\", \"Not Sig.\"),\n                   include.lowest = TRUE)\n\n# Maps with very small dots\ntm1 &lt;- tm_shape(mdata) +\n  tm_dots(\"Ii\",\n          size = 0.003,\n          style = \"quantile\",\n          palette = \"-RdBu\",\n          title = \"Local Moran's I\",\n          n = 5,\n          alpha = 0.7) +\n  tm_layout(main.title = \"Local Moran's I Values\",\n            main.title.size = 0.8)\n\ntm2 &lt;- tm_shape(mdata) +\n  tm_dots(\"P_sig\",\n          size = 0.003,\n          palette = c(\"darkgreen\", \"green\", \"lightgreen\", \"grey95\"),\n          title = \"Significance\",\n          alpha = 0.7) +\n  tm_layout(main.title = \"P-values\",\n            main.title.size = 0.8)\n\ntmap_arrange(tm1, tm2, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n8.3 Creating LISA Cluster Map\n\n# Standardize variables\nmdata$z_price &lt;- scale(mdata$resale_price)[,1]\nmdata$lag_z_price &lt;- lag.listw(knn8_lw, mdata$z_price,\n                                zero.policy = TRUE)\n\n# Define LISA categories\nmdata$quadrant &lt;- NA\nmdata$quadrant[mdata$z_price &gt; 0 & mdata$lag_z_price &gt; 0] &lt;- \"HH\"\nmdata$quadrant[mdata$z_price &lt; 0 & mdata$lag_z_price &lt; 0] &lt;- \"LL\"  \nmdata$quadrant[mdata$z_price &gt; 0 & mdata$lag_z_price &lt; 0] &lt;- \"HL\"\nmdata$quadrant[mdata$z_price &lt; 0 & mdata$lag_z_price &gt; 0] &lt;- \"LH\"\n\n# Keep only significant clusters\nmdata$quadrant_sig &lt;- ifelse(mdata$P_value &lt;= 0.05,\n                              mdata$quadrant,\n                              \"Not Significant\")\n\n# Summary table\ncat(\"LISA Cluster Distribution:\\n\")\n\nLISA Cluster Distribution:\n\ntable(mdata$quadrant_sig) %&gt;% \n  as.data.frame() %&gt;%\n  kable(col.names = c(\"Cluster Type\", \"Count\"),\n        format = \"simple\")\n\n\n\n\nCluster Type\nCount\n\n\n\n\nHH\n2829\n\n\nHL\n2\n\n\nLH\n50\n\n\nLL\n3662\n\n\nNot Significant\n9358\n\n\n\n\n\n\n\n8.4 Visualizing LISA Clusters\n\n# LISA cluster map\ntm_shape(mdata) +\n  tm_dots(\"quadrant_sig\",\n          size = 0.008,\n          palette = c(\"red\", \"lightblue\", \"pink\", \"blue\", \"grey95\"),\n          title = \"LISA Clusters\",\n          alpha = 0.8) +\n  tm_layout(main.title = \"LISA Cluster Map - HDB Resale Prices (p &lt; 0.05)\",\n            main.title.size = 1.0,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n8.5 Moran Scatterplot\n\n# Moran scatterplot without labels\npar(mar = c(5, 4, 4, 2))\nmoran.plot(mdata$resale_price, knn8_lw,\n           labels = FALSE,\n           xlab = \"Resale Price\",\n           ylab = \"Spatially Lagged Resale Price\",\n           main = \"Moran Scatterplot\",\n           quiet = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#hot-spot-and-cold-spot-analysis",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#hot-spot-and-cold-spot-analysis",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "9. Hot Spot and Cold Spot Analysis",
    "text": "9. Hot Spot and Cold Spot Analysis\n\n9.1 Computing Getis-Ord Gi* Statistics\n\n# Create binary weights for Gi*\nknn8_lw_B &lt;- nb2listw(knn8, style = \"B\")\n\n# Compute Gi* statistics\ngi_stats &lt;- localG(mdata$resale_price, knn8_lw_B)\n\n# Add to data\nmdata$gi_stats &lt;- as.numeric(gi_stats)\n\n# Summary\ncat(\"Gi* Statistics Summary:\\n\")\n\nGi* Statistics Summary:\n\nsummary(mdata$gi_stats)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-4.52464 -1.84222 -0.67625  0.02955  0.81311 13.49530 \n\n\n\n\n9.2 Visualizing Hot and Cold Spots\n\n# Create categories\nmdata$gi_category &lt;- cut(mdata$gi_stats,\n                         breaks = c(-Inf, -2.58, -1.96, -1.65,\n                                   1.65, 1.96, 2.58, Inf),\n                         labels = c(\"Cold Spot (99%)\",\n                                   \"Cold Spot (95%)\",\n                                   \"Cold Spot (90%)\",\n                                   \"Not Significant\",\n                                   \"Hot Spot (90%)\",\n                                   \"Hot Spot (95%)\",\n                                   \"Hot Spot (99%)\"),\n                         include.lowest = TRUE)\n\n# Map\ntm_shape(mdata) +\n  tm_dots(\"gi_category\",\n          size = 0.008,\n          palette = c(\"darkblue\", \"blue\", \"lightblue\",\n                     \"grey95\",\n                     \"pink\", \"red\", \"darkred\"),\n          title = \"Hot/Cold Spots\",\n          alpha = 0.8) +\n  tm_layout(main.title = \"Hot and Cold Spots of HDB Resale Prices\",\n            main.title.size = 1.0,\n            legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n# Summary table\ncat(\"\\nHot/Cold Spot Distribution:\\n\")\n\n\nHot/Cold Spot Distribution:\n\ntable(mdata$gi_category) %&gt;%\n  as.data.frame() %&gt;%\n  kable(col.names = c(\"Category\", \"Count\"),\n        format = \"simple\")\n\n\n\n\nCategory\nCount\n\n\n\n\nCold Spot (99%)\n1671\n\n\nCold Spot (95%)\n1993\n\n\nCold Spot (90%)\n881\n\n\nNot Significant\n8155\n\n\nHot Spot (90%)\n322\n\n\nHot Spot (95%)\n578\n\n\nHot Spot (99%)\n2301"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#summary-results",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#summary-results",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "10. Summary Results",
    "text": "10. Summary Results\n\n10.1 Overall Statistics\n\n# Summary table\nsummary_stats &lt;- data.frame(\n  Statistic = c(\"Observations\",\n                \"Global Moran's I\",\n                \"Global Geary's C\",\n                \"Significant LISA (p&lt;0.05)\",\n                \"HH Clusters\",\n                \"LL Clusters\",\n                \"Hot Spots (95%)\",\n                \"Cold Spots (95%)\"),\n  Value = c(format(nrow(mdata), big.mark = \",\"),\n            round(MC_moran$statistic, 4),\n            round(MC_geary$statistic, 4),\n            format(sum(mdata$P_value &lt;= 0.05), big.mark = \",\"),\n            format(sum(mdata$quadrant_sig == \"HH\"), big.mark = \",\"),\n            format(sum(mdata$quadrant_sig == \"LL\"), big.mark = \",\"),\n            format(sum(mdata$gi_stats &gt; 1.96), big.mark = \",\"),\n            format(sum(mdata$gi_stats &lt; -1.96), big.mark = \",\"))\n)\n\nkable(summary_stats, \n      caption = \"Summary of Spatial Autocorrelation Results\",\n      format = \"simple\")\n\n\nSummary of Spatial Autocorrelation Results\n\n\nStatistic\nValue\n\n\n\n\nObservations\n15,901\n\n\nGlobal Moran’s I\n0.9272\n\n\nGlobal Geary’s C\n0.0869\n\n\nSignificant LISA (p&lt;0.05)\n6,543\n\n\nHH Clusters\n2,829\n\n\nLL Clusters\n3,662\n\n\nHot Spots (95%)\n2,879\n\n\nCold Spots (95%)\n3,664\n\n\n\n\n\n\n\n10.2 Top Locations (Interactive Table)\n\n# Top hot spots\ntop_hotspots &lt;- mdata %&gt;%\n  st_drop_geometry() %&gt;%\n  filter(gi_stats &gt; 2.58) %&gt;%\n  arrange(desc(gi_stats)) %&gt;%\n  select(resale_price, floor_area_sqm, PROX_CBD, gi_stats) %&gt;%\n  slice_head(n = 10) %&gt;%\n  mutate(resale_price = format(resale_price, big.mark = \",\"),\n         across(c(floor_area_sqm, PROX_CBD, gi_stats), ~round(., 2)))\n\ncat(\"Top 10 Hot Spots:\\n\")\n\nTop 10 Hot Spots:\n\nDT::datatable(top_hotspots, \n              options = list(dom = 't', \n                            pageLength = 10),\n              rownames = FALSE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#interactive-visualization-optimized",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#interactive-visualization-optimized",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "11. Interactive Visualization (Optimized)",
    "text": "11. Interactive Visualization (Optimized)\n\n# Sample for interactive map\nset.seed(1234)\nmdata_interactive &lt;- mdata[sample(nrow(mdata), 1500), ]\n\ntmap_mode(\"view\")\ntm_shape(mdata_interactive) +\n  tm_dots(\"resale_price\",\n          size = 0.02,\n          style = \"quantile\",\n          palette = \"YlOrRd\",\n          title = \"Price\",\n          popup.vars = c(\"Price\" = \"resale_price\",\n                        \"Floor Area\" = \"floor_area_sqm\",\n                        \"LISA\" = \"quadrant_sig\",\n                        \"Hot/Cold\" = \"gi_category\"),\n          clustering = TRUE)  # Enable clustering for performance\n\n\n\n\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#save-results",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#save-results",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "12. Save Results",
    "text": "12. Save Results\n\n# Save enhanced dataset\nsaveRDS(mdata, \"data/model/mdata_analyzed.rds\")\n\n# Create compact summary\nresults_summary &lt;- list(\n  n_obs = nrow(mdata),\n  global_moran = round(MC_moran$statistic, 4),\n  global_geary = round(MC_geary$statistic, 4),\n  n_significant = sum(mdata$P_value &lt;= 0.05),\n  date = Sys.Date()\n)\n\nsaveRDS(results_summary, \"data/model/spatial_autocorr_results.rds\")\n\ncat(\"✅ Analysis complete! Results saved to data/model/\\n\")\n\n✅ Analysis complete! Results saved to data/model/"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex08/ex08.html#conclusions",
    "href": "Hands-on_Ex/Hands-on_ex08/ex08.html#conclusions",
    "title": "Hands-on Exercise 08: Global and Local Measures of Spatial Autocorrelation",
    "section": "13. Conclusions",
    "text": "13. Conclusions\n\nKey Findings\nThis spatial autocorrelation analysis of 15,901 HDB resale transactions reveals:\n\nStrong Positive Spatial Autocorrelation:\n\nGlobal Moran’s I confirms significant spatial clustering\nSimilar-priced properties cluster together\n\nDistinct Spatial Patterns:\n\nHH clusters in prime locations\nLL clusters in peripheral areas\nSpatial outliers indicate transitional zones\n\nPolicy Implications:\n\nSpatial spillover effects are significant\nTargeted area-based interventions needed\nInfrastructure improvements can reduce spatial inequality\n\n\n\n\nMethodological Notes\n\nLarge dataset (15,901 points) requires computational optimization\nK=8 nearest neighbors appropriate for dense point patterns\nResults robust across different specifications"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "",
    "text": "Since the OD_Matrix.csv contains Origin-Destination cost data rather than property transaction data, this exercise will demonstrate: 1. Spatial accessibility analysis using the OD matrix 2. Creating synthetic property data for GWR demonstration 3. Applying GWR methods to understand spatial heterogeneity\n\n\nBy the end of this exercise, you will be able to: - Understand OD matrix applications in spatial analysis - Generate synthetic spatial data for modeling - Apply GWR methods to spatial data - Visualize spatial patterns and relationships"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#overview",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#overview",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "",
    "text": "Since the OD_Matrix.csv contains Origin-Destination cost data rather than property transaction data, this exercise will demonstrate: 1. Spatial accessibility analysis using the OD matrix 2. Creating synthetic property data for GWR demonstration 3. Applying GWR methods to understand spatial heterogeneity\n\n\nBy the end of this exercise, you will be able to: - Understand OD matrix applications in spatial analysis - Generate synthetic spatial data for modeling - Apply GWR methods to spatial data - Visualize spatial patterns and relationships"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#the-data",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#the-data",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "2. The Data",
    "text": "2. The Data\nWe have the following datasets: 1. URA Master Plan 2014 subzone boundaries (MP14_SUBZONE_NO_SEA_PL) 2. Eldercare facilities (ELDERCARE) 3. OD Matrix - Origin-Destination cost matrix 4. Hexagon grid (hexagons) for visualization"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#getting-started",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "3. Getting Started",
    "text": "3. Getting Started\n\n3.1 Loading Required Packages\n\npacman::p_load(sf, tidyverse, tmap, spdep, GWmodel, \n               ggpubr, corrplot, plotly, gtsummary,\n               olsrr, devtools, parallel, readr)\n\n\n\n3.2 Setting Up the Environment\n\n# Set tmap mode to plot for better performance\ntmap_mode(\"plot\")\n\n# Set seed for reproducibility\nset.seed(12345)\n\n# Set up parallel processing\ncores &lt;- max(1, parallel::detectCores() - 1)\ncat(\"Number of cores available for parallel processing:\", cores, \"\\n\")\n\nNumber of cores available for parallel processing: 21"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-geospatial-data",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-geospatial-data",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "4. Import Geospatial Data",
    "text": "4. Import Geospatial Data\n\n4.1 Import Subzone Boundaries\n\n# Read Master Plan 2014 Subzone Boundary\nmpsz &lt;- st_read(dsn = \"data/geospatial\", \n                layer = \"MP14_SUBZONE_NO_SEA_PL\",\n                quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\ncat(\"Number of subzones:\", nrow(mpsz), \"\\n\")\n\nNumber of subzones: 323 \n\n\n\n\n4.2 Import Eldercare Facilities\n\n# Read eldercare facilities\neldercare &lt;- st_read(dsn = \"data/geospatial\",\n                     layer = \"ELDERCARE\",\n                     quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\ncat(\"Number of eldercare facilities:\", nrow(eldercare), \"\\n\")\n\nNumber of eldercare facilities: 120 \n\n\n\n\n4.3 Import Hexagon Grid\n\n# Read hexagon grid\nhexagons &lt;- st_read(dsn = \"data/geospatial\",\n                    layer = \"hexagons\",\n                    quiet = TRUE) %&gt;%\n  st_transform(crs = 3414)\n\ncat(\"Number of hexagons:\", nrow(hexagons), \"\\n\")\n\nNumber of hexagons: 3125"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-and-analyze-od-matrix",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#import-and-analyze-od-matrix",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "5. Import and Analyze OD Matrix",
    "text": "5. Import and Analyze OD Matrix\n\n5.1 Import OD Matrix\n\n# Read OD Matrix\nod_data &lt;- read_csv(\"data/aspatial/OD_Matrix.csv\",\n                    show_col_types = FALSE)\n\n# Display structure\nglimpse(od_data)\n\nRows: 375,000\nColumns: 6\n$ origin_id      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ destination_id &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18,…\n$ entry_cost     &lt;dbl&gt; 667.9336, 667.9336, 667.9336, 667.9336, 667.9336, 667.9…\n$ network_cost   &lt;dbl&gt; 19846.87, 45026.76, 17644.17, 36009.56, 31068.09, 31194…\n$ exit_cost      &lt;dbl&gt; 47.64874, 31.87162, 173.47882, 92.19676, 64.62840, 117.…\n$ total_cost     &lt;dbl&gt; 20562.45, 45726.57, 18485.58, 36769.69, 31800.65, 31979…\n\n# Summary statistics\nsummary(od_data$total_cost)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   36.93 11675.78 17303.99 18355.00 23649.11 56350.82 \n\n\n\n\n5.2 Create Distance Matrix\n\n# Convert OD data to wide format distance matrix\ndistance_matrix &lt;- od_data %&gt;%\n  select(origin_id, destination_id, total_cost) %&gt;%\n  pivot_wider(names_from = destination_id,\n              values_from = total_cost,\n              names_prefix = \"dest_\")\n\ncat(\"Distance matrix dimensions:\", dim(distance_matrix), \"\\n\")\n\nDistance matrix dimensions: 3125 121 \n\n# Display first few rows and columns\ndistance_matrix[1:5, 1:6]\n\n# A tibble: 5 × 6\n  origin_id dest_1 dest_2 dest_3 dest_4 dest_5\n      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n1         1 20562. 45727. 18486. 36770. 31801.\n2         2 23069. 48233. 20992. 39276. 34307.\n3         3 23590. 48754. 21513. 39797. 34828.\n4         4 24069. 49233. 21992. 40276. 35307.\n5         5 24241. 49405. 22164. 40448. 35479.\n\n\n\n\n5.3 Analyze Accessibility to Eldercare\n\n# Calculate accessibility metrics\n# For demonstration, we'll use the first 120 destinations as eldercare locations\neldercare_ids &lt;- 1:min(120, max(od_data$destination_id))\n\naccessibility_eldercare &lt;- od_data %&gt;%\n  filter(destination_id %in% eldercare_ids) %&gt;%\n  group_by(origin_id) %&gt;%\n  summarise(\n    min_cost_eldercare = min(total_cost),\n    mean_cost_eldercare = mean(total_cost),\n    accessibility_index = 1 / mean(total_cost) * 10000\n  )\n\nsummary(accessibility_eldercare)\n\n   origin_id    min_cost_eldercare mean_cost_eldercare accessibility_index\n Min.   :   1   Min.   :   36.93   Min.   : 4974       Min.   :0.2389     \n 1st Qu.: 782   1st Qu.: 2213.14   1st Qu.:13666       1st Qu.:0.4547     \n Median :1563   Median : 4069.30   Median :16768       Median :0.5964     \n Mean   :1563   Mean   : 6118.05   Mean   :18425       Mean   :0.6055     \n 3rd Qu.:2344   3rd Qu.: 8061.08   3rd Qu.:21992       3rd Qu.:0.7317     \n Max.   :3125   Max.   :32450.08   Max.   :41859       Max.   :2.0105"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#generate-synthetic-property-data",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#generate-synthetic-property-data",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "6. Generate Synthetic Property Data",
    "text": "6. Generate Synthetic Property Data\nSince we don’t have actual property data, we’ll create synthetic data based on spatial patterns:\n\n# Generate synthetic property data for demonstration\nn_properties &lt;- 2000\n\n# Create random points within Singapore boundaries\nbbox &lt;- st_bbox(mpsz)\nsynthetic_properties &lt;- data.frame(\n  property_id = 1:n_properties,\n  x = runif(n_properties, bbox$xmin, bbox$xmax),\n  y = runif(n_properties, bbox$ymin, bbox$ymax)\n) %&gt;%\n  st_as_sf(coords = c(\"x\", \"y\"), crs = 3414)\n\n# Keep only points within actual boundaries\nsynthetic_properties &lt;- synthetic_properties[mpsz, ]\nn_properties &lt;- nrow(synthetic_properties)\n\ncat(\"Number of synthetic properties within boundaries:\", n_properties, \"\\n\")\n\nNumber of synthetic properties within boundaries: 838 \n\n\n\n6.1 Generate Property Attributes\n\n# Extract coordinates for distance calculations\ncoords &lt;- st_coordinates(synthetic_properties)\n\n# Calculate distance to CBD (assume CBD is at central point)\ncbd_point &lt;- c(mean(bbox$xmin, bbox$xmax), mean(bbox$ymin, bbox$ymax))\ndist_cbd &lt;- sqrt((coords[,1] - cbd_point[1])^2 + (coords[,2] - cbd_point[2])^2)\n\n# Generate synthetic property attributes with spatial correlation\nsynthetic_properties &lt;- synthetic_properties %&gt;%\n  mutate(\n    # Structural attributes\n    AREA_SQM = rnorm(n(), mean = 100, sd = 30) + (15000 - dist_cbd/1000) * 0.002,\n    AREA_SQM = pmax(AREA_SQM, 40),  # Minimum 40 sqm\n    AGE = rpois(n(), lambda = 10) + runif(n(), 0, 5),\n    NO_OF_UNITS = sample(50:500, n(), replace = TRUE),\n    \n    # Location attributes (using actual distances)\n    PROX_CBD = dist_cbd,\n    PROX_MRT = abs(rnorm(n(), mean = 800, sd = 400)) + dist_cbd * 0.05,\n    PROX_PARK = abs(rnorm(n(), mean = 500, sd = 200)),\n    PROX_SHOPPING_MALL = abs(rnorm(n(), mean = 1000, sd = 500)),\n    PROX_PRIMARY_SCH = abs(rnorm(n(), mean = 600, sd = 300)),\n    PROX_BUS_STOP = abs(rnorm(n(), mean = 200, sd = 100)),\n    \n    # Binary attributes\n    FREEHOLD = sample(c(0, 1), n(), replace = TRUE, prob = c(0.7, 0.3)),\n    \n    # Generate price based on attributes with spatial variation\n    SELLING_PRICE = 300000 +  # Base price\n      AREA_SQM * 8000 +        # Price per sqm\n      -AGE * 5000 +            # Age depreciation\n      -PROX_CBD * 20 +         # CBD distance effect\n      -PROX_MRT * 15 +         # MRT distance effect\n      FREEHOLD * 50000 +       # Freehold premium\n      rnorm(n(), 0, 50000) +   # Random variation\n      # Add spatial autocorrelation component\n      10000 * sin(coords[,1]/5000) * cos(coords[,2]/5000),\n    \n    # Ensure positive prices\n    SELLING_PRICE = pmax(SELLING_PRICE, 100000),\n    \n    # Log transformation\n    LOG_SELLING_PRICE = log(SELLING_PRICE)\n  )\n\n# Summary of synthetic data\nsummary(synthetic_properties %&gt;% \n        st_drop_geometry() %&gt;%\n        select(SELLING_PRICE, AREA_SQM, AGE, PROX_CBD, PROX_MRT))\n\n SELLING_PRICE        AREA_SQM          AGE            PROX_CBD    \n Min.   : 100000   Min.   : 40.0   Min.   : 3.432   Min.   : 6930  \n 1st Qu.: 325512   1st Qu.:110.5   1st Qu.: 9.947   1st Qu.:25825  \n Median : 572747   Median :129.6   Median :12.441   Median :33394  \n Mean   : 585239   Mean   :129.4   Mean   :12.472   Mean   :33931  \n 3rd Qu.: 831244   3rd Qu.:148.5   3rd Qu.:14.782   3rd Qu.:41905  \n Max.   :1626410   Max.   :212.6   Max.   :23.104   Max.   :59745  \n    PROX_MRT     \n Min.   : 691.2  \n 1st Qu.:2014.4  \n Median :2469.3  \n Mean   :2505.1  \n 3rd Qu.:2965.2  \n Max.   :4624.8"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#exploratory-data-analysis",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#exploratory-data-analysis",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "7. Exploratory Data Analysis",
    "text": "7. Exploratory Data Analysis\n\n7.1 Visualize Property Distribution\n\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\",\n              border.col = \"grey60\",\n              lwd = 0.5) +\ntm_shape(synthetic_properties) +\n  tm_dots(col = \"SELLING_PRICE\",\n          size = 0.02,\n          style = \"quantile\",\n          n = 5,\n          palette = \"YlOrRd\",\n          title = \"Selling Price ($)\",\n          alpha = 0.6) +\n  tm_layout(main.title = \"Distribution of Synthetic Property Prices\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\n\n\n\n\n\n7.2 Price Distribution Analysis\n\npar(mfrow = c(1, 2))\nhist(synthetic_properties$SELLING_PRICE/1000, \n     main = \"Distribution of Selling Price\",\n     xlab = \"Selling Price ($'000)\",\n     col = \"lightblue\",\n     breaks = 30)\nhist(synthetic_properties$LOG_SELLING_PRICE,\n     main = \"Distribution of Log Selling Price\",\n     xlab = \"Log(Selling Price)\",\n     col = \"lightgreen\",\n     breaks = 30)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))\n\n\n\n7.3 Correlation Analysis\n\n# Select numeric variables for correlation\ncor_vars &lt;- synthetic_properties %&gt;%\n  st_drop_geometry() %&gt;%\n  select(SELLING_PRICE, AREA_SQM, AGE, PROX_CBD, PROX_MRT,\n         PROX_PARK, PROX_SHOPPING_MALL, PROX_PRIMARY_SCH, PROX_BUS_STOP)\n\n# Calculate correlation matrix\ncor_matrix &lt;- cor(cor_vars)\n\n# Visualize\ncorrplot(cor_matrix,\n         method = \"circle\",\n         type = \"upper\",\n         diag = FALSE,\n         tl.cex = 0.8,\n         tl.col = \"black\",\n         tl.srt = 45)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#ols-regression-model",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#ols-regression-model",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "8. OLS Regression Model",
    "text": "8. OLS Regression Model\n\n8.1 Build OLS Model\n\n# Build OLS model\nols_model &lt;- lm(LOG_SELLING_PRICE ~ AREA_SQM + AGE + \n                  PROX_CBD + PROX_MRT + PROX_PARK +\n                  PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n                  PROX_BUS_STOP + FREEHOLD,\n                data = synthetic_properties)\n\nsummary(ols_model)\n\n\nCall:\nlm(formula = LOG_SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_MRT + PROX_PARK + PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n    PROX_BUS_STOP + FREEHOLD, data = synthetic_properties)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.82778 -0.11477  0.05392  0.15644  0.75009 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)         1.262e+01  6.532e-02 193.259  &lt; 2e-16 ***\nAREA_SQM            1.546e-02  2.797e-04  55.263  &lt; 2e-16 ***\nAGE                -8.715e-03  2.328e-03  -3.744 0.000193 ***\nPROX_CBD           -4.022e-05  1.217e-06 -33.049  &lt; 2e-16 ***\nPROX_MRT           -4.108e-05  2.013e-05  -2.040 0.041659 *  \nPROX_PARK          -5.979e-06  3.997e-05  -0.150 0.881125    \nPROX_SHOPPING_MALL -2.859e-06  1.666e-05  -0.172 0.863771    \nPROX_PRIMARY_SCH    1.079e-05  2.670e-05   0.404 0.686122    \nPROX_BUS_STOP      -4.446e-05  8.218e-05  -0.541 0.588645    \nFREEHOLD            1.090e-01  1.714e-02   6.358 3.36e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2278 on 828 degrees of freedom\nMultiple R-squared:  0.9006,    Adjusted R-squared:  0.8995 \nF-statistic: 833.2 on 9 and 828 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n8.2 Model Diagnostics\n\npar(mfrow = c(2, 2))\nplot(ols_model)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#test-for-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#test-for-spatial-autocorrelation",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "9. Test for Spatial Autocorrelation",
    "text": "9. Test for Spatial Autocorrelation\n\n9.1 Create Spatial Weights\n\n# Add residuals to spatial data\nsynthetic_properties$ols_residuals &lt;- residuals(ols_model)\n\n# Create spatial weights\ncoords &lt;- st_coordinates(synthetic_properties)\nknn_nb &lt;- knn2nb(knearneigh(coords, k = 8))\nknn_listw &lt;- nb2listw(knn_nb, style = \"W\")\n\n\n\n9.2 Moran’s I Test\n\nmoran_test &lt;- moran.test(synthetic_properties$ols_residuals, knn_listw)\nprint(moran_test)\n\n\n    Moran I test under randomisation\n\ndata:  synthetic_properties$ols_residuals  \nweights: knn_listw    \n\nMoran I statistic standard deviate = 7.713, p-value = 6.144e-15\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.1251081698     -0.0011947431      0.0002681507 \n\n# Moran scatterplot\nmoran.plot(synthetic_properties$ols_residuals, knn_listw,\n           main = \"Moran Scatterplot of OLS Residuals\",\n           xlab = \"Residuals\",\n           ylab = \"Spatially Lagged Residuals\",\n           labels = FALSE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#geographically-weighted-regression",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#geographically-weighted-regression",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "10. Geographically Weighted Regression",
    "text": "10. Geographically Weighted Regression\n\n10.1 Prepare Data for GWR\n\n# Convert to Spatial object for GWmodel\nproperties_sp &lt;- as(synthetic_properties, \"Spatial\")\n\n\n\n10.2 Adaptive Bandwidth GWR\n\n# Cache file\ncache_file &lt;- \"gwr_synthetic_cache.rds\"\n\nif(file.exists(cache_file)){\n  cat(\"Loading cached GWR results...\\n\")\n  gwr_results &lt;- readRDS(cache_file)\n  bw_adaptive &lt;- gwr_results$bw\n  gwr_adaptive &lt;- gwr_results$model\n} else {\n  cat(\"Calculating optimal adaptive bandwidth...\\n\")\n  \n  # Determine optimal bandwidth\n  bw_adaptive &lt;- bw.gwr(LOG_SELLING_PRICE ~ AREA_SQM + AGE + \n                         PROX_CBD + PROX_MRT + PROX_PARK +\n                         PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n                         PROX_BUS_STOP + FREEHOLD,\n                       data = properties_sp,\n                       approach = \"AICc\",\n                       kernel = \"bisquare\",\n                       adaptive = TRUE,\n                       longlat = FALSE,\n                       parallel.method = \"omp\",\n                       parallel.arg = cores)\n  \n  cat(\"Optimal bandwidth:\", bw_adaptive, \"neighbors\\n\")\n  \n  # Calibrate GWR model\n  gwr_adaptive &lt;- gwr.basic(LOG_SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_MRT + PROX_PARK +\n                            PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n                            PROX_BUS_STOP + FREEHOLD,\n                          data = properties_sp,\n                          bw = bw_adaptive,\n                          kernel = \"bisquare\",\n                          adaptive = TRUE,\n                          longlat = FALSE)\n  \n  # Save cache\n  saveRDS(list(bw = bw_adaptive, model = gwr_adaptive), cache_file)\n}\n\nLoading cached GWR results...\n\nprint(gwr_adaptive)\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2025-11-08 10:28:21.694015 \n   Call:\n   gwr.basic(formula = LOG_SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_MRT + PROX_PARK + PROX_SHOPPING_MALL + PROX_PRIMARY_SCH + \n    PROX_BUS_STOP + FREEHOLD, data = properties_sp, bw = bw_adaptive, \n    kernel = \"bisquare\", adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  LOG_SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_MRT PROX_PARK PROX_SHOPPING_MALL PROX_PRIMARY_SCH PROX_BUS_STOP FREEHOLD\n   Number of data points: 838\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-0.82778 -0.11477  0.05392  0.15644  0.75009 \n\n   Coefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)         1.262e+01  6.532e-02 193.259  &lt; 2e-16 ***\n   AREA_SQM            1.546e-02  2.797e-04  55.263  &lt; 2e-16 ***\n   AGE                -8.715e-03  2.328e-03  -3.744 0.000193 ***\n   PROX_CBD           -4.022e-05  1.217e-06 -33.049  &lt; 2e-16 ***\n   PROX_MRT           -4.108e-05  2.013e-05  -2.040 0.041659 *  \n   PROX_PARK          -5.979e-06  3.997e-05  -0.150 0.881125    \n   PROX_SHOPPING_MALL -2.859e-06  1.666e-05  -0.172 0.863771    \n   PROX_PRIMARY_SCH    1.079e-05  2.670e-05   0.404 0.686122    \n   PROX_BUS_STOP      -4.446e-05  8.218e-05  -0.541 0.588645    \n   FREEHOLD            1.090e-01  1.714e-02   6.358 3.36e-10 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 0.2278 on 828 degrees of freedom\n   Multiple R-squared: 0.9006\n   Adjusted R-squared: 0.8995 \n   F-statistic: 833.2 on 9 and 828 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 42.98441\n   Sigma(hat): 0.2267526\n   AIC:  -88.8704\n   AICc:  -88.55078\n   BIC:  -800.788\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: bisquare \n   Adaptive bandwidth: 323 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                             Min.     1st Qu.      Median     3rd Qu.    Max.\n   Intercept           1.2271e+01  1.2523e+01  1.2685e+01  1.2798e+01 12.9082\n   AREA_SQM            9.7076e-03  1.2572e-02  1.6222e-02  1.9173e-02  0.0213\n   AGE                -1.7725e-02 -1.1518e-02 -7.0853e-03 -4.7165e-03 -0.0024\n   PROX_CBD           -5.8508e-05 -4.7722e-05 -3.8656e-05 -3.1402e-05  0.0000\n   PROX_MRT           -8.8581e-05 -6.7459e-05 -3.8171e-05 -2.2047e-05  0.0000\n   PROX_PARK          -1.3381e-04 -5.1991e-05 -1.0447e-05  2.6315e-05  0.0002\n   PROX_SHOPPING_MALL -6.3753e-05 -3.5783e-05 -9.6839e-06  6.0429e-06  0.0000\n   PROX_PRIMARY_SCH   -6.7361e-05 -1.6536e-05 -3.9701e-06  1.1177e-05  0.0000\n   PROX_BUS_STOP      -2.3674e-04 -8.4826e-05 -2.6751e-05  5.5639e-05  0.0002\n   FREEHOLD            4.8283e-02  6.9573e-02  9.1426e-02  1.3896e-01  0.1610\n   ************************Diagnostic information*************************\n   Number of data points: 838 \n   Effective number of parameters (2trace(S) - trace(S'S)): 81.62715 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 756.3729 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): -441.5433 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): -514.6195 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): -1003.044 \n   Residual sum of squares: 24.68628 \n   R-square value:  0.9428931 \n   Adjusted R-square value:  0.936722 \n\n   ***********************************************************************\n   Program stops at: 2025-11-08 10:28:21.844458 \n\n\n\n\n10.3 Extract GWR Results\n\n# Extract results\ngwr_sf &lt;- st_as_sf(gwr_adaptive$SDF)\n\n# Add to original data\nsynthetic_properties$gwr_localR2 &lt;- gwr_sf$Local_R2\nsynthetic_properties$gwr_residual &lt;- gwr_sf$residual\n\n# Summary of Local R²\nsummary(synthetic_properties$gwr_localR2)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.9077  0.9236  0.9407  0.9422  0.9560  0.9897"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#visualize-gwr-results",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#visualize-gwr-results",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "11. Visualize GWR Results",
    "text": "11. Visualize GWR Results\n\n11.1 Map Local R²\n\ntm_shape(mpsz) +\n  tm_polygons(col = \"grey95\",\n              border.col = \"grey60\",\n              lwd = 0.5) +\ntm_shape(synthetic_properties) +\n  tm_dots(col = \"gwr_localR2\",\n          size = 0.03,\n          style = \"quantile\",\n          n = 5,\n          palette = \"RdPu\",\n          title = \"Local R²\",\n          alpha = 0.7) +\n  tm_layout(main.title = \"GWR Local R² Values\",\n            main.title.size = 1.2,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE)\n\n\n\n\n\n\n\n\n\n\n11.2 Compare Residuals\n\ntm1 &lt;- tm_shape(mpsz) +\n       tm_polygons(alpha = 0.4) +\n       tm_shape(synthetic_properties) +\n       tm_dots(col = \"ols_residuals\",\n               size = 0.02,\n               style = \"quantile\",\n               palette = \"-RdBu\",\n               title = \"OLS Residuals\") +\n       tm_layout(main.title = \"OLS Residuals\")\n\ntm2 &lt;- tm_shape(mpsz) +\n       tm_polygons(alpha = 0.4) +\n       tm_shape(synthetic_properties) +\n       tm_dots(col = \"gwr_residual\",\n               size = 0.02,\n               style = \"quantile\",\n               palette = \"-RdBu\",\n               title = \"GWR Residuals\") +\n       tm_layout(main.title = \"GWR Residuals\")\n\ntmap_arrange(tm1, tm2, ncol = 2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#model-comparison",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#model-comparison",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "12. Model Comparison",
    "text": "12. Model Comparison\n\n12.1 Performance Metrics\n\n# Compare models\ncomparison &lt;- data.frame(\n  Model = c(\"OLS\", \"GWR Adaptive\"),\n  AICc = c(AIC(ols_model), gwr_adaptive$GW.diagnostic$AICc),\n  Adj_R2 = c(summary(ols_model)$adj.r.squared, \n             gwr_adaptive$GW.diagnostic$R2.adj),\n  RSS = c(sum(residuals(ols_model)^2),\n          gwr_adaptive$GW.diagnostic$RSS.gw)\n)\n\nknitr::kable(comparison, digits = 3,\n             caption = \"Model Performance Comparison\")\n\n\nModel Performance Comparison\n\n\nModel\nAICc\nAdj_R2\nRSS\n\n\n\n\nOLS\n-88.870\n0.899\n42.984\n\n\nGWR Adaptive\n-441.543\n0.899\n24.686\n\n\n\n\n\n\n\n12.2 Spatial Autocorrelation in Residuals\n\n# Test GWR residuals\nmoran_gwr &lt;- moran.test(synthetic_properties$gwr_residual, knn_listw)\n\n# Compare Moran's I\nmoran_comparison &lt;- data.frame(\n  Model = c(\"OLS\", \"GWR\"),\n  Morans_I = c(moran_test$estimate[1], moran_gwr$estimate[1]),\n  P_value = c(moran_test$p.value, moran_gwr$p.value)\n)\n\nknitr::kable(moran_comparison, digits = 4,\n             caption = \"Spatial Autocorrelation Comparison\")\n\n\nSpatial Autocorrelation Comparison\n\n\nModel\nMorans_I\nP_value\n\n\n\n\nOLS\n0.1251\n0.0000\n\n\nGWR\n-0.0017\n0.5129"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#key-findings-and-conclusions",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#key-findings-and-conclusions",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "13. Key Findings and Conclusions",
    "text": "13. Key Findings and Conclusions\n\nSummary\nThis analysis demonstrates the application of GWR methods using:\n\nOD Matrix Analysis: Understanding spatial accessibility patterns\nSynthetic Data Generation: Creating spatially correlated property data\nGWR Application: Capturing spatial heterogeneity in relationships\n\n\n\nKey Insights:\n\nSpatial Heterogeneity: GWR reveals that relationships between property prices and attributes vary across space\nModel Improvement: GWR shows better fit than OLS (higher R², lower AICc)\nReduced Spatial Autocorrelation: GWR effectively captures spatial patterns\n\n\n\nLimitations:\n\nThis uses synthetic data for demonstration\nReal property data would show more complex patterns\nAdditional variables would improve model performance\n\n\n\nNext Steps:\nTo apply this with real data: 1. Obtain actual property transaction data 2. Include more location-specific amenities 3. Consider temporal dimensions 4. Explore other spatial modeling techniques"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_ex09/ex09.html#notes-on-data-requirements",
    "href": "Hands-on_Ex/Hands-on_ex09/ex09.html#notes-on-data-requirements",
    "title": "Hands-on Exercise 09: Spatial Accessibility Analysis and GWR Method",
    "section": "14. Notes on Data Requirements",
    "text": "14. Notes on Data Requirements\nFor a complete hedonic pricing analysis, you would need:\n\nProperty Transaction Data with:\n\nSelling prices\nProperty characteristics (area, age, type)\nExact locations (coordinates)\nTransaction dates\n\nProximity Variables:\n\nDistance to amenities\nAccessibility indices\nNeighborhood characteristics\n\nSpatial Data:\n\nAdministrative boundaries\nTransportation networks\nLand use patterns\n\n\nThe OD matrix can be used to calculate sophisticated accessibility measures that can be incorporated as variables in the hedonic pricing model."
  }
]